(self.webpackChunkTS24AppWeb=self.webpackChunkTS24AppWeb||[]).push([[7],{7:(yo,Ca,oe)=>{"use strict";oe.r(Ca),oe.d(Ca,{TicketListModule:()=>pE});var $t=oe(1083),ve=oe(2382),K=oe(9808),on=oe(520),Fr=oe(2866),n=oe(5e3),mn=oe(9071),zi=oe(7429),ct=oe(7904),Ee=oe(969),be=oe(226);new n.OlP("nz-empty-component-name");let Od=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[be.vT,K.ez,zi.eL,Ee.T,ct.YI]]}),t})();var Pt=oe(3087),Mn=oe(2683),Bt=oe(9776),Ed=oe(5911),Rn=oe(4832),cr=oe(925),bt=oe(6950);let cl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[be.vT,K.ez,ct.YI,ve.u5,cr.ud,Bt.U8,Pt.PV,Ee.T,Od,bt.e4,Rn.g,Mn.a,mn.Cl,Ed.rt]]}),t})();var Oe=oe(655),rt=oe(7579),En=oe(1135),ur=oe(6451),Ii=oe(9841),Yn=oe(4004),ul=oe(5577),dr=oe(9300),Oi=oe(9718),dl=oe(3601),wo=oe(1884),Re=oe(2722),fl=oe(8675),zt=oe(3900),_e=oe(1721),Ei=oe(8076);const Gd=["nz-submenu-title",""];function Wd(t,r){if(1&t&&n._UZ(0,"i",4),2&t){const e=n.oxw();n.Q6J("nzType",e.nzIcon)}}function Yd(t,r){if(1&t&&(n.ynx(0),n.TgZ(1,"span"),n._uU(2),n.qZA(),n.BQk()),2&t){const e=n.oxw();n.xp6(2),n.Oqu(e.nzTitle)}}function $d(t,r){1&t&&n._UZ(0,"i",8)}function Jd(t,r){1&t&&n._UZ(0,"i",9)}function Qd(t,r){if(1&t&&(n.TgZ(0,"span",5),n.YNc(1,$d,1,0,"i",6),n.YNc(2,Jd,1,0,"i",7),n.qZA()),2&t){const e=n.oxw();n.Q6J("ngSwitch",e.dir),n.xp6(1),n.Q6J("ngSwitchCase","rtl")}}function qd(t,r){1&t&&n._UZ(0,"i",10)}const Xd=["*"],Kd=["nz-submenu-inline-child",""];function ef(t,r){}const tf=["nz-submenu-none-inline-child",""];function nf(t,r){}const rf=["nz-submenu",""];function af(t,r){1&t&&n.Hsn(0,0,["*ngIf","!nzTitle"])}function sf(t,r){if(1&t&&n._UZ(0,"div",6),2&t){const e=n.oxw(),i=n.MAs(7);n.Q6J("mode",e.mode)("nzOpen",e.nzOpen)("@.disabled",null==e.noAnimation?null:e.noAnimation.nzNoAnimation)("nzNoAnimation",null==e.noAnimation?null:e.noAnimation.nzNoAnimation)("menuClass",e.nzMenuClassName)("templateOutlet",i)}}function lf(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"div",8),n.NdJ("subMenuMouseState",function(a){return n.CHM(e),n.oxw(2).setMouseEnterState(a)}),n.qZA()}if(2&t){const e=n.oxw(2),i=n.MAs(7);n.Q6J("theme",e.theme)("mode",e.mode)("nzOpen",e.nzOpen)("position",e.position)("nzDisabled",e.nzDisabled)("isMenuInsideDropDown",e.isMenuInsideDropDown)("templateOutlet",i)("menuClass",e.nzMenuClassName)("@.disabled",null==e.noAnimation?null:e.noAnimation.nzNoAnimation)("nzNoAnimation",null==e.noAnimation?null:e.noAnimation.nzNoAnimation)}}function cf(t,r){if(1&t){const e=n.EpF();n.YNc(0,lf,1,10,"ng-template",7),n.NdJ("positionChange",function(a){return n.CHM(e),n.oxw().onPositionChange(a)})}if(2&t){const e=n.oxw(),i=n.MAs(1);n.Q6J("cdkConnectedOverlayPositions",e.overlayPositions)("cdkConnectedOverlayOrigin",i)("cdkConnectedOverlayWidth",e.triggerWidth)("cdkConnectedOverlayOpen",e.nzOpen)("cdkConnectedOverlayTransformOriginOn",".ant-menu-submenu")}}function uf(t,r){1&t&&n.Hsn(0,1)}const df=[[["","title",""]],"*"],ff=["[title]","*"],Ar=new n.OlP("NzIsInDropDownMenuToken"),pl=new n.OlP("NzMenuServiceLocalToken");let $n=(()=>{class t{constructor(){this.descendantMenuItemClick$=new rt.x,this.childMenuItemClick$=new rt.x,this.theme$=new En.X("light"),this.mode$=new En.X("vertical"),this.inlineIndent$=new En.X(24),this.isChildSubMenuOpen$=new En.X(!1)}onDescendantMenuItemClick(e){this.descendantMenuItemClick$.next(e)}onChildMenuItemClick(e){this.childMenuItemClick$.next(e)}setMode(e){this.mode$.next(e)}setTheme(e){this.theme$.next(e)}setInlineIndent(e){this.inlineIndent$.next(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac}),t})(),To=(()=>{class t{constructor(e,i,a){this.nzHostSubmenuService=e,this.nzMenuService=i,this.isMenuInsideDropDown=a,this.mode$=this.nzMenuService.mode$.pipe((0,Yn.U)(c=>"inline"===c?"inline":"vertical"===c||this.nzHostSubmenuService?"vertical":"horizontal")),this.level=1,this.isCurrentSubMenuOpen$=new En.X(!1),this.isChildSubMenuOpen$=new En.X(!1),this.isMouseEnterTitleOrOverlay$=new rt.x,this.childMenuItemClick$=new rt.x,this.destroy$=new rt.x,this.nzHostSubmenuService&&(this.level=this.nzHostSubmenuService.level+1);const o=this.childMenuItemClick$.pipe((0,ul.z)(()=>this.mode$),(0,dr.h)(c=>"inline"!==c||this.isMenuInsideDropDown),(0,Oi.h)(!1)),s=(0,ur.T)(this.isMouseEnterTitleOrOverlay$,o);(0,Ii.a)([this.isChildSubMenuOpen$,s]).pipe((0,Yn.U)(([c,u])=>c||u),(0,dl.e)(150),(0,wo.x)(),(0,Re.R)(this.destroy$)).pipe((0,wo.x)()).subscribe(c=>{this.setOpenStateWithoutDebounce(c),this.nzHostSubmenuService?this.nzHostSubmenuService.isChildSubMenuOpen$.next(c):this.nzMenuService.isChildSubMenuOpen$.next(c)})}onChildMenuItemClick(e){this.childMenuItemClick$.next(e)}setOpenStateWithoutDebounce(e){this.isCurrentSubMenuOpen$.next(e)}setMouseEnterTitleOrOverlayState(e){this.isMouseEnterTitleOrOverlay$.next(e)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(n.LFG(t,12),n.LFG($n),n.LFG(Ar))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac}),t})(),Sa=(()=>{class t{constructor(e,i,a,o,s,l,c,u){this.nzMenuService=e,this.cdr=i,this.nzSubmenuService=a,this.isMenuInsideDropDown=o,this.directionality=s,this.routerLink=l,this.routerLinkWithHref=c,this.router=u,this.destroy$=new rt.x,this.level=this.nzSubmenuService?this.nzSubmenuService.level+1:1,this.selected$=new rt.x,this.inlinePaddingLeft=null,this.dir="ltr",this.nzDisabled=!1,this.nzSelected=!1,this.nzDanger=!1,this.nzMatchRouterExact=!1,this.nzMatchRouter=!1,u&&this.router.events.pipe((0,Re.R)(this.destroy$),(0,dr.h)(d=>d instanceof $t.m2)).subscribe(()=>{this.updateRouterActive()})}clickMenuItem(e){this.nzDisabled?(e.preventDefault(),e.stopPropagation()):(this.nzMenuService.onDescendantMenuItemClick(this),this.nzSubmenuService?this.nzSubmenuService.onChildMenuItemClick(this):this.nzMenuService.onChildMenuItemClick(this))}setSelectedState(e){this.nzSelected=e,this.selected$.next(e)}updateRouterActive(){!this.listOfRouterLink||!this.listOfRouterLinkWithHref||!this.router||!this.router.navigated||!this.nzMatchRouter||Promise.resolve().then(()=>{const e=this.hasActiveLinks();this.nzSelected!==e&&(this.nzSelected=e,this.setSelectedState(this.nzSelected),this.cdr.markForCheck())})}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.routerLink&&e(this.routerLink)||this.routerLinkWithHref&&e(this.routerLinkWithHref)||this.listOfRouterLink.some(e)||this.listOfRouterLinkWithHref.some(e)}isLinkActive(e){return i=>e.isActive(i.urlTree||"",{paths:this.nzMatchRouterExact?"exact":"subset",queryParams:this.nzMatchRouterExact?"exact":"subset",fragment:"ignored",matrixParams:"ignored"})}ngOnInit(){var e;(0,Ii.a)([this.nzMenuService.mode$,this.nzMenuService.inlineIndent$]).pipe((0,Re.R)(this.destroy$)).subscribe(([i,a])=>{this.inlinePaddingLeft="inline"===i?this.level*a:null}),this.dir=this.directionality.value,null===(e=this.directionality.change)||void 0===e||e.pipe((0,Re.R)(this.destroy$)).subscribe(i=>{this.dir=i})}ngAfterContentInit(){this.listOfRouterLink.changes.pipe((0,Re.R)(this.destroy$)).subscribe(()=>this.updateRouterActive()),this.listOfRouterLinkWithHref.changes.pipe((0,Re.R)(this.destroy$)).subscribe(()=>this.updateRouterActive()),this.updateRouterActive()}ngOnChanges(e){e.nzSelected&&this.setSelectedState(this.nzSelected)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36($n),n.Y36(n.sBO),n.Y36(To,8),n.Y36(Ar),n.Y36(be.Is,8),n.Y36($t.rH,8),n.Y36($t.yS,8),n.Y36($t.F0,8))},t.\u0275dir=n.lG2({type:t,selectors:[["","nz-menu-item",""]],contentQueries:function(e,i,a){if(1&e&&(n.Suo(a,$t.rH,5),n.Suo(a,$t.yS,5)),2&e){let o;n.iGM(o=n.CRH())&&(i.listOfRouterLink=o),n.iGM(o=n.CRH())&&(i.listOfRouterLinkWithHref=o)}},hostVars:20,hostBindings:function(e,i){1&e&&n.NdJ("click",function(o){return i.clickMenuItem(o)}),2&e&&(n.Udp("padding-left","rtl"===i.dir?null:i.nzPaddingLeft||i.inlinePaddingLeft,"px")("padding-right","rtl"===i.dir?i.nzPaddingLeft||i.inlinePaddingLeft:null,"px"),n.ekj("ant-dropdown-menu-item",i.isMenuInsideDropDown)("ant-dropdown-menu-item-selected",i.isMenuInsideDropDown&&i.nzSelected)("ant-dropdown-menu-item-danger",i.isMenuInsideDropDown&&i.nzDanger)("ant-dropdown-menu-item-disabled",i.isMenuInsideDropDown&&i.nzDisabled)("ant-menu-item",!i.isMenuInsideDropDown)("ant-menu-item-selected",!i.isMenuInsideDropDown&&i.nzSelected)("ant-menu-item-danger",!i.isMenuInsideDropDown&&i.nzDanger)("ant-menu-item-disabled",!i.isMenuInsideDropDown&&i.nzDisabled))},inputs:{nzPaddingLeft:"nzPaddingLeft",nzDisabled:"nzDisabled",nzSelected:"nzSelected",nzDanger:"nzDanger",nzMatchRouterExact:"nzMatchRouterExact",nzMatchRouter:"nzMatchRouter"},exportAs:["nzMenuItem"],features:[n.TTD]}),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzDisabled",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzSelected",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzDanger",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzMatchRouterExact",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzMatchRouter",void 0),t})(),pf=(()=>{class t{constructor(e,i){this.cdr=e,this.directionality=i,this.nzIcon=null,this.nzTitle=null,this.isMenuInsideDropDown=!1,this.nzDisabled=!1,this.paddingLeft=null,this.mode="vertical",this.toggleSubMenu=new n.vpe,this.subMenuMouseState=new n.vpe,this.dir="ltr",this.destroy$=new rt.x}ngOnInit(){var e;this.dir=this.directionality.value,null===(e=this.directionality.change)||void 0===e||e.pipe((0,Re.R)(this.destroy$)).subscribe(i=>{this.dir=i,this.cdr.detectChanges()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setMouseState(e){this.nzDisabled||this.subMenuMouseState.next(e)}clickTitle(){"inline"===this.mode&&!this.nzDisabled&&this.toggleSubMenu.emit()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(n.sBO),n.Y36(be.Is,8))},t.\u0275cmp=n.Xpm({type:t,selectors:[["","nz-submenu-title",""]],hostVars:8,hostBindings:function(e,i){1&e&&n.NdJ("click",function(){return i.clickTitle()})("mouseenter",function(){return i.setMouseState(!0)})("mouseleave",function(){return i.setMouseState(!1)}),2&e&&(n.Udp("padding-left","rtl"===i.dir?null:i.paddingLeft,"px")("padding-right","rtl"===i.dir?i.paddingLeft:null,"px"),n.ekj("ant-dropdown-menu-submenu-title",i.isMenuInsideDropDown)("ant-menu-submenu-title",!i.isMenuInsideDropDown))},inputs:{nzIcon:"nzIcon",nzTitle:"nzTitle",isMenuInsideDropDown:"isMenuInsideDropDown",nzDisabled:"nzDisabled",paddingLeft:"paddingLeft",mode:"mode"},outputs:{toggleSubMenu:"toggleSubMenu",subMenuMouseState:"subMenuMouseState"},exportAs:["nzSubmenuTitle"],attrs:Gd,ngContentSelectors:Xd,decls:6,vars:4,consts:[["nz-icon","",3,"nzType",4,"ngIf"],[4,"nzStringTemplateOutlet"],["class","ant-dropdown-menu-submenu-expand-icon",3,"ngSwitch",4,"ngIf","ngIfElse"],["notDropdownTpl",""],["nz-icon","",3,"nzType"],[1,"ant-dropdown-menu-submenu-expand-icon",3,"ngSwitch"],["nz-icon","","nzType","left","class","ant-dropdown-menu-submenu-arrow-icon",4,"ngSwitchCase"],["nz-icon","","nzType","right","class","ant-dropdown-menu-submenu-arrow-icon",4,"ngSwitchDefault"],["nz-icon","","nzType","left",1,"ant-dropdown-menu-submenu-arrow-icon"],["nz-icon","","nzType","right",1,"ant-dropdown-menu-submenu-arrow-icon"],[1,"ant-menu-submenu-arrow"]],template:function(e,i){if(1&e&&(n.F$t(),n.YNc(0,Wd,1,1,"i",0),n.YNc(1,Yd,3,1,"ng-container",1),n.Hsn(2),n.YNc(3,Qd,3,2,"span",2),n.YNc(4,qd,1,0,"ng-template",null,3,n.W1O)),2&e){const a=n.MAs(5);n.Q6J("ngIf",i.nzIcon),n.xp6(1),n.Q6J("nzStringTemplateOutlet",i.nzTitle),n.xp6(2),n.Q6J("ngIf",i.isMenuInsideDropDown)("ngIfElse",a)}},directives:[K.O5,Pt.Ls,Ee.f,K.RF,K.n9,K.ED],encapsulation:2,changeDetection:0}),t})(),hf=(()=>{class t{constructor(e,i,a){this.elementRef=e,this.renderer=i,this.directionality=a,this.templateOutlet=null,this.menuClass="",this.mode="vertical",this.nzOpen=!1,this.listOfCacheClassName=[],this.expandState="collapsed",this.dir="ltr",this.destroy$=new rt.x}calcMotionState(){this.expandState=this.nzOpen?"expanded":"collapsed"}ngOnInit(){var e;this.calcMotionState(),this.dir=this.directionality.value,null===(e=this.directionality.change)||void 0===e||e.pipe((0,Re.R)(this.destroy$)).subscribe(i=>{this.dir=i})}ngOnChanges(e){const{mode:i,nzOpen:a,menuClass:o}=e;(i||a)&&this.calcMotionState(),o&&(this.listOfCacheClassName.length&&this.listOfCacheClassName.filter(s=>!!s).forEach(s=>{this.renderer.removeClass(this.elementRef.nativeElement,s)}),this.menuClass&&(this.listOfCacheClassName=this.menuClass.split(" "),this.listOfCacheClassName.filter(s=>!!s).forEach(s=>{this.renderer.addClass(this.elementRef.nativeElement,s)})))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(n.SBq),n.Y36(n.Qsj),n.Y36(be.Is,8))},t.\u0275cmp=n.Xpm({type:t,selectors:[["","nz-submenu-inline-child",""]],hostAttrs:[1,"ant-menu","ant-menu-inline","ant-menu-sub"],hostVars:3,hostBindings:function(e,i){2&e&&(n.d8E("@collapseMotion",i.expandState),n.ekj("ant-menu-rtl","rtl"===i.dir))},inputs:{templateOutlet:"templateOutlet",menuClass:"menuClass",mode:"mode",nzOpen:"nzOpen"},exportAs:["nzSubmenuInlineChild"],features:[n.TTD],attrs:Kd,decls:1,vars:1,consts:[[3,"ngTemplateOutlet"]],template:function(e,i){1&e&&n.YNc(0,ef,0,0,"ng-template",0),2&e&&n.Q6J("ngTemplateOutlet",i.templateOutlet)},directives:[K.tP],encapsulation:2,data:{animation:[Ei.J_]},changeDetection:0}),t})(),mf=(()=>{class t{constructor(e){this.directionality=e,this.menuClass="",this.theme="light",this.templateOutlet=null,this.isMenuInsideDropDown=!1,this.mode="vertical",this.position="right",this.nzDisabled=!1,this.nzOpen=!1,this.subMenuMouseState=new n.vpe,this.expandState="collapsed",this.dir="ltr",this.destroy$=new rt.x}setMouseState(e){this.nzDisabled||this.subMenuMouseState.next(e)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}calcMotionState(){this.nzOpen?"horizontal"===this.mode?this.expandState="bottom":"vertical"===this.mode&&(this.expandState="active"):this.expandState="collapsed"}ngOnInit(){var e;this.calcMotionState(),this.dir=this.directionality.value,null===(e=this.directionality.change)||void 0===e||e.pipe((0,Re.R)(this.destroy$)).subscribe(i=>{this.dir=i})}ngOnChanges(e){const{mode:i,nzOpen:a}=e;(i||a)&&this.calcMotionState()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(be.Is,8))},t.\u0275cmp=n.Xpm({type:t,selectors:[["","nz-submenu-none-inline-child",""]],hostAttrs:[1,"ant-menu-submenu","ant-menu-submenu-popup"],hostVars:14,hostBindings:function(e,i){1&e&&n.NdJ("mouseenter",function(){return i.setMouseState(!0)})("mouseleave",function(){return i.setMouseState(!1)}),2&e&&(n.d8E("@slideMotion",i.expandState)("@zoomBigMotion",i.expandState),n.ekj("ant-menu-light","light"===i.theme)("ant-menu-dark","dark"===i.theme)("ant-menu-submenu-placement-bottom","horizontal"===i.mode)("ant-menu-submenu-placement-right","vertical"===i.mode&&"right"===i.position)("ant-menu-submenu-placement-left","vertical"===i.mode&&"left"===i.position)("ant-menu-submenu-rtl","rtl"===i.dir))},inputs:{menuClass:"menuClass",theme:"theme",templateOutlet:"templateOutlet",isMenuInsideDropDown:"isMenuInsideDropDown",mode:"mode",position:"position",nzDisabled:"nzDisabled",nzOpen:"nzOpen"},outputs:{subMenuMouseState:"subMenuMouseState"},exportAs:["nzSubmenuNoneInlineChild"],features:[n.TTD],attrs:tf,decls:2,vars:16,consts:[[3,"ngClass"],[3,"ngTemplateOutlet"]],template:function(e,i){1&e&&(n.TgZ(0,"div",0),n.YNc(1,nf,0,0,"ng-template",1),n.qZA()),2&e&&(n.ekj("ant-dropdown-menu",i.isMenuInsideDropDown)("ant-menu",!i.isMenuInsideDropDown)("ant-dropdown-menu-vertical",i.isMenuInsideDropDown)("ant-menu-vertical",!i.isMenuInsideDropDown)("ant-dropdown-menu-sub",i.isMenuInsideDropDown)("ant-menu-sub",!i.isMenuInsideDropDown)("ant-menu-rtl","rtl"===i.dir),n.Q6J("ngClass",i.menuClass),n.xp6(1),n.Q6J("ngTemplateOutlet",i.templateOutlet))},directives:[K.mk,K.tP],encapsulation:2,data:{animation:[Ei.$C,Ei.mF]},changeDetection:0}),t})();const hl=[bt.yW.rightTop,bt.yW.right,bt.yW.rightBottom,bt.yW.leftTop,bt.yW.left,bt.yW.leftBottom],gf=[bt.yW.bottomLeft];let _f=(()=>{class t{constructor(e,i,a,o,s,l,c){this.nzMenuService=e,this.cdr=i,this.nzSubmenuService=a,this.platform=o,this.isMenuInsideDropDown=s,this.directionality=l,this.noAnimation=c,this.nzMenuClassName="",this.nzPaddingLeft=null,this.nzTitle=null,this.nzIcon=null,this.nzOpen=!1,this.nzDisabled=!1,this.nzOpenChange=new n.vpe,this.cdkOverlayOrigin=null,this.listOfNzSubMenuComponent=null,this.listOfNzMenuItemDirective=null,this.level=this.nzSubmenuService.level,this.destroy$=new rt.x,this.position="right",this.triggerWidth=null,this.theme="light",this.mode="vertical",this.inlinePaddingLeft=null,this.overlayPositions=hl,this.isSelected=!1,this.isActive=!1,this.dir="ltr"}setOpenStateWithoutDebounce(e){this.nzSubmenuService.setOpenStateWithoutDebounce(e)}toggleSubMenu(){this.setOpenStateWithoutDebounce(!this.nzOpen)}setMouseEnterState(e){this.isActive=e,"inline"!==this.mode&&this.nzSubmenuService.setMouseEnterTitleOrOverlayState(e)}setTriggerWidth(){"horizontal"===this.mode&&this.platform.isBrowser&&this.cdkOverlayOrigin&&(this.triggerWidth=this.cdkOverlayOrigin.nativeElement.getBoundingClientRect().width)}onPositionChange(e){const i=(0,bt.d_)(e);"rightTop"===i||"rightBottom"===i||"right"===i?this.position="right":("leftTop"===i||"leftBottom"===i||"left"===i)&&(this.position="left")}ngOnInit(){var e;this.nzMenuService.theme$.pipe((0,Re.R)(this.destroy$)).subscribe(i=>{this.theme=i,this.cdr.markForCheck()}),this.nzSubmenuService.mode$.pipe((0,Re.R)(this.destroy$)).subscribe(i=>{this.mode=i,"horizontal"===i?this.overlayPositions=gf:"vertical"===i&&(this.overlayPositions=hl),this.cdr.markForCheck()}),(0,Ii.a)([this.nzSubmenuService.mode$,this.nzMenuService.inlineIndent$]).pipe((0,Re.R)(this.destroy$)).subscribe(([i,a])=>{this.inlinePaddingLeft="inline"===i?this.level*a:null,this.cdr.markForCheck()}),this.nzSubmenuService.isCurrentSubMenuOpen$.pipe((0,Re.R)(this.destroy$)).subscribe(i=>{this.isActive=i,i!==this.nzOpen&&(this.setTriggerWidth(),this.nzOpen=i,this.nzOpenChange.emit(this.nzOpen),this.cdr.markForCheck())}),this.dir=this.directionality.value,null===(e=this.directionality.change)||void 0===e||e.pipe((0,Re.R)(this.destroy$)).subscribe(i=>{this.dir=i,this.cdr.markForCheck()})}ngAfterContentInit(){this.setTriggerWidth();const e=this.listOfNzMenuItemDirective,i=e.changes,a=(0,ur.T)(i,...e.map(o=>o.selected$));i.pipe((0,fl.O)(e),(0,zt.w)(()=>a),(0,fl.O)(!0),(0,Yn.U)(()=>e.some(o=>o.nzSelected)),(0,Re.R)(this.destroy$)).subscribe(o=>{this.isSelected=o,this.cdr.markForCheck()})}ngOnChanges(e){const{nzOpen:i}=e;i&&(this.nzSubmenuService.setOpenStateWithoutDebounce(this.nzOpen),this.setTriggerWidth())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36($n),n.Y36(n.sBO),n.Y36(To),n.Y36(cr.t4),n.Y36(Ar),n.Y36(be.Is,8),n.Y36(Rn.P,9))},t.\u0275cmp=n.Xpm({type:t,selectors:[["","nz-submenu",""]],contentQueries:function(e,i,a){if(1&e&&(n.Suo(a,t,5),n.Suo(a,Sa,5)),2&e){let o;n.iGM(o=n.CRH())&&(i.listOfNzSubMenuComponent=o),n.iGM(o=n.CRH())&&(i.listOfNzMenuItemDirective=o)}},viewQuery:function(e,i){if(1&e&&n.Gf(Bt.xu,7,n.SBq),2&e){let a;n.iGM(a=n.CRH())&&(i.cdkOverlayOrigin=a.first)}},hostVars:34,hostBindings:function(e,i){2&e&&n.ekj("ant-dropdown-menu-submenu",i.isMenuInsideDropDown)("ant-dropdown-menu-submenu-disabled",i.isMenuInsideDropDown&&i.nzDisabled)("ant-dropdown-menu-submenu-open",i.isMenuInsideDropDown&&i.nzOpen)("ant-dropdown-menu-submenu-selected",i.isMenuInsideDropDown&&i.isSelected)("ant-dropdown-menu-submenu-vertical",i.isMenuInsideDropDown&&"vertical"===i.mode)("ant-dropdown-menu-submenu-horizontal",i.isMenuInsideDropDown&&"horizontal"===i.mode)("ant-dropdown-menu-submenu-inline",i.isMenuInsideDropDown&&"inline"===i.mode)("ant-dropdown-menu-submenu-active",i.isMenuInsideDropDown&&i.isActive)("ant-menu-submenu",!i.isMenuInsideDropDown)("ant-menu-submenu-disabled",!i.isMenuInsideDropDown&&i.nzDisabled)("ant-menu-submenu-open",!i.isMenuInsideDropDown&&i.nzOpen)("ant-menu-submenu-selected",!i.isMenuInsideDropDown&&i.isSelected)("ant-menu-submenu-vertical",!i.isMenuInsideDropDown&&"vertical"===i.mode)("ant-menu-submenu-horizontal",!i.isMenuInsideDropDown&&"horizontal"===i.mode)("ant-menu-submenu-inline",!i.isMenuInsideDropDown&&"inline"===i.mode)("ant-menu-submenu-active",!i.isMenuInsideDropDown&&i.isActive)("ant-menu-submenu-rtl","rtl"===i.dir)},inputs:{nzMenuClassName:"nzMenuClassName",nzPaddingLeft:"nzPaddingLeft",nzTitle:"nzTitle",nzIcon:"nzIcon",nzOpen:"nzOpen",nzDisabled:"nzDisabled"},outputs:{nzOpenChange:"nzOpenChange"},exportAs:["nzSubmenu"],features:[n._Bn([To]),n.TTD],attrs:rf,ngContentSelectors:ff,decls:8,vars:9,consts:[["nz-submenu-title","","cdkOverlayOrigin","",3,"nzIcon","nzTitle","mode","nzDisabled","isMenuInsideDropDown","paddingLeft","subMenuMouseState","toggleSubMenu"],["origin","cdkOverlayOrigin"],[4,"ngIf"],["nz-submenu-inline-child","",3,"mode","nzOpen","nzNoAnimation","menuClass","templateOutlet",4,"ngIf","ngIfElse"],["nonInlineTemplate",""],["subMenuTemplate",""],["nz-submenu-inline-child","",3,"mode","nzOpen","nzNoAnimation","menuClass","templateOutlet"],["cdkConnectedOverlay","",3,"cdkConnectedOverlayPositions","cdkConnectedOverlayOrigin","cdkConnectedOverlayWidth","cdkConnectedOverlayOpen","cdkConnectedOverlayTransformOriginOn","positionChange"],["nz-submenu-none-inline-child","",3,"theme","mode","nzOpen","position","nzDisabled","isMenuInsideDropDown","templateOutlet","menuClass","nzNoAnimation","subMenuMouseState"]],template:function(e,i){if(1&e&&(n.F$t(df),n.TgZ(0,"div",0,1),n.NdJ("subMenuMouseState",function(o){return i.setMouseEnterState(o)})("toggleSubMenu",function(){return i.toggleSubMenu()}),n.YNc(2,af,1,0,"ng-content",2),n.qZA(),n.YNc(3,sf,1,6,"div",3),n.YNc(4,cf,1,5,"ng-template",null,4,n.W1O),n.YNc(6,uf,1,0,"ng-template",null,5,n.W1O)),2&e){const a=n.MAs(5);n.Q6J("nzIcon",i.nzIcon)("nzTitle",i.nzTitle)("mode",i.mode)("nzDisabled",i.nzDisabled)("isMenuInsideDropDown",i.isMenuInsideDropDown)("paddingLeft",i.nzPaddingLeft||i.inlinePaddingLeft),n.xp6(2),n.Q6J("ngIf",!i.nzTitle),n.xp6(1),n.Q6J("ngIf","inline"===i.mode)("ngIfElse",a)}},directives:[pf,hf,mf,Bt.xu,K.O5,Rn.P,Bt.pI],encapsulation:2,changeDetection:0}),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzOpen",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzDisabled",void 0),t})();function xf(t,r){return t||r}function vf(t){return t||!1}let ml=(()=>{class t{constructor(e,i,a,o){this.nzMenuService=e,this.isMenuInsideDropDown=i,this.cdr=a,this.directionality=o,this.nzInlineIndent=24,this.nzTheme="light",this.nzMode="vertical",this.nzInlineCollapsed=!1,this.nzSelectable=!this.isMenuInsideDropDown,this.nzClick=new n.vpe,this.actualMode="vertical",this.dir="ltr",this.inlineCollapsed$=new En.X(this.nzInlineCollapsed),this.mode$=new En.X(this.nzMode),this.destroy$=new rt.x,this.listOfOpenedNzSubMenuComponent=[]}setInlineCollapsed(e){this.nzInlineCollapsed=e,this.inlineCollapsed$.next(e)}updateInlineCollapse(){this.listOfNzMenuItemDirective&&(this.nzInlineCollapsed?(this.listOfOpenedNzSubMenuComponent=this.listOfNzSubMenuComponent.filter(e=>e.nzOpen),this.listOfNzSubMenuComponent.forEach(e=>e.setOpenStateWithoutDebounce(!1))):(this.listOfOpenedNzSubMenuComponent.forEach(e=>e.setOpenStateWithoutDebounce(!0)),this.listOfOpenedNzSubMenuComponent=[]))}ngOnInit(){var e;(0,Ii.a)([this.inlineCollapsed$,this.mode$]).pipe((0,Re.R)(this.destroy$)).subscribe(([i,a])=>{this.actualMode=i?"vertical":a,this.nzMenuService.setMode(this.actualMode),this.cdr.markForCheck()}),this.nzMenuService.descendantMenuItemClick$.pipe((0,Re.R)(this.destroy$)).subscribe(i=>{this.nzClick.emit(i),this.nzSelectable&&!i.nzMatchRouter&&this.listOfNzMenuItemDirective.forEach(a=>a.setSelectedState(a===i))}),this.dir=this.directionality.value,null===(e=this.directionality.change)||void 0===e||e.pipe((0,Re.R)(this.destroy$)).subscribe(i=>{this.dir=i,this.nzMenuService.setMode(this.actualMode),this.cdr.markForCheck()})}ngAfterContentInit(){this.inlineCollapsed$.pipe((0,Re.R)(this.destroy$)).subscribe(()=>{this.updateInlineCollapse(),this.cdr.markForCheck()})}ngOnChanges(e){const{nzInlineCollapsed:i,nzInlineIndent:a,nzTheme:o,nzMode:s}=e;i&&this.inlineCollapsed$.next(this.nzInlineCollapsed),a&&this.nzMenuService.setInlineIndent(this.nzInlineIndent),o&&this.nzMenuService.setTheme(this.nzTheme),s&&(this.mode$.next(this.nzMode),!e.nzMode.isFirstChange()&&this.listOfNzSubMenuComponent&&this.listOfNzSubMenuComponent.forEach(l=>l.setOpenStateWithoutDebounce(!1)))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36($n),n.Y36(Ar),n.Y36(n.sBO),n.Y36(be.Is,8))},t.\u0275dir=n.lG2({type:t,selectors:[["","nz-menu",""]],contentQueries:function(e,i,a){if(1&e&&(n.Suo(a,Sa,5),n.Suo(a,_f,5)),2&e){let o;n.iGM(o=n.CRH())&&(i.listOfNzMenuItemDirective=o),n.iGM(o=n.CRH())&&(i.listOfNzSubMenuComponent=o)}},hostVars:34,hostBindings:function(e,i){2&e&&n.ekj("ant-dropdown-menu",i.isMenuInsideDropDown)("ant-dropdown-menu-root",i.isMenuInsideDropDown)("ant-dropdown-menu-light",i.isMenuInsideDropDown&&"light"===i.nzTheme)("ant-dropdown-menu-dark",i.isMenuInsideDropDown&&"dark"===i.nzTheme)("ant-dropdown-menu-vertical",i.isMenuInsideDropDown&&"vertical"===i.actualMode)("ant-dropdown-menu-horizontal",i.isMenuInsideDropDown&&"horizontal"===i.actualMode)("ant-dropdown-menu-inline",i.isMenuInsideDropDown&&"inline"===i.actualMode)("ant-dropdown-menu-inline-collapsed",i.isMenuInsideDropDown&&i.nzInlineCollapsed)("ant-menu",!i.isMenuInsideDropDown)("ant-menu-root",!i.isMenuInsideDropDown)("ant-menu-light",!i.isMenuInsideDropDown&&"light"===i.nzTheme)("ant-menu-dark",!i.isMenuInsideDropDown&&"dark"===i.nzTheme)("ant-menu-vertical",!i.isMenuInsideDropDown&&"vertical"===i.actualMode)("ant-menu-horizontal",!i.isMenuInsideDropDown&&"horizontal"===i.actualMode)("ant-menu-inline",!i.isMenuInsideDropDown&&"inline"===i.actualMode)("ant-menu-inline-collapsed",!i.isMenuInsideDropDown&&i.nzInlineCollapsed)("ant-menu-rtl","rtl"===i.dir)},inputs:{nzInlineIndent:"nzInlineIndent",nzTheme:"nzTheme",nzMode:"nzMode",nzInlineCollapsed:"nzInlineCollapsed",nzSelectable:"nzSelectable"},outputs:{nzClick:"nzClick"},exportAs:["nzMenu"],features:[n._Bn([{provide:pl,useClass:$n},{provide:$n,useFactory:xf,deps:[[new n.tp0,new n.FiY,$n],pl]},{provide:Ar,useFactory:vf,deps:[[new n.tp0,new n.FiY,Ar]]}]),n.TTD]}),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzInlineCollapsed",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzSelectable",void 0),t})(),ko=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[be.vT,K.ez,cr.ud,Bt.U8,Pt.PV,Rn.g,Ee.T]]}),t})(),gl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[K.ez,Ee.T],be.vT]}),t})();var _n=oe(1047),It=oe(6042),Fi=oe(4546),Nr=oe(6114),ba=oe(1159),Ke=oe(9646),Nt=oe(8306),_l=oe(727),fr=oe(4968),Jn=oe(8505),So=oe(6947),pr=oe(1777),tn=oe(9439);function Mf(t,r){if(1&t&&(n.ynx(0),n._UZ(1,"i",8),n.BQk()),2&t){const e=n.oxw(3);n.xp6(1),n.Q6J("nzType",e.icon)}}function Rf(t,r){if(1&t&&(n.ynx(0),n._uU(1),n.BQk()),2&t){const e=r.$implicit,i=n.oxw(4);n.xp6(1),n.hij(" ",e(i.nzPercent)," ")}}const Pf=function(t){return{$implicit:t}};function Bf(t,r){if(1&t&&n.YNc(0,Rf,2,1,"ng-container",9),2&t){const e=n.oxw(3);n.Q6J("nzStringTemplateOutlet",e.formatter)("nzStringTemplateOutletContext",n.VKq(2,Pf,e.nzPercent))}}function Lf(t,r){if(1&t&&(n.TgZ(0,"span",5),n.YNc(1,Mf,2,1,"ng-container",6),n.YNc(2,Bf,1,4,"ng-template",null,7,n.W1O),n.qZA()),2&t){const e=n.MAs(3),i=n.oxw(2);n.xp6(1),n.Q6J("ngIf",("exception"===i.status||"success"===i.status)&&!i.nzFormat)("ngIfElse",e)}}function Uf(t,r){if(1&t&&n.YNc(0,Lf,4,2,"span",4),2&t){const e=n.oxw();n.Q6J("ngIf",e.nzShowInfo)}}function Hf(t,r){if(1&t&&n._UZ(0,"div",17),2&t){const e=n.oxw(4);n.Udp("width",e.nzSuccessPercent,"%")("border-radius","round"===e.nzStrokeLinecap?"100px":"0")("height",e.strokeWidth,"px")}}function Vf(t,r){if(1&t&&(n.TgZ(0,"div",13)(1,"div",14),n._UZ(2,"div",15),n.YNc(3,Hf,1,6,"div",16),n.qZA()()),2&t){const e=n.oxw(3);n.xp6(2),n.Udp("width",e.nzPercent,"%")("border-radius","round"===e.nzStrokeLinecap?"100px":"0")("background",e.isGradient?null:e.nzStrokeColor)("background-image",e.isGradient?e.lineGradient:null)("height",e.strokeWidth,"px"),n.xp6(1),n.Q6J("ngIf",e.nzSuccessPercent||0===e.nzSuccessPercent)}}function Zf(t,r){}function jf(t,r){if(1&t&&(n.ynx(0),n.YNc(1,Vf,4,11,"div",11),n.YNc(2,Zf,0,0,"ng-template",12),n.BQk()),2&t){const e=n.oxw(2),i=n.MAs(1);n.xp6(1),n.Q6J("ngIf",!e.isSteps),n.xp6(1),n.Q6J("ngTemplateOutlet",i)}}function Gf(t,r){1&t&&n._UZ(0,"div",20),2&t&&n.Q6J("ngStyle",r.$implicit)}function Wf(t,r){}function Yf(t,r){if(1&t&&(n.TgZ(0,"div",18),n.YNc(1,Gf,1,1,"div",19),n.YNc(2,Wf,0,0,"ng-template",12),n.qZA()),2&t){const e=n.oxw(2),i=n.MAs(1);n.xp6(1),n.Q6J("ngForOf",e.steps),n.xp6(1),n.Q6J("ngTemplateOutlet",i)}}function $f(t,r){if(1&t&&(n.TgZ(0,"div"),n.YNc(1,jf,3,2,"ng-container",2),n.YNc(2,Yf,3,2,"div",10),n.qZA()),2&t){const e=n.oxw();n.xp6(1),n.Q6J("ngIf",!e.isSteps),n.xp6(1),n.Q6J("ngIf",e.isSteps)}}function Jf(t,r){if(1&t&&(n.O4$(),n._UZ(0,"stop")),2&t){const e=r.$implicit;n.uIk("offset",e.offset)("stop-color",e.color)}}function Qf(t,r){if(1&t&&(n.O4$(),n.TgZ(0,"defs")(1,"linearGradient",24),n.YNc(2,Jf,1,2,"stop",25),n.qZA()()),2&t){const e=n.oxw(2);n.xp6(1),n.Q6J("id","gradient-"+e.gradientId),n.xp6(1),n.Q6J("ngForOf",e.circleGradient)}}function qf(t,r){if(1&t&&(n.O4$(),n._UZ(0,"path",26)),2&t){const e=r.$implicit,i=n.oxw(2);n.Q6J("ngStyle",e.strokePathStyle),n.uIk("d",i.pathString)("stroke-linecap",i.nzStrokeLinecap)("stroke",e.stroke)("stroke-width",i.nzPercent?i.strokeWidth:0)}}function Xf(t,r){1&t&&n.O4$()}function Kf(t,r){if(1&t&&(n.TgZ(0,"div",14),n.O4$(),n.TgZ(1,"svg",21),n.YNc(2,Qf,3,2,"defs",2),n._UZ(3,"path",22),n.YNc(4,qf,1,5,"path",23),n.qZA(),n.YNc(5,Xf,0,0,"ng-template",12),n.qZA()),2&t){const e=n.oxw(),i=n.MAs(1);n.Udp("width",e.nzWidth,"px")("height",e.nzWidth,"px")("font-size",.15*e.nzWidth+6,"px"),n.ekj("ant-progress-circle-gradient",e.isGradient),n.xp6(2),n.Q6J("ngIf",e.isGradient),n.xp6(1),n.Q6J("ngStyle",e.trailPathStyle),n.uIk("stroke-width",e.strokeWidth)("d",e.pathString),n.xp6(1),n.Q6J("ngForOf",e.progressCirclePath)("ngForTrackBy",e.trackByFn),n.xp6(1),n.Q6J("ngTemplateOutlet",i)}}const xl=t=>{let r=[];return Object.keys(t).forEach(e=>{const i=t[e],a=function ep(t){return+t.replace("%","")}(e);isNaN(a)||r.push({key:a,value:i})}),r=r.sort((e,i)=>e.key-i.key),r};let rp=0;const vl="progress",ip=new Map([["success","check"],["exception","close"]]),ap=new Map([["normal","#108ee9"],["exception","#ff5500"],["success","#87d068"]]),op=t=>`${t}%`;let sp=(()=>{class t{constructor(e,i,a){this.cdr=e,this.nzConfigService=i,this.directionality=a,this._nzModuleName=vl,this.nzShowInfo=!0,this.nzWidth=132,this.nzStrokeColor=void 0,this.nzSize="default",this.nzPercent=0,this.nzStrokeWidth=void 0,this.nzGapDegree=void 0,this.nzType="line",this.nzGapPosition="top",this.nzStrokeLinecap="round",this.nzSteps=0,this.steps=[],this.lineGradient=null,this.isGradient=!1,this.isSteps=!1,this.gradientId=rp++,this.progressCirclePath=[],this.trailPathStyle=null,this.dir="ltr",this.trackByFn=o=>`${o}`,this.cachedStatus="normal",this.inferredStatus="normal",this.destroy$=new rt.x}get formatter(){return this.nzFormat||op}get status(){return this.nzStatus||this.inferredStatus}get strokeWidth(){return this.nzStrokeWidth||("line"===this.nzType&&"small"!==this.nzSize?8:6)}get isCircleStyle(){return"circle"===this.nzType||"dashboard"===this.nzType}ngOnChanges(e){const{nzSteps:i,nzGapPosition:a,nzStrokeLinecap:o,nzStrokeColor:s,nzGapDegree:l,nzType:c,nzStatus:u,nzPercent:d,nzSuccessPercent:f,nzStrokeWidth:p}=e;u&&(this.cachedStatus=this.nzStatus||this.cachedStatus),(d||f)&&(parseInt(this.nzPercent.toString(),10)>=100?((0,_e.DX)(this.nzSuccessPercent)&&this.nzSuccessPercent>=100||void 0===this.nzSuccessPercent)&&(this.inferredStatus="success"):this.inferredStatus=this.cachedStatus),(u||d||f||s)&&this.updateIcon(),s&&this.setStrokeColor(),(a||o||l||c||d||s||s)&&this.getCirclePaths(),(d||i||p)&&(this.isSteps=this.nzSteps>0,this.isSteps&&this.getSteps())}ngOnInit(){var e;this.nzConfigService.getConfigChangeEventForComponent(vl).pipe((0,Re.R)(this.destroy$)).subscribe(()=>{this.updateIcon(),this.setStrokeColor(),this.getCirclePaths()}),null===(e=this.directionality.change)||void 0===e||e.pipe((0,Re.R)(this.destroy$)).subscribe(i=>{this.dir=i,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}updateIcon(){const e=ip.get(this.status);this.icon=e?e+(this.isCircleStyle?"-o":"-circle-fill"):""}getSteps(){const e=Math.floor(this.nzSteps*(this.nzPercent/100)),i="small"===this.nzSize?2:14,a=[];for(let o=0;o<this.nzSteps;o++){let s;o<=e-1&&(s=this.nzStrokeColor),a.push({backgroundColor:`${s}`,width:`${i}px`,height:`${this.strokeWidth}px`})}this.steps=a}getCirclePaths(){if(!this.isCircleStyle)return;const e=(0,_e.DX)(this.nzSuccessPercent)?[this.nzSuccessPercent,this.nzPercent]:[this.nzPercent],i=50-this.strokeWidth/2,o=2*Math.PI*i,s=this.nzGapDegree||("circle"===this.nzType?0:75);let l=0,c=-i,u=0,d=-2*i;switch(this.nzGapPosition||("circle"===this.nzType?"top":"bottom")){case"left":l=-i,c=0,u=2*i,d=0;break;case"right":l=i,c=0,u=-2*i,d=0;break;case"bottom":c=i,d=2*i}this.pathString=`M 50,50 m ${l},${c}\n       a ${i},${i} 0 1 1 ${u},${-d}\n       a ${i},${i} 0 1 1 ${-u},${d}`,this.trailPathStyle={strokeDasharray:`${o-s}px ${o}px`,strokeDashoffset:`-${s/2}px`,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s"},this.progressCirclePath=e.map((f,p)=>{const m=2===e.length&&0===p;return{stroke:this.isGradient&&!m?`url(#gradient-${this.gradientId})`:null,strokePathStyle:{stroke:this.isGradient?null:m?ap.get("success"):this.nzStrokeColor,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s",strokeDasharray:`${(f||0)/100*(o-s)}px ${o}px`,strokeDashoffset:`-${s/2}px`}}}).reverse()}setStrokeColor(){const e=this.nzStrokeColor,i=this.isGradient=!!e&&"string"!=typeof e;i&&!this.isCircleStyle?this.lineGradient=(t=>{const{from:r="#1890ff",to:e="#1890ff",direction:i="to right"}=t,a=(0,Oe._T)(t,["from","to","direction"]);return 0!==Object.keys(a).length?`linear-gradient(${i}, ${xl(a).map(({key:s,value:l})=>`${l} ${s}%`).join(", ")})`:`linear-gradient(${i}, ${r}, ${e})`})(e):i&&this.isCircleStyle?this.circleGradient=(t=>xl(this.nzStrokeColor).map(({key:r,value:e})=>({offset:`${r}%`,color:e})))():(this.lineGradient=null,this.circleGradient=[])}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(n.sBO),n.Y36(tn.jY),n.Y36(be.Is,8))},t.\u0275cmp=n.Xpm({type:t,selectors:[["nz-progress"]],inputs:{nzShowInfo:"nzShowInfo",nzWidth:"nzWidth",nzStrokeColor:"nzStrokeColor",nzSize:"nzSize",nzFormat:"nzFormat",nzSuccessPercent:"nzSuccessPercent",nzPercent:"nzPercent",nzStrokeWidth:"nzStrokeWidth",nzGapDegree:"nzGapDegree",nzStatus:"nzStatus",nzType:"nzType",nzGapPosition:"nzGapPosition",nzStrokeLinecap:"nzStrokeLinecap",nzSteps:"nzSteps"},exportAs:["nzProgress"],features:[n.TTD],decls:5,vars:15,consts:[["progressInfoTemplate",""],[3,"ngClass"],[4,"ngIf"],["class","ant-progress-inner",3,"width","height","fontSize","ant-progress-circle-gradient",4,"ngIf"],["class","ant-progress-text",4,"ngIf"],[1,"ant-progress-text"],[4,"ngIf","ngIfElse"],["formatTemplate",""],["nz-icon","",3,"nzType"],[4,"nzStringTemplateOutlet","nzStringTemplateOutletContext"],["class","ant-progress-steps-outer",4,"ngIf"],["class","ant-progress-outer",4,"ngIf"],[3,"ngTemplateOutlet"],[1,"ant-progress-outer"],[1,"ant-progress-inner"],[1,"ant-progress-bg"],["class","ant-progress-success-bg",3,"width","border-radius","height",4,"ngIf"],[1,"ant-progress-success-bg"],[1,"ant-progress-steps-outer"],["class","ant-progress-steps-item",3,"ngStyle",4,"ngFor","ngForOf"],[1,"ant-progress-steps-item",3,"ngStyle"],["viewBox","0 0 100 100",1,"ant-progress-circle"],["stroke","#f3f3f3","fill-opacity","0",1,"ant-progress-circle-trail",3,"ngStyle"],["class","ant-progress-circle-path","fill-opacity","0",3,"ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["x1","100%","y1","0%","x2","0%","y2","0%",3,"id"],[4,"ngFor","ngForOf"],["fill-opacity","0",1,"ant-progress-circle-path",3,"ngStyle"]],template:function(e,i){1&e&&(n.YNc(0,Uf,1,1,"ng-template",null,0,n.W1O),n.TgZ(2,"div",1),n.YNc(3,$f,3,2,"div",2),n.YNc(4,Kf,6,15,"div",3),n.qZA()),2&e&&(n.xp6(2),n.ekj("ant-progress-line","line"===i.nzType)("ant-progress-small","small"===i.nzSize)("ant-progress-show-info",i.nzShowInfo)("ant-progress-circle",i.isCircleStyle)("ant-progress-steps",i.isSteps)("ant-progress-rtl","rtl"===i.dir),n.Q6J("ngClass","ant-progress ant-progress-status-"+i.status),n.xp6(1),n.Q6J("ngIf","line"===i.nzType),n.xp6(1),n.Q6J("ngIf",i.isCircleStyle))},directives:[K.O5,Pt.Ls,Ee.f,K.mk,K.tP,K.sg,K.PC],encapsulation:2,changeDetection:0}),(0,Oe.gn)([(0,tn.oS)()],t.prototype,"nzShowInfo",void 0),(0,Oe.gn)([(0,tn.oS)()],t.prototype,"nzStrokeColor",void 0),(0,Oe.gn)([(0,tn.oS)()],t.prototype,"nzSize",void 0),(0,Oe.gn)([(0,_e.Rn)()],t.prototype,"nzSuccessPercent",void 0),(0,Oe.gn)([(0,_e.Rn)()],t.prototype,"nzPercent",void 0),(0,Oe.gn)([(0,tn.oS)(),(0,_e.Rn)()],t.prototype,"nzStrokeWidth",void 0),(0,Oe.gn)([(0,tn.oS)(),(0,_e.Rn)()],t.prototype,"nzGapDegree",void 0),(0,Oe.gn)([(0,tn.oS)()],t.prototype,"nzGapPosition",void 0),(0,Oe.gn)([(0,tn.oS)()],t.prototype,"nzStrokeLinecap",void 0),(0,Oe.gn)([(0,_e.Rn)()],t.prototype,"nzSteps",void 0),t})(),lp=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[be.vT,K.ez,Pt.PV,Ee.T]]}),t})();var Cl=oe(6695);const cp=["file"],up=["nz-upload-btn",""],yl=["*"];function dp(t,r){}const Di=function(t){return{$implicit:t}};function fp(t,r){if(1&t&&(n.TgZ(0,"div",18),n.YNc(1,dp,0,0,"ng-template",19),n.qZA()),2&t){const e=n.oxw(2).$implicit,i=n.MAs(5);n.ekj("ant-upload-list-item-file",!e.isUploading),n.xp6(1),n.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",n.VKq(4,Di,e))}}function pp(t,r){if(1&t&&n._UZ(0,"img",22),2&t){const e=n.oxw(3).$implicit;n.Q6J("src",e.thumbUrl||e.url,n.LSH),n.uIk("alt",e.name)}}function hp(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"a",20),n.NdJ("click",function(a){n.CHM(e);const o=n.oxw(2).$implicit;return n.oxw().handlePreview(o,a)}),n.YNc(1,pp,1,2,"img",21),n.qZA()}if(2&t){n.oxw();const e=n.MAs(5),i=n.oxw().$implicit;n.ekj("ant-upload-list-item-file",!i.isImageUrl),n.Q6J("href",i.url||i.thumbUrl,n.LSH),n.xp6(1),n.Q6J("ngIf",i.isImageUrl)("ngIfElse",e)}}function mp(t,r){}function gp(t,r){if(1&t&&(n.TgZ(0,"div",23),n.YNc(1,mp,0,0,"ng-template",19),n.qZA()),2&t){const e=n.oxw(2).$implicit,i=n.MAs(5);n.xp6(1),n.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",n.VKq(2,Di,e))}}function _p(t,r){}function xp(t,r){if(1&t&&n.YNc(0,_p,0,0,"ng-template",19),2&t){const e=n.oxw(2).$implicit,i=n.MAs(5);n.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",n.VKq(2,Di,e))}}function vp(t,r){if(1&t&&(n.ynx(0,13),n.YNc(1,fp,2,6,"div",14),n.YNc(2,hp,2,5,"a",15),n.YNc(3,gp,2,4,"div",16),n.BQk(),n.YNc(4,xp,1,4,"ng-template",null,17,n.W1O)),2&t){const e=n.oxw().$implicit;n.Q6J("ngSwitch",e.iconType),n.xp6(1),n.Q6J("ngSwitchCase","uploading"),n.xp6(1),n.Q6J("ngSwitchCase","thumbnail")}}function Cp(t,r){1&t&&(n.ynx(0),n._UZ(1,"i",29),n.BQk())}function yp(t,r){if(1&t&&(n.ynx(0),n.YNc(1,Cp,2,0,"ng-container",24),n.BQk()),2&t){const e=n.oxw(2).$implicit,i=n.MAs(4);n.xp6(1),n.Q6J("ngIf",e.isUploading)("ngIfElse",i)}}function wp(t,r){if(1&t&&(n.ynx(0),n._uU(1),n.BQk()),2&t){const e=n.oxw(5);n.xp6(1),n.hij(" ",e.locale.uploading," ")}}function Tp(t,r){if(1&t&&(n.ynx(0),n.YNc(1,wp,2,1,"ng-container",24),n.BQk()),2&t){const e=n.oxw(2).$implicit,i=n.MAs(4);n.xp6(1),n.Q6J("ngIf",e.isUploading)("ngIfElse",i)}}function kp(t,r){if(1&t&&n._UZ(0,"i",30),2&t){const e=n.oxw(2).$implicit;n.Q6J("nzType",e.isUploading?"loading":"paper-clip")}}function Sp(t,r){if(1&t&&(n.ynx(0)(1,13),n.YNc(2,yp,2,2,"ng-container",27),n.YNc(3,Tp,2,2,"ng-container",27),n.YNc(4,kp,1,1,"i",28),n.BQk()()),2&t){const e=n.oxw(3);n.xp6(1),n.Q6J("ngSwitch",e.listType),n.xp6(1),n.Q6J("ngSwitchCase","picture"),n.xp6(1),n.Q6J("ngSwitchCase","picture-card")}}function bp(t,r){}function zp(t,r){if(1&t&&n._UZ(0,"i",31),2&t){const e=n.oxw().$implicit;n.Q6J("nzType",e.isImageUrl?"picture":"file")}}function Ip(t,r){if(1&t&&(n.YNc(0,Sp,5,3,"ng-container",24),n.YNc(1,bp,0,0,"ng-template",19,25,n.W1O),n.YNc(3,zp,1,1,"ng-template",null,26,n.W1O)),2&t){const e=r.$implicit,i=n.MAs(2),a=n.oxw(2);n.Q6J("ngIf",!a.iconRender)("ngIfElse",i),n.xp6(1),n.Q6J("ngTemplateOutlet",a.iconRender)("ngTemplateOutletContext",n.VKq(4,Di,e))}}function Op(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"button",33),n.NdJ("click",function(a){n.CHM(e);const o=n.oxw(2).$implicit;return n.oxw().handleRemove(o,a)}),n._UZ(1,"i",34),n.qZA()}if(2&t){const e=n.oxw(3);n.uIk("title",e.locale.removeFile)}}function Ep(t,r){if(1&t&&n.YNc(0,Op,2,1,"button",32),2&t){const e=n.oxw(2);n.Q6J("ngIf",e.icons.showRemoveIcon)}}function Fp(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"button",33),n.NdJ("click",function(){n.CHM(e);const a=n.oxw(2).$implicit;return n.oxw().handleDownload(a)}),n._UZ(1,"i",35),n.qZA()}if(2&t){const e=n.oxw(3);n.uIk("title",e.locale.downloadFile)}}function Dp(t,r){if(1&t&&n.YNc(0,Fp,2,1,"button",32),2&t){const e=n.oxw().$implicit;n.Q6J("ngIf",e.showDownload)}}function Ap(t,r){}function Np(t,r){}function Mp(t,r){if(1&t&&(n.TgZ(0,"span"),n.YNc(1,Ap,0,0,"ng-template",10),n.YNc(2,Np,0,0,"ng-template",10),n.qZA()),2&t){n.oxw(2);const e=n.MAs(9),i=n.MAs(7),a=n.oxw();n.Gre("ant-upload-list-item-card-actions ","picture"===a.listType?"picture":"",""),n.xp6(1),n.Q6J("ngTemplateOutlet",e),n.xp6(1),n.Q6J("ngTemplateOutlet",i)}}function Rp(t,r){if(1&t&&n.YNc(0,Mp,3,5,"span",36),2&t){const e=n.oxw(2);n.Q6J("ngIf","picture-card"!==e.listType)}}function Pp(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"a",39),n.NdJ("click",function(a){n.CHM(e);const o=n.oxw(2).$implicit;return n.oxw().handlePreview(o,a)}),n._uU(1),n.qZA()}if(2&t){const e=n.oxw(2).$implicit;n.Q6J("href",e.url,n.LSH),n.uIk("title",e.name)("download",e.linkProps&&e.linkProps.download),n.xp6(1),n.hij(" ",e.name," ")}}function Bp(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"span",40),n.NdJ("click",function(a){n.CHM(e);const o=n.oxw(2).$implicit;return n.oxw().handlePreview(o,a)}),n._uU(1),n.qZA()}if(2&t){const e=n.oxw(2).$implicit;n.uIk("title",e.name),n.xp6(1),n.hij(" ",e.name," ")}}function Lp(t,r){}function Up(t,r){if(1&t&&(n.YNc(0,Pp,2,4,"a",37),n.YNc(1,Bp,2,2,"span",38),n.YNc(2,Lp,0,0,"ng-template",10)),2&t){const e=n.oxw().$implicit,i=n.MAs(11);n.Q6J("ngIf",e.url),n.xp6(1),n.Q6J("ngIf",!e.url),n.xp6(1),n.Q6J("ngTemplateOutlet",i)}}function Hp(t,r){}function Vp(t,r){}const Zp=function(){return{opacity:.5,"pointer-events":"none"}};function jp(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"a",44),n.NdJ("click",function(a){n.CHM(e);const o=n.oxw(2).$implicit;return n.oxw().handlePreview(o,a)}),n._UZ(1,"i",45),n.qZA()}if(2&t){const e=n.oxw(2).$implicit,i=n.oxw();n.Q6J("href",e.url||e.thumbUrl,n.LSH)("ngStyle",e.url||e.thumbUrl?null:n.DdM(3,Zp)),n.uIk("title",i.locale.previewFile)}}function Gp(t,r){}function Wp(t,r){if(1&t&&(n.ynx(0),n.YNc(1,Gp,0,0,"ng-template",10),n.BQk()),2&t){n.oxw(2);const e=n.MAs(9);n.xp6(1),n.Q6J("ngTemplateOutlet",e)}}function Yp(t,r){}function $p(t,r){if(1&t&&(n.TgZ(0,"span",41),n.YNc(1,jp,2,4,"a",42),n.YNc(2,Wp,2,1,"ng-container",43),n.YNc(3,Yp,0,0,"ng-template",10),n.qZA()),2&t){const e=n.oxw().$implicit,i=n.MAs(7),a=n.oxw();n.xp6(1),n.Q6J("ngIf",a.icons.showPreviewIcon),n.xp6(1),n.Q6J("ngIf","done"===e.status),n.xp6(1),n.Q6J("ngTemplateOutlet",i)}}function Jp(t,r){if(1&t&&(n.TgZ(0,"div",46),n._UZ(1,"nz-progress",47),n.qZA()),2&t){const e=n.oxw().$implicit;n.xp6(1),n.Q6J("nzPercent",e.percent)("nzShowInfo",!1)("nzStrokeWidth",2)}}function Qp(t,r){if(1&t&&(n.TgZ(0,"div")(1,"div",1),n.YNc(2,vp,6,3,"ng-template",null,2,n.W1O),n.YNc(4,Ip,5,6,"ng-template",null,3,n.W1O),n.YNc(6,Ep,1,1,"ng-template",null,4,n.W1O),n.YNc(8,Dp,1,1,"ng-template",null,5,n.W1O),n.YNc(10,Rp,1,1,"ng-template",null,6,n.W1O),n.YNc(12,Up,3,3,"ng-template",null,7,n.W1O),n.TgZ(14,"div",8)(15,"span",9),n.YNc(16,Hp,0,0,"ng-template",10),n.YNc(17,Vp,0,0,"ng-template",10),n.qZA()(),n.YNc(18,$p,4,3,"span",11),n.YNc(19,Jp,2,3,"div",12),n.qZA()()),2&t){const e=r.$implicit,i=n.MAs(3),a=n.MAs(13),o=n.oxw();n.Gre("ant-upload-list-",o.listType,"-container"),n.xp6(1),n.MT6("ant-upload-list-item ant-upload-list-item-",e.status," ant-upload-list-item-list-type-",o.listType,""),n.Q6J("@itemState",void 0)("nzTooltipTitle","error"===e.status?e.message:null),n.uIk("data-key",e.key),n.xp6(15),n.Q6J("ngTemplateOutlet",i),n.xp6(1),n.Q6J("ngTemplateOutlet",a),n.xp6(1),n.Q6J("ngIf","picture-card"===o.listType&&!e.isUploading),n.xp6(1),n.Q6J("ngIf",e.isUploading)}}const qp=["uploadComp"],Xp=["listComp"],Kp=function(){return[]};function eh(t,r){if(1&t&&n._UZ(0,"nz-upload-list",8,9),2&t){const e=n.oxw(2);n.Udp("display",e.nzShowUploadList?"":"none"),n.Q6J("locale",e.locale)("listType",e.nzListType)("items",e.nzFileList||n.DdM(13,Kp))("icons",e.nzShowUploadList)("iconRender",e.nzIconRender)("previewFile",e.nzPreviewFile)("previewIsImage",e.nzPreviewIsImage)("onPreview",e.nzPreview)("onRemove",e.onRemove)("onDownload",e.nzDownload)("dir",e.dir)}}function th(t,r){1&t&&n.GkF(0)}function nh(t,r){if(1&t&&(n.ynx(0),n.YNc(1,th,1,0,"ng-container",10),n.BQk()),2&t){const e=n.oxw(2);n.xp6(1),n.Q6J("ngTemplateOutlet",e.nzFileListRender)("ngTemplateOutletContext",n.VKq(2,Di,e.nzFileList))}}function rh(t,r){if(1&t&&(n.YNc(0,eh,2,14,"nz-upload-list",6),n.YNc(1,nh,2,4,"ng-container",7)),2&t){const e=n.oxw();n.Q6J("ngIf",e.locale&&!e.nzFileListRender),n.xp6(1),n.Q6J("ngIf",e.nzFileListRender)}}function ih(t,r){1&t&&n.Hsn(0)}function ah(t,r){}function oh(t,r){if(1&t&&(n.TgZ(0,"div",11)(1,"div",12,13),n.YNc(3,ah,0,0,"ng-template",14),n.qZA()()),2&t){const e=n.oxw(),i=n.MAs(3);n.Udp("display",e.nzShowButton?"":"none"),n.Q6J("ngClass",e.classList),n.xp6(1),n.Q6J("options",e._btnOptions),n.xp6(2),n.Q6J("ngTemplateOutlet",i)}}function sh(t,r){}function lh(t,r){}function ch(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"div",15),n.NdJ("drop",function(a){return n.CHM(e),n.oxw().fileDrop(a)})("dragover",function(a){return n.CHM(e),n.oxw().fileDrop(a)})("dragleave",function(a){return n.CHM(e),n.oxw().fileDrop(a)}),n.TgZ(2,"div",16,13)(4,"div",17),n.YNc(5,sh,0,0,"ng-template",14),n.qZA()()(),n.YNc(6,lh,0,0,"ng-template",14),n.BQk()}if(2&t){const e=n.oxw(),i=n.MAs(3),a=n.MAs(1);n.xp6(1),n.Q6J("ngClass",e.classList),n.xp6(1),n.Q6J("options",e._btnOptions),n.xp6(3),n.Q6J("ngTemplateOutlet",i),n.xp6(1),n.Q6J("ngTemplateOutlet",a)}}function uh(t,r){}function dh(t,r){}function fh(t,r){if(1&t&&(n.ynx(0),n.YNc(1,uh,0,0,"ng-template",14),n.YNc(2,dh,0,0,"ng-template",14),n.BQk()),2&t){n.oxw(2);const e=n.MAs(1),i=n.MAs(5);n.xp6(1),n.Q6J("ngTemplateOutlet",e),n.xp6(1),n.Q6J("ngTemplateOutlet",i)}}function ph(t,r){if(1&t&&n.YNc(0,fh,3,2,"ng-container",3),2&t){const e=n.oxw(),i=n.MAs(10);n.Q6J("ngIf","picture-card"===e.nzListType)("ngIfElse",i)}}function hh(t,r){}function mh(t,r){}function gh(t,r){if(1&t&&(n.YNc(0,hh,0,0,"ng-template",14),n.YNc(1,mh,0,0,"ng-template",14)),2&t){n.oxw();const e=n.MAs(5),i=n.MAs(1);n.Q6J("ngTemplateOutlet",e),n.xp6(1),n.Q6J("ngTemplateOutlet",i)}}let _h=(()=>{class t{constructor(e,i,a){if(this.ngZone=e,this.http=i,this.elementRef=a,this.reqs={},this.destroy=!1,this.destroy$=new rt.x,!i)throw new Error("Not found 'HttpClient', You can import 'HttpClientModule' in your root module.")}onClick(){this.options.disabled||!this.options.openFileDialogOnClick||this.file.nativeElement.click()}onFileDrop(e){if(this.options.disabled||"dragover"===e.type)e.preventDefault();else{if(this.options.directory)this.traverseFileTree(e.dataTransfer.items);else{const i=Array.prototype.slice.call(e.dataTransfer.files).filter(a=>this.attrAccept(a,this.options.accept));i.length&&this.uploadFiles(i)}e.preventDefault()}}onChange(e){if(this.options.disabled)return;const i=e.target;this.uploadFiles(i.files),i.value=""}traverseFileTree(e){const i=(a,o)=>{a.isFile?a.file(s=>{this.attrAccept(s,this.options.accept)&&this.uploadFiles([s])}):a.isDirectory&&a.createReader().readEntries(l=>{for(const c of l)i(c,`${o}${a.name}/`)})};for(const a of e)i(a.webkitGetAsEntry(),"")}attrAccept(e,i){if(e&&i){const a=Array.isArray(i)?i:i.split(","),o=`${e.name}`,s=`${e.type}`,l=s.replace(/\/.*$/,"");return a.some(c=>{const u=c.trim();return"."===u.charAt(0)?-1!==o.toLowerCase().indexOf(u.toLowerCase(),o.toLowerCase().length-u.toLowerCase().length):/\/\*$/.test(u)?l===u.replace(/\/.*$/,""):s===u})}return!0}attachUid(e){return e.uid||(e.uid=Math.random().toString(36).substring(2)),e}uploadFiles(e){let i=(0,Ke.of)(Array.prototype.slice.call(e));this.options.filters&&this.options.filters.forEach(a=>{i=i.pipe((0,zt.w)(o=>{const s=a.fn(o);return s instanceof Nt.y?s:(0,Ke.of)(s)}))}),i.subscribe(a=>{a.forEach(o=>{this.attachUid(o),this.upload(o,a)})},a=>{(0,So.ZK)("Unhandled upload filter error",a)})}upload(e,i){if(!this.options.beforeUpload)return this.post(e);const a=this.options.beforeUpload(e,i);if(a instanceof Nt.y)a.subscribe(o=>{const s=Object.prototype.toString.call(o);"[object File]"===s||"[object Blob]"===s?(this.attachUid(o),this.post(o)):"boolean"==typeof o&&!1!==o&&this.post(e)},o=>{(0,So.ZK)("Unhandled upload beforeUpload error",o)});else if(!1!==a)return this.post(e)}post(e){if(this.destroy)return;let a,i=(0,Ke.of)(e);const o=this.options,{uid:s}=e,{action:l,data:c,headers:u,transformFile:d}=o,f={action:"string"==typeof l?l:"",name:o.name,headers:u,file:e,postFile:e,data:c,withCredentials:o.withCredentials,onProgress:o.onProgress?p=>{o.onProgress(p,e)}:void 0,onSuccess:(p,m)=>{this.clean(s),o.onSuccess(p,e,m)},onError:p=>{this.clean(s),o.onError(p,e)}};if("function"==typeof l){const p=l(e);p instanceof Nt.y?i=i.pipe((0,zt.w)(()=>p),(0,Yn.U)(m=>(f.action=m,e))):f.action=p}if("function"==typeof d){const p=d(e);i=i.pipe((0,zt.w)(()=>p instanceof Nt.y?p:(0,Ke.of)(p)),(0,Jn.b)(m=>a=m))}if("function"==typeof c){const p=c(e);p instanceof Nt.y?i=i.pipe((0,zt.w)(()=>p),(0,Yn.U)(m=>(f.data=m,null!=a?a:e))):f.data=p}if("function"==typeof u){const p=u(e);p instanceof Nt.y?i=i.pipe((0,zt.w)(()=>p),(0,Yn.U)(m=>(f.headers=m,null!=a?a:e))):f.headers=p}i.subscribe(p=>{f.postFile=p;const m=(o.customRequest||this.xhr).call(this,f);m instanceof _l.w0||(0,So.ZK)("Must return Subscription type in '[nzCustomRequest]' property"),this.reqs[s]=m,o.onStart(e)})}xhr(e){const i=new FormData;e.data&&Object.keys(e.data).map(o=>{i.append(o,e.data[o])}),i.append(e.name,e.postFile),e.headers||(e.headers={}),null!==e.headers["X-Requested-With"]?e.headers["X-Requested-With"]="XMLHttpRequest":delete e.headers["X-Requested-With"];const a=new on.aW("POST",e.action,i,{reportProgress:!0,withCredentials:e.withCredentials,headers:new on.WM(e.headers)});return this.http.request(a).subscribe(o=>{o.type===on.dt.UploadProgress?(o.total>0&&(o.percent=o.loaded/o.total*100),e.onProgress(o,e.file)):o instanceof on.Zn&&e.onSuccess(o.body,e.file,o)},o=>{this.abort(e.file),e.onError(o,e.file)})}clean(e){const i=this.reqs[e];i instanceof _l.w0&&i.unsubscribe(),delete this.reqs[e]}abort(e){e?this.clean(e&&e.uid):Object.keys(this.reqs).forEach(i=>this.clean(i))}ngOnInit(){this.ngZone.runOutsideAngular(()=>{(0,fr.R)(this.elementRef.nativeElement,"click").pipe((0,Re.R)(this.destroy$)).subscribe(()=>this.onClick()),(0,fr.R)(this.elementRef.nativeElement,"keydown").pipe((0,Re.R)(this.destroy$)).subscribe(e=>{this.options.disabled||("Enter"===e.key||e.keyCode===ba.K5)&&this.onClick()})})}ngOnDestroy(){this.destroy=!0,this.destroy$.next(),this.abort()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(n.R0b),n.Y36(on.eN,8),n.Y36(n.SBq))},t.\u0275cmp=n.Xpm({type:t,selectors:[["","nz-upload-btn",""]],viewQuery:function(e,i){if(1&e&&n.Gf(cp,7),2&e){let a;n.iGM(a=n.CRH())&&(i.file=a.first)}},hostAttrs:[1,"ant-upload"],hostVars:4,hostBindings:function(e,i){1&e&&n.NdJ("drop",function(o){return i.onFileDrop(o)})("dragover",function(o){return i.onFileDrop(o)}),2&e&&(n.uIk("tabindex","0")("role","button"),n.ekj("ant-upload-disabled",i.options.disabled))},inputs:{options:"options"},exportAs:["nzUploadBtn"],attrs:up,ngContentSelectors:yl,decls:3,vars:4,consts:[["type","file",2,"display","none",3,"multiple","change"],["file",""]],template:function(e,i){1&e&&(n.F$t(),n.TgZ(0,"input",0,1),n.NdJ("change",function(o){return i.onChange(o)}),n.qZA(),n.Hsn(2)),2&e&&(n.Q6J("multiple",i.options.multiple),n.uIk("accept",i.options.accept)("directory",i.options.directory?"directory":null)("webkitdirectory",i.options.directory?"webkitdirectory":null))},encapsulation:2}),t})();const wl=t=>!!t&&0===t.indexOf("image/");let xh=(()=>{class t{constructor(e,i,a,o){this.cdr=e,this.doc=i,this.ngZone=a,this.platform=o,this.list=[],this.locale={},this.iconRender=null,this.dir="ltr",this.destroy$=new rt.x}get showPic(){return"picture"===this.listType||"picture-card"===this.listType}set items(e){this.list=e}genErr(e){return e.response&&"string"==typeof e.response?e.response:e.error&&e.error.statusText||this.locale.uploadError}extname(e){const i=e.split("/"),o=i[i.length-1].split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(o)||[""])[0]}isImageUrl(e){if(wl(e.type))return!0;const i=e.thumbUrl||e.url||"";if(!i)return!1;const a=this.extname(i);return!(!/^data:image\//.test(i)&&!/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg)$/i.test(a))||!/^data:/.test(i)&&!a}getIconType(e){return this.showPic?e.isUploading||!e.thumbUrl&&!e.url?"uploading":"thumbnail":""}previewImage(e){if(!wl(e.type)||!this.platform.isBrowser)return(0,Ke.of)("");const i=this.doc.createElement("canvas");i.width=200,i.height=200,i.style.cssText="position: fixed; left: 0; top: 0; width: 200px; height: 200px; z-index: 9999; display: none;",this.doc.body.appendChild(i);const a=i.getContext("2d"),o=new Image,s=URL.createObjectURL(e);return o.src=s,(0,fr.R)(o,"load").pipe((0,Yn.U)(()=>{const{width:l,height:c}=o;let u=200,d=200,f=0,p=0;l<c?(d=c*(200/l),p=-(d-u)/2):(u=l*(200/c),f=-(u-d)/2);try{a.drawImage(o,f,p,u,d)}catch(x){}const m=i.toDataURL();return this.doc.body.removeChild(i),URL.revokeObjectURL(s),m}))}genThumb(){if(!this.platform.isBrowser)return;const e=window;!this.showPic||"undefined"==typeof document||void 0===e||!e.FileReader||!e.File||this.list.filter(i=>i.originFileObj instanceof File&&void 0===i.thumbUrl).forEach(i=>{i.thumbUrl="";const a=(this.previewFile?this.previewFile(i):this.previewImage(i.originFileObj)).pipe((0,Re.R)(this.destroy$));this.ngZone.runOutsideAngular(()=>{a.subscribe(o=>{this.ngZone.run(()=>{i.thumbUrl=o,this.detectChanges()})})})})}showDownload(e){return!(!this.icons.showDownloadIcon||"done"!==e.status)}fixData(){this.list.forEach(e=>{e.isUploading="uploading"===e.status,e.message=this.genErr(e),e.linkProps="string"==typeof e.linkProps?JSON.parse(e.linkProps):e.linkProps,e.isImageUrl=this.previewIsImage?this.previewIsImage(e):this.isImageUrl(e),e.iconType=this.getIconType(e),e.showDownload=this.showDownload(e)})}handlePreview(e,i){if(this.onPreview)return i.preventDefault(),this.onPreview(e)}handleRemove(e,i){i.preventDefault(),this.onRemove&&this.onRemove(e)}handleDownload(e){"function"==typeof this.onDownload?this.onDownload(e):e.url&&window.open(e.url)}detectChanges(){this.fixData(),this.cdr.detectChanges()}ngOnChanges(){this.fixData(),this.genThumb()}ngOnDestroy(){this.destroy$.next()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(n.sBO),n.Y36(K.K0),n.Y36(n.R0b),n.Y36(cr.t4))},t.\u0275cmp=n.Xpm({type:t,selectors:[["nz-upload-list"]],hostAttrs:[1,"ant-upload-list"],hostVars:8,hostBindings:function(e,i){2&e&&n.ekj("ant-upload-list-rtl","rtl"===i.dir)("ant-upload-list-text","text"===i.listType)("ant-upload-list-picture","picture"===i.listType)("ant-upload-list-picture-card","picture-card"===i.listType)},inputs:{locale:"locale",listType:"listType",items:"items",icons:"icons",onPreview:"onPreview",onRemove:"onRemove",onDownload:"onDownload",previewFile:"previewFile",previewIsImage:"previewIsImage",iconRender:"iconRender",dir:"dir"},exportAs:["nzUploadList"],features:[n.TTD],decls:1,vars:1,consts:[[3,"class",4,"ngFor","ngForOf"],["nz-tooltip","",3,"nzTooltipTitle"],["icon",""],["iconNode",""],["removeIcon",""],["downloadIcon",""],["downloadOrDelete",""],["preview",""],[1,"ant-upload-list-item-info"],[1,"ant-upload-span"],[3,"ngTemplateOutlet"],["class","ant-upload-list-item-actions",4,"ngIf"],["class","ant-upload-list-item-progress",4,"ngIf"],[3,"ngSwitch"],["class","ant-upload-list-item-thumbnail",3,"ant-upload-list-item-file",4,"ngSwitchCase"],["class","ant-upload-list-item-thumbnail","target","_blank","rel","noopener noreferrer",3,"ant-upload-list-item-file","href","click",4,"ngSwitchCase"],["class","ant-upload-text-icon",4,"ngSwitchDefault"],["noImageThumbTpl",""],[1,"ant-upload-list-item-thumbnail"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["target","_blank","rel","noopener noreferrer",1,"ant-upload-list-item-thumbnail",3,"href","click"],["class","ant-upload-list-item-image",3,"src",4,"ngIf","ngIfElse"],[1,"ant-upload-list-item-image",3,"src"],[1,"ant-upload-text-icon"],[4,"ngIf","ngIfElse"],["customIconRender",""],["iconNodeFileIcon",""],[4,"ngSwitchCase"],["nz-icon","",3,"nzType",4,"ngSwitchDefault"],["nz-icon","","nzType","loading"],["nz-icon","",3,"nzType"],["nz-icon","","nzTheme","twotone",3,"nzType"],["type","button","nz-button","","nzType","text","nzSize","small","class","ant-upload-list-item-card-actions-btn",3,"click",4,"ngIf"],["type","button","nz-button","","nzType","text","nzSize","small",1,"ant-upload-list-item-card-actions-btn",3,"click"],["nz-icon","","nzType","delete"],["nz-icon","","nzType","download"],[3,"class",4,"ngIf"],["target","_blank","rel","noopener noreferrer","class","ant-upload-list-item-name",3,"href","click",4,"ngIf"],["class","ant-upload-list-item-name",3,"click",4,"ngIf"],["target","_blank","rel","noopener noreferrer",1,"ant-upload-list-item-name",3,"href","click"],[1,"ant-upload-list-item-name",3,"click"],[1,"ant-upload-list-item-actions"],["target","_blank","rel","noopener noreferrer",3,"href","ngStyle","click",4,"ngIf"],[4,"ngIf"],["target","_blank","rel","noopener noreferrer",3,"href","ngStyle","click"],["nz-icon","","nzType","eye"],[1,"ant-upload-list-item-progress"],["nzType","line",3,"nzPercent","nzShowInfo","nzStrokeWidth"]],template:function(e,i){1&e&&n.YNc(0,Qp,20,14,"div",0),2&e&&n.Q6J("ngForOf",i.list)},directives:[It.ix,sp,K.sg,Cl.SY,K.RF,K.n9,K.tP,K.O5,K.ED,Pt.Ls,Mn.w,K.PC],encapsulation:2,data:{animation:[(0,pr.X$)("itemState",[(0,pr.eR)(":enter",[(0,pr.oB)({height:"0",width:"0",opacity:0}),(0,pr.jt)(150,(0,pr.oB)({height:"*",width:"*",opacity:1}))]),(0,pr.eR)(":leave",[(0,pr.jt)(150,(0,pr.oB)({height:"0",width:"0",opacity:0}))])])]},changeDetection:0}),t})(),Tl=(()=>{class t{constructor(e,i,a){this.cdr=e,this.i18n=i,this.directionality=a,this.destroy$=new rt.x,this.dir="ltr",this.nzType="select",this.nzLimit=0,this.nzSize=0,this.nzDirectory=!1,this.nzOpenFileDialogOnClick=!0,this.nzFilter=[],this.nzFileList=[],this.nzDisabled=!1,this.nzListType="text",this.nzMultiple=!1,this.nzName="file",this._showUploadList=!0,this.nzShowButton=!0,this.nzWithCredentials=!1,this.nzIconRender=null,this.nzFileListRender=null,this.nzChange=new n.vpe,this.nzFileListChange=new n.vpe,this.onStart=o=>{this.nzFileList||(this.nzFileList=[]);const s=this.fileToObject(o);s.status="uploading",this.nzFileList=this.nzFileList.concat(s),this.nzFileListChange.emit(this.nzFileList),this.nzChange.emit({file:s,fileList:this.nzFileList,type:"start"}),this.detectChangesList()},this.onProgress=(o,s)=>{const c=this.getFileItem(s,this.nzFileList);c.percent=o.percent,this.nzChange.emit({event:o,file:Object.assign({},c),fileList:this.nzFileList,type:"progress"}),this.detectChangesList()},this.onSuccess=(o,s)=>{const l=this.nzFileList,c=this.getFileItem(s,l);c.status="done",c.response=o,this.nzChange.emit({file:Object.assign({},c),fileList:l,type:"success"}),this.detectChangesList()},this.onError=(o,s)=>{const l=this.nzFileList,c=this.getFileItem(s,l);c.error=o,c.status="error",this.nzChange.emit({file:Object.assign({},c),fileList:l,type:"error"}),this.detectChangesList()},this.onRemove=o=>{this.uploadComp.abort(o),o.status="removed";const s="function"==typeof this.nzRemove?this.nzRemove(o):null==this.nzRemove||this.nzRemove;(s instanceof Nt.y?s:(0,Ke.of)(s)).pipe((0,dr.h)(l=>l)).subscribe(()=>{this.nzFileList=this.removeFileItem(o,this.nzFileList),this.nzChange.emit({file:o,fileList:this.nzFileList,type:"removed"}),this.nzFileListChange.emit(this.nzFileList),this.cdr.detectChanges()})},this.prefixCls="ant-upload",this.classList=[]}set nzShowUploadList(e){this._showUploadList="boolean"==typeof e?(0,_e.sw)(e):e}get nzShowUploadList(){return this._showUploadList}zipOptions(){"boolean"==typeof this.nzShowUploadList&&this.nzShowUploadList&&(this.nzShowUploadList={showPreviewIcon:!0,showRemoveIcon:!0,showDownloadIcon:!0});const e=this.nzFilter.slice();if(this.nzMultiple&&this.nzLimit>0&&-1===e.findIndex(i=>"limit"===i.name)&&e.push({name:"limit",fn:i=>i.slice(-this.nzLimit)}),this.nzSize>0&&-1===e.findIndex(i=>"size"===i.name)&&e.push({name:"size",fn:i=>i.filter(a=>a.size/1024<=this.nzSize)}),this.nzFileType&&this.nzFileType.length>0&&-1===e.findIndex(i=>"type"===i.name)){const i=this.nzFileType.split(",");e.push({name:"type",fn:a=>a.filter(o=>~i.indexOf(o.type))})}return this._btnOptions={disabled:this.nzDisabled,accept:this.nzAccept,action:this.nzAction,directory:this.nzDirectory,openFileDialogOnClick:this.nzOpenFileDialogOnClick,beforeUpload:this.nzBeforeUpload,customRequest:this.nzCustomRequest,data:this.nzData,headers:this.nzHeaders,name:this.nzName,multiple:this.nzMultiple,withCredentials:this.nzWithCredentials,filters:e,transformFile:this.nzTransformFile,onStart:this.onStart,onProgress:this.onProgress,onSuccess:this.onSuccess,onError:this.onError},this}fileToObject(e){return{lastModified:e.lastModified,lastModifiedDate:e.lastModifiedDate,name:e.filename||e.name,size:e.size,type:e.type,uid:e.uid,response:e.response,error:e.error,percent:0,originFileObj:e}}getFileItem(e,i){return i.filter(a=>a.uid===e.uid)[0]}removeFileItem(e,i){return i.filter(a=>a.uid!==e.uid)}fileDrop(e){e.type!==this.dragState&&(this.dragState=e.type,this.setClassMap())}detectChangesList(){var e;this.cdr.detectChanges(),null===(e=this.listComp)||void 0===e||e.detectChanges()}setClassMap(){let e=[];"drag"===this.nzType?(this.nzFileList.some(i=>"uploading"===i.status)&&e.push(`${this.prefixCls}-drag-uploading`),"dragover"===this.dragState&&e.push(`${this.prefixCls}-drag-hover`)):e=[`${this.prefixCls}-select-${this.nzListType}`],this.classList=[this.prefixCls,`${this.prefixCls}-${this.nzType}`,...e,this.nzDisabled&&`${this.prefixCls}-disabled`||"","rtl"===this.dir&&`${this.prefixCls}-rtl`||""].filter(i=>!!i),this.cdr.detectChanges()}ngOnInit(){var e;this.dir=this.directionality.value,null===(e=this.directionality.change)||void 0===e||e.pipe((0,Re.R)(this.destroy$)).subscribe(i=>{this.dir=i,this.setClassMap(),this.cdr.detectChanges()}),this.i18n.localeChange.pipe((0,Re.R)(this.destroy$)).subscribe(()=>{this.locale=this.i18n.getLocaleData("Upload"),this.detectChangesList()})}ngOnChanges(){this.zipOptions().setClassMap()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(n.sBO),n.Y36(ct.wi),n.Y36(be.Is,8))},t.\u0275cmp=n.Xpm({type:t,selectors:[["nz-upload"]],viewQuery:function(e,i){if(1&e&&(n.Gf(qp,5),n.Gf(Xp,5)),2&e){let a;n.iGM(a=n.CRH())&&(i.uploadComp=a.first),n.iGM(a=n.CRH())&&(i.listComp=a.first)}},hostVars:2,hostBindings:function(e,i){2&e&&n.ekj("ant-upload-picture-card-wrapper","picture-card"===i.nzListType)},inputs:{nzType:"nzType",nzLimit:"nzLimit",nzSize:"nzSize",nzFileType:"nzFileType",nzAccept:"nzAccept",nzAction:"nzAction",nzDirectory:"nzDirectory",nzOpenFileDialogOnClick:"nzOpenFileDialogOnClick",nzBeforeUpload:"nzBeforeUpload",nzCustomRequest:"nzCustomRequest",nzData:"nzData",nzFilter:"nzFilter",nzFileList:"nzFileList",nzDisabled:"nzDisabled",nzHeaders:"nzHeaders",nzListType:"nzListType",nzMultiple:"nzMultiple",nzName:"nzName",nzShowUploadList:"nzShowUploadList",nzShowButton:"nzShowButton",nzWithCredentials:"nzWithCredentials",nzRemove:"nzRemove",nzPreview:"nzPreview",nzPreviewFile:"nzPreviewFile",nzPreviewIsImage:"nzPreviewIsImage",nzTransformFile:"nzTransformFile",nzDownload:"nzDownload",nzIconRender:"nzIconRender",nzFileListRender:"nzFileListRender"},outputs:{nzChange:"nzChange",nzFileListChange:"nzFileListChange"},exportAs:["nzUpload"],features:[n.TTD],ngContentSelectors:yl,decls:11,vars:2,consts:[["list",""],["con",""],["btn",""],[4,"ngIf","ngIfElse"],["select",""],["pic",""],[3,"display","locale","listType","items","icons","iconRender","previewFile","previewIsImage","onPreview","onRemove","onDownload","dir",4,"ngIf"],[4,"ngIf"],[3,"locale","listType","items","icons","iconRender","previewFile","previewIsImage","onPreview","onRemove","onDownload","dir"],["listComp",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass"],["nz-upload-btn","",3,"options"],["uploadComp",""],[3,"ngTemplateOutlet"],[3,"ngClass","drop","dragover","dragleave"],["nz-upload-btn","",1,"ant-upload-btn",3,"options"],[1,"ant-upload-drag-container"]],template:function(e,i){if(1&e&&(n.F$t(),n.YNc(0,rh,2,2,"ng-template",null,0,n.W1O),n.YNc(2,ih,1,0,"ng-template",null,1,n.W1O),n.YNc(4,oh,4,5,"ng-template",null,2,n.W1O),n.YNc(6,ch,7,4,"ng-container",3),n.YNc(7,ph,1,2,"ng-template",null,4,n.W1O),n.YNc(9,gh,2,2,"ng-template",null,5,n.W1O)),2&e){const a=n.MAs(8);n.xp6(6),n.Q6J("ngIf","drag"===i.nzType)("ngIfElse",a)}},directives:[xh,_h,K.O5,be.Lv,K.tP,K.mk],encapsulation:2,changeDetection:0}),(0,Oe.gn)([(0,_e.Rn)()],t.prototype,"nzLimit",void 0),(0,Oe.gn)([(0,_e.Rn)()],t.prototype,"nzSize",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzDirectory",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzOpenFileDialogOnClick",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzDisabled",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzMultiple",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzShowButton",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzWithCredentials",void 0),t})(),kl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[be.vT,K.ez,ve.u5,cr.ud,Cl.cg,lp,ct.YI,Pt.PV,It.sL]]}),t})();function vh(t,r){if(1&t&&(n.ynx(0),n._uU(1),n.BQk()),2&t){const e=n.oxw(2);n.xp6(1),n.Oqu(e.nzText)}}function Ch(t,r){if(1&t&&(n.TgZ(0,"span",1),n.YNc(1,vh,2,1,"ng-container",2),n.qZA()),2&t){const e=n.oxw();n.xp6(1),n.Q6J("nzStringTemplateOutlet",e.nzText)}}let yh=(()=>{class t{constructor(){this.nzType="horizontal",this.nzOrientation="center",this.nzDashed=!1,this.nzPlain=!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.Xpm({type:t,selectors:[["nz-divider"]],hostAttrs:[1,"ant-divider"],hostVars:16,hostBindings:function(e,i){2&e&&n.ekj("ant-divider-horizontal","horizontal"===i.nzType)("ant-divider-vertical","vertical"===i.nzType)("ant-divider-with-text",i.nzText)("ant-divider-plain",i.nzPlain)("ant-divider-with-text-left",i.nzText&&"left"===i.nzOrientation)("ant-divider-with-text-right",i.nzText&&"right"===i.nzOrientation)("ant-divider-with-text-center",i.nzText&&"center"===i.nzOrientation)("ant-divider-dashed",i.nzDashed)},inputs:{nzText:"nzText",nzType:"nzType",nzOrientation:"nzOrientation",nzDashed:"nzDashed",nzPlain:"nzPlain"},exportAs:["nzDivider"],decls:1,vars:1,consts:[["class","ant-divider-inner-text",4,"ngIf"],[1,"ant-divider-inner-text"],[4,"nzStringTemplateOutlet"]],template:function(e,i){1&e&&n.YNc(0,Ch,2,1,"span",0),2&e&&n.Q6J("ngIf",i.nzText)},directives:[K.O5,Ee.f],encapsulation:2,changeDetection:0}),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzDashed",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzPlain",void 0),t})(),Sl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[be.vT,K.ez,Ee.T]]}),t})();var bo=oe(515);function wh(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"div",0),n.NdJ("@slideMotion.done",function(a){return n.CHM(e),n.oxw().onAnimationEvent(a)})("mouseenter",function(){return n.CHM(e),n.oxw().setMouseState(!0)})("mouseleave",function(){return n.CHM(e),n.oxw().setMouseState(!1)}),n.Hsn(1),n.qZA()}if(2&t){const e=n.oxw();n.ekj("ant-dropdown-rtl","rtl"===e.dir),n.Q6J("ngClass",e.nzOverlayClassName)("ngStyle",e.nzOverlayStyle)("@slideMotion",void 0)("@.disabled",null==e.noAnimation?null:e.noAnimation.nzNoAnimation)("nzNoAnimation",null==e.noAnimation?null:e.noAnimation.nzNoAnimation)}}const Th=["*"],Sh=[bt.yW.bottomLeft,bt.yW.bottomRight,bt.yW.topRight,bt.yW.topLeft];let bl=(()=>{class t{constructor(e,i,a,o,s,l){this.nzConfigService=e,this.elementRef=i,this.overlay=a,this.renderer=o,this.viewContainerRef=s,this.platform=l,this._nzModuleName="dropDown",this.overlayRef=null,this.destroy$=new rt.x,this.positionStrategy=this.overlay.position().flexibleConnectedTo(this.elementRef.nativeElement).withLockedPosition().withTransformOriginOn(".ant-dropdown"),this.inputVisible$=new En.X(!1),this.nzTrigger$=new En.X("hover"),this.overlayClose$=new rt.x,this.nzDropdownMenu=null,this.nzTrigger="hover",this.nzMatchWidthElement=null,this.nzBackdrop=!1,this.nzClickHide=!0,this.nzDisabled=!1,this.nzVisible=!1,this.nzOverlayClassName="",this.nzOverlayStyle={},this.nzPlacement="bottomLeft",this.nzVisibleChange=new n.vpe}setDropdownMenuValue(e,i){this.nzDropdownMenu&&this.nzDropdownMenu.setValue(e,i)}ngAfterViewInit(){if(this.nzDropdownMenu){const e=this.elementRef.nativeElement,i=(0,ur.T)((0,fr.R)(e,"mouseenter").pipe((0,Oi.h)(!0)),(0,fr.R)(e,"mouseleave").pipe((0,Oi.h)(!1))),o=(0,ur.T)(this.nzDropdownMenu.mouseState$,i),s=(0,fr.R)(e,"click").pipe((0,Yn.U)(()=>!this.nzVisible)),l=this.nzTrigger$.pipe((0,zt.w)(f=>"hover"===f?o:"click"===f?s:bo.E)),c=this.nzDropdownMenu.descendantMenuItemClick$.pipe((0,dr.h)(()=>this.nzClickHide),(0,Oi.h)(!1)),u=(0,ur.T)(l,c,this.overlayClose$).pipe((0,dr.h)(()=>!this.nzDisabled)),d=(0,ur.T)(this.inputVisible$,u);(0,Ii.a)([d,this.nzDropdownMenu.isChildSubMenuOpen$]).pipe((0,Yn.U)(([f,p])=>f||p),(0,dl.e)(150),(0,wo.x)(),(0,dr.h)(()=>this.platform.isBrowser),(0,Re.R)(this.destroy$)).subscribe(f=>{const m=(this.nzMatchWidthElement?this.nzMatchWidthElement.nativeElement:e).getBoundingClientRect().width;this.nzVisible!==f&&this.nzVisibleChange.emit(f),this.nzVisible=f,f?(this.overlayRef?this.overlayRef.getConfig().minWidth=m:(this.overlayRef=this.overlay.create({positionStrategy:this.positionStrategy,minWidth:m,disposeOnNavigation:!0,hasBackdrop:this.nzBackdrop&&"click"===this.nzTrigger,scrollStrategy:this.overlay.scrollStrategies.reposition()}),(0,ur.T)(this.overlayRef.backdropClick(),this.overlayRef.detachments(),this.overlayRef.outsidePointerEvents().pipe((0,dr.h)(x=>!this.elementRef.nativeElement.contains(x.target))),this.overlayRef.keydownEvents().pipe((0,dr.h)(x=>x.keyCode===ba.hY&&!(0,ba.Vb)(x)))).pipe((0,Re.R)(this.destroy$)).subscribe(()=>{this.overlayClose$.next(!1)})),this.positionStrategy.withPositions([bt.yW[this.nzPlacement],...Sh]),(!this.portal||this.portal.templateRef!==this.nzDropdownMenu.templateRef)&&(this.portal=new zi.UE(this.nzDropdownMenu.templateRef,this.viewContainerRef)),this.overlayRef.attach(this.portal)):this.overlayRef&&this.overlayRef.detach()}),this.nzDropdownMenu.animationStateChange$.pipe((0,Re.R)(this.destroy$)).subscribe(f=>{"void"===f.toState&&(this.overlayRef&&this.overlayRef.dispose(),this.overlayRef=null)})}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=null)}ngOnChanges(e){const{nzVisible:i,nzDisabled:a,nzOverlayClassName:o,nzOverlayStyle:s,nzTrigger:l}=e;if(l&&this.nzTrigger$.next(this.nzTrigger),i&&this.inputVisible$.next(this.nzVisible),a){const c=this.elementRef.nativeElement;this.nzDisabled?(this.renderer.setAttribute(c,"disabled",""),this.inputVisible$.next(!1)):this.renderer.removeAttribute(c,"disabled")}o&&this.setDropdownMenuValue("nzOverlayClassName",this.nzOverlayClassName),s&&this.setDropdownMenuValue("nzOverlayStyle",this.nzOverlayStyle)}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(tn.jY),n.Y36(n.SBq),n.Y36(Bt.aV),n.Y36(n.Qsj),n.Y36(n.s_b),n.Y36(cr.t4))},t.\u0275dir=n.lG2({type:t,selectors:[["","nz-dropdown",""]],hostAttrs:[1,"ant-dropdown-trigger"],inputs:{nzDropdownMenu:"nzDropdownMenu",nzTrigger:"nzTrigger",nzMatchWidthElement:"nzMatchWidthElement",nzBackdrop:"nzBackdrop",nzClickHide:"nzClickHide",nzDisabled:"nzDisabled",nzVisible:"nzVisible",nzOverlayClassName:"nzOverlayClassName",nzOverlayStyle:"nzOverlayStyle",nzPlacement:"nzPlacement"},outputs:{nzVisibleChange:"nzVisibleChange"},exportAs:["nzDropdown"],features:[n.TTD]}),(0,Oe.gn)([(0,tn.oS)(),(0,_e.yF)()],t.prototype,"nzBackdrop",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzClickHide",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzDisabled",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzVisible",void 0),t})(),bh=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({}),t})(),zl=(()=>{class t{constructor(e,i,a){this.renderer=e,this.nzButtonGroupComponent=i,this.elementRef=a}ngAfterViewInit(){const e=this.renderer.parentNode(this.elementRef.nativeElement);this.nzButtonGroupComponent&&e&&this.renderer.addClass(e,"ant-dropdown-button")}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(n.Qsj),n.Y36(It.fY,9),n.Y36(n.SBq))},t.\u0275dir=n.lG2({type:t,selectors:[["","nz-button","","nz-dropdown",""]]}),t})(),Il=(()=>{class t{constructor(e,i,a,o,s,l,c){this.cdr=e,this.elementRef=i,this.renderer=a,this.viewContainerRef=o,this.nzMenuService=s,this.directionality=l,this.noAnimation=c,this.mouseState$=new En.X(!1),this.isChildSubMenuOpen$=this.nzMenuService.isChildSubMenuOpen$,this.descendantMenuItemClick$=this.nzMenuService.descendantMenuItemClick$,this.animationStateChange$=new n.vpe,this.nzOverlayClassName="",this.nzOverlayStyle={},this.dir="ltr",this.destroy$=new rt.x}onAnimationEvent(e){this.animationStateChange$.emit(e)}setMouseState(e){this.mouseState$.next(e)}setValue(e,i){this[e]=i,this.cdr.markForCheck()}ngOnInit(){var e;null===(e=this.directionality.change)||void 0===e||e.pipe((0,Re.R)(this.destroy$)).subscribe(i=>{this.dir=i,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngAfterContentInit(){this.renderer.removeChild(this.renderer.parentNode(this.elementRef.nativeElement),this.elementRef.nativeElement)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(n.sBO),n.Y36(n.SBq),n.Y36(n.Qsj),n.Y36(n.s_b),n.Y36($n),n.Y36(be.Is,8),n.Y36(Rn.P,9))},t.\u0275cmp=n.Xpm({type:t,selectors:[["nz-dropdown-menu"]],viewQuery:function(e,i){if(1&e&&n.Gf(n.Rgc,7),2&e){let a;n.iGM(a=n.CRH())&&(i.templateRef=a.first)}},exportAs:["nzDropdownMenu"],features:[n._Bn([$n,{provide:Ar,useValue:!0}])],ngContentSelectors:Th,decls:1,vars:0,consts:[[1,"ant-dropdown",3,"ngClass","ngStyle","nzNoAnimation","mouseenter","mouseleave"]],template:function(e,i){1&e&&(n.F$t(),n.YNc(0,wh,2,7,"ng-template"))},directives:[K.mk,K.PC,Rn.P],encapsulation:2,data:{animation:[Ei.mF]},changeDetection:0}),t})(),Ol=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[be.vT,K.ez,Bt.U8,ve.u5,It.sL,ko,Pt.PV,Rn.g,cr.ud,bt.e4,bh,Ee.T],ko]}),t})();new Bt.tR({originX:"start",originY:"top"},{overlayX:"start",overlayY:"top"}),new Bt.tR({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"}),new Bt.tR({originX:"start",originY:"top"},{overlayX:"end",overlayY:"bottom"}),new Bt.tR({originX:"start",originY:"top"},{overlayX:"end",overlayY:"top"});const El=["moz","ms","webkit"],Oh=function Ih(){if("undefined"==typeof window)return()=>0;if(window.requestAnimationFrame)return window.requestAnimationFrame.bind(window);const t=El.filter(r=>`${r}RequestAnimationFrame`in window)[0];return t?window[`${t}RequestAnimationFrame`]:function zh(){let t=0;return function(r){const e=(new Date).getTime(),i=Math.max(0,16-(e-t)),a=setTimeout(()=>{r(e+i)},i);return t=e+i,a}}()}();var Mr=oe(2643);const Eh=["hourListElement"],Fh=["minuteListElement"],Dh=["secondListElement"],Ah=["use12HoursListElement"];function Nh(t,r){if(1&t&&(n.TgZ(0,"div",4)(1,"div",5),n._uU(2),n.qZA()()),2&t){const e=n.oxw();n.xp6(2),n.Oqu(e.dateHelper.format(null==e.time?null:e.time.value,e.format)||"\xa0")}}function Mh(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",10),n.NdJ("click",function(){n.CHM(e);const a=n.oxw().$implicit;return n.oxw(2).selectHour(a)}),n.TgZ(1,"div",11),n._uU(2),n.ALo(3,"number"),n.qZA()()}if(2&t){const e=n.oxw().$implicit,i=n.oxw(2);n.ekj("ant-picker-time-panel-cell-selected",i.isSelectedHour(e))("ant-picker-time-panel-cell-disabled",e.disabled),n.xp6(2),n.Oqu(n.xi3(3,5,e.index,"2.0-0"))}}function Rh(t,r){if(1&t&&(n.ynx(0),n.YNc(1,Mh,4,8,"li",9),n.BQk()),2&t){const e=r.$implicit,i=n.oxw(2);n.xp6(1),n.Q6J("ngIf",!(i.nzHideDisabledOptions&&e.disabled))}}function Ph(t,r){if(1&t&&(n.TgZ(0,"ul",6,7),n.YNc(2,Rh,2,1,"ng-container",8),n.qZA()),2&t){const e=n.oxw();n.xp6(2),n.Q6J("ngForOf",e.hourRange)("ngForTrackBy",e.trackByFn)}}function Bh(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",10),n.NdJ("click",function(){n.CHM(e);const a=n.oxw().$implicit;return n.oxw(2).selectMinute(a)}),n.TgZ(1,"div",11),n._uU(2),n.ALo(3,"number"),n.qZA()()}if(2&t){const e=n.oxw().$implicit,i=n.oxw(2);n.ekj("ant-picker-time-panel-cell-selected",i.isSelectedMinute(e))("ant-picker-time-panel-cell-disabled",e.disabled),n.xp6(2),n.Oqu(n.xi3(3,5,e.index,"2.0-0"))}}function Lh(t,r){if(1&t&&(n.ynx(0),n.YNc(1,Bh,4,8,"li",9),n.BQk()),2&t){const e=r.$implicit,i=n.oxw(2);n.xp6(1),n.Q6J("ngIf",!(i.nzHideDisabledOptions&&e.disabled))}}function Uh(t,r){if(1&t&&(n.TgZ(0,"ul",6,12),n.YNc(2,Lh,2,1,"ng-container",8),n.qZA()),2&t){const e=n.oxw();n.xp6(2),n.Q6J("ngForOf",e.minuteRange)("ngForTrackBy",e.trackByFn)}}function Hh(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",10),n.NdJ("click",function(){n.CHM(e);const a=n.oxw().$implicit;return n.oxw(2).selectSecond(a)}),n.TgZ(1,"div",11),n._uU(2),n.ALo(3,"number"),n.qZA()()}if(2&t){const e=n.oxw().$implicit,i=n.oxw(2);n.ekj("ant-picker-time-panel-cell-selected",i.isSelectedSecond(e))("ant-picker-time-panel-cell-disabled",e.disabled),n.xp6(2),n.Oqu(n.xi3(3,5,e.index,"2.0-0"))}}function Vh(t,r){if(1&t&&(n.ynx(0),n.YNc(1,Hh,4,8,"li",9),n.BQk()),2&t){const e=r.$implicit,i=n.oxw(2);n.xp6(1),n.Q6J("ngIf",!(i.nzHideDisabledOptions&&e.disabled))}}function Zh(t,r){if(1&t&&(n.TgZ(0,"ul",6,13),n.YNc(2,Vh,2,1,"ng-container",8),n.qZA()),2&t){const e=n.oxw();n.xp6(2),n.Q6J("ngForOf",e.secondRange)("ngForTrackBy",e.trackByFn)}}function jh(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",10),n.NdJ("click",function(){n.CHM(e);const a=n.oxw().$implicit;return n.oxw(2).select12Hours(a)}),n.TgZ(1,"div",11),n._uU(2),n.qZA()()}if(2&t){const e=n.oxw().$implicit,i=n.oxw(2);n.ekj("ant-picker-time-panel-cell-selected",i.isSelected12Hours(e)),n.xp6(2),n.Oqu(e.value)}}function Gh(t,r){if(1&t&&(n.ynx(0),n.YNc(1,jh,3,3,"li",16),n.BQk()),2&t){const e=n.oxw(2);n.xp6(1),n.Q6J("ngIf",!e.nzHideDisabledOptions)}}function Wh(t,r){if(1&t&&(n.TgZ(0,"ul",6,14),n.YNc(2,Gh,2,1,"ng-container",15),n.qZA()),2&t){const e=n.oxw();n.xp6(2),n.Q6J("ngForOf",e.use12HoursRange)}}function Yh(t,r){}function $h(t,r){if(1&t&&(n.TgZ(0,"div",24),n.YNc(1,Yh,0,0,"ng-template",25),n.qZA()),2&t){const e=n.oxw(2);n.xp6(1),n.Q6J("ngTemplateOutlet",e.nzAddOn)}}function Jh(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"div",17),n.YNc(1,$h,2,1,"div",18),n.TgZ(2,"ul",19)(3,"li",20)(4,"a",21),n.NdJ("click",function(){return n.CHM(e),n.oxw().onClickNow()}),n._uU(5),n.ALo(6,"nzI18n"),n.qZA()(),n.TgZ(7,"li",22)(8,"button",23),n.NdJ("click",function(){return n.CHM(e),n.oxw().onClickOk()}),n._uU(9),n.ALo(10,"nzI18n"),n.qZA()()()()}if(2&t){const e=n.oxw();n.xp6(1),n.Q6J("ngIf",e.nzAddOn),n.xp6(4),n.hij(" ",e.nzNowText||n.lcZ(6,3,"Calendar.lang.now")," "),n.xp6(4),n.hij(" ",e.nzOkText||n.lcZ(10,5,"Calendar.lang.ok")," ")}}class Qh{constructor(){this.selected12Hours=void 0,this._use12Hours=!1,this._changes=new rt.x}setMinutes(r,e){return e||(this.initValue(),this.value.setMinutes(r),this.update()),this}setHours(r,e){return e||(this.initValue(),this.value.setHours(this._use12Hours?"PM"===this.selected12Hours&&12!==r?r+12:"AM"===this.selected12Hours&&12===r?0:r:r),this.update()),this}setSeconds(r,e){return e||(this.initValue(),this.value.setSeconds(r),this.update()),this}setUse12Hours(r){return this._use12Hours=r,this}get changes(){return this._changes.asObservable()}setValue(r,e){return(0,_e.DX)(e)&&(this._use12Hours=e),r!==this.value&&(this._value=r,(0,_e.DX)(this.value)?this._use12Hours&&(0,_e.DX)(this.hours)&&(this.selected12Hours=this.hours>=12?"PM":"AM"):this._clear()),this}initValue(){(0,_e.kK)(this.value)&&this.setValue(new Date,this._use12Hours)}clear(){this._clear(),this.update()}get isEmpty(){return!((0,_e.DX)(this.hours)||(0,_e.DX)(this.minutes)||(0,_e.DX)(this.seconds))}_clear(){this._value=void 0,this.selected12Hours=void 0}update(){this.isEmpty?this._value=void 0:((0,_e.DX)(this.hours)&&this.value.setHours(this.hours),(0,_e.DX)(this.minutes)&&this.value.setMinutes(this.minutes),(0,_e.DX)(this.seconds)&&this.value.setSeconds(this.seconds),this._use12Hours&&("PM"===this.selected12Hours&&this.hours<12&&this.value.setHours(this.hours+12),"AM"===this.selected12Hours&&this.hours>=12&&this.value.setHours(this.hours-12))),this.changed()}changed(){this._changes.next(this.value)}get viewHours(){return this._use12Hours&&(0,_e.DX)(this.hours)?this.calculateViewHour(this.hours):this.hours}setSelected12Hours(r){r.toUpperCase()!==this.selected12Hours&&(this.selected12Hours=r.toUpperCase(),this.update())}get value(){return this._value||this._defaultOpenValue}get hours(){var r;return null===(r=this.value)||void 0===r?void 0:r.getHours()}get minutes(){var r;return null===(r=this.value)||void 0===r?void 0:r.getMinutes()}get seconds(){var r;return null===(r=this.value)||void 0===r?void 0:r.getSeconds()}setDefaultOpenValue(r){return this._defaultOpenValue=r,this}calculateViewHour(r){const e=this.selected12Hours;return"PM"===e&&r>12?r-12:"AM"===e&&0===r?12:r}}function zo(t,r=1,e=0){return new Array(Math.ceil(t/r)).fill(0).map((i,a)=>(a+e)*r)}let qh=(()=>{class t{constructor(e,i,a,o){this.ngZone=e,this.cdr=i,this.dateHelper=a,this.elementRef=o,this._nzHourStep=1,this._nzMinuteStep=1,this._nzSecondStep=1,this.unsubscribe$=new rt.x,this._format="HH:mm:ss",this._disabledHours=()=>[],this._disabledMinutes=()=>[],this._disabledSeconds=()=>[],this._allowEmpty=!0,this.time=new Qh,this.hourEnabled=!0,this.minuteEnabled=!0,this.secondEnabled=!0,this.firstScrolled=!1,this.enabledColumns=3,this.nzInDatePicker=!1,this.nzHideDisabledOptions=!1,this.nzUse12Hours=!1,this.closePanel=new n.vpe}set nzAllowEmpty(e){(0,_e.DX)(e)&&(this._allowEmpty=e)}get nzAllowEmpty(){return this._allowEmpty}set nzDisabledHours(e){this._disabledHours=e,this._disabledHours&&this.buildHours()}get nzDisabledHours(){return this._disabledHours}set nzDisabledMinutes(e){(0,_e.DX)(e)&&(this._disabledMinutes=e,this.buildMinutes())}get nzDisabledMinutes(){return this._disabledMinutes}set nzDisabledSeconds(e){(0,_e.DX)(e)&&(this._disabledSeconds=e,this.buildSeconds())}get nzDisabledSeconds(){return this._disabledSeconds}set format(e){if((0,_e.DX)(e)){this._format=e,this.enabledColumns=0;const i=new Set(e);this.hourEnabled=i.has("H")||i.has("h"),this.minuteEnabled=i.has("m"),this.secondEnabled=i.has("s"),this.hourEnabled&&this.enabledColumns++,this.minuteEnabled&&this.enabledColumns++,this.secondEnabled&&this.enabledColumns++,this.nzUse12Hours&&this.build12Hours()}}get format(){return this._format}set nzHourStep(e){(0,_e.DX)(e)&&(this._nzHourStep=e,this.buildHours())}get nzHourStep(){return this._nzHourStep}set nzMinuteStep(e){(0,_e.DX)(e)&&(this._nzMinuteStep=e,this.buildMinutes())}get nzMinuteStep(){return this._nzMinuteStep}set nzSecondStep(e){(0,_e.DX)(e)&&(this._nzSecondStep=e,this.buildSeconds())}get nzSecondStep(){return this._nzSecondStep}trackByFn(e){return e}buildHours(){var e;let i=24,a=null===(e=this.nzDisabledHours)||void 0===e?void 0:e.call(this),o=0;if(this.nzUse12Hours&&(i=12,a&&(a="PM"===this.time.selected12Hours?a.filter(s=>s>=12).map(s=>s>12?s-12:s):a.filter(s=>s<12||24===s).map(s=>24===s||0===s?12:s)),o=1),this.hourRange=zo(i,this.nzHourStep,o).map(s=>({index:s,disabled:!!a&&-1!==a.indexOf(s)})),this.nzUse12Hours&&12===this.hourRange[this.hourRange.length-1].index){const s=[...this.hourRange];s.unshift(s[s.length-1]),s.splice(s.length-1,1),this.hourRange=s}}buildMinutes(){this.minuteRange=zo(60,this.nzMinuteStep).map(e=>({index:e,disabled:!!this.nzDisabledMinutes&&-1!==this.nzDisabledMinutes(this.time.hours).indexOf(e)}))}buildSeconds(){this.secondRange=zo(60,this.nzSecondStep).map(e=>({index:e,disabled:!!this.nzDisabledSeconds&&-1!==this.nzDisabledSeconds(this.time.hours,this.time.minutes).indexOf(e)}))}build12Hours(){const e=this._format.includes("A");this.use12HoursRange=[{index:0,value:e?"AM":"am"},{index:1,value:e?"PM":"pm"}]}buildTimes(){this.buildHours(),this.buildMinutes(),this.buildSeconds(),this.build12Hours()}scrollToTime(e=0){this.hourEnabled&&this.hourListElement&&this.scrollToSelected(this.hourListElement.nativeElement,this.time.viewHours,e,"hour"),this.minuteEnabled&&this.minuteListElement&&this.scrollToSelected(this.minuteListElement.nativeElement,this.time.minutes,e,"minute"),this.secondEnabled&&this.secondListElement&&this.scrollToSelected(this.secondListElement.nativeElement,this.time.seconds,e,"second"),this.nzUse12Hours&&this.use12HoursListElement&&this.scrollToSelected(this.use12HoursListElement.nativeElement,"AM"===this.time.selected12Hours?0:1,e,"12-hour")}selectHour(e){this.time.setHours(e.index,e.disabled),this._disabledMinutes&&this.buildMinutes(),(this._disabledSeconds||this._disabledMinutes)&&this.buildSeconds()}selectMinute(e){this.time.setMinutes(e.index,e.disabled),this._disabledSeconds&&this.buildSeconds()}selectSecond(e){this.time.setSeconds(e.index,e.disabled)}select12Hours(e){this.time.setSelected12Hours(e.value),this._disabledHours&&this.buildHours(),this._disabledMinutes&&this.buildMinutes(),this._disabledSeconds&&this.buildSeconds()}scrollToSelected(e,i,a=0,o){if(!e)return;const s=this.translateIndex(i,o);this.scrollTo(e,(e.children[s]||e.children[0]).offsetTop,a)}translateIndex(e,i){var a,o,s;return"hour"===i?this.calcIndex(null===(a=this.nzDisabledHours)||void 0===a?void 0:a.call(this),this.hourRange.map(l=>l.index).indexOf(e)):"minute"===i?this.calcIndex(null===(o=this.nzDisabledMinutes)||void 0===o?void 0:o.call(this,this.time.hours),this.minuteRange.map(l=>l.index).indexOf(e)):"second"===i?this.calcIndex(null===(s=this.nzDisabledSeconds)||void 0===s?void 0:s.call(this,this.time.hours,this.time.minutes),this.secondRange.map(l=>l.index).indexOf(e)):this.calcIndex([],this.use12HoursRange.map(l=>l.index).indexOf(e))}scrollTo(e,i,a){if(a<=0)return void(e.scrollTop=i);const s=(i-e.scrollTop)/a*10;this.ngZone.runOutsideAngular(()=>{Oh(()=>{e.scrollTop=e.scrollTop+s,e.scrollTop!==i&&this.scrollTo(e,i,a-10)})})}calcIndex(e,i){return(null==e?void 0:e.length)&&this.nzHideDisabledOptions?i-e.reduce((a,o)=>a+(o<i?1:0),0):i}changed(){this.onChange&&this.onChange(this.time.value)}touched(){this.onTouch&&this.onTouch()}timeDisabled(e){var i,a,o,s,l,c;const u=e.getHours(),d=e.getMinutes(),f=e.getSeconds();return(null!==(a=null===(i=this.nzDisabledHours)||void 0===i?void 0:i.call(this).indexOf(u))&&void 0!==a?a:-1)>-1||(null!==(s=null===(o=this.nzDisabledMinutes)||void 0===o?void 0:o.call(this,u).indexOf(d))&&void 0!==s?s:-1)>-1||(null!==(c=null===(l=this.nzDisabledSeconds)||void 0===l?void 0:l.call(this,u,d).indexOf(f))&&void 0!==c?c:-1)>-1}onClickNow(){const e=new Date;this.timeDisabled(e)||(this.time.setValue(e),this.changed(),this.closePanel.emit())}onClickOk(){this.time.setValue(this.time.value,this.nzUse12Hours),this.changed(),this.closePanel.emit()}isSelectedHour(e){return e.index===this.time.viewHours}isSelectedMinute(e){return e.index===this.time.minutes}isSelectedSecond(e){return e.index===this.time.seconds}isSelected12Hours(e){return e.value.toUpperCase()===this.time.selected12Hours}ngOnInit(){this.time.changes.pipe((0,Re.R)(this.unsubscribe$)).subscribe(()=>{this.changed(),this.touched(),this.scrollToTime(120)}),this.buildTimes(),this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.scrollToTime(),this.firstScrolled=!0}),(0,fr.R)(this.elementRef.nativeElement,"mousedown").pipe((0,Re.R)(this.unsubscribe$)).subscribe(e=>{e.preventDefault()})})}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}ngOnChanges(e){const{nzUse12Hours:i,nzDefaultOpenValue:a}=e;!(null==i?void 0:i.previousValue)&&(null==i?void 0:i.currentValue)&&(this.build12Hours(),this.enabledColumns++),(null==a?void 0:a.currentValue)&&this.time.setDefaultOpenValue(this.nzDefaultOpenValue||new Date)}writeValue(e){this.time.setValue(e,this.nzUse12Hours),this.buildTimes(),e&&this.firstScrolled&&this.scrollToTime(120),this.cdr.markForCheck()}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouch=e}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(n.R0b),n.Y36(n.sBO),n.Y36(ct.mx),n.Y36(n.SBq))},t.\u0275cmp=n.Xpm({type:t,selectors:[["nz-time-picker-panel"]],viewQuery:function(e,i){if(1&e&&(n.Gf(Eh,5),n.Gf(Fh,5),n.Gf(Dh,5),n.Gf(Ah,5)),2&e){let a;n.iGM(a=n.CRH())&&(i.hourListElement=a.first),n.iGM(a=n.CRH())&&(i.minuteListElement=a.first),n.iGM(a=n.CRH())&&(i.secondListElement=a.first),n.iGM(a=n.CRH())&&(i.use12HoursListElement=a.first)}},hostAttrs:[1,"ant-picker-time-panel"],hostVars:12,hostBindings:function(e,i){2&e&&n.ekj("ant-picker-time-panel-column-0",0===i.enabledColumns&&!i.nzInDatePicker)("ant-picker-time-panel-column-1",1===i.enabledColumns&&!i.nzInDatePicker)("ant-picker-time-panel-column-2",2===i.enabledColumns&&!i.nzInDatePicker)("ant-picker-time-panel-column-3",3===i.enabledColumns&&!i.nzInDatePicker)("ant-picker-time-panel-narrow",i.enabledColumns<3)("ant-picker-time-panel-placement-bottomLeft",!i.nzInDatePicker)},inputs:{nzInDatePicker:"nzInDatePicker",nzAddOn:"nzAddOn",nzHideDisabledOptions:"nzHideDisabledOptions",nzClearText:"nzClearText",nzNowText:"nzNowText",nzOkText:"nzOkText",nzPlaceHolder:"nzPlaceHolder",nzUse12Hours:"nzUse12Hours",nzDefaultOpenValue:"nzDefaultOpenValue",nzAllowEmpty:"nzAllowEmpty",nzDisabledHours:"nzDisabledHours",nzDisabledMinutes:"nzDisabledMinutes",nzDisabledSeconds:"nzDisabledSeconds",format:"format",nzHourStep:"nzHourStep",nzMinuteStep:"nzMinuteStep",nzSecondStep:"nzSecondStep"},outputs:{closePanel:"closePanel"},exportAs:["nzTimePickerPanel"],features:[n._Bn([{provide:ve.JU,useExisting:t,multi:!0}]),n.TTD],decls:7,vars:6,consts:[["class","ant-picker-header",4,"ngIf"],[1,"ant-picker-content"],["class","ant-picker-time-panel-column","style","position: relative;",4,"ngIf"],["class","ant-picker-footer",4,"ngIf"],[1,"ant-picker-header"],[1,"ant-picker-header-view"],[1,"ant-picker-time-panel-column",2,"position","relative"],["hourListElement",""],[4,"ngFor","ngForOf","ngForTrackBy"],["class","ant-picker-time-panel-cell",3,"ant-picker-time-panel-cell-selected","ant-picker-time-panel-cell-disabled","click",4,"ngIf"],[1,"ant-picker-time-panel-cell",3,"click"],[1,"ant-picker-time-panel-cell-inner"],["minuteListElement",""],["secondListElement",""],["use12HoursListElement",""],[4,"ngFor","ngForOf"],["class","ant-picker-time-panel-cell",3,"ant-picker-time-panel-cell-selected","click",4,"ngIf"],[1,"ant-picker-footer"],["class","ant-picker-footer-extra",4,"ngIf"],[1,"ant-picker-ranges"],[1,"ant-picker-now"],[3,"click"],[1,"ant-picker-ok"],["nz-button","","type","button","nzSize","small","nzType","primary",3,"click"],[1,"ant-picker-footer-extra"],[3,"ngTemplateOutlet"]],template:function(e,i){1&e&&(n.YNc(0,Nh,3,1,"div",0),n.TgZ(1,"div",1),n.YNc(2,Ph,3,2,"ul",2),n.YNc(3,Uh,3,2,"ul",2),n.YNc(4,Zh,3,2,"ul",2),n.YNc(5,Wh,3,1,"ul",2),n.qZA(),n.YNc(6,Jh,11,7,"div",3)),2&e&&(n.Q6J("ngIf",i.nzInDatePicker),n.xp6(2),n.Q6J("ngIf",i.hourEnabled),n.xp6(1),n.Q6J("ngIf",i.minuteEnabled),n.xp6(1),n.Q6J("ngIf",i.secondEnabled),n.xp6(1),n.Q6J("ngIf",i.nzUse12Hours),n.xp6(1),n.Q6J("ngIf",!i.nzInDatePicker))},directives:[It.ix,K.O5,K.sg,K.tP,Mr.dQ,Mn.w],pipes:[K.JJ,ct.o9],encapsulation:2,changeDetection:0}),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzUse12Hours",void 0),t})(),Fl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[be.vT,K.ez,ve.u5,ct.YI,Bt.U8,Pt.PV,bt.e4,Ee.T,It.sL]]}),t})();var et=oe(315),Xh=oe(4707),Kh=oe(3191);let em=(()=>{class t{create(e){return"undefined"==typeof ResizeObserver?null:new ResizeObserver(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),tm=(()=>{class t{constructor(e){this.nzResizeObserverFactory=e,this.observedElements=new Map}ngOnDestroy(){this.observedElements.forEach((e,i)=>this.cleanupObserver(i))}observe(e){const i=(0,Kh.fI)(e);return new Nt.y(a=>{const s=this.observeElement(i).subscribe(a);return()=>{s.unsubscribe(),this.unobserveElement(i)}})}observeElement(e){if(this.observedElements.has(e))this.observedElements.get(e).count++;else{const i=new rt.x,a=this.nzResizeObserverFactory.create(o=>i.next(o));a&&a.observe(e),this.observedElements.set(e,{observer:a,stream:i,count:1})}return this.observedElements.get(e).stream}unobserveElement(e){this.observedElements.has(e)&&(this.observedElements.get(e).count--,this.observedElements.get(e).count||this.cleanupObserver(e))}cleanupObserver(e){if(this.observedElements.has(e)){const{observer:i,stream:a}=this.observedElements.get(e);i&&i.disconnect(),a.complete(),this.observedElements.delete(e)}}}return t.\u0275fac=function(e){return new(e||t)(n.LFG(em))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function nm(t,r){1&t&&n.GkF(0)}function rm(t,r){if(1&t&&(n.ynx(0),n.YNc(1,nm,1,0,"ng-container",4),n.BQk()),2&t){const e=n.oxw(2);n.xp6(1),n.Q6J("ngTemplateOutlet",e.extraFooter)}}function im(t,r){if(1&t&&(n.ynx(0),n._UZ(1,"span",5),n.BQk()),2&t){const e=n.oxw(2);n.xp6(1),n.Q6J("innerHTML",e.extraFooter,n.oJD)}}function am(t,r){if(1&t&&(n.TgZ(0,"div"),n.ynx(1,2),n.YNc(2,rm,2,1,"ng-container",3),n.YNc(3,im,2,1,"ng-container",3),n.BQk(),n.qZA()),2&t){const e=n.oxw();n.Gre("",e.prefixCls,"-footer-extra"),n.xp6(1),n.Q6J("ngSwitch",!0),n.xp6(1),n.Q6J("ngSwitchCase",e.isTemplateRef(e.extraFooter)),n.xp6(1),n.Q6J("ngSwitchCase",e.isNonEmptyString(e.extraFooter))}}function om(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"a",6),n.NdJ("click",function(){n.CHM(e);const a=n.oxw();return a.isTodayDisabled?null:a.onClickToday()}),n._uU(1),n.qZA()}if(2&t){const e=n.oxw();n.MT6("",e.prefixCls,"-today-btn ",e.isTodayDisabled?e.prefixCls+"-today-btn-disabled":"",""),n.s9C("title",e.todayTitle),n.xp6(1),n.hij(" ",e.locale.today," ")}}function sm(t,r){1&t&&n.GkF(0)}function lm(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li")(1,"a",7),n.NdJ("click",function(){n.CHM(e);const a=n.oxw(2);return a.isTodayDisabled?null:a.onClickToday()}),n._uU(2),n.qZA()()}if(2&t){const e=n.oxw(2);n.Gre("",e.prefixCls,"-now"),n.xp6(1),n.Gre("",e.prefixCls,"-now-btn"),n.xp6(1),n.hij(" ",e.locale.now," ")}}function cm(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li")(1,"button",8),n.NdJ("click",function(){n.CHM(e);const a=n.oxw(2);return a.okDisabled?null:a.clickOk.emit()}),n._uU(2),n.qZA()()}if(2&t){const e=n.oxw(2);n.Gre("",e.prefixCls,"-ok"),n.xp6(1),n.Q6J("disabled",e.okDisabled),n.xp6(1),n.hij(" ",e.locale.ok," ")}}function um(t,r){if(1&t&&(n.TgZ(0,"ul"),n.YNc(1,sm,1,0,"ng-container",4),n.YNc(2,lm,3,7,"li",0),n.YNc(3,cm,3,5,"li",0),n.qZA()),2&t){const e=n.oxw();n.Gre("",e.prefixCls,"-ranges"),n.xp6(1),n.Q6J("ngTemplateOutlet",e.rangeQuickSelector),n.xp6(1),n.Q6J("ngIf",e.showNow),n.xp6(1),n.Q6J("ngIf",e.hasTimePicker)}}function dm(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"button",6),n.NdJ("click",function(){return n.CHM(e).$implicit.onClick()}),n._uU(2),n.qZA(),n.BQk()}if(2&t){const e=r.$implicit;n.xp6(1),n.Tol(e.className),n.s9C("title",e.title||null),n.xp6(1),n.hij(" ",e.label," ")}}function fm(t,r){1&t&&n._UZ(0,"th",6)}function pm(t,r){if(1&t&&(n.TgZ(0,"th",7),n._uU(1),n.qZA()),2&t){const e=r.$implicit;n.s9C("title",e.title),n.xp6(1),n.hij(" ",e.content," ")}}function hm(t,r){if(1&t&&(n.TgZ(0,"thead")(1,"tr",3),n.YNc(2,fm,1,0,"th",4),n.YNc(3,pm,2,2,"th",5),n.qZA()()),2&t){const e=n.oxw();n.xp6(2),n.Q6J("ngIf",e.showWeek),n.xp6(1),n.Q6J("ngForOf",e.headRow)}}function mm(t,r){if(1&t&&(n.TgZ(0,"td",11),n._uU(1),n.qZA()),2&t){const e=n.oxw().$implicit,i=n.oxw();n.Gre("",i.prefixCls,"-cell-week"),n.xp6(1),n.hij(" ",e.weekNum," ")}}function gm(t,r){1&t&&n.GkF(0)}const xn=function(t){return{$implicit:t}};function _m(t,r){if(1&t&&(n.ynx(0),n.YNc(1,gm,1,0,"ng-container",16),n.BQk()),2&t){const e=n.oxw(2).$implicit;n.xp6(1),n.Q6J("ngTemplateOutlet",e.cellRender)("ngTemplateOutletContext",n.VKq(2,xn,e.value))}}function xm(t,r){if(1&t&&(n.ynx(0),n._UZ(1,"span",17),n.BQk()),2&t){const e=n.oxw(2).$implicit;n.xp6(1),n.Q6J("innerHTML",e.cellRender,n.oJD)}}function vm(t,r){if(1&t&&(n.ynx(0),n.TgZ(1,"div"),n._uU(2),n.qZA(),n.BQk()),2&t){const e=n.oxw(2).$implicit,i=n.oxw(2);n.xp6(1),n.Gre("",i.prefixCls,"-cell-inner"),n.uIk("aria-selected",e.isSelected)("aria-disabled",e.isDisabled),n.xp6(1),n.hij(" ",e.content," ")}}function Cm(t,r){if(1&t&&(n.ynx(0)(1,13),n.YNc(2,_m,2,4,"ng-container",14),n.YNc(3,xm,2,1,"ng-container",14),n.YNc(4,vm,3,6,"ng-container",15),n.BQk()()),2&t){const e=n.oxw().$implicit,i=n.oxw(2);n.xp6(1),n.Q6J("ngSwitch",!0),n.xp6(1),n.Q6J("ngSwitchCase",i.isTemplateRef(e.cellRender)),n.xp6(1),n.Q6J("ngSwitchCase",i.isNonEmptyString(e.cellRender))}}function ym(t,r){1&t&&n.GkF(0)}function wm(t,r){if(1&t&&(n.ynx(0),n.YNc(1,ym,1,0,"ng-container",16),n.BQk()),2&t){const e=n.oxw(2).$implicit;n.xp6(1),n.Q6J("ngTemplateOutlet",e.fullCellRender)("ngTemplateOutletContext",n.VKq(2,xn,e.value))}}function Tm(t,r){1&t&&n.GkF(0)}function km(t,r){if(1&t&&(n.TgZ(0,"div"),n._uU(1),n.qZA(),n.TgZ(2,"div"),n.YNc(3,Tm,1,0,"ng-container",16),n.qZA()),2&t){const e=n.oxw(2).$implicit,i=n.oxw(2);n.Gre("",i.prefixCls,"-date-value"),n.xp6(1),n.Oqu(e.content),n.xp6(1),n.Gre("",i.prefixCls,"-date-content"),n.xp6(1),n.Q6J("ngTemplateOutlet",e.cellRender)("ngTemplateOutletContext",n.VKq(9,xn,e.value))}}function Sm(t,r){if(1&t&&(n.ynx(0),n.TgZ(1,"div"),n.YNc(2,wm,2,4,"ng-container",18),n.YNc(3,km,4,11,"ng-template",null,19,n.W1O),n.qZA(),n.BQk()),2&t){const e=n.MAs(4),i=n.oxw().$implicit,a=n.oxw(2);n.xp6(1),n.Gre("",a.prefixCls,"-date ant-picker-cell-inner"),n.ekj("ant-picker-calendar-date-today",i.isToday),n.xp6(1),n.Q6J("ngIf",i.fullCellRender)("ngIfElse",e)}}function bm(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"td",12),n.NdJ("click",function(){const o=n.CHM(e).$implicit;return o.isDisabled?null:o.onClick()})("mouseenter",function(){return n.CHM(e).$implicit.onMouseEnter()}),n.ynx(1,13),n.YNc(2,Cm,5,3,"ng-container",14),n.YNc(3,Sm,5,7,"ng-container",14),n.BQk(),n.qZA()}if(2&t){const e=r.$implicit,i=n.oxw(2);n.s9C("title",e.title),n.Q6J("ngClass",e.classMap),n.xp6(1),n.Q6J("ngSwitch",i.prefixCls),n.xp6(1),n.Q6J("ngSwitchCase","ant-picker"),n.xp6(1),n.Q6J("ngSwitchCase","ant-picker-calendar")}}function zm(t,r){if(1&t&&(n.TgZ(0,"tr",8),n.YNc(1,mm,2,4,"td",9),n.YNc(2,bm,4,5,"td",10),n.qZA()),2&t){const e=r.$implicit,i=n.oxw();n.Q6J("ngClass",e.classMap),n.xp6(1),n.Q6J("ngIf",e.weekNum),n.xp6(1),n.Q6J("ngForOf",e.dateCells)("ngForTrackBy",i.trackByBodyColumn)}}function Im(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"button",6),n.NdJ("click",function(){return n.CHM(e).$implicit.onClick()}),n._uU(2),n.qZA(),n.BQk()}if(2&t){const e=r.$implicit;n.xp6(1),n.Tol(e.className),n.s9C("title",e.title||null),n.xp6(1),n.hij(" ",e.label," ")}}function Om(t,r){1&t&&n._UZ(0,"th",6)}function Em(t,r){if(1&t&&(n.TgZ(0,"th",7),n._uU(1),n.qZA()),2&t){const e=r.$implicit;n.s9C("title",e.title),n.xp6(1),n.hij(" ",e.content," ")}}function Fm(t,r){if(1&t&&(n.TgZ(0,"thead")(1,"tr",3),n.YNc(2,Om,1,0,"th",4),n.YNc(3,Em,2,2,"th",5),n.qZA()()),2&t){const e=n.oxw();n.xp6(2),n.Q6J("ngIf",e.showWeek),n.xp6(1),n.Q6J("ngForOf",e.headRow)}}function Dm(t,r){if(1&t&&(n.TgZ(0,"td",11),n._uU(1),n.qZA()),2&t){const e=n.oxw().$implicit,i=n.oxw();n.Gre("",i.prefixCls,"-cell-week"),n.xp6(1),n.hij(" ",e.weekNum," ")}}function Am(t,r){1&t&&n.GkF(0)}function Nm(t,r){if(1&t&&(n.ynx(0),n.YNc(1,Am,1,0,"ng-container",16),n.BQk()),2&t){const e=n.oxw(2).$implicit;n.xp6(1),n.Q6J("ngTemplateOutlet",e.cellRender)("ngTemplateOutletContext",n.VKq(2,xn,e.value))}}function Mm(t,r){if(1&t&&(n.ynx(0),n._UZ(1,"span",17),n.BQk()),2&t){const e=n.oxw(2).$implicit;n.xp6(1),n.Q6J("innerHTML",e.cellRender,n.oJD)}}function Rm(t,r){if(1&t&&(n.ynx(0),n.TgZ(1,"div"),n._uU(2),n.qZA(),n.BQk()),2&t){const e=n.oxw(2).$implicit,i=n.oxw(2);n.xp6(1),n.Gre("",i.prefixCls,"-cell-inner"),n.uIk("aria-selected",e.isSelected)("aria-disabled",e.isDisabled),n.xp6(1),n.hij(" ",e.content," ")}}function Pm(t,r){if(1&t&&(n.ynx(0)(1,13),n.YNc(2,Nm,2,4,"ng-container",14),n.YNc(3,Mm,2,1,"ng-container",14),n.YNc(4,Rm,3,6,"ng-container",15),n.BQk()()),2&t){const e=n.oxw().$implicit,i=n.oxw(2);n.xp6(1),n.Q6J("ngSwitch",!0),n.xp6(1),n.Q6J("ngSwitchCase",i.isTemplateRef(e.cellRender)),n.xp6(1),n.Q6J("ngSwitchCase",i.isNonEmptyString(e.cellRender))}}function Bm(t,r){1&t&&n.GkF(0)}function Lm(t,r){if(1&t&&(n.ynx(0),n.YNc(1,Bm,1,0,"ng-container",16),n.BQk()),2&t){const e=n.oxw(2).$implicit;n.xp6(1),n.Q6J("ngTemplateOutlet",e.fullCellRender)("ngTemplateOutletContext",n.VKq(2,xn,e.value))}}function Um(t,r){1&t&&n.GkF(0)}function Hm(t,r){if(1&t&&(n.TgZ(0,"div"),n._uU(1),n.qZA(),n.TgZ(2,"div"),n.YNc(3,Um,1,0,"ng-container",16),n.qZA()),2&t){const e=n.oxw(2).$implicit,i=n.oxw(2);n.Gre("",i.prefixCls,"-date-value"),n.xp6(1),n.Oqu(e.content),n.xp6(1),n.Gre("",i.prefixCls,"-date-content"),n.xp6(1),n.Q6J("ngTemplateOutlet",e.cellRender)("ngTemplateOutletContext",n.VKq(9,xn,e.value))}}function Vm(t,r){if(1&t&&(n.ynx(0),n.TgZ(1,"div"),n.YNc(2,Lm,2,4,"ng-container",18),n.YNc(3,Hm,4,11,"ng-template",null,19,n.W1O),n.qZA(),n.BQk()),2&t){const e=n.MAs(4),i=n.oxw().$implicit,a=n.oxw(2);n.xp6(1),n.Gre("",a.prefixCls,"-date ant-picker-cell-inner"),n.ekj("ant-picker-calendar-date-today",i.isToday),n.xp6(1),n.Q6J("ngIf",i.fullCellRender)("ngIfElse",e)}}function Zm(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"td",12),n.NdJ("click",function(){const o=n.CHM(e).$implicit;return o.isDisabled?null:o.onClick()})("mouseenter",function(){return n.CHM(e).$implicit.onMouseEnter()}),n.ynx(1,13),n.YNc(2,Pm,5,3,"ng-container",14),n.YNc(3,Vm,5,7,"ng-container",14),n.BQk(),n.qZA()}if(2&t){const e=r.$implicit,i=n.oxw(2);n.s9C("title",e.title),n.Q6J("ngClass",e.classMap),n.xp6(1),n.Q6J("ngSwitch",i.prefixCls),n.xp6(1),n.Q6J("ngSwitchCase","ant-picker"),n.xp6(1),n.Q6J("ngSwitchCase","ant-picker-calendar")}}function jm(t,r){if(1&t&&(n.TgZ(0,"tr",8),n.YNc(1,Dm,2,4,"td",9),n.YNc(2,Zm,4,5,"td",10),n.qZA()),2&t){const e=r.$implicit,i=n.oxw();n.Q6J("ngClass",e.classMap),n.xp6(1),n.Q6J("ngIf",e.weekNum),n.xp6(1),n.Q6J("ngForOf",e.dateCells)("ngForTrackBy",i.trackByBodyColumn)}}function Gm(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"button",6),n.NdJ("click",function(){return n.CHM(e).$implicit.onClick()}),n._uU(2),n.qZA(),n.BQk()}if(2&t){const e=r.$implicit;n.xp6(1),n.Tol(e.className),n.s9C("title",e.title||null),n.xp6(1),n.hij(" ",e.label," ")}}function Wm(t,r){1&t&&n._UZ(0,"th",6)}function Ym(t,r){if(1&t&&(n.TgZ(0,"th",7),n._uU(1),n.qZA()),2&t){const e=r.$implicit;n.s9C("title",e.title),n.xp6(1),n.hij(" ",e.content," ")}}function $m(t,r){if(1&t&&(n.TgZ(0,"thead")(1,"tr",3),n.YNc(2,Wm,1,0,"th",4),n.YNc(3,Ym,2,2,"th",5),n.qZA()()),2&t){const e=n.oxw();n.xp6(2),n.Q6J("ngIf",e.showWeek),n.xp6(1),n.Q6J("ngForOf",e.headRow)}}function Jm(t,r){if(1&t&&(n.TgZ(0,"td",11),n._uU(1),n.qZA()),2&t){const e=n.oxw().$implicit,i=n.oxw();n.Gre("",i.prefixCls,"-cell-week"),n.xp6(1),n.hij(" ",e.weekNum," ")}}function Qm(t,r){1&t&&n.GkF(0)}function qm(t,r){if(1&t&&(n.ynx(0),n.YNc(1,Qm,1,0,"ng-container",16),n.BQk()),2&t){const e=n.oxw(2).$implicit;n.xp6(1),n.Q6J("ngTemplateOutlet",e.cellRender)("ngTemplateOutletContext",n.VKq(2,xn,e.value))}}function Xm(t,r){if(1&t&&(n.ynx(0),n._UZ(1,"span",17),n.BQk()),2&t){const e=n.oxw(2).$implicit;n.xp6(1),n.Q6J("innerHTML",e.cellRender,n.oJD)}}function Km(t,r){if(1&t&&(n.ynx(0),n.TgZ(1,"div"),n._uU(2),n.qZA(),n.BQk()),2&t){const e=n.oxw(2).$implicit,i=n.oxw(2);n.xp6(1),n.Gre("",i.prefixCls,"-cell-inner"),n.uIk("aria-selected",e.isSelected)("aria-disabled",e.isDisabled),n.xp6(1),n.hij(" ",e.content," ")}}function eg(t,r){if(1&t&&(n.ynx(0)(1,13),n.YNc(2,qm,2,4,"ng-container",14),n.YNc(3,Xm,2,1,"ng-container",14),n.YNc(4,Km,3,6,"ng-container",15),n.BQk()()),2&t){const e=n.oxw().$implicit,i=n.oxw(2);n.xp6(1),n.Q6J("ngSwitch",!0),n.xp6(1),n.Q6J("ngSwitchCase",i.isTemplateRef(e.cellRender)),n.xp6(1),n.Q6J("ngSwitchCase",i.isNonEmptyString(e.cellRender))}}function tg(t,r){1&t&&n.GkF(0)}function ng(t,r){if(1&t&&(n.ynx(0),n.YNc(1,tg,1,0,"ng-container",16),n.BQk()),2&t){const e=n.oxw(2).$implicit;n.xp6(1),n.Q6J("ngTemplateOutlet",e.fullCellRender)("ngTemplateOutletContext",n.VKq(2,xn,e.value))}}function rg(t,r){1&t&&n.GkF(0)}function ig(t,r){if(1&t&&(n.TgZ(0,"div"),n._uU(1),n.qZA(),n.TgZ(2,"div"),n.YNc(3,rg,1,0,"ng-container",16),n.qZA()),2&t){const e=n.oxw(2).$implicit,i=n.oxw(2);n.Gre("",i.prefixCls,"-date-value"),n.xp6(1),n.Oqu(e.content),n.xp6(1),n.Gre("",i.prefixCls,"-date-content"),n.xp6(1),n.Q6J("ngTemplateOutlet",e.cellRender)("ngTemplateOutletContext",n.VKq(9,xn,e.value))}}function ag(t,r){if(1&t&&(n.ynx(0),n.TgZ(1,"div"),n.YNc(2,ng,2,4,"ng-container",18),n.YNc(3,ig,4,11,"ng-template",null,19,n.W1O),n.qZA(),n.BQk()),2&t){const e=n.MAs(4),i=n.oxw().$implicit,a=n.oxw(2);n.xp6(1),n.Gre("",a.prefixCls,"-date ant-picker-cell-inner"),n.ekj("ant-picker-calendar-date-today",i.isToday),n.xp6(1),n.Q6J("ngIf",i.fullCellRender)("ngIfElse",e)}}function og(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"td",12),n.NdJ("click",function(){const o=n.CHM(e).$implicit;return o.isDisabled?null:o.onClick()})("mouseenter",function(){return n.CHM(e).$implicit.onMouseEnter()}),n.ynx(1,13),n.YNc(2,eg,5,3,"ng-container",14),n.YNc(3,ag,5,7,"ng-container",14),n.BQk(),n.qZA()}if(2&t){const e=r.$implicit,i=n.oxw(2);n.s9C("title",e.title),n.Q6J("ngClass",e.classMap),n.xp6(1),n.Q6J("ngSwitch",i.prefixCls),n.xp6(1),n.Q6J("ngSwitchCase","ant-picker"),n.xp6(1),n.Q6J("ngSwitchCase","ant-picker-calendar")}}function sg(t,r){if(1&t&&(n.TgZ(0,"tr",8),n.YNc(1,Jm,2,4,"td",9),n.YNc(2,og,4,5,"td",10),n.qZA()),2&t){const e=r.$implicit,i=n.oxw();n.Q6J("ngClass",e.classMap),n.xp6(1),n.Q6J("ngIf",e.weekNum),n.xp6(1),n.Q6J("ngForOf",e.dateCells)("ngForTrackBy",i.trackByBodyColumn)}}function lg(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"button",6),n.NdJ("click",function(){return n.CHM(e).$implicit.onClick()}),n._uU(2),n.qZA(),n.BQk()}if(2&t){const e=r.$implicit;n.xp6(1),n.Tol(e.className),n.s9C("title",e.title||null),n.xp6(1),n.hij(" ",e.label," ")}}function cg(t,r){1&t&&n._UZ(0,"th",6)}function ug(t,r){if(1&t&&(n.TgZ(0,"th",7),n._uU(1),n.qZA()),2&t){const e=r.$implicit;n.s9C("title",e.title),n.xp6(1),n.hij(" ",e.content," ")}}function dg(t,r){if(1&t&&(n.TgZ(0,"thead")(1,"tr",3),n.YNc(2,cg,1,0,"th",4),n.YNc(3,ug,2,2,"th",5),n.qZA()()),2&t){const e=n.oxw();n.xp6(2),n.Q6J("ngIf",e.showWeek),n.xp6(1),n.Q6J("ngForOf",e.headRow)}}function fg(t,r){if(1&t&&(n.TgZ(0,"td",11),n._uU(1),n.qZA()),2&t){const e=n.oxw().$implicit,i=n.oxw();n.Gre("",i.prefixCls,"-cell-week"),n.xp6(1),n.hij(" ",e.weekNum," ")}}function pg(t,r){1&t&&n.GkF(0)}function hg(t,r){if(1&t&&(n.ynx(0),n.YNc(1,pg,1,0,"ng-container",16),n.BQk()),2&t){const e=n.oxw(2).$implicit;n.xp6(1),n.Q6J("ngTemplateOutlet",e.cellRender)("ngTemplateOutletContext",n.VKq(2,xn,e.value))}}function mg(t,r){if(1&t&&(n.ynx(0),n._UZ(1,"span",17),n.BQk()),2&t){const e=n.oxw(2).$implicit;n.xp6(1),n.Q6J("innerHTML",e.cellRender,n.oJD)}}function gg(t,r){if(1&t&&(n.ynx(0),n.TgZ(1,"div"),n._uU(2),n.qZA(),n.BQk()),2&t){const e=n.oxw(2).$implicit,i=n.oxw(2);n.xp6(1),n.Gre("",i.prefixCls,"-cell-inner"),n.uIk("aria-selected",e.isSelected)("aria-disabled",e.isDisabled),n.xp6(1),n.hij(" ",e.content," ")}}function _g(t,r){if(1&t&&(n.ynx(0)(1,13),n.YNc(2,hg,2,4,"ng-container",14),n.YNc(3,mg,2,1,"ng-container",14),n.YNc(4,gg,3,6,"ng-container",15),n.BQk()()),2&t){const e=n.oxw().$implicit,i=n.oxw(2);n.xp6(1),n.Q6J("ngSwitch",!0),n.xp6(1),n.Q6J("ngSwitchCase",i.isTemplateRef(e.cellRender)),n.xp6(1),n.Q6J("ngSwitchCase",i.isNonEmptyString(e.cellRender))}}function xg(t,r){1&t&&n.GkF(0)}function vg(t,r){if(1&t&&(n.ynx(0),n.YNc(1,xg,1,0,"ng-container",16),n.BQk()),2&t){const e=n.oxw(2).$implicit;n.xp6(1),n.Q6J("ngTemplateOutlet",e.fullCellRender)("ngTemplateOutletContext",n.VKq(2,xn,e.value))}}function Cg(t,r){1&t&&n.GkF(0)}function yg(t,r){if(1&t&&(n.TgZ(0,"div"),n._uU(1),n.qZA(),n.TgZ(2,"div"),n.YNc(3,Cg,1,0,"ng-container",16),n.qZA()),2&t){const e=n.oxw(2).$implicit,i=n.oxw(2);n.Gre("",i.prefixCls,"-date-value"),n.xp6(1),n.Oqu(e.content),n.xp6(1),n.Gre("",i.prefixCls,"-date-content"),n.xp6(1),n.Q6J("ngTemplateOutlet",e.cellRender)("ngTemplateOutletContext",n.VKq(9,xn,e.value))}}function wg(t,r){if(1&t&&(n.ynx(0),n.TgZ(1,"div"),n.YNc(2,vg,2,4,"ng-container",18),n.YNc(3,yg,4,11,"ng-template",null,19,n.W1O),n.qZA(),n.BQk()),2&t){const e=n.MAs(4),i=n.oxw().$implicit,a=n.oxw(2);n.xp6(1),n.Gre("",a.prefixCls,"-date ant-picker-cell-inner"),n.ekj("ant-picker-calendar-date-today",i.isToday),n.xp6(1),n.Q6J("ngIf",i.fullCellRender)("ngIfElse",e)}}function Tg(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"td",12),n.NdJ("click",function(){const o=n.CHM(e).$implicit;return o.isDisabled?null:o.onClick()})("mouseenter",function(){return n.CHM(e).$implicit.onMouseEnter()}),n.ynx(1,13),n.YNc(2,_g,5,3,"ng-container",14),n.YNc(3,wg,5,7,"ng-container",14),n.BQk(),n.qZA()}if(2&t){const e=r.$implicit,i=n.oxw(2);n.s9C("title",e.title),n.Q6J("ngClass",e.classMap),n.xp6(1),n.Q6J("ngSwitch",i.prefixCls),n.xp6(1),n.Q6J("ngSwitchCase","ant-picker"),n.xp6(1),n.Q6J("ngSwitchCase","ant-picker-calendar")}}function kg(t,r){if(1&t&&(n.TgZ(0,"tr",8),n.YNc(1,fg,2,4,"td",9),n.YNc(2,Tg,4,5,"td",10),n.qZA()),2&t){const e=r.$implicit,i=n.oxw();n.Q6J("ngClass",e.classMap),n.xp6(1),n.Q6J("ngIf",e.weekNum),n.xp6(1),n.Q6J("ngForOf",e.dateCells)("ngForTrackBy",i.trackByBodyColumn)}}function Sg(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"decade-header",4),n.NdJ("valueChange",function(a){return n.CHM(e),n.oxw().activeDate=a})("panelModeChange",function(a){return n.CHM(e),n.oxw().panelModeChange.emit(a)})("valueChange",function(a){return n.CHM(e),n.oxw().headerChange.emit(a)}),n.qZA(),n.TgZ(2,"div")(3,"decade-table",5),n.NdJ("valueChange",function(a){return n.CHM(e),n.oxw().onChooseDecade(a)}),n.qZA()(),n.BQk()}if(2&t){const e=n.oxw();n.xp6(1),n.Q6J("value",e.activeDate)("locale",e.locale)("showSuperPreBtn",e.enablePrevNext("prev","decade"))("showSuperNextBtn",e.enablePrevNext("next","decade"))("showNextBtn",!1)("showPreBtn",!1),n.xp6(1),n.Gre("",e.prefixCls,"-body"),n.xp6(1),n.Q6J("activeDate",e.activeDate)("value",e.value)("locale",e.locale)("disabledDate",e.disabledDate)}}function bg(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"year-header",4),n.NdJ("valueChange",function(a){return n.CHM(e),n.oxw().activeDate=a})("panelModeChange",function(a){return n.CHM(e),n.oxw().panelModeChange.emit(a)})("valueChange",function(a){return n.CHM(e),n.oxw().headerChange.emit(a)}),n.qZA(),n.TgZ(2,"div")(3,"year-table",6),n.NdJ("valueChange",function(a){return n.CHM(e),n.oxw().onChooseYear(a)})("cellHover",function(a){return n.CHM(e),n.oxw().cellHover.emit(a)}),n.qZA()(),n.BQk()}if(2&t){const e=n.oxw();n.xp6(1),n.Q6J("value",e.activeDate)("locale",e.locale)("showSuperPreBtn",e.enablePrevNext("prev","year"))("showSuperNextBtn",e.enablePrevNext("next","year"))("showNextBtn",!1)("showPreBtn",!1),n.xp6(1),n.Gre("",e.prefixCls,"-body"),n.xp6(1),n.Q6J("activeDate",e.activeDate)("value",e.value)("locale",e.locale)("disabledDate",e.disabledDate)("selectedValue",e.selectedValue)("hoverValue",e.hoverValue)}}function zg(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"month-header",4),n.NdJ("valueChange",function(a){return n.CHM(e),n.oxw().activeDate=a})("panelModeChange",function(a){return n.CHM(e),n.oxw().panelModeChange.emit(a)})("valueChange",function(a){return n.CHM(e),n.oxw().headerChange.emit(a)}),n.qZA(),n.TgZ(2,"div")(3,"month-table",7),n.NdJ("valueChange",function(a){return n.CHM(e),n.oxw().onChooseMonth(a)})("cellHover",function(a){return n.CHM(e),n.oxw().cellHover.emit(a)}),n.qZA()(),n.BQk()}if(2&t){const e=n.oxw();n.xp6(1),n.Q6J("value",e.activeDate)("locale",e.locale)("showSuperPreBtn",e.enablePrevNext("prev","month"))("showSuperNextBtn",e.enablePrevNext("next","month"))("showNextBtn",!1)("showPreBtn",!1),n.xp6(1),n.Gre("",e.prefixCls,"-body"),n.xp6(1),n.Q6J("value",e.value)("activeDate",e.activeDate)("locale",e.locale)("disabledDate",e.disabledDate)("selectedValue",e.selectedValue)("hoverValue",e.hoverValue)}}function Ig(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"date-header",8),n.NdJ("valueChange",function(a){return n.CHM(e),n.oxw().activeDate=a})("panelModeChange",function(a){return n.CHM(e),n.oxw().panelModeChange.emit(a)})("valueChange",function(a){return n.CHM(e),n.oxw().headerChange.emit(a)}),n.qZA(),n.TgZ(2,"div")(3,"date-table",9),n.NdJ("valueChange",function(a){return n.CHM(e),n.oxw().onSelectDate(a)})("cellHover",function(a){return n.CHM(e),n.oxw().cellHover.emit(a)}),n.qZA()(),n.BQk()}if(2&t){const e=n.oxw();n.xp6(1),n.Q6J("value",e.activeDate)("locale",e.locale)("showSuperPreBtn",e.enablePrevNext("prev",e.showWeek?"week":"date"))("showSuperNextBtn",e.enablePrevNext("next",e.showWeek?"week":"date"))("showPreBtn",e.enablePrevNext("prev",e.showWeek?"week":"date"))("showNextBtn",e.enablePrevNext("next",e.showWeek?"week":"date")),n.xp6(1),n.Gre("",e.prefixCls,"-body"),n.xp6(1),n.Q6J("locale",e.locale)("showWeek",e.showWeek)("value",e.value)("activeDate",e.activeDate)("disabledDate",e.disabledDate)("cellRender",e.dateRender)("selectedValue",e.selectedValue)("hoverValue",e.hoverValue)}}function Og(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"nz-time-picker-panel",10),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().onSelectTime(a)}),n.qZA(),n.BQk()}if(2&t){const e=n.oxw();n.xp6(1),n.Q6J("nzInDatePicker",!0)("ngModel",null==e.value?null:e.value.nativeDate)("format",e.timeOptions.nzFormat)("nzHourStep",e.timeOptions.nzHourStep)("nzMinuteStep",e.timeOptions.nzMinuteStep)("nzSecondStep",e.timeOptions.nzSecondStep)("nzDisabledHours",e.timeOptions.nzDisabledHours)("nzDisabledMinutes",e.timeOptions.nzDisabledMinutes)("nzDisabledSeconds",e.timeOptions.nzDisabledSeconds)("nzHideDisabledOptions",!!e.timeOptions.nzHideDisabledOptions)("nzDefaultOpenValue",e.timeOptions.nzDefaultOpenValue)("nzUse12Hours",!!e.timeOptions.nzUse12Hours)("nzAddOn",e.timeOptions.nzAddOn)}}function Eg(t,r){1&t&&n.GkF(0)}const Fg=function(t){return{partType:t}};function Dg(t,r){if(1&t&&(n.ynx(0),n.YNc(1,Eg,1,0,"ng-container",7),n.BQk()),2&t){const e=n.oxw(2),i=n.MAs(4);n.xp6(1),n.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",n.VKq(2,Fg,e.datePickerService.activeInput))}}function Ag(t,r){1&t&&n.GkF(0)}function Ng(t,r){1&t&&n.GkF(0)}const Dl=function(){return{partType:"left"}},Al=function(){return{partType:"right"}};function Mg(t,r){if(1&t&&(n.YNc(0,Ag,1,0,"ng-container",7),n.YNc(1,Ng,1,0,"ng-container",7)),2&t){n.oxw(2);const e=n.MAs(4);n.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",n.DdM(4,Dl)),n.xp6(1),n.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",n.DdM(5,Al))}}function Rg(t,r){1&t&&n.GkF(0)}function Pg(t,r){if(1&t&&(n.ynx(0),n.TgZ(1,"div"),n._UZ(2,"div"),n.TgZ(3,"div")(4,"div"),n.YNc(5,Dg,2,4,"ng-container",0),n.YNc(6,Mg,2,6,"ng-template",null,5,n.W1O),n.qZA(),n.YNc(8,Rg,1,0,"ng-container",6),n.qZA()(),n.BQk()),2&t){const e=n.MAs(7),i=n.oxw(),a=n.MAs(6);n.xp6(1),n.MT6("",i.prefixCls,"-range-wrapper ",i.prefixCls,"-date-range-wrapper"),n.xp6(1),n.Gre("",i.prefixCls,"-range-arrow"),n.Udp("left",null==i.datePickerService?null:i.datePickerService.arrowLeft,"px"),n.xp6(1),n.Gre("",i.prefixCls,"-panel-container"),n.xp6(1),n.Gre("",i.prefixCls,"-panels"),n.xp6(1),n.Q6J("ngIf",i.hasTimePicker)("ngIfElse",e),n.xp6(3),n.Q6J("ngTemplateOutlet",a)}}function Bg(t,r){1&t&&n.GkF(0)}function Lg(t,r){1&t&&n.GkF(0)}function Ug(t,r){if(1&t&&(n.TgZ(0,"div")(1,"div",8),n.YNc(2,Bg,1,0,"ng-container",6),n.YNc(3,Lg,1,0,"ng-container",6),n.qZA()()),2&t){const e=n.oxw(),i=n.MAs(4),a=n.MAs(6);n.DjV("",e.prefixCls,"-panel-container ",e.showWeek?e.prefixCls+"-week-number":""," ",e.hasTimePicker?e.prefixCls+"-time":""," ",e.isRange?e.prefixCls+"-range":"",""),n.xp6(1),n.Gre("",e.prefixCls,"-panel"),n.ekj("ant-picker-panel-rtl","rtl"===e.dir),n.xp6(1),n.Q6J("ngTemplateOutlet",i),n.xp6(1),n.Q6J("ngTemplateOutlet",a)}}function Hg(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"div")(1,"inner-popup",9),n.NdJ("panelModeChange",function(a){const s=n.CHM(e).partType;return n.oxw().onPanelModeChange(a,s)})("cellHover",function(a){return n.CHM(e),n.oxw().onCellHover(a)})("selectDate",function(a){n.CHM(e);const o=n.oxw();return o.changeValueFromSelect(a,!o.showTime)})("selectTime",function(a){const s=n.CHM(e).partType;return n.oxw().onSelectTime(a,s)})("headerChange",function(a){const s=n.CHM(e).partType;return n.oxw().onActiveDateChange(a,s)}),n.qZA()()}if(2&t){const e=r.partType,i=n.oxw();n.Gre("",i.prefixCls,"-panel"),n.ekj("ant-picker-panel-rtl","rtl"===i.dir),n.xp6(1),n.Q6J("showWeek",i.showWeek)("endPanelMode",i.getPanelMode(i.endPanelMode,e))("partType",e)("locale",i.locale)("showTimePicker",i.hasTimePicker)("timeOptions",i.getTimeOptions(e))("panelMode",i.getPanelMode(i.panelMode,e))("activeDate",i.getActiveDate(e))("value",i.getValue(e))("disabledDate",i.disabledDate)("dateRender",i.dateRender)("selectedValue",null==i.datePickerService?null:i.datePickerService.value)("hoverValue",i.hoverValue)}}function Vg(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"calendar-footer",11),n.NdJ("clickOk",function(){return n.CHM(e),n.oxw(2).onClickOk()})("clickToday",function(a){return n.CHM(e),n.oxw(2).onClickToday(a)}),n.qZA()}if(2&t){const e=n.oxw(2),i=n.MAs(8);n.Q6J("locale",e.locale)("isRange",e.isRange)("showToday",e.showToday)("showNow",e.showNow)("hasTimePicker",e.hasTimePicker)("okDisabled",!e.isAllowed(null==e.datePickerService?null:e.datePickerService.value))("extraFooter",e.extraFooter)("rangeQuickSelector",e.ranges?i:null)}}function Zg(t,r){if(1&t&&n.YNc(0,Vg,1,8,"calendar-footer",10),2&t){const e=n.oxw();n.Q6J("ngIf",e.hasFooter)}}function jg(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",13),n.NdJ("click",function(){const o=n.CHM(e).$implicit,s=n.oxw(2);return s.onClickPresetRange(s.ranges[o])})("mouseenter",function(){const o=n.CHM(e).$implicit,s=n.oxw(2);return s.onHoverPresetRange(s.ranges[o])})("mouseleave",function(){return n.CHM(e),n.oxw(2).onPresetRangeMouseLeave()}),n.TgZ(1,"span",14),n._uU(2),n.qZA()()}if(2&t){const e=r.$implicit,i=n.oxw(2);n.Gre("",i.prefixCls,"-preset"),n.xp6(2),n.Oqu(e)}}function Gg(t,r){if(1&t&&n.YNc(0,jg,3,4,"li",12),2&t){const e=n.oxw();n.Q6J("ngForOf",e.getObjectKeys(e.ranges))}}const Wg=["separatorElement"],Yg=["pickerInput"],$g=["rangePickerInput"];function Jg(t,r){1&t&&n.GkF(0)}function Qg(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"div")(1,"input",7,8),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw(2).inputValue=a})("focus",function(a){return n.CHM(e),n.oxw(2).onFocus(a)})("focusout",function(a){return n.CHM(e),n.oxw(2).onFocusout(a)})("ngModelChange",function(a){return n.CHM(e),n.oxw(2).onInputChange(a)})("keyup.enter",function(a){return n.CHM(e),n.oxw(2).onKeyupEnter(a)}),n.qZA(),n.YNc(3,Jg,1,0,"ng-container",9),n.qZA()}if(2&t){const e=n.oxw(2),i=n.MAs(4);n.Gre("",e.prefixCls,"-input"),n.xp6(1),n.ekj("ant-input-disabled",e.nzDisabled),n.s9C("placeholder",e.getPlaceholder()),n.Q6J("disabled",e.nzDisabled)("readOnly",e.nzInputReadOnly)("ngModel",e.inputValue)("size",e.inputSize),n.uIk("id",e.nzId),n.xp6(2),n.Q6J("ngTemplateOutlet",i)}}function qg(t,r){1&t&&n.GkF(0)}function Xg(t,r){if(1&t&&(n.ynx(0),n._uU(1),n.BQk()),2&t){const e=n.oxw(3);n.xp6(1),n.Oqu(e.nzSeparator)}}function Kg(t,r){1&t&&n._UZ(0,"i",13)}function e_(t,r){1&t&&n.GkF(0)}function t_(t,r){1&t&&n.GkF(0)}function n_(t,r){if(1&t&&(n.ynx(0),n.TgZ(1,"div"),n.YNc(2,qg,1,0,"ng-container",10),n.qZA(),n.TgZ(3,"div",null,11)(5,"span"),n.YNc(6,Xg,2,1,"ng-container",0),n.qZA(),n.YNc(7,Kg,1,0,"ng-template",null,12,n.W1O),n.qZA(),n.TgZ(9,"div"),n.YNc(10,e_,1,0,"ng-container",10),n.qZA(),n.YNc(11,t_,1,0,"ng-container",9),n.BQk()),2&t){const e=n.MAs(8),i=n.oxw(2),a=n.MAs(2),o=n.MAs(4);n.xp6(1),n.Gre("",i.prefixCls,"-input"),n.xp6(1),n.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",n.DdM(19,Dl)),n.xp6(1),n.Gre("",i.prefixCls,"-range-separator"),n.xp6(2),n.Gre("",i.prefixCls,"-separator"),n.xp6(1),n.Q6J("ngIf",i.nzSeparator)("ngIfElse",e),n.xp6(3),n.Gre("",i.prefixCls,"-input"),n.xp6(1),n.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",n.DdM(20,Al)),n.xp6(1),n.Q6J("ngTemplateOutlet",o)}}function r_(t,r){if(1&t&&(n.ynx(0),n.YNc(1,Qg,4,12,"div",5),n.YNc(2,n_,12,21,"ng-container",6),n.BQk()),2&t){const e=n.oxw();n.xp6(1),n.Q6J("ngIf",!e.isRange),n.xp6(1),n.Q6J("ngIf",e.isRange)}}function i_(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"input",14,15),n.NdJ("click",function(a){return n.CHM(e),n.oxw().onClickInputBox(a)})("focusout",function(a){return n.CHM(e),n.oxw().onFocusout(a)})("focus",function(a){const s=n.CHM(e).partType;return n.oxw().onFocus(a,s)})("keyup.enter",function(a){return n.CHM(e),n.oxw().onKeyupEnter(a)})("ngModelChange",function(a){const s=n.CHM(e).partType,l=n.oxw();return l.inputValue[l.datePickerService.getActiveIndex(s)]=a})("ngModelChange",function(a){return n.CHM(e),n.oxw().onInputChange(a)}),n.qZA()}if(2&t){const e=r.partType,i=n.oxw();n.s9C("placeholder",i.getPlaceholder(e)),n.Q6J("disabled",i.nzDisabled)("readOnly",i.nzInputReadOnly)("size",i.inputSize)("ngModel",i.inputValue[i.datePickerService.getActiveIndex(e)]),n.uIk("id",i.nzId)}}function a_(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"span",19),n.NdJ("click",function(a){return n.CHM(e),n.oxw(2).onClickClear(a)}),n._UZ(1,"i",20),n.qZA()}if(2&t){const e=n.oxw(2);n.Gre("",e.prefixCls,"-clear")}}function o_(t,r){if(1&t&&(n.ynx(0),n._UZ(1,"i",21),n.BQk()),2&t){const e=r.$implicit;n.xp6(1),n.Q6J("nzType",e)}}function s_(t,r){if(1&t&&(n._UZ(0,"div",16),n.YNc(1,a_,2,3,"span",17),n.TgZ(2,"span"),n.YNc(3,o_,2,1,"ng-container",18),n.qZA()),2&t){const e=n.oxw();n.Gre("",e.prefixCls,"-active-bar"),n.Q6J("ngStyle",e.activeBarStyle),n.xp6(1),n.Q6J("ngIf",e.showClear()),n.xp6(1),n.Gre("",e.prefixCls,"-suffix"),n.xp6(1),n.Q6J("nzStringTemplateOutlet",e.nzSuffixIcon)}}function l_(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"div",16)(1,"date-range-popup",22),n.NdJ("panelModeChange",function(a){return n.CHM(e),n.oxw().onPanelModeChange(a)})("calendarChange",function(a){return n.CHM(e),n.oxw().onCalendarChange(a)})("resultOk",function(){return n.CHM(e),n.oxw().onResultOk()}),n.qZA()()}if(2&t){const e=n.oxw();n.MT6("",e.prefixCls,"-dropdown ",e.nzDropdownClassName,""),n.ekj("ant-picker-dropdown-rtl","rtl"===e.dir)("ant-picker-dropdown-placement-bottomLeft","bottom"===e.currentPositionY&&"start"===e.currentPositionX)("ant-picker-dropdown-placement-topLeft","top"===e.currentPositionY&&"start"===e.currentPositionX)("ant-picker-dropdown-placement-bottomRight","bottom"===e.currentPositionY&&"end"===e.currentPositionX)("ant-picker-dropdown-placement-topRight","top"===e.currentPositionY&&"end"===e.currentPositionX)("ant-picker-dropdown-range",e.isRange)("ant-picker-active-left","left"===e.datePickerService.activeInput)("ant-picker-active-right","right"===e.datePickerService.activeInput),n.Q6J("ngStyle",e.nzPopupStyle),n.xp6(1),n.Q6J("isRange",e.isRange)("inline",e.nzInline)("defaultPickerValue",e.nzDefaultPickerValue)("showWeek","week"===e.nzMode)("panelMode",e.panelMode)("locale",null==e.nzLocale?null:e.nzLocale.lang)("showToday","date"===e.nzMode&&e.nzShowToday&&!e.isRange&&!e.nzShowTime)("showNow","date"===e.nzMode&&e.nzShowNow&&!e.isRange&&!!e.nzShowTime)("showTime",e.nzShowTime)("dateRender",e.nzDateRender)("disabledDate",e.nzDisabledDate)("disabledTime",e.nzDisabledTime)("extraFooter",e.extraFooter)("ranges",e.nzRanges)("dir",e.dir)}}function c_(t,r){1&t&&n.GkF(0)}function u_(t,r){if(1&t&&(n.TgZ(0,"div",23),n.YNc(1,c_,1,0,"ng-container",9),n.qZA()),2&t){const e=n.oxw(),i=n.MAs(6);n.Q6J("nzNoAnimation",!(null==e.noAnimation||!e.noAnimation.nzNoAnimation))("@slideMotion","enter"),n.xp6(1),n.Q6J("ngTemplateOutlet",i)}}const za="ant-picker",d_={nzDisabledHours:()=>[],nzDisabledMinutes:()=>[],nzDisabledSeconds:()=>[]};function Nl(t,r){let e=r?r(t&&t.nativeDate):{};return e=Object.assign(Object.assign({},d_),e),e}function Ia(t,r,e){return!(!t||r&&r(t.nativeDate)||e&&!function p_(t,r){return function f_(t,r){let e=!1;if(t){const i=t.getHours(),a=t.getMinutes(),o=t.getSeconds();e=-1!==r.nzDisabledHours().indexOf(i)||-1!==r.nzDisabledMinutes(i).indexOf(a)||-1!==r.nzDisabledSeconds(i,a).indexOf(o)}return!e}(t,Nl(t,r))}(t,e))}function Oa(t){return t&&t.replace(/Y/g,"y").replace(/D/g,"d")}let h_=(()=>{class t{constructor(e){this.dateHelper=e,this.showToday=!1,this.showNow=!1,this.hasTimePicker=!1,this.isRange=!1,this.okDisabled=!1,this.rangeQuickSelector=null,this.clickOk=new n.vpe,this.clickToday=new n.vpe,this.prefixCls=za,this.isTemplateRef=_e.de,this.isNonEmptyString=_e.HH,this.isTodayDisabled=!1,this.todayTitle=""}ngOnChanges(e){const i=new Date;if(e.disabledDate&&(this.isTodayDisabled=!(!this.disabledDate||!this.disabledDate(i))),e.locale){const a=Oa(this.locale.dateFormat);this.todayTitle=this.dateHelper.format(i,a)}}onClickToday(){const e=new et.Yp;this.clickToday.emit(e.clone())}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(ct.mx))},t.\u0275cmp=n.Xpm({type:t,selectors:[["calendar-footer"]],inputs:{locale:"locale",showToday:"showToday",showNow:"showNow",hasTimePicker:"hasTimePicker",isRange:"isRange",okDisabled:"okDisabled",disabledDate:"disabledDate",extraFooter:"extraFooter",rangeQuickSelector:"rangeQuickSelector"},outputs:{clickOk:"clickOk",clickToday:"clickToday"},exportAs:["calendarFooter"],features:[n.TTD],decls:4,vars:6,consts:[[3,"class",4,"ngIf"],["role","button",3,"class","title","click",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngTemplateOutlet"],[3,"innerHTML"],["role","button",3,"title","click"],[3,"click"],["nz-button","","type","button","nzType","primary","nzSize","small",3,"disabled","click"]],template:function(e,i){1&e&&(n.TgZ(0,"div"),n.YNc(1,am,4,6,"div",0),n.YNc(2,om,2,6,"a",1),n.YNc(3,um,4,6,"ul",0),n.qZA()),2&e&&(n.Gre("",i.prefixCls,"-footer"),n.xp6(1),n.Q6J("ngIf",i.extraFooter),n.xp6(1),n.Q6J("ngIf",i.showToday),n.xp6(1),n.Q6J("ngIf",i.hasTimePicker||i.rangeQuickSelector))},directives:[It.ix,K.O5,K.RF,K.n9,K.tP,Mr.dQ,Mn.w],encapsulation:2,changeDetection:0}),t})(),Io=(()=>{class t{constructor(){this.activeInput="left",this.arrowLeft=0,this.isRange=!1,this.valueChange$=new Xh.t(1),this.emitValue$=new rt.x,this.inputPartChange$=new rt.x}initValue(e=!1){e&&(this.initialValue=this.isRange?[]:null),this.setValue(this.initialValue)}hasValue(e=this.value){return Array.isArray(e)?!!e[0]||!!e[1]:!!e}makeValue(e){return this.isRange?e?e.map(i=>new et.Yp(i)):[]:e?new et.Yp(e):null}setActiveDate(e,i=!1,a="month"){this.activeDate=this.isRange?(0,et._p)(e,i,{date:"month",month:"year",year:"decade"}[a],this.activeInput):(0,et.ky)(e)}setValue(e){this.value=e,this.valueChange$.next(this.value)}getActiveIndex(e=this.activeInput){return{left:0,right:1}[e]}ngOnDestroy(){this.valueChange$.complete(),this.emitValue$.complete(),this.inputPartChange$.complete()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac}),t})(),Ea=(()=>{class t{constructor(){this.prefixCls="ant-picker-header",this.selectors=[],this.showSuperPreBtn=!0,this.showSuperNextBtn=!0,this.showPreBtn=!0,this.showNextBtn=!0,this.panelModeChange=new n.vpe,this.valueChange=new n.vpe}superPreviousTitle(){return this.locale.previousYear}previousTitle(){return this.locale.previousMonth}superNextTitle(){return this.locale.nextYear}nextTitle(){return this.locale.nextMonth}superPrevious(){this.changeValue(this.value.addYears(-1))}superNext(){this.changeValue(this.value.addYears(1))}previous(){this.changeValue(this.value.addMonths(-1))}next(){this.changeValue(this.value.addMonths(1))}changeValue(e){this.value!==e&&(this.value=e,this.valueChange.emit(this.value),this.render())}changeMode(e){this.panelModeChange.emit(e)}render(){this.value&&(this.selectors=this.getSelectors())}ngOnInit(){this.value||(this.value=new et.Yp),this.selectors=this.getSelectors()}ngOnChanges(e){(e.value||e.locale)&&this.render()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=n.lG2({type:t,inputs:{value:"value",locale:"locale",showSuperPreBtn:"showSuperPreBtn",showSuperNextBtn:"showSuperNextBtn",showPreBtn:"showPreBtn",showNextBtn:"showNextBtn"},outputs:{panelModeChange:"panelModeChange",valueChange:"valueChange"},features:[n.TTD]}),t})(),m_=(()=>{class t extends Ea{previous(){}next(){}get startYear(){return 100*parseInt(""+this.value.getYear()/100,10)}get endYear(){return this.startYear+99}superPrevious(){this.changeValue(this.value.addYears(-100))}superNext(){this.changeValue(this.value.addYears(100))}getSelectors(){return[{className:`${this.prefixCls}-decade-btn`,title:"",onClick:()=>{},label:`${this.startYear}-${this.endYear}`}]}}return t.\u0275fac=function(){let r;return function(i){return(r||(r=n.n5z(t)))(i||t)}}(),t.\u0275cmp=n.Xpm({type:t,selectors:[["decade-header"]],exportAs:["decadeHeader"],features:[n.qOj],decls:11,vars:31,consts:[["role","button","type","button","tabindex","-1",3,"title","click"],[1,"ant-picker-super-prev-icon"],[1,"ant-picker-prev-icon"],[4,"ngFor","ngForOf"],[1,"ant-picker-next-icon"],[1,"ant-picker-super-next-icon"],["role","button","type","button",3,"title","click"]],template:function(e,i){1&e&&(n.TgZ(0,"div")(1,"button",0),n.NdJ("click",function(){return i.superPrevious()}),n._UZ(2,"span",1),n.qZA(),n.TgZ(3,"button",0),n.NdJ("click",function(){return i.previous()}),n._UZ(4,"span",2),n.qZA(),n.TgZ(5,"div"),n.YNc(6,dm,3,5,"ng-container",3),n.qZA(),n.TgZ(7,"button",0),n.NdJ("click",function(){return i.next()}),n._UZ(8,"span",4),n.qZA(),n.TgZ(9,"button",0),n.NdJ("click",function(){return i.superNext()}),n._UZ(10,"span",5),n.qZA()()),2&e&&(n.Tol(i.prefixCls),n.xp6(1),n.Gre("",i.prefixCls,"-super-prev-btn"),n.Udp("visibility",i.showSuperPreBtn?"visible":"hidden"),n.s9C("title",i.superPreviousTitle()),n.xp6(2),n.Gre("",i.prefixCls,"-prev-btn"),n.Udp("visibility",i.showPreBtn?"visible":"hidden"),n.s9C("title",i.previousTitle()),n.xp6(2),n.Gre("",i.prefixCls,"-view"),n.xp6(1),n.Q6J("ngForOf",i.selectors),n.xp6(1),n.Gre("",i.prefixCls,"-next-btn"),n.Udp("visibility",i.showNextBtn?"visible":"hidden"),n.s9C("title",i.nextTitle()),n.xp6(2),n.Gre("",i.prefixCls,"-super-next-btn"),n.Udp("visibility",i.showSuperNextBtn?"visible":"hidden"),n.s9C("title",i.superNextTitle()))},directives:[K.sg],encapsulation:2,changeDetection:0}),t})(),Fa=(()=>{class t{constructor(){this.isTemplateRef=_e.de,this.isNonEmptyString=_e.HH,this.headRow=[],this.bodyRows=[],this.MAX_ROW=6,this.MAX_COL=7,this.prefixCls="ant-picker",this.activeDate=new et.Yp,this.showWeek=!1,this.selectedValue=[],this.hoverValue=[],this.valueChange=new n.vpe,this.cellHover=new n.vpe}render(){this.activeDate&&(this.headRow=this.makeHeadRow(),this.bodyRows=this.makeBodyRows())}trackByBodyRow(e,i){return i.trackByIndex}trackByBodyColumn(e,i){return i.trackByIndex}hasRangeValue(){var e,i;return(null===(e=this.selectedValue)||void 0===e?void 0:e.length)>0||(null===(i=this.hoverValue)||void 0===i?void 0:i.length)>0}getClassMap(e){return{"ant-picker-cell":!0,"ant-picker-cell-in-view":!0,"ant-picker-cell-selected":e.isSelected,"ant-picker-cell-disabled":e.isDisabled,"ant-picker-cell-in-range":!!e.isInSelectedRange,"ant-picker-cell-range-start":!!e.isSelectedStart,"ant-picker-cell-range-end":!!e.isSelectedEnd,"ant-picker-cell-range-start-single":!!e.isStartSingle,"ant-picker-cell-range-end-single":!!e.isEndSingle,"ant-picker-cell-range-hover":!!e.isInHoverRange,"ant-picker-cell-range-hover-start":!!e.isHoverStart,"ant-picker-cell-range-hover-end":!!e.isHoverEnd,"ant-picker-cell-range-hover-edge-start":!!e.isFirstCellInPanel,"ant-picker-cell-range-hover-edge-end":!!e.isLastCellInPanel,"ant-picker-cell-range-start-near-hover":!!e.isRangeStartNearHover,"ant-picker-cell-range-end-near-hover":!!e.isRangeEndNearHover}}ngOnInit(){this.render()}ngOnChanges(e){e.activeDate&&!e.activeDate.currentValue&&(this.activeDate=new et.Yp),(e.disabledDate||e.locale||e.showWeek||this.isDateRealChange(e.activeDate)||this.isDateRealChange(e.value)||this.isDateRealChange(e.selectedValue)||this.isDateRealChange(e.hoverValue))&&this.render()}isDateRealChange(e){if(e){const i=e.previousValue,a=e.currentValue;return Array.isArray(a)?!Array.isArray(i)||a.length!==i.length||a.some((o,s)=>{const l=i[s];return l instanceof et.Yp?l.isSameDay(o):l!==o}):!this.isSameDate(i,a)}return!1}isSameDate(e,i){return!e&&!i||e&&i&&i.isSameDay(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=n.lG2({type:t,inputs:{prefixCls:"prefixCls",value:"value",locale:"locale",activeDate:"activeDate",showWeek:"showWeek",selectedValue:"selectedValue",hoverValue:"hoverValue",disabledDate:"disabledDate",cellRender:"cellRender",fullCellRender:"fullCellRender"},outputs:{valueChange:"valueChange",cellHover:"cellHover"},features:[n.TTD]}),t})(),x_=(()=>{class t extends Fa{get startYear(){return 100*parseInt(""+this.activeDate.getYear()/100,10)}get endYear(){return this.startYear+99}makeHeadRow(){return[]}makeBodyRows(){const e=[],i=this.value&&this.value.getYear(),a=this.startYear,o=this.endYear,s=a-10;let l=0;for(let c=0;c<4;c++){const u={dateCells:[],trackByIndex:c};for(let d=0;d<3;d++){const f=s+10*l,p=s+10*l+9,m=`${f}-${p}`,x={trackByIndex:d,value:this.activeDate.setYear(f).nativeDate,content:m,title:m,isDisabled:!1,isSelected:i>=f&&i<=p,isLowerThanStart:p<a,isBiggerThanEnd:f>o,classMap:{},onClick(){},onMouseEnter(){}};x.classMap=this.getClassMap(x),x.onClick=()=>this.chooseDecade(f),l++,u.dateCells.push(x)}e.push(u)}return e}getClassMap(e){return{[`${this.prefixCls}-cell`]:!0,[`${this.prefixCls}-cell-in-view`]:!e.isBiggerThanEnd&&!e.isLowerThanStart,[`${this.prefixCls}-cell-selected`]:e.isSelected,[`${this.prefixCls}-cell-disabled`]:e.isDisabled}}chooseDecade(e){this.value=this.activeDate.setYear(e),this.valueChange.emit(this.value)}}return t.\u0275fac=function(){let r;return function(i){return(r||(r=n.n5z(t)))(i||t)}}(),t.\u0275cmp=n.Xpm({type:t,selectors:[["decade-table"]],exportAs:["decadeTable"],features:[n.qOj],decls:4,vars:3,consts:[["cellspacing","0","role","grid",1,"ant-picker-content"],[4,"ngIf"],["role","row",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["role","row"],["role","columnheader",4,"ngIf"],["role","columnheader",3,"title",4,"ngFor","ngForOf"],["role","columnheader"],["role","columnheader",3,"title"],["role","row",3,"ngClass"],["role","gridcell",3,"class",4,"ngIf"],["role","gridcell",3,"title","ngClass","click","mouseenter",4,"ngFor","ngForOf","ngForTrackBy"],["role","gridcell"],["role","gridcell",3,"title","ngClass","click","mouseenter"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"innerHTML"],[4,"ngIf","ngIfElse"],["defaultCell",""]],template:function(e,i){1&e&&(n.TgZ(0,"table",0),n.YNc(1,hm,4,2,"thead",1),n.TgZ(2,"tbody"),n.YNc(3,zm,3,4,"tr",2),n.qZA()()),2&e&&(n.xp6(1),n.Q6J("ngIf",i.headRow&&i.headRow.length>0),n.xp6(2),n.Q6J("ngForOf",i.bodyRows)("ngForTrackBy",i.trackByBodyRow))},directives:[K.O5,K.sg,K.mk,K.RF,K.n9,K.tP,K.ED],encapsulation:2,changeDetection:0}),t})(),v_=(()=>{class t extends Ea{get startYear(){return 10*parseInt(""+this.value.getYear()/10,10)}get endYear(){return this.startYear+9}superPrevious(){this.changeValue(this.value.addYears(-10))}superNext(){this.changeValue(this.value.addYears(10))}getSelectors(){return[{className:`${this.prefixCls}-year-btn`,title:"",onClick:()=>this.changeMode("decade"),label:`${this.startYear}-${this.endYear}`}]}}return t.\u0275fac=function(){let r;return function(i){return(r||(r=n.n5z(t)))(i||t)}}(),t.\u0275cmp=n.Xpm({type:t,selectors:[["year-header"]],exportAs:["yearHeader"],features:[n.qOj],decls:11,vars:31,consts:[["role","button","type","button","tabindex","-1",3,"title","click"],[1,"ant-picker-super-prev-icon"],[1,"ant-picker-prev-icon"],[4,"ngFor","ngForOf"],[1,"ant-picker-next-icon"],[1,"ant-picker-super-next-icon"],["role","button","type","button",3,"title","click"]],template:function(e,i){1&e&&(n.TgZ(0,"div")(1,"button",0),n.NdJ("click",function(){return i.superPrevious()}),n._UZ(2,"span",1),n.qZA(),n.TgZ(3,"button",0),n.NdJ("click",function(){return i.previous()}),n._UZ(4,"span",2),n.qZA(),n.TgZ(5,"div"),n.YNc(6,Im,3,5,"ng-container",3),n.qZA(),n.TgZ(7,"button",0),n.NdJ("click",function(){return i.next()}),n._UZ(8,"span",4),n.qZA(),n.TgZ(9,"button",0),n.NdJ("click",function(){return i.superNext()}),n._UZ(10,"span",5),n.qZA()()),2&e&&(n.Tol(i.prefixCls),n.xp6(1),n.Gre("",i.prefixCls,"-super-prev-btn"),n.Udp("visibility",i.showSuperPreBtn?"visible":"hidden"),n.s9C("title",i.superPreviousTitle()),n.xp6(2),n.Gre("",i.prefixCls,"-prev-btn"),n.Udp("visibility",i.showPreBtn?"visible":"hidden"),n.s9C("title",i.previousTitle()),n.xp6(2),n.Gre("",i.prefixCls,"-view"),n.xp6(1),n.Q6J("ngForOf",i.selectors),n.xp6(1),n.Gre("",i.prefixCls,"-next-btn"),n.Udp("visibility",i.showNextBtn?"visible":"hidden"),n.s9C("title",i.nextTitle()),n.xp6(2),n.Gre("",i.prefixCls,"-super-next-btn"),n.Udp("visibility",i.showSuperNextBtn?"visible":"hidden"),n.s9C("title",i.superNextTitle()))},directives:[K.sg],encapsulation:2,changeDetection:0}),t})(),C_=(()=>{class t extends Fa{constructor(e){super(),this.dateHelper=e,this.MAX_ROW=4,this.MAX_COL=3}makeHeadRow(){return[]}makeBodyRows(){const e=this.activeDate&&this.activeDate.getYear(),i=10*parseInt(""+e/10,10),a=i+9,o=i-1,s=[];let l=0;for(let c=0;c<this.MAX_ROW;c++){const u={dateCells:[],trackByIndex:c};for(let d=0;d<this.MAX_COL;d++){const f=o+l,p=this.activeDate.setYear(f),m=this.dateHelper.format(p.nativeDate,"yyyy"),x=this.isDisabledYear(p),h={trackByIndex:d,value:p.nativeDate,isDisabled:x,isSameDecade:f>=i&&f<=a,isSelected:f===(this.value&&this.value.getYear()),content:m,title:m,classMap:{},isLastCellInPanel:p.getYear()===a,isFirstCellInPanel:p.getYear()===i,cellRender:(0,_e.rw)(this.cellRender,p),fullCellRender:(0,_e.rw)(this.fullCellRender,p),onClick:()=>this.chooseYear(h.value.getFullYear()),onMouseEnter:()=>this.cellHover.emit(p)};this.addCellProperty(h,p),u.dateCells.push(h),l++}s.push(u)}return s}getClassMap(e){return Object.assign(Object.assign({},super.getClassMap(e)),{"ant-picker-cell-in-view":!!e.isSameDecade})}isDisabledYear(e){if(!this.disabledDate)return!1;for(let a=e.setMonth(0).setDate(1);a.getYear()===e.getYear();a=a.addDays(1))if(!this.disabledDate(a.nativeDate))return!1;return!0}addCellProperty(e,i){if(this.hasRangeValue()){const[a,o]=this.hoverValue,[s,l]=this.selectedValue;(null==s?void 0:s.isSameYear(i))&&(e.isSelectedStart=!0,e.isSelected=!0),(null==l?void 0:l.isSameYear(i))&&(e.isSelectedEnd=!0,e.isSelected=!0),a&&o&&(e.isHoverStart=a.isSameYear(i),e.isHoverEnd=o.isSameYear(i),e.isInHoverRange=a.isBeforeYear(i)&&i.isBeforeYear(o)),e.isStartSingle=s&&!l,e.isEndSingle=!s&&l,e.isInSelectedRange=(null==s?void 0:s.isBeforeYear(i))&&(null==i?void 0:i.isBeforeYear(l)),e.isRangeStartNearHover=s&&e.isInHoverRange,e.isRangeEndNearHover=l&&e.isInHoverRange}else i.isSameYear(this.value)&&(e.isSelected=!0);e.classMap=this.getClassMap(e)}chooseYear(e){this.value=this.activeDate.setYear(e),this.valueChange.emit(this.value),this.render()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(ct.mx))},t.\u0275cmp=n.Xpm({type:t,selectors:[["year-table"]],exportAs:["yearTable"],features:[n.qOj],decls:4,vars:3,consts:[["cellspacing","0","role","grid",1,"ant-picker-content"],[4,"ngIf"],["role","row",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["role","row"],["role","columnheader",4,"ngIf"],["role","columnheader",3,"title",4,"ngFor","ngForOf"],["role","columnheader"],["role","columnheader",3,"title"],["role","row",3,"ngClass"],["role","gridcell",3,"class",4,"ngIf"],["role","gridcell",3,"title","ngClass","click","mouseenter",4,"ngFor","ngForOf","ngForTrackBy"],["role","gridcell"],["role","gridcell",3,"title","ngClass","click","mouseenter"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"innerHTML"],[4,"ngIf","ngIfElse"],["defaultCell",""]],template:function(e,i){1&e&&(n.TgZ(0,"table",0),n.YNc(1,Fm,4,2,"thead",1),n.TgZ(2,"tbody"),n.YNc(3,jm,3,4,"tr",2),n.qZA()()),2&e&&(n.xp6(1),n.Q6J("ngIf",i.headRow&&i.headRow.length>0),n.xp6(2),n.Q6J("ngForOf",i.bodyRows)("ngForTrackBy",i.trackByBodyRow))},directives:[K.O5,K.sg,K.mk,K.RF,K.n9,K.tP,K.ED],encapsulation:2,changeDetection:0}),t})(),y_=(()=>{class t extends Ea{constructor(e){super(),this.dateHelper=e}getSelectors(){return[{className:`${this.prefixCls}-month-btn`,title:this.locale.yearSelect,onClick:()=>this.changeMode("year"),label:this.dateHelper.format(this.value.nativeDate,Oa(this.locale.yearFormat))}]}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(ct.mx))},t.\u0275cmp=n.Xpm({type:t,selectors:[["month-header"]],exportAs:["monthHeader"],features:[n.qOj],decls:11,vars:31,consts:[["role","button","type","button","tabindex","-1",3,"title","click"],[1,"ant-picker-super-prev-icon"],[1,"ant-picker-prev-icon"],[4,"ngFor","ngForOf"],[1,"ant-picker-next-icon"],[1,"ant-picker-super-next-icon"],["role","button","type","button",3,"title","click"]],template:function(e,i){1&e&&(n.TgZ(0,"div")(1,"button",0),n.NdJ("click",function(){return i.superPrevious()}),n._UZ(2,"span",1),n.qZA(),n.TgZ(3,"button",0),n.NdJ("click",function(){return i.previous()}),n._UZ(4,"span",2),n.qZA(),n.TgZ(5,"div"),n.YNc(6,Gm,3,5,"ng-container",3),n.qZA(),n.TgZ(7,"button",0),n.NdJ("click",function(){return i.next()}),n._UZ(8,"span",4),n.qZA(),n.TgZ(9,"button",0),n.NdJ("click",function(){return i.superNext()}),n._UZ(10,"span",5),n.qZA()()),2&e&&(n.Tol(i.prefixCls),n.xp6(1),n.Gre("",i.prefixCls,"-super-prev-btn"),n.Udp("visibility",i.showSuperPreBtn?"visible":"hidden"),n.s9C("title",i.superPreviousTitle()),n.xp6(2),n.Gre("",i.prefixCls,"-prev-btn"),n.Udp("visibility",i.showPreBtn?"visible":"hidden"),n.s9C("title",i.previousTitle()),n.xp6(2),n.Gre("",i.prefixCls,"-view"),n.xp6(1),n.Q6J("ngForOf",i.selectors),n.xp6(1),n.Gre("",i.prefixCls,"-next-btn"),n.Udp("visibility",i.showNextBtn?"visible":"hidden"),n.s9C("title",i.nextTitle()),n.xp6(2),n.Gre("",i.prefixCls,"-super-next-btn"),n.Udp("visibility",i.showSuperNextBtn?"visible":"hidden"),n.s9C("title",i.superNextTitle()))},directives:[K.sg],encapsulation:2,changeDetection:0}),t})(),w_=(()=>{class t extends Fa{constructor(e){super(),this.dateHelper=e,this.MAX_ROW=4,this.MAX_COL=3}makeHeadRow(){return[]}makeBodyRows(){const e=[];let i=0;for(let a=0;a<this.MAX_ROW;a++){const o={dateCells:[],trackByIndex:a};for(let s=0;s<this.MAX_COL;s++){const l=this.activeDate.setMonth(i),c=this.isDisabledMonth(l),u=this.dateHelper.format(l.nativeDate,"MMM"),d={trackByIndex:s,value:l.nativeDate,isDisabled:c,isSelected:l.isSameMonth(this.value),content:u,title:u,classMap:{},cellRender:(0,_e.rw)(this.cellRender,l),fullCellRender:(0,_e.rw)(this.fullCellRender,l),onClick:()=>this.chooseMonth(d.value.getMonth()),onMouseEnter:()=>this.cellHover.emit(l)};this.addCellProperty(d,l),o.dateCells.push(d),i++}e.push(o)}return e}isDisabledMonth(e){if(!this.disabledDate)return!1;for(let a=e.setDate(1);a.getMonth()===e.getMonth();a=a.addDays(1))if(!this.disabledDate(a.nativeDate))return!1;return!0}addCellProperty(e,i){if(this.hasRangeValue()){const[a,o]=this.hoverValue,[s,l]=this.selectedValue;(null==s?void 0:s.isSameMonth(i))&&(e.isSelectedStart=!0,e.isSelected=!0),(null==l?void 0:l.isSameMonth(i))&&(e.isSelectedEnd=!0,e.isSelected=!0),a&&o&&(e.isHoverStart=a.isSameMonth(i),e.isHoverEnd=o.isSameMonth(i),e.isLastCellInPanel=11===i.getMonth(),e.isFirstCellInPanel=0===i.getMonth(),e.isInHoverRange=a.isBeforeMonth(i)&&i.isBeforeMonth(o)),e.isStartSingle=s&&!l,e.isEndSingle=!s&&l,e.isInSelectedRange=(null==s?void 0:s.isBeforeMonth(i))&&(null==i?void 0:i.isBeforeMonth(l)),e.isRangeStartNearHover=s&&e.isInHoverRange,e.isRangeEndNearHover=l&&e.isInHoverRange}else i.isSameMonth(this.value)&&(e.isSelected=!0);e.classMap=this.getClassMap(e)}chooseMonth(e){this.value=this.activeDate.setMonth(e),this.valueChange.emit(this.value)}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(ct.mx))},t.\u0275cmp=n.Xpm({type:t,selectors:[["month-table"]],exportAs:["monthTable"],features:[n.qOj],decls:4,vars:3,consts:[["cellspacing","0","role","grid",1,"ant-picker-content"],[4,"ngIf"],["role","row",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["role","row"],["role","columnheader",4,"ngIf"],["role","columnheader",3,"title",4,"ngFor","ngForOf"],["role","columnheader"],["role","columnheader",3,"title"],["role","row",3,"ngClass"],["role","gridcell",3,"class",4,"ngIf"],["role","gridcell",3,"title","ngClass","click","mouseenter",4,"ngFor","ngForOf","ngForTrackBy"],["role","gridcell"],["role","gridcell",3,"title","ngClass","click","mouseenter"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"innerHTML"],[4,"ngIf","ngIfElse"],["defaultCell",""]],template:function(e,i){1&e&&(n.TgZ(0,"table",0),n.YNc(1,$m,4,2,"thead",1),n.TgZ(2,"tbody"),n.YNc(3,sg,3,4,"tr",2),n.qZA()()),2&e&&(n.xp6(1),n.Q6J("ngIf",i.headRow&&i.headRow.length>0),n.xp6(2),n.Q6J("ngForOf",i.bodyRows)("ngForTrackBy",i.trackByBodyRow))},directives:[K.O5,K.sg,K.mk,K.RF,K.n9,K.tP,K.ED],encapsulation:2,changeDetection:0}),t})(),T_=(()=>{class t extends Ea{constructor(e){super(),this.dateHelper=e}getSelectors(){return[{className:`${this.prefixCls}-year-btn`,title:this.locale.yearSelect,onClick:()=>this.changeMode("year"),label:this.dateHelper.format(this.value.nativeDate,Oa(this.locale.yearFormat))},{className:`${this.prefixCls}-month-btn`,title:this.locale.monthSelect,onClick:()=>this.changeMode("month"),label:this.dateHelper.format(this.value.nativeDate,this.locale.monthFormat||"MMM")}]}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(ct.mx))},t.\u0275cmp=n.Xpm({type:t,selectors:[["date-header"]],exportAs:["dateHeader"],features:[n.qOj],decls:11,vars:31,consts:[["role","button","type","button","tabindex","-1",3,"title","click"],[1,"ant-picker-super-prev-icon"],[1,"ant-picker-prev-icon"],[4,"ngFor","ngForOf"],[1,"ant-picker-next-icon"],[1,"ant-picker-super-next-icon"],["role","button","type","button",3,"title","click"]],template:function(e,i){1&e&&(n.TgZ(0,"div")(1,"button",0),n.NdJ("click",function(){return i.superPrevious()}),n._UZ(2,"span",1),n.qZA(),n.TgZ(3,"button",0),n.NdJ("click",function(){return i.previous()}),n._UZ(4,"span",2),n.qZA(),n.TgZ(5,"div"),n.YNc(6,lg,3,5,"ng-container",3),n.qZA(),n.TgZ(7,"button",0),n.NdJ("click",function(){return i.next()}),n._UZ(8,"span",4),n.qZA(),n.TgZ(9,"button",0),n.NdJ("click",function(){return i.superNext()}),n._UZ(10,"span",5),n.qZA()()),2&e&&(n.Tol(i.prefixCls),n.xp6(1),n.Gre("",i.prefixCls,"-super-prev-btn"),n.Udp("visibility",i.showSuperPreBtn?"visible":"hidden"),n.s9C("title",i.superPreviousTitle()),n.xp6(2),n.Gre("",i.prefixCls,"-prev-btn"),n.Udp("visibility",i.showPreBtn?"visible":"hidden"),n.s9C("title",i.previousTitle()),n.xp6(2),n.Gre("",i.prefixCls,"-view"),n.xp6(1),n.Q6J("ngForOf",i.selectors),n.xp6(1),n.Gre("",i.prefixCls,"-next-btn"),n.Udp("visibility",i.showNextBtn?"visible":"hidden"),n.s9C("title",i.nextTitle()),n.xp6(2),n.Gre("",i.prefixCls,"-super-next-btn"),n.Udp("visibility",i.showSuperNextBtn?"visible":"hidden"),n.s9C("title",i.superNextTitle()))},directives:[K.sg],encapsulation:2,changeDetection:0}),t})(),k_=(()=>{class t extends Fa{constructor(e,i){super(),this.i18n=e,this.dateHelper=i}changeValueFromInside(e){this.activeDate=this.activeDate.setYear(e.getYear()).setMonth(e.getMonth()).setDate(e.getDate()),this.valueChange.emit(this.activeDate),this.activeDate.isSameMonth(this.value)||this.render()}makeHeadRow(){const e=[],i=this.activeDate.calendarStart({weekStartsOn:this.dateHelper.getFirstDayOfWeek()});for(let a=0;a<this.MAX_COL;a++){const o=i.addDays(a);e.push({trackByIndex:null,value:o.nativeDate,title:this.dateHelper.format(o.nativeDate,"E"),content:this.dateHelper.format(o.nativeDate,this.getVeryShortWeekFormat()),isSelected:!1,isDisabled:!1,onClick(){},onMouseEnter(){}})}return e}getVeryShortWeekFormat(){return 0===this.i18n.getLocaleId().toLowerCase().indexOf("zh")?"EEEEE":"EEEEEE"}makeBodyRows(){const e=[],i=this.activeDate.calendarStart({weekStartsOn:this.dateHelper.getFirstDayOfWeek()});for(let a=0;a<this.MAX_ROW;a++){const o=i.addDays(7*a),s={isActive:!1,dateCells:[],trackByIndex:a};for(let l=0;l<7;l++){const c=o.addDays(l),u=Oa(this.i18n.getLocaleData("DatePicker.lang.dateFormat","YYYY-MM-DD")),d=this.dateHelper.format(c.nativeDate,u),f=this.dateHelper.format(c.nativeDate,"dd"),p={trackByIndex:l,value:c.nativeDate,label:f,isSelected:!1,isDisabled:!1,isToday:!1,title:d,cellRender:(0,_e.rw)(this.cellRender,c),fullCellRender:(0,_e.rw)(this.fullCellRender,c),content:`${c.getDate()}`,onClick:()=>this.changeValueFromInside(c),onMouseEnter:()=>this.cellHover.emit(c)};this.addCellProperty(p,c),this.showWeek&&!s.weekNum&&(s.weekNum=this.dateHelper.getISOWeek(c.nativeDate)),c.isSameDay(this.value)&&(s.isActive=c.isSameDay(this.value)),s.dateCells.push(p)}s.classMap={"ant-picker-week-panel-row":this.showWeek,"ant-picker-week-panel-row-selected":this.showWeek&&s.isActive},e.push(s)}return e}addCellProperty(e,i){var a;if(this.hasRangeValue()&&!this.showWeek){const[o,s]=this.hoverValue,[l,c]=this.selectedValue;(null==l?void 0:l.isSameDay(i))&&(e.isSelectedStart=!0,e.isSelected=!0),(null==c?void 0:c.isSameDay(i))&&(e.isSelectedEnd=!0,e.isSelected=!0),o&&s&&(e.isHoverStart=o.isSameDay(i),e.isHoverEnd=s.isSameDay(i),e.isLastCellInPanel=i.isLastDayOfMonth(),e.isFirstCellInPanel=i.isFirstDayOfMonth(),e.isInHoverRange=o.isBeforeDay(i)&&i.isBeforeDay(s)),e.isStartSingle=l&&!c,e.isEndSingle=!l&&c,e.isInSelectedRange=(null==l?void 0:l.isBeforeDay(i))&&i.isBeforeDay(c),e.isRangeStartNearHover=l&&e.isInHoverRange,e.isRangeEndNearHover=c&&e.isInHoverRange}e.isToday=i.isToday(),e.isSelected=i.isSameDay(this.value),e.isDisabled=!!(null===(a=this.disabledDate)||void 0===a?void 0:a.call(this,i.nativeDate)),e.classMap=this.getClassMap(e)}getClassMap(e){const i=new et.Yp(e.value);return Object.assign(Object.assign({},super.getClassMap(e)),{"ant-picker-cell-today":!!e.isToday,"ant-picker-cell-in-view":i.isSameMonth(this.activeDate)})}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(ct.wi),n.Y36(ct.mx))},t.\u0275cmp=n.Xpm({type:t,selectors:[["date-table"]],inputs:{locale:"locale"},exportAs:["dateTable"],features:[n.qOj],decls:4,vars:3,consts:[["cellspacing","0","role","grid",1,"ant-picker-content"],[4,"ngIf"],["role","row",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["role","row"],["role","columnheader",4,"ngIf"],["role","columnheader",3,"title",4,"ngFor","ngForOf"],["role","columnheader"],["role","columnheader",3,"title"],["role","row",3,"ngClass"],["role","gridcell",3,"class",4,"ngIf"],["role","gridcell",3,"title","ngClass","click","mouseenter",4,"ngFor","ngForOf","ngForTrackBy"],["role","gridcell"],["role","gridcell",3,"title","ngClass","click","mouseenter"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"innerHTML"],[4,"ngIf","ngIfElse"],["defaultCell",""]],template:function(e,i){1&e&&(n.TgZ(0,"table",0),n.YNc(1,dg,4,2,"thead",1),n.TgZ(2,"tbody"),n.YNc(3,kg,3,4,"tr",2),n.qZA()()),2&e&&(n.xp6(1),n.Q6J("ngIf",i.headRow&&i.headRow.length>0),n.xp6(2),n.Q6J("ngForOf",i.bodyRows)("ngForTrackBy",i.trackByBodyRow))},directives:[K.O5,K.sg,K.mk,K.RF,K.n9,K.tP,K.ED],encapsulation:2,changeDetection:0}),t})(),S_=(()=>{class t{constructor(){this.panelModeChange=new n.vpe,this.headerChange=new n.vpe,this.selectDate=new n.vpe,this.selectTime=new n.vpe,this.cellHover=new n.vpe,this.prefixCls=za}enablePrevNext(e,i){return!(!this.showTimePicker&&i===this.endPanelMode&&("left"===this.partType&&"next"===e||"right"===this.partType&&"prev"===e))}onSelectTime(e){this.selectTime.emit(new et.Yp(e))}onSelectDate(e){const i=e instanceof et.Yp?e:new et.Yp(e),a=this.timeOptions&&this.timeOptions.nzDefaultOpenValue;!this.value&&a&&i.setHms(a.getHours(),a.getMinutes(),a.getSeconds()),this.selectDate.emit(i)}onChooseMonth(e){this.activeDate=this.activeDate.setMonth(e.getMonth()),"month"===this.endPanelMode?(this.value=e,this.selectDate.emit(e)):(this.headerChange.emit(e),this.panelModeChange.emit(this.endPanelMode))}onChooseYear(e){this.activeDate=this.activeDate.setYear(e.getYear()),"year"===this.endPanelMode?(this.value=e,this.selectDate.emit(e)):(this.headerChange.emit(e),this.panelModeChange.emit(this.endPanelMode))}onChooseDecade(e){this.activeDate=this.activeDate.setYear(e.getYear()),"decade"===this.endPanelMode?(this.value=e,this.selectDate.emit(e)):(this.headerChange.emit(e),this.panelModeChange.emit("year"))}ngOnChanges(e){e.activeDate&&!e.activeDate.currentValue&&(this.activeDate=new et.Yp),e.panelMode&&"time"===e.panelMode.currentValue&&(this.panelMode="date")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.Xpm({type:t,selectors:[["inner-popup"]],inputs:{activeDate:"activeDate",endPanelMode:"endPanelMode",panelMode:"panelMode",showWeek:"showWeek",locale:"locale",showTimePicker:"showTimePicker",timeOptions:"timeOptions",disabledDate:"disabledDate",dateRender:"dateRender",selectedValue:"selectedValue",hoverValue:"hoverValue",value:"value",partType:"partType"},outputs:{panelModeChange:"panelModeChange",headerChange:"headerChange",selectDate:"selectDate",selectTime:"selectTime",cellHover:"cellHover"},exportAs:["innerPopup"],features:[n.TTD],decls:8,vars:11,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],[3,"value","locale","showSuperPreBtn","showSuperNextBtn","showNextBtn","showPreBtn","valueChange","panelModeChange"],[3,"activeDate","value","locale","disabledDate","valueChange"],[3,"activeDate","value","locale","disabledDate","selectedValue","hoverValue","valueChange","cellHover"],[3,"value","activeDate","locale","disabledDate","selectedValue","hoverValue","valueChange","cellHover"],[3,"value","locale","showSuperPreBtn","showSuperNextBtn","showPreBtn","showNextBtn","valueChange","panelModeChange"],[3,"locale","showWeek","value","activeDate","disabledDate","cellRender","selectedValue","hoverValue","valueChange","cellHover"],[3,"nzInDatePicker","ngModel","format","nzHourStep","nzMinuteStep","nzSecondStep","nzDisabledHours","nzDisabledMinutes","nzDisabledSeconds","nzHideDisabledOptions","nzDefaultOpenValue","nzUse12Hours","nzAddOn","ngModelChange"]],template:function(e,i){1&e&&(n.TgZ(0,"div")(1,"div"),n.ynx(2,0),n.YNc(3,Sg,4,13,"ng-container",1),n.YNc(4,bg,4,15,"ng-container",1),n.YNc(5,zg,4,15,"ng-container",1),n.YNc(6,Ig,4,17,"ng-container",2),n.BQk(),n.qZA(),n.YNc(7,Og,2,13,"ng-container",3),n.qZA()),2&e&&(n.ekj("ant-picker-datetime-panel",i.showTimePicker),n.xp6(1),n.MT6("",i.prefixCls,"-",i.panelMode,"-panel"),n.xp6(1),n.Q6J("ngSwitch",i.panelMode),n.xp6(1),n.Q6J("ngSwitchCase","decade"),n.xp6(1),n.Q6J("ngSwitchCase","year"),n.xp6(1),n.Q6J("ngSwitchCase","month"),n.xp6(2),n.Q6J("ngIf",i.showTimePicker&&i.timeOptions))},directives:[m_,x_,v_,C_,y_,w_,T_,k_,qh,K.RF,K.n9,K.ED,K.O5,ve.JJ,ve.On],encapsulation:2,changeDetection:0}),t})(),Ml=(()=>{class t{constructor(e,i,a,o){this.datePickerService=e,this.cdr=i,this.ngZone=a,this.host=o,this.inline=!1,this.dir="ltr",this.panelModeChange=new n.vpe,this.calendarChange=new n.vpe,this.resultOk=new n.vpe,this.prefixCls=za,this.endPanelMode="date",this.timeOptions=null,this.hoverValue=[],this.checkedPartArr=[!1,!1],this.destroy$=new rt.x,this.disabledStartTime=s=>this.disabledTime&&this.disabledTime(s,"start"),this.disabledEndTime=s=>this.disabledTime&&this.disabledTime(s,"end")}get hasTimePicker(){return!!this.showTime}get hasFooter(){return this.showToday||this.hasTimePicker||!!this.extraFooter||!!this.ranges}ngOnInit(){(0,ur.T)(this.datePickerService.valueChange$,this.datePickerService.inputPartChange$).pipe((0,Re.R)(this.destroy$)).subscribe(()=>{this.updateActiveDate(),this.cdr.markForCheck()}),this.ngZone.runOutsideAngular(()=>{(0,fr.R)(this.host.nativeElement,"mousedown").pipe((0,Re.R)(this.destroy$)).subscribe(e=>e.preventDefault())})}ngOnChanges(e){(e.showTime||e.disabledTime)&&this.showTime&&this.buildTimeOptions(),e.panelMode&&(this.endPanelMode=this.panelMode),e.defaultPickerValue&&this.updateActiveDate()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}updateActiveDate(){const e=this.datePickerService.hasValue()?this.datePickerService.value:this.datePickerService.makeValue(this.defaultPickerValue);this.datePickerService.setActiveDate(e,this.hasTimePicker,this.getPanelMode(this.endPanelMode))}onClickOk(){this.changeValueFromSelect(this.isRange?this.datePickerService.value[{left:0,right:1}[this.datePickerService.activeInput]]:this.datePickerService.value),this.resultOk.emit()}onClickToday(e){this.changeValueFromSelect(e,!this.showTime)}onCellHover(e){if(!this.isRange)return;const a=this.datePickerService.value[{left:1,right:0}[this.datePickerService.activeInput]];a&&(this.hoverValue=a.isBeforeDay(e)?[a,e]:[e,a])}onPanelModeChange(e,i){this.panelMode=this.isRange?0===this.datePickerService.getActiveIndex(i)?[e,this.panelMode[1]]:[this.panelMode[0],e]:e,this.panelModeChange.emit(this.panelMode)}onActiveDateChange(e,i){if(this.isRange){const a=[];a[this.datePickerService.getActiveIndex(i)]=e,this.datePickerService.setActiveDate(a,this.hasTimePicker,this.getPanelMode(this.endPanelMode,i))}else this.datePickerService.setActiveDate(e)}onSelectTime(e,i){if(this.isRange){const a=(0,et.ky)(this.datePickerService.value),o=this.datePickerService.getActiveIndex(i);a[o]=this.overrideHms(e,a[o]),this.datePickerService.setValue(a)}else{const a=this.overrideHms(e,this.datePickerService.value);this.datePickerService.setValue(a)}this.datePickerService.inputPartChange$.next(),this.buildTimeOptions()}changeValueFromSelect(e,i=!0){if(this.isRange){const a=(0,et.ky)(this.datePickerService.value),o=this.datePickerService.activeInput;let s=o;a[this.datePickerService.getActiveIndex(o)]=e,this.checkedPartArr[this.datePickerService.getActiveIndex(o)]=!0,this.hoverValue=a,i?this.inline?(s=this.reversedPart(o),"right"===s&&(a[this.datePickerService.getActiveIndex(s)]=null,this.checkedPartArr[this.datePickerService.getActiveIndex(s)]=!1),this.datePickerService.setValue(a),this.calendarChange.emit(a),this.isBothAllowed(a)&&this.checkedPartArr[0]&&this.checkedPartArr[1]&&(this.clearHoverValue(),this.datePickerService.emitValue$.next())):((0,et.Et)(a)&&(s=this.reversedPart(o),a[this.datePickerService.getActiveIndex(s)]=null,this.checkedPartArr[this.datePickerService.getActiveIndex(s)]=!1),this.datePickerService.setValue(a),this.isBothAllowed(a)&&this.checkedPartArr[0]&&this.checkedPartArr[1]?(this.calendarChange.emit(a),this.clearHoverValue(),this.datePickerService.emitValue$.next()):this.isAllowed(a)&&(s=this.reversedPart(o),this.calendarChange.emit([e.clone()]))):this.datePickerService.setValue(a),this.datePickerService.inputPartChange$.next(s)}else this.datePickerService.setValue(e),this.datePickerService.inputPartChange$.next(),i&&this.isAllowed(e)&&this.datePickerService.emitValue$.next();this.buildTimeOptions()}reversedPart(e){return"left"===e?"right":"left"}getPanelMode(e,i){return this.isRange?e[this.datePickerService.getActiveIndex(i)]:e}getValue(e){return this.isRange?(this.datePickerService.value||[])[this.datePickerService.getActiveIndex(e)]:this.datePickerService.value}getActiveDate(e){return this.isRange?this.datePickerService.activeDate[this.datePickerService.getActiveIndex(e)]:this.datePickerService.activeDate}isOneAllowed(e){const i=this.datePickerService.getActiveIndex();return Ia(e[i],this.disabledDate,[this.disabledStartTime,this.disabledEndTime][i])}isBothAllowed(e){return Ia(e[0],this.disabledDate,this.disabledStartTime)&&Ia(e[1],this.disabledDate,this.disabledEndTime)}isAllowed(e,i=!1){return this.isRange?i?this.isBothAllowed(e):this.isOneAllowed(e):Ia(e,this.disabledDate,this.disabledTime)}getTimeOptions(e){return this.showTime&&this.timeOptions?this.timeOptions instanceof Array?this.timeOptions[this.datePickerService.getActiveIndex(e)]:this.timeOptions:null}onClickPresetRange(e){const i="function"==typeof e?e():e;i&&(this.datePickerService.setValue([new et.Yp(i[0]),new et.Yp(i[1])]),this.datePickerService.emitValue$.next())}onPresetRangeMouseLeave(){this.clearHoverValue()}onHoverPresetRange(e){"function"!=typeof e&&(this.hoverValue=[new et.Yp(e[0]),new et.Yp(e[1])])}getObjectKeys(e){return e?Object.keys(e):[]}show(e){return!(this.showTime&&this.isRange&&this.datePickerService.activeInput!==e)}clearHoverValue(){this.hoverValue=[]}buildTimeOptions(){if(this.showTime){const e="object"==typeof this.showTime?this.showTime:{};if(this.isRange){const i=this.datePickerService.value;this.timeOptions=[this.overrideTimeOptions(e,i[0],"start"),this.overrideTimeOptions(e,i[1],"end")]}else this.timeOptions=this.overrideTimeOptions(e,this.datePickerService.value)}else this.timeOptions=null}overrideTimeOptions(e,i,a){let o;return o=a?"start"===a?this.disabledStartTime:this.disabledEndTime:this.disabledTime,Object.assign(Object.assign({},e),Nl(i,o))}overrideHms(e,i){return e=e||new et.Yp,(i=i||new et.Yp).setHms(e.getHours(),e.getMinutes(),e.getSeconds())}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(Io),n.Y36(n.sBO),n.Y36(n.R0b),n.Y36(n.SBq))},t.\u0275cmp=n.Xpm({type:t,selectors:[["date-range-popup"]],inputs:{isRange:"isRange",inline:"inline",showWeek:"showWeek",locale:"locale",disabledDate:"disabledDate",disabledTime:"disabledTime",showToday:"showToday",showNow:"showNow",showTime:"showTime",extraFooter:"extraFooter",ranges:"ranges",dateRender:"dateRender",panelMode:"panelMode",defaultPickerValue:"defaultPickerValue",dir:"dir"},outputs:{panelModeChange:"panelModeChange",calendarChange:"calendarChange",resultOk:"resultOk"},exportAs:["dateRangePopup"],features:[n.TTD],decls:9,vars:2,consts:[[4,"ngIf","ngIfElse"],["singlePanel",""],["tplInnerPopup",""],["tplFooter",""],["tplRangeQuickSelector",""],["noTimePicker",""],[4,"ngTemplateOutlet"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["tabindex","-1"],[3,"showWeek","endPanelMode","partType","locale","showTimePicker","timeOptions","panelMode","activeDate","value","disabledDate","dateRender","selectedValue","hoverValue","panelModeChange","cellHover","selectDate","selectTime","headerChange"],[3,"locale","isRange","showToday","showNow","hasTimePicker","okDisabled","extraFooter","rangeQuickSelector","clickOk","clickToday",4,"ngIf"],[3,"locale","isRange","showToday","showNow","hasTimePicker","okDisabled","extraFooter","rangeQuickSelector","clickOk","clickToday"],[3,"class","click","mouseenter","mouseleave",4,"ngFor","ngForOf"],[3,"click","mouseenter","mouseleave"],[1,"ant-tag","ant-tag-blue"]],template:function(e,i){if(1&e&&(n.YNc(0,Pg,9,18,"ng-container",0),n.YNc(1,Ug,4,13,"ng-template",null,1,n.W1O),n.YNc(3,Hg,2,18,"ng-template",null,2,n.W1O),n.YNc(5,Zg,1,1,"ng-template",null,3,n.W1O),n.YNc(7,Gg,1,1,"ng-template",null,4,n.W1O)),2&e){const a=n.MAs(2);n.Q6J("ngIf",i.isRange)("ngIfElse",a)}},directives:[S_,h_,K.O5,K.tP,K.sg],encapsulation:2,changeDetection:0}),t})();const Oo={position:"relative"};let Rl=(()=>{class t{constructor(e,i,a,o,s,l,c,u,d,f,p,m){this.nzConfigService=e,this.datePickerService=i,this.i18n=a,this.cdr=o,this.renderer=s,this.elementRef=l,this.dateHelper=c,this.nzResizeObserver=u,this.platform=d,this.directionality=p,this.noAnimation=m,this._nzModuleName="datePicker",this.isRange=!1,this.dir="ltr",this.panelMode="date",this.destroyed$=new rt.x,this.isCustomPlaceHolder=!1,this.isCustomFormat=!1,this.showTime=!1,this.nzAllowClear=!0,this.nzAutoFocus=!1,this.nzDisabled=!1,this.nzBorderless=!1,this.nzInputReadOnly=!1,this.nzInline=!1,this.nzPlaceHolder="",this.nzPopupStyle=Oo,this.nzSize="default",this.nzShowToday=!0,this.nzMode="date",this.nzShowNow=!0,this.nzDefaultPickerValue=null,this.nzSeparator=void 0,this.nzSuffixIcon="calendar",this.nzBackdrop=!1,this.nzId=null,this.nzOnPanelChange=new n.vpe,this.nzOnCalendarChange=new n.vpe,this.nzOnOk=new n.vpe,this.nzOnOpenChange=new n.vpe,this.inputSize=12,this.prefixCls=za,this.activeBarStyle={},this.overlayOpen=!1,this.overlayPositions=[{offsetY:2,originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{offsetY:-2,originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{offsetY:2,originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{offsetY:-2,originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"}],this.currentPositionX="start",this.currentPositionY="bottom",this.onChangeFn=()=>{},this.onTouchedFn=()=>{},this.document=f,this.origin=new Bt.xu(this.elementRef)}get nzShowTime(){return this.showTime}set nzShowTime(e){this.showTime="object"==typeof e?e:(0,_e.sw)(e)}get realOpenState(){return this.isOpenHandledByUser()?!!this.nzOpen:this.overlayOpen}ngAfterViewInit(){this.nzAutoFocus&&this.focus(),this.isRange&&this.platform.isBrowser&&this.nzResizeObserver.observe(this.elementRef).pipe((0,Re.R)(this.destroyed$)).subscribe(()=>{this.updateInputWidthAndArrowLeft()}),this.datePickerService.inputPartChange$.pipe((0,Re.R)(this.destroyed$)).subscribe(e=>{e&&(this.datePickerService.activeInput=e),this.focus(),this.updateInputWidthAndArrowLeft()})}updateInputWidthAndArrowLeft(){var e,i,a;this.inputWidth=(null===(i=null===(e=this.rangePickerInputs)||void 0===e?void 0:e.first)||void 0===i?void 0:i.nativeElement.offsetWidth)||0;const o={position:"absolute",width:`${this.inputWidth}px`};this.datePickerService.arrowLeft="left"===this.datePickerService.activeInput?0:this.inputWidth+(null===(a=this.separatorElement)||void 0===a?void 0:a.nativeElement.offsetWidth)||0,this.activeBarStyle=Object.assign(Object.assign({},o),"rtl"===this.dir?{right:`${this.datePickerService.arrowLeft}px`}:{left:`${this.datePickerService.arrowLeft}px`}),this.cdr.markForCheck()}getInput(e){var i,a;if(!this.nzInline)return this.isRange?"left"===e?null===(i=this.rangePickerInputs)||void 0===i?void 0:i.first.nativeElement:null===(a=this.rangePickerInputs)||void 0===a?void 0:a.last.nativeElement:this.pickerInput.nativeElement}focus(){const e=this.getInput(this.datePickerService.activeInput);this.document.activeElement!==e&&(null==e||e.focus())}onFocus(e,i){e.preventDefault(),i&&this.datePickerService.inputPartChange$.next(i),this.renderClass(!0)}onFocusout(e){e.preventDefault(),this.elementRef.nativeElement.contains(e.relatedTarget)||this.checkAndClose(),this.renderClass(!1)}open(){this.nzInline||!this.realOpenState&&!this.nzDisabled&&(this.updateInputWidthAndArrowLeft(),this.overlayOpen=!0,this.nzOnOpenChange.emit(!0),this.cdr.markForCheck())}close(){this.nzInline||this.realOpenState&&(this.overlayOpen=!1,this.nzOnOpenChange.emit(!1))}showClear(){return!this.nzDisabled&&!this.isEmptyValue(this.datePickerService.value)&&this.nzAllowClear}checkAndClose(){if(this.realOpenState)if(this.panel.isAllowed(this.datePickerService.value,!0)){if(Array.isArray(this.datePickerService.value)&&(0,et.Et)(this.datePickerService.value)){const e=this.datePickerService.getActiveIndex();return void this.panel.changeValueFromSelect(this.datePickerService.value[e],!0)}this.updateInputValue(),this.datePickerService.emitValue$.next()}else this.datePickerService.setValue(this.datePickerService.initialValue),this.close()}onClickInputBox(e){e.stopPropagation(),this.focus(),this.isOpenHandledByUser()||this.open()}onOverlayKeydown(e){e.keyCode===ba.hY&&this.datePickerService.initValue()}onPositionChange(e){this.currentPositionX=e.connectionPair.originX,this.currentPositionY=e.connectionPair.originY,this.cdr.detectChanges()}onClickClear(e){e.preventDefault(),e.stopPropagation(),this.datePickerService.initValue(!0),this.datePickerService.emitValue$.next()}updateInputValue(){const e=this.datePickerService.value;this.inputValue=this.isRange?e?e.map(i=>this.formatValue(i)):["",""]:this.formatValue(e),this.cdr.markForCheck()}formatValue(e){return this.dateHelper.format(e&&e.nativeDate,this.nzFormat)}onInputChange(e,i=!1){if(!this.platform.TRIDENT&&this.document.activeElement===this.getInput(this.datePickerService.activeInput)&&!this.realOpenState)return void this.open();const a=this.checkValidDate(e);a&&this.realOpenState&&this.panel.changeValueFromSelect(a,i)}onKeyupEnter(e){this.onInputChange(e.target.value,!0)}checkValidDate(e){const i=new et.Yp(this.dateHelper.parseDate(e,this.nzFormat));return i.isValid()&&e===this.dateHelper.format(i.nativeDate,this.nzFormat)?i:null}getPlaceholder(e){return this.isRange?this.nzPlaceHolder[this.datePickerService.getActiveIndex(e)]:this.nzPlaceHolder}isEmptyValue(e){return null===e||(this.isRange?!e||!Array.isArray(e)||e.every(i=>!i):!e)}isOpenHandledByUser(){return void 0!==this.nzOpen}ngOnInit(){var e;this.nzLocale||this.i18n.localeChange.pipe((0,Re.R)(this.destroyed$)).subscribe(()=>this.setLocale()),this.datePickerService.isRange=this.isRange,this.datePickerService.initValue(!0),this.datePickerService.emitValue$.pipe((0,Re.R)(this.destroyed$)).subscribe(i=>{var a,o,s,l;const c=this.datePickerService.value;if(this.datePickerService.initialValue=(0,et.ky)(c),this.isRange){const u=c;this.onChangeFn(u.length?[null!==(o=null===(a=u[0])||void 0===a?void 0:a.nativeDate)&&void 0!==o?o:null,null!==(l=null===(s=u[1])||void 0===s?void 0:s.nativeDate)&&void 0!==l?l:null]:[])}else this.onChangeFn(c?c.nativeDate:null);this.onTouchedFn(),this.close()}),null===(e=this.directionality.change)||void 0===e||e.pipe((0,Re.R)(this.destroyed$)).subscribe(i=>{this.dir=i,this.cdr.detectChanges()}),this.dir=this.directionality.value,this.inputValue=this.isRange?["",""]:"",this.setModeAndFormat(),this.datePickerService.valueChange$.pipe((0,Re.R)(this.destroyed$)).subscribe(()=>{this.updateInputValue()})}ngOnChanges(e){var i,a;e.nzPopupStyle&&(this.nzPopupStyle=this.nzPopupStyle?Object.assign(Object.assign({},this.nzPopupStyle),Oo):Oo),(null===(i=e.nzPlaceHolder)||void 0===i?void 0:i.currentValue)&&(this.isCustomPlaceHolder=!0),(null===(a=e.nzFormat)||void 0===a?void 0:a.currentValue)&&(this.isCustomFormat=!0),e.nzLocale&&this.setDefaultPlaceHolder(),e.nzRenderExtraFooter&&(this.extraFooter=(0,_e.rw)(this.nzRenderExtraFooter)),e.nzMode&&(this.setDefaultPlaceHolder(),this.setModeAndFormat())}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}setModeAndFormat(){const e={year:"yyyy",month:"yyyy-MM",week:this.i18n.getDateLocale()?"RRRR-II":"yyyy-ww",date:this.nzShowTime?"yyyy-MM-dd HH:mm:ss":"yyyy-MM-dd"};this.nzMode||(this.nzMode="date"),this.panelMode=this.isRange?[this.nzMode,this.nzMode]:this.nzMode,this.isCustomFormat||(this.nzFormat=e[this.nzMode]),this.inputSize=Math.max(10,this.nzFormat.length)+2,this.updateInputValue()}onOpenChange(e){this.nzOnOpenChange.emit(e)}writeValue(e){this.setValue(e),this.cdr.markForCheck()}registerOnChange(e){this.onChangeFn=e}registerOnTouched(e){this.onTouchedFn=e}setDisabledState(e){this.nzDisabled=e,this.cdr.markForCheck()}setLocale(){this.nzLocale=this.i18n.getLocaleData("DatePicker",{}),this.setDefaultPlaceHolder(),this.cdr.markForCheck()}setDefaultPlaceHolder(){if(!this.isCustomPlaceHolder&&this.nzLocale){const e={year:this.getPropertyOfLocale("yearPlaceholder"),month:this.getPropertyOfLocale("monthPlaceholder"),week:this.getPropertyOfLocale("weekPlaceholder"),date:this.getPropertyOfLocale("placeholder")},i={year:this.getPropertyOfLocale("rangeYearPlaceholder"),month:this.getPropertyOfLocale("rangeMonthPlaceholder"),week:this.getPropertyOfLocale("rangeWeekPlaceholder"),date:this.getPropertyOfLocale("rangePlaceholder")};this.nzPlaceHolder=this.isRange?i[this.nzMode]:e[this.nzMode]}}getPropertyOfLocale(e){return this.nzLocale.lang[e]||this.i18n.getLocaleData(`DatePicker.lang.${e}`)}setValue(e){const i=this.datePickerService.makeValue(e);this.datePickerService.setValue(i),this.datePickerService.initialValue=i}renderClass(e){e?this.renderer.addClass(this.elementRef.nativeElement,"ant-picker-focused"):this.renderer.removeClass(this.elementRef.nativeElement,"ant-picker-focused")}onPanelModeChange(e){this.nzOnPanelChange.emit(e)}onCalendarChange(e){if(this.isRange&&Array.isArray(e)){const i=e.filter(a=>a instanceof et.Yp).map(a=>a.nativeDate);this.nzOnCalendarChange.emit(i)}}onResultOk(){var e,i;if(this.isRange){const a=this.datePickerService.value;this.nzOnOk.emit(a.length?[(null===(e=a[0])||void 0===e?void 0:e.nativeDate)||null,(null===(i=a[1])||void 0===i?void 0:i.nativeDate)||null]:[])}else this.nzOnOk.emit(this.datePickerService.value?this.datePickerService.value.nativeDate:null)}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(tn.jY),n.Y36(Io),n.Y36(ct.wi),n.Y36(n.sBO),n.Y36(n.Qsj),n.Y36(n.SBq),n.Y36(ct.mx),n.Y36(tm),n.Y36(cr.t4),n.Y36(K.K0),n.Y36(be.Is,8),n.Y36(Rn.P,9))},t.\u0275cmp=n.Xpm({type:t,selectors:[["nz-date-picker"],["nz-week-picker"],["nz-month-picker"],["nz-year-picker"],["nz-range-picker"]],viewQuery:function(e,i){if(1&e&&(n.Gf(Bt.pI,5),n.Gf(Ml,5),n.Gf(Wg,5),n.Gf(Yg,5),n.Gf($g,5)),2&e){let a;n.iGM(a=n.CRH())&&(i.cdkConnectedOverlay=a.first),n.iGM(a=n.CRH())&&(i.panel=a.first),n.iGM(a=n.CRH())&&(i.separatorElement=a.first),n.iGM(a=n.CRH())&&(i.pickerInput=a.first),n.iGM(a=n.CRH())&&(i.rangePickerInputs=a)}},hostVars:16,hostBindings:function(e,i){1&e&&n.NdJ("click",function(o){return i.onClickInputBox(o)}),2&e&&n.ekj("ant-picker",!0)("ant-picker-range",i.isRange)("ant-picker-large","large"===i.nzSize)("ant-picker-small","small"===i.nzSize)("ant-picker-disabled",i.nzDisabled)("ant-picker-rtl","rtl"===i.dir)("ant-picker-borderless",i.nzBorderless)("ant-picker-inline",i.nzInline)},inputs:{nzAllowClear:"nzAllowClear",nzAutoFocus:"nzAutoFocus",nzDisabled:"nzDisabled",nzBorderless:"nzBorderless",nzInputReadOnly:"nzInputReadOnly",nzInline:"nzInline",nzOpen:"nzOpen",nzDisabledDate:"nzDisabledDate",nzLocale:"nzLocale",nzPlaceHolder:"nzPlaceHolder",nzPopupStyle:"nzPopupStyle",nzDropdownClassName:"nzDropdownClassName",nzSize:"nzSize",nzFormat:"nzFormat",nzDateRender:"nzDateRender",nzDisabledTime:"nzDisabledTime",nzRenderExtraFooter:"nzRenderExtraFooter",nzShowToday:"nzShowToday",nzMode:"nzMode",nzShowNow:"nzShowNow",nzRanges:"nzRanges",nzDefaultPickerValue:"nzDefaultPickerValue",nzSeparator:"nzSeparator",nzSuffixIcon:"nzSuffixIcon",nzBackdrop:"nzBackdrop",nzId:"nzId",nzShowTime:"nzShowTime"},outputs:{nzOnPanelChange:"nzOnPanelChange",nzOnCalendarChange:"nzOnCalendarChange",nzOnOk:"nzOnOk",nzOnOpenChange:"nzOnOpenChange"},exportAs:["nzDatePicker"],features:[n._Bn([Io,{provide:ve.JU,multi:!0,useExisting:(0,n.Gpc)(()=>t)}]),n.TTD],decls:8,vars:7,consts:[[4,"ngIf","ngIfElse"],["tplRangeInput",""],["tplRightRest",""],["inlineMode",""],["cdkConnectedOverlay","","nzConnectedOverlay","",3,"cdkConnectedOverlayHasBackdrop","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayTransformOriginOn","positionChange","detach","overlayKeydown"],[3,"class",4,"ngIf"],[4,"ngIf"],["autocomplete","off",3,"disabled","readOnly","ngModel","placeholder","size","ngModelChange","focus","focusout","keyup.enter"],["pickerInput",""],[4,"ngTemplateOutlet"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["separatorElement",""],["defaultSeparator",""],["nz-icon","","nzType","swap-right","nzTheme","outline"],["autocomplete","off",3,"disabled","readOnly","size","ngModel","placeholder","click","focusout","focus","keyup.enter","ngModelChange"],["rangePickerInput",""],[3,"ngStyle"],[3,"class","click",4,"ngIf"],[4,"nzStringTemplateOutlet"],[3,"click"],["nz-icon","","nzType","close-circle","nzTheme","fill"],["nz-icon","",3,"nzType"],[3,"isRange","inline","defaultPickerValue","showWeek","panelMode","locale","showToday","showNow","showTime","dateRender","disabledDate","disabledTime","extraFooter","ranges","dir","panelModeChange","calendarChange","resultOk"],[1,"ant-picker-wrapper",2,"position","relative",3,"nzNoAnimation"]],template:function(e,i){if(1&e&&(n.YNc(0,r_,3,2,"ng-container",0),n.YNc(1,i_,2,6,"ng-template",null,1,n.W1O),n.YNc(3,s_,4,9,"ng-template",null,2,n.W1O),n.YNc(5,l_,2,36,"ng-template",null,3,n.W1O),n.YNc(7,u_,2,3,"ng-template",4),n.NdJ("positionChange",function(o){return i.onPositionChange(o)})("detach",function(){return i.close()})("overlayKeydown",function(o){return i.onOverlayKeydown(o)})),2&e){const a=n.MAs(6);n.Q6J("ngIf",!i.nzInline)("ngIfElse",a),n.xp6(7),n.Q6J("cdkConnectedOverlayHasBackdrop",i.nzBackdrop)("cdkConnectedOverlayOrigin",i.origin)("cdkConnectedOverlayOpen",i.realOpenState)("cdkConnectedOverlayPositions",i.overlayPositions)("cdkConnectedOverlayTransformOriginOn",".ant-picker-wrapper")}},directives:[Ml,K.O5,ve.Fj,ve.JJ,ve.On,K.tP,Pt.Ls,Mn.w,K.PC,Ee.f,be.Lv,Bt.pI,bt.hQ,Rn.P],encapsulation:2,data:{animation:[Ei.mF]},changeDetection:0}),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzAllowClear",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzAutoFocus",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzDisabled",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzBorderless",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzInputReadOnly",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzInline",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzOpen",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzShowToday",void 0),(0,Oe.gn)([(0,_e.yF)()],t.prototype,"nzShowNow",void 0),(0,Oe.gn)([(0,tn.oS)()],t.prototype,"nzSeparator",void 0),(0,Oe.gn)([(0,tn.oS)()],t.prototype,"nzSuffixIcon",void 0),(0,Oe.gn)([(0,tn.oS)()],t.prototype,"nzBackdrop",void 0),t})(),Pl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[K.ez,ve.u5,ct.YI,Fl,Ee.T]]}),t})(),z_=(()=>{class t{constructor(e){this.datePicker=e,this.datePicker.isRange=!0}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(Rl,9))},t.\u0275dir=n.lG2({type:t,selectors:[["nz-range-picker"]],exportAs:["nzRangePicker"]}),t})(),Bl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[be.vT,K.ez,ve.u5,Bt.U8,Pl,Pt.PV,bt.e4,Rn.g,Ee.T,Fl,It.sL,Pl]]}),t})();function Ll(t,r,e,i,a,o,s){try{var l=t[o](s),c=l.value}catch(u){return void e(u)}l.done?r(c):Promise.resolve(c).then(i,a)}function Eo(t){return function(){var r=this,e=arguments;return new Promise(function(i,a){var o=t.apply(r,e);function s(c){Ll(o,i,a,s,l,"next",c)}function l(c){Ll(o,i,a,s,l,"throw",c)}s(void 0)})}}var D=oe(7854),Fo=oe(4986),Ul=oe(5963);function Rr(t=0,r=Fo.z){return t<0&&(t=0),(0,Ul.H)(t,t,r)}var I_=oe(9975),oi=oe(4351),O_=oe(7272),Ai=oe(5698),E_=oe(4482),F_=oe(5403),D_=oe(5032);function Hl(t,r){return r?e=>(0,O_.z)(r.pipe((0,Ai.q)(1),function A_(){return(0,E_.e)((t,r)=>{t.subscribe((0,F_.x)(r,D_.Z))})}()),e.pipe(Hl(t))):(0,ul.z)((e,i)=>t(e,i).pipe((0,Ai.q)(1),(0,Oi.h)(e)))}function si(t,r=Fo.z){const e=(0,Ul.H)(t,r);return Hl(()=>e)}var Do=oe(262),li=oe(6305),Qn=oe(7957),Pr=oe(2843),N_=oe(7043),Ni_version="0.18.5",sn=1200,Br=1252,M_=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ao={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Da=function(t){-1!=M_.indexOf(t)&&(Br=Ao[0]=t)},vn=function(t){sn=t,Da(t)};function Aa(){vn(1200),function R_(){Da(1252)}()}function Na(t){for(var r=[],e=0,i=t.length;e<i;++e)r[e]=t.charCodeAt(e);return r}function Vl(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return r.join("")}var je,ci=function(t){var r=t.charCodeAt(0),e=t.charCodeAt(1);return 255==r&&254==e?function P_(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e)+(t.charCodeAt(2*e+1)<<8));return r.join("")}(t.slice(2)):254==r&&255==e?Vl(t.slice(2)):65279==r?t.slice(1):t},Mi=function(r){return String.fromCharCode(r)},No=function(r){return String.fromCharCode(r)},mr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Pi(t){for(var r="",e=0,i=0,a=0,o=0,s=0,l=0,c=0,u=0;u<t.length;)o=(e=t.charCodeAt(u++))>>2,s=(3&e)<<4|(i=t.charCodeAt(u++))>>4,l=(15&i)<<2|(a=t.charCodeAt(u++))>>6,c=63&a,isNaN(i)?l=c=64:isNaN(a)&&(c=64),r+=mr.charAt(o)+mr.charAt(s)+mr.charAt(l)+mr.charAt(c);return r}function ln(t){var r="",o=0,s=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)o=mr.indexOf(t.charAt(u++)),s=mr.indexOf(t.charAt(u++)),r+=String.fromCharCode(o<<2|s>>4),64!==(l=mr.indexOf(t.charAt(u++)))&&(r+=String.fromCharCode((15&s)<<4|l>>2)),64!==(c=mr.indexOf(t.charAt(u++)))&&(r+=String.fromCharCode((3&l)<<6|c));return r}var Pe=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),qn=function(){if("undefined"!=typeof Buffer){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch(r){t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function gr(t){return Pe?Buffer.alloc?Buffer.alloc(t):new Buffer(t):"undefined"!=typeof Uint8Array?new Uint8Array(t):new Array(t)}function Zl(t){return Pe?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):"undefined"!=typeof Uint8Array?new Uint8Array(t):new Array(t)}var cn=function(r){return Pe?qn(r,"binary"):r.split("").map(function(e){return 255&e.charCodeAt(0)})};function Bi(t){if("undefined"==typeof ArrayBuffer)return cn(t);for(var r=new ArrayBuffer(t.length),e=new Uint8Array(r),i=0;i!=t.length;++i)e[i]=255&t.charCodeAt(i);return r}function _r(t){if(Array.isArray(t))return t.map(function(i){return String.fromCharCode(i)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function Mo(t){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Mo(new Uint8Array(t));for(var r=new Array(t.length),e=0;e<t.length;++e)r[e]=t[e];return r}var Ot=Pe?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:qn(r)}))}:function(t){if("undefined"!=typeof Uint8Array){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var i=new Uint8Array(e),a=0;for(r=0,e=0;r<t.length;e+=a,++r)if(a=t[r].length,t[r]instanceof Uint8Array)i.set(t[r],e);else{if("string"==typeof t[r])throw"wtf";i.set(new Uint8Array(t[r]),e)}return i}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))},Lt=/\u0000/g,Li=/[\u0001-\u0006]/g;function ui(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function Fn(t,r){var e=""+t;return e.length>=r?e:ft("0",r-e.length)+e}function Ro(t,r){var e=""+t;return e.length>=r?e:ft(" ",r-e.length)+e}function Ma(t,r){var e=""+t;return e.length>=r?e:e+ft(" ",r-e.length)}var jl=Math.pow(2,32);function di(t,r){return t>jl||t<-jl?function U_(t,r){var e=""+Math.round(t);return e.length>=r?e:ft("0",r-e.length)+e}(t,r):function H_(t,r){var e=""+t;return e.length>=r?e:ft("0",r-e.length)+e}(Math.round(t),r)}function Ra(t,r){return t.length>=7+(r=r||0)&&103==(32|t.charCodeAt(r))&&101==(32|t.charCodeAt(r+1))&&110==(32|t.charCodeAt(r+2))&&101==(32|t.charCodeAt(r+3))&&114==(32|t.charCodeAt(r+4))&&97==(32|t.charCodeAt(r+5))&&108==(32|t.charCodeAt(r+6))}var Gl=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Po=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],Se={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Wl={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Z_={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Pa(t,r,e){for(var i=t<0?-1:1,a=t*i,o=0,s=1,l=0,c=1,u=0,d=0,f=Math.floor(a);u<r&&(l=(f=Math.floor(a))*s+o,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),o=s,s=l,c=u,u=d;if(d>r&&(u>r?(d=c,l=o):(d=u,l=s)),!e)return[0,i*l,d];var p=Math.floor(i*l/d);return[p,i*l-p*d,d]}function xr(t,r,e){if(t>2958465||t<0)return null;var i=0|t,a=Math.floor(86400*(t-i)),o=0,s=[],l={D:i,T:a,u:86400*(t-i)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),r&&r.date1904&&(i+=1462),l.u>.9999&&(l.u=0,86400==++a&&(l.T=a=0,++i,++l.D)),60===i)s=e?[1317,10,29]:[1900,2,29],o=3;else if(0===i)s=e?[1317,8,29]:[1900,1,0],o=6;else{i>60&&--i;var c=new Date(1900,0,1);c.setDate(c.getDate()+i-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],o=c.getDay(),i<60&&(o=(o+6)%7),e&&(o=function J_(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}(c,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=o,l}var Yl=new Date(1899,11,31,0,0,0),j_=Yl.getTime(),G_=new Date(1900,2,1,0,0,0);function $l(t,r){var e=t.getTime();return r?e-=1262304e5:t>=G_&&(e+=864e5),(e-(j_+6e4*(t.getTimezoneOffset()-Yl.getTimezoneOffset())))/864e5}function Bo(t){return-1==t.indexOf(".")?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ui(t){var e,r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E);return e=r>=-4&&r<=-1?t.toPrecision(10+r):Math.abs(r)<=9?function Y_(t){var r=t<0?12:11,e=Bo(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10)).length<=r?e:t.toExponential(5)}(t):10===r?t.toFixed(10).substr(0,12):function $_(t){var r=Bo(t.toFixed(11));return r.length>(t<0?12:11)||"0"===r||"-0"===r?t.toPrecision(6):r}(t),Bo(function W_(t){return-1==t.indexOf("E")?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(e.toUpperCase()))}function Lr(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(0|t)===t?t.toString(10):Ui(t);case"undefined":return"";case"object":if(null==t)return"";if(t instanceof Date)return un(14,$l(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function Q_(t,r,e,i){var c,a="",o=0,s=0,l=e.y,u=0;switch(t){case 98:l=e.y+543;case 121:switch(r.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4}break;case 109:switch(r.length){case 1:case 2:c=e.m,u=r.length;break;case 3:return Po[e.m-1][1];case 5:return Po[e.m-1][0];default:return Po[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=e.d,u=r.length;break;case 3:return Gl[e.q][0];default:return Gl[e.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(e.H+11)%12,u=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=e.H,u=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=e.M,u=r.length;break;default:throw"bad minute format: "+r}break;case 115:if("s"!=r&&"ss"!=r&&".0"!=r&&".00"!=r&&".000"!=r)throw"bad second format: "+r;return 0!==e.u||"s"!=r&&"ss"!=r?(s=i>=2?3===i?1e3:100:1===i?10:1,(o=Math.round(s*(e.S+e.u)))>=60*s&&(o=0),"s"===r?0===o?"0":""+o/s:(a=Fn(o,2+i),"ss"===r?a.substr(0,2):"."+a.substr(2,r.length-1))):Fn(e.S,r.length);case 90:switch(r){case"[h]":case"[hh]":c=24*e.D+e.H;break;case"[m]":case"[mm]":c=60*(24*e.D+e.H)+e.M;break;case"[s]":case"[ss]":c=60*(60*(24*e.D+e.H)+e.M)+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+r}u=3===r.length?1:2;break;case 101:c=l,u=1}return u>0?Fn(c,u):""}function vr(t){if(t.length<=3)return t;for(var e=t.length%3,i=t.substr(0,e);e!=t.length;e+=3)i+=(i.length>0?",":"")+t.substr(e,3);return i}var Jl=/%/g;function Ql(t,r){var e,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+Ql(t,-r);var a=t.indexOf(".");-1===a&&(a=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%a;if(o<0&&(o+=a),-1===(e=(r/Math.pow(10,o)).toPrecision(i+1+(a+o)%a)).indexOf("e")){var s=Math.floor(Math.log(r)*Math.LOG10E);for(-1===e.indexOf(".")?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+o):e+="E+"+(s-o);"0."===e.substr(0,2);)e=(e=e.charAt(0)+e.substr(2,a)+"."+e.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+o)%a)+"."+d.substr(o)+"E"})}else e=r.toExponential(i);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var ql=/# (\?+)( ?)\/( ?)(\d+)/,Xl=/^#*0*\.([0#]+)/,Kl=/\).*[0#]/,ec=/\(###\) ###\\?-####/;function Jt(t){for(var e,r="",i=0;i!=t.length;++i)switch(e=t.charCodeAt(i)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function tc(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function nc(t,r){var e=t-Math.floor(t),i=Math.pow(10,r);return r<(""+Math.round(e*i)).length?0:Math.round(e*i)}function Cn(t,r,e){if(40===t.charCodeAt(0)&&!r.match(Kl)){var i=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Cn("n",i,e):"("+Cn("n",i,-e)+")"}if(44===r.charCodeAt(r.length-1))return function X_(t,r,e){for(var i=r.length-1;44===r.charCodeAt(i-1);)--i;return Xn(t,r.substr(0,i),e/Math.pow(10,3*(r.length-i)))}(t,r,e);if(-1!==r.indexOf("%"))return function q_(t,r,e){var i=r.replace(Jl,""),a=r.length-i.length;return Xn(t,i,e*Math.pow(10,2*a))+ft("%",a)}(t,r,e);if(-1!==r.indexOf("E"))return Ql(r,e);if(36===r.charCodeAt(0))return"$"+Cn(t,r.substr(" "==r.charAt(1)?2:1),e);var a,o,s,l,c=Math.abs(e),u=e<0?"-":"";if(r.match(/^00+$/))return u+di(c,r.length);if(r.match(/^[#?]+$/))return"0"===(a=di(e,0))&&(a=""),a.length>r.length?a:Jt(r.substr(0,r.length-a.length))+a;if(o=r.match(ql))return function K_(t,r,e){var i=parseInt(t[4],10),a=Math.round(r*i),o=Math.floor(a/i),s=a-o*i,l=i;return e+(0===o?"":""+o)+" "+(0===s?ft(" ",t[1].length+1+t[4].length):Ro(s,t[1].length)+t[2]+"/"+t[3]+Fn(l,t[4].length))}(o,c,u);if(r.match(/^#+0+$/))return u+di(c,r.length-r.indexOf("0"));if(o=r.match(Xl))return a=tc(e,o[1].length).replace(/^([^\.]+)$/,"$1."+Jt(o[1])).replace(/\.$/,"."+Jt(o[1])).replace(/\.(\d*)$/,function(x,h){return"."+h+ft("0",Jt(o[1]).length-h.length)}),-1!==r.indexOf("0.")?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return u+tc(c,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return u+vr(di(c,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Cn(t,r,-e):vr(""+(Math.floor(e)+function t1(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}(e,o[1].length)))+"."+Fn(nc(e,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return Cn(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ui(Cn(t,r.replace(/[\\-]/g,""),e)),s=0,ui(ui(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):"0"===x?"0":""}));if(r.match(ec))return"("+(a=Cn(t,"##########",e)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),l=Pa(c,Math.pow(10,s)-1,!1),a=""+u," "==(d=Xn("n",o[1],l[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),a+=d+o[2]+"/"+o[3],(d=Ma(l[2],s)).length<o[4].length&&(d=Jt(o[4].substr(o[4].length-d.length))+d),a+=d;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),u+((l=Pa(c,Math.pow(10,s)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?Ro(l[1],s)+o[2]+"/"+o[3]+Ma(l[2],s):ft(" ",2*s+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return a=di(e,0),r.length<=a.length?a:Jt(r.substr(0,r.length-a.length))+a;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=r.indexOf(".")-s,p=r.length-a.length-f;return Jt(r.substr(0,f)+a+r.substr(r.length-p))}if(o=r.match(/^00,000\.([#0]*0)$/))return s=nc(e,o[1].length),e<0?"-"+Cn(t,r,-e):vr(function n1(t){return t<2147483647&&t>-2147483648?""+(t>=0?0|t:t-1|0):""+Math.floor(t)}(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Fn(0,3-x.length):"")+x})+"."+Fn(s,o[1].length);switch(r){case"###,##0.00":return Cn(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var m=vr(di(c,0));return"0"!==m?u+m:"";case"###,###.00":return Cn(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Cn(t,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function rc(t,r){var e,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+rc(t,-r);var a=t.indexOf(".");-1===a&&(a=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%a;if(o<0&&(o+=a),!(e=(r/Math.pow(10,o)).toPrecision(i+1+(a+o)%a)).match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);-1===e.indexOf(".")?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+o):e+="E+"+(s-o),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+o)%a)+"."+d.substr(o)+"E"})}else e=r.toExponential(i);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Pn(t,r,e){if(40===t.charCodeAt(0)&&!r.match(Kl)){var i=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Pn("n",i,e):"("+Pn("n",i,-e)+")"}if(44===r.charCodeAt(r.length-1))return function r1(t,r,e){for(var i=r.length-1;44===r.charCodeAt(i-1);)--i;return Xn(t,r.substr(0,i),e/Math.pow(10,3*(r.length-i)))}(t,r,e);if(-1!==r.indexOf("%"))return function a1(t,r,e){var i=r.replace(Jl,""),a=r.length-i.length;return Xn(t,i,e*Math.pow(10,2*a))+ft("%",a)}(t,r,e);if(-1!==r.indexOf("E"))return rc(r,e);if(36===r.charCodeAt(0))return"$"+Pn(t,r.substr(" "==r.charAt(1)?2:1),e);var a,o,s,l,c=Math.abs(e),u=e<0?"-":"";if(r.match(/^00+$/))return u+Fn(c,r.length);if(r.match(/^[#?]+$/))return a=""+e,0===e&&(a=""),a.length>r.length?a:Jt(r.substr(0,r.length-a.length))+a;if(o=r.match(ql))return function e1(t,r,e){return e+(0===r?"":""+r)+ft(" ",t[1].length+2+t[4].length)}(o,c,u);if(r.match(/^#+0+$/))return u+Fn(c,r.length-r.indexOf("0"));if(o=r.match(Xl))return a=(a=(""+e).replace(/^([^\.]+)$/,"$1."+Jt(o[1])).replace(/\.$/,"."+Jt(o[1]))).replace(/\.(\d*)$/,function(x,h){return"."+h+ft("0",Jt(o[1]).length-h.length)}),-1!==r.indexOf("0.")?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return u+vr(""+c);if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Pn(t,r,-e):vr(""+e)+"."+ft("0",o[1].length);if(o=r.match(/^#,#*,#0/))return Pn(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ui(Pn(t,r.replace(/[\\-]/g,""),e)),s=0,ui(ui(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):"0"===x?"0":""}));if(r.match(ec))return"("+(a=Pn(t,"##########",e)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),l=Pa(c,Math.pow(10,s)-1,!1),a=""+u," "==(d=Xn("n",o[1],l[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),a+=d+o[2]+"/"+o[3],(d=Ma(l[2],s)).length<o[4].length&&(d=Jt(o[4].substr(o[4].length-d.length))+d),a+=d;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),u+((l=Pa(c,Math.pow(10,s)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?Ro(l[1],s)+o[2]+"/"+o[3]+Ma(l[2],s):ft(" ",2*s+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return r.length<=(a=""+e).length?a:Jt(r.substr(0,r.length-a.length))+a;if(o=r.match(/^([#0]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=r.indexOf(".")-s,p=r.length-a.length-f;return Jt(r.substr(0,f)+a+r.substr(r.length-p))}if(o=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Pn(t,r,-e):vr(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Fn(0,3-x.length):"")+x})+"."+Fn(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var m=vr(""+c);return"0"!==m?u+m:"";default:if(r.match(/\.[0#?]*$/))return Pn(t,r.slice(0,r.lastIndexOf(".")),e)+Jt(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Xn(t,r,e){return(0|e)===e?Pn(t,r,e):Cn(t,r,e)}var ic=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ur(t){for(var r=0,e="",i="";r<t.length;)switch(e=t.charAt(r)){case"G":Ra(t,r)&&(r+=6),r++;break;case'"':for(;34!==t.charCodeAt(++r)&&r<t.length;);++r;break;case"\\":case"_":r+=2;break;case"@":++r;break;case"B":case"b":if("1"===t.charAt(r+1)||"2"===t.charAt(r+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===t.substr(r,3).toUpperCase()||"AM/PM"===t.substr(r,5).toUpperCase()||"\u4e0a\u5348/\u4e0b\u5348"===t.substr(r,5).toUpperCase())return!0;++r;break;case"[":for(i=e;"]"!==t.charAt(r++)&&r<t.length;)i+=t.charAt(r);if(i.match(ic))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||"\\"==e&&"-"==t.charAt(r+1)&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(" "==t.charAt(r)||"*"==t.charAt(r))&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;default:++r}return!1}var ac=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function oc(t,r){if(null==r)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0}return!1}function un(t,r,e){null==e&&(e={});var i="";switch(typeof t){case"string":i="m/d/yy"==t&&e.dateNF?e.dateNF:t;break;case"number":null==(i=14==t&&e.dateNF?e.dateNF:(null!=e.table?e.table:Se)[t])&&(i=e.table&&e.table[Wl[t]]||Se[Wl[t]]),null==i&&(i=Z_[t]||"General")}if(Ra(i,0))return Lr(r,e);r instanceof Date&&(r=$l(r,e.date1904));var a=function l1(t,r){var e=function o1(t){for(var r=[],e=!1,i=0,a=0;i<t.length;++i)switch(t.charCodeAt(i)){case 34:e=!e;break;case 95:case 42:case 92:++i;break;case 59:r[r.length]=t.substr(a,i-a),a=i+1}if(r[r.length]=t.substr(a),!0===e)throw new Error("Format |"+t+"| unterminated string ");return r}(t),i=e.length,a=e[i-1].indexOf("@");if(i<4&&a>-1&&--i,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if("number"!=typeof r)return[4,4===e.length||a>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=a>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=a>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=a>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"]}var o=r>0?e[0]:r<0?e[1]:e[2];if(-1===e[0].indexOf("[")&&-1===e[1].indexOf("["))return[i,o];if(null!=e[0].match(/\[[=<>]/)||null!=e[1].match(/\[[=<>]/)){var s=e[0].match(ac),l=e[1].match(ac);return oc(r,s)?[i,e[0]]:oc(r,l)?[i,e[1]]:[i,e[null!=s&&null!=l?2:1]]}return[i,o]}(i,r);if(Ra(a[1]))return Lr(r,e);if(!0===r)r="TRUE";else if(!1===r)r="FALSE";else if(""===r||null==r)return"";return function s1(t,r,e,i){for(var u,d,f,a=[],o="",s=0,l="",c="t",p="H";s<t.length;)switch(l=t.charAt(s)){case"G":if(!Ra(t,s))throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(o="";34!==(f=t.charCodeAt(++s))&&s<t.length;)o+=String.fromCharCode(f);a[a.length]={t:"t",v:o},++s;break;case"\\":var m=t.charAt(++s);a[a.length]={t:"("===m||")"===m?m:"t",v:m},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:r},++s;break;case"B":case"b":if("1"===t.charAt(s+1)||"2"===t.charAt(s+1)){if(null==u&&null==(u=xr(r,e,"2"===t.charAt(s+1))))return"";a[a.length]={t:"X",v:t.substr(s,2)},c=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||null==u&&null==(u=xr(r,e)))return"";for(o=l;++s<t.length&&t.charAt(s).toLowerCase()===l;)o+=l;"m"===l&&"h"===c.toLowerCase()&&(l="M"),"h"===l&&(l=p),a[a.length]={t:l,v:o},c=l;break;case"A":case"a":case"\u4e0a":var h={t:l,v:l};if(null==u&&(u=xr(r,e)),"A/P"===t.substr(s,3).toUpperCase()?(null!=u&&(h.v=u.H>=12?"P":"A"),h.t="T",p="h",s+=3):"AM/PM"===t.substr(s,5).toUpperCase()?(null!=u&&(h.v=u.H>=12?"PM":"AM"),h.t="T",s+=5,p="h"):"\u4e0a\u5348/\u4e0b\u5348"===t.substr(s,5).toUpperCase()?(null!=u&&(h.v=u.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),h.t="T",s+=5,p="h"):(h.t="t",++s),null==u&&"T"===h.t)return"";a[a.length]=h,c=l;break;case"[":for(o=l;"]"!==t.charAt(s++)&&s<t.length;)o+=t.charAt(s);if("]"!==o.slice(-1))throw'unterminated "[" block: |'+o+"|";if(o.match(ic)){if(null==u&&null==(u=xr(r,e)))return"";a[a.length]={t:"Z",v:o.toLowerCase()},c=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ur(t)||(a[a.length]={t:"t",v:o}));break;case".":if(null!=u){for(o=l;++s<t.length&&"0"===(l=t.charAt(s));)o+=l;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=l;++s<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(s))>-1;)o+=l;a[a.length]={t:"n",v:o};break;case"?":for(o=l;t.charAt(++s)===l;)o+=l;a[a.length]={t:l,v:o},c=l;break;case"*":++s,(" "==t.charAt(s)||"*"==t.charAt(s))&&++s;break;case"(":case")":a[a.length]={t:1===i?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=l;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;)o+=t.charAt(s);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:l,v:l},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(l))throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"t",v:l},++s}var S,v=0,T=0;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=p,c="h",v<1&&(v=1);break;case"s":(S=a[s].v.match(/\.0+$/))&&(T=Math.max(T,S[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":"s"===c&&(a[s].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[s].v.match(/[Hh]/)&&(v=1),v<2&&a[s].v.match(/[Mm]/)&&(v=2),v<3&&a[s].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M)}var P,y="";for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=Q_(a[s].t.charCodeAt(0),a[s].v,u,T),a[s].t="t";break;case"n":case"?":for(P=s+1;null!=a[P]&&("?"===(l=a[P].t)||"D"===l||(" "===l||"t"===l)&&null!=a[P+1]&&("?"===a[P+1].t||"t"===a[P+1].t&&"/"===a[P+1].v)||"("===a[s].t&&(" "===l||"n"===l||")"===l)||"t"===l&&("/"===a[P].v||" "===a[P].v&&null!=a[P+1]&&"?"==a[P+1].t));)a[s].v+=a[P].v,a[P]={v:"",t:";"},++P;y+=a[s].v,s=P-1;break;case"G":a[s].t="t",a[s].v=Lr(r,e)}var M,I,U="";if(y.length>0){40==y.charCodeAt(0)?(M=r<0&&45===y.charCodeAt(0)?-r:r,I=Xn("n",y,M)):(I=Xn("n",y,M=r<0&&i>1?-r:r),M<0&&a[0]&&"t"==a[0].t&&(I=I.substr(1),a[0].v="-"+a[0].v)),P=I.length-1;var B=a.length;for(s=0;s<a.length;++s)if(null!=a[s]&&"t"!=a[s].t&&a[s].v.indexOf(".")>-1){B=s;break}var R=a.length;if(B===a.length&&-1===I.indexOf("E")){for(s=a.length-1;s>=0;--s)null==a[s]||-1==="n?".indexOf(a[s].t)||(P>=a[s].v.length-1?a[s].v=I.substr(1+(P-=a[s].v.length),a[s].v.length):P<0?a[s].v="":(a[s].v=I.substr(0,P+1),P=-1),a[s].t="t",R=s);P>=0&&R<a.length&&(a[R].v=I.substr(0,P+1)+a[R].v)}else if(B!==a.length&&-1===I.indexOf("E")){for(P=I.indexOf(".")-1,s=B;s>=0;--s)if(null!=a[s]&&-1!=="n?".indexOf(a[s].t)){for(d=a[s].v.indexOf(".")>-1&&s===B?a[s].v.indexOf(".")-1:a[s].v.length-1,U=a[s].v.substr(d+1);d>=0;--d)P>=0&&("0"===a[s].v.charAt(d)||"#"===a[s].v.charAt(d))&&(U=I.charAt(P--)+U);a[s].v=U,a[s].t="t",R=s}for(P>=0&&R<a.length&&(a[R].v=I.substr(0,P+1)+a[R].v),P=I.indexOf(".")+1,s=B;s<a.length;++s)if(null!=a[s]&&(-1!=="n?(".indexOf(a[s].t)||s===B)){for(d=a[s].v.indexOf(".")>-1&&s===B?a[s].v.indexOf(".")+1:0,U=a[s].v.substr(0,d);d<a[s].v.length;++d)P<I.length&&(U+=I.charAt(P++));a[s].v=U,a[s].t="t",R=s}}}for(s=0;s<a.length;++s)null!=a[s]&&"n?".indexOf(a[s].t)>-1&&(a[s].v=Xn(a[s].t,a[s].v,M=i>1&&r<0&&s>0&&"-"===a[s-1].v?-r:r),a[s].t="t");var W="";for(s=0;s!==a.length;++s)null!=a[s]&&(W+=a[s].v);return W}(a[1],r,e,a[0])}function Bn(t,r){if("number"!=typeof r){r=+r||-1;for(var e=0;e<392;++e)if(null!=Se[e]){if(Se[e]==t){r=e;break}}else r<0&&(r=e);r<0&&(r=391)}return Se[r]=t,r}function Hi(t){for(var r=0;392!=r;++r)void 0!==t[r]&&Bn(t[r],r)}function fi(){Se=function V_(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',t}()}var u1={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},sc=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,p1=function(){var t={version:"1.2.0"},e=function r(){for(var I=0,B=new Array(256),R=0;256!=R;++R)B[R]=I=1&(I=1&(I=1&(I=1&(I=1&(I=1&(I=1&(I=1&(I=R)?-306674912^I>>>1:I>>>1)?-306674912^I>>>1:I>>>1)?-306674912^I>>>1:I>>>1)?-306674912^I>>>1:I>>>1)?-306674912^I>>>1:I>>>1)?-306674912^I>>>1:I>>>1)?-306674912^I>>>1:I>>>1)?-306674912^I>>>1:I>>>1;return"undefined"!=typeof Int32Array?new Int32Array(B):B}(),a=function i(I){var B=0,R=0,W=0,J="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(W=0;256!=W;++W)J[W]=I[W];for(W=0;256!=W;++W)for(R=I[W],B=256+W;B<4096;B+=256)R=J[B]=R>>>8^I[255&R];var L=[];for(W=1;16!=W;++W)L[W-1]="undefined"!=typeof Int32Array?J.subarray(256*W,256*W+256):J.slice(256*W,256*W+256);return L}(e),o=a[0],s=a[1],l=a[2],c=a[3],u=a[4],d=a[5],f=a[6],p=a[7],m=a[8],x=a[9],h=a[10],v=a[11],T=a[12],S=a[13],y=a[14];return t.table=e,t.bstr=function P(I,B){for(var R=-1^B,W=0,J=I.length;W<J;)R=R>>>8^e[255&(R^I.charCodeAt(W++))];return~R},t.buf=function U(I,B){for(var R=-1^B,W=I.length-15,J=0;J<W;)R=y[I[J++]^255&R]^S[I[J++]^R>>8&255]^T[I[J++]^R>>16&255]^v[I[J++]^R>>>24]^h[I[J++]]^x[I[J++]]^m[I[J++]]^p[I[J++]]^f[I[J++]]^d[I[J++]]^u[I[J++]]^c[I[J++]]^l[I[J++]]^s[I[J++]]^o[I[J++]]^e[I[J++]];for(W+=15;J<W;)R=R>>>8^e[255&(R^I[J++])];return~R},t.str=function M(I,B){for(var R=-1^B,W=0,J=I.length,L=0,le=0;W<J;)(L=I.charCodeAt(W++))<128?R=R>>>8^e[255&(R^L)]:L<2048?R=(R=R>>>8^e[255&(R^(192|L>>6&31))])>>>8^e[255&(R^(128|63&L))]:L>=55296&&L<57344?(L=64+(1023&L),le=1023&I.charCodeAt(W++),R=(R=(R=(R=R>>>8^e[255&(R^(240|L>>8&7))])>>>8^e[255&(R^(128|L>>2&63))])>>>8^e[255&(R^(128|le>>6&15|(3&L)<<4))])>>>8^e[255&(R^(128|63&le))]):R=(R=(R=R>>>8^e[255&(R^(224|L>>12&15))])>>>8^e[255&(R^(128|L>>6&63))])>>>8^e[255&(R^(128|63&L))];return~R},t}(),ke=function(){var c,r={};function i(C){if("/"==C.charAt(C.length-1))return-1===C.slice(0,-1).indexOf("/")?C:i(C.slice(0,-1));var b=C.lastIndexOf("/");return-1===b?C:C.slice(0,b+1)}function a(C){if("/"==C.charAt(C.length-1))return a(C.slice(0,-1));var b=C.lastIndexOf("/");return-1===b?C:C.slice(b+1)}function o(C,b){"string"==typeof b&&(b=new Date(b));var w=b.getHours();w=(w=w<<6|b.getMinutes())<<5|b.getSeconds()>>>1,C.write_shift(2,w);var k=b.getFullYear()-1980;k=(k=k<<4|b.getMonth()+1)<<5|b.getDate(),C.write_shift(2,k)}function l(C){Rt(C,0);for(var b={},w=0;C.l<=C.length-4;){var k=C.read_shift(2),z=C.read_shift(2),O=C.l+z,H={};21589===k&&(1&(w=C.read_shift(1))&&(H.mtime=C.read_shift(4)),z>5&&(2&w&&(H.atime=C.read_shift(4)),4&w&&(H.ctime=C.read_shift(4))),H.mtime&&(H.mt=new Date(1e3*H.mtime))),C.l=O,b[k]=H}return b}function u(){return c||(c={})}function d(C,b){if(80==C[0]&&75==C[1])return Td(C,b);if(109==(32|C[0])&&105==(32|C[1]))return function TE(C,b){if("mime-version:"!=me(C.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var w=b&&b.root||"",k=(Pe&&Buffer.isBuffer(C)?C.toString("binary"):me(C)).split("\r\n"),z=0,O="";for(z=0;z<k.length;++z)if(/^Content-Location:/i.test(O=k[z])&&(O=O.slice(O.indexOf("file")),w||(w=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,w.length)!=w))for(;w.length>0&&(w=(w=w.slice(0,w.length-1)).slice(0,w.lastIndexOf("/")+1),O.slice(0,w.length)!=w););var H=(k[1]||"").match(/boundary="(.*?)"/);if(!H)throw new Error("MAD cannot find boundary");var q="--"+(H[1]||""),G={FileIndex:[],FullPaths:[]};I(G);var re,de=0;for(z=0;z<k.length;++z){var ye=k[z];ye!==q&&ye!==q+"--"||(de++&&wE(G,k.slice(re,z),w),re=z)}return G}(C,b);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var w,z,O,H,q,j,k=512,V=[],G=C.slice(0,512);Rt(G,0);var re=function f(C){if(80==C[C.l]&&75==C[C.l+1])return[0,0];C.chk(xe,"Header Signature: "),C.l+=16;var b=C.read_shift(2,"u");return[C.read_shift(2,"u"),b]}(G);switch(w=re[0]){case 3:k=512;break;case 4:k=4096;break;case 0:if(0==re[1])return Td(C,b);default:throw new Error("Major Version: Expected 3 or 4 saw "+w)}512!==k&&Rt(G=C.slice(0,k),28);var de=C.slice(0,k);!function p(C,b){var w;switch(C.l+=2,w=C.read_shift(2)){case 9:if(3!=b)throw new Error("Sector Shift: Expected 9 saw "+w);break;case 12:if(4!=b)throw new Error("Sector Shift: Expected 12 saw "+w);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+w)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}(G,w);var ye=G.read_shift(4,"i");if(3===w&&0!==ye)throw new Error("# Directory Sectors: Expected 0 saw "+ye);G.l+=4,H=G.read_shift(4,"i"),G.l+=4,G.chk("00100000","Mini Stream Cutoff Size: "),q=G.read_shift(4,"i"),z=G.read_shift(4,"i"),j=G.read_shift(4,"i"),O=G.read_shift(4,"i");for(var fe=-1,he=0;he<109&&!((fe=G.read_shift(4,"i"))<0);++he)V[he]=fe;var Fe=function m(C,b){for(var w=Math.ceil(C.length/b)-1,k=[],z=1;z<w;++z)k[z-1]=C.slice(z*b,(z+1)*b);return k[w-1]=C.slice(w*b),k}(C,k);v(j,O,Fe,k,V);var st=function S(C,b,w,k){var z=C.length,O=[],H=[],q=[],j=[],V=k-1,G=0,re=0,de=0,ye=0;for(G=0;G<z;++G)if(q=[],(de=G+b)>=z&&(de-=z),!H[de]){j=[];var fe=[];for(re=de;re>=0;){fe[re]=!0,H[re]=!0,q[q.length]=re,j.push(C[re]);var he=w[Math.floor(4*re/k)];if(k<4+(ye=4*re&V))throw new Error("FAT boundary crossed: "+re+" 4 "+k);if(!C[he]||fe[re=Vr(C[he],ye)])break}O[de]={nodes:q,data:Oc([j])}}return O}(Fe,H,V,k);st[H].name="!Directory",z>0&&q!==le&&(st[q].name="!MiniFAT"),st[V[0]].name="!FAT",st.fat_addrs=V,st.ssz=k;var Tt=[],hn=[],xa=[];(function y(C,b,w,k,z,O,H,q){for(var ye,j=0,V=k.length?2:0,G=b[C].data,re=0,de=0;re<G.length;re+=128){var fe=G.slice(re,re+128);Rt(fe,64),de=fe.read_shift(2),ye=Za(fe,0,de-V),k.push(ye);var he={name:ye,type:fe.read_shift(1),color:fe.read_shift(1),L:fe.read_shift(4,"i"),R:fe.read_shift(4,"i"),C:fe.read_shift(4,"i"),clsid:fe.read_shift(16),state:fe.read_shift(4,"i"),start:0,size:0};0!==fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)&&(he.ct=P(fe,fe.l-8)),0!==fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)&&(he.mt=P(fe,fe.l-8)),he.start=fe.read_shift(4,"i"),he.size=fe.read_shift(4,"i"),he.size<0&&he.start<0&&(he.size=he.type=0,he.start=le,he.name=""),5===he.type?(j=he.start,z>0&&j!==le&&(b[j].name="!StreamData")):he.size>=4096?(he.storage="fat",void 0===b[he.start]&&(b[he.start]=T(w,he.start,b.fat_addrs,b.ssz)),b[he.start].name=he.name,he.content=b[he.start].data.slice(0,he.size)):(he.storage="minifat",he.size<0?he.size=0:j!==le&&he.start!==le&&b[j]&&(he.content=h(he,b[j].data,(b[q]||{}).data))),he.content&&Rt(he.content,0),O[ye]=he,H.push(he)}})(H,st,Fe,Tt,z,{},hn,q),function x(C,b,w){for(var k=0,z=0,O=0,H=0,q=0,j=w.length,V=[],G=[];k<j;++k)V[k]=G[k]=k,b[k]=w[k];for(;q<G.length;++q)z=C[k=G[q]].L,O=C[k].R,H=C[k].C,V[k]===k&&(-1!==z&&V[z]!==z&&(V[k]=V[z]),-1!==O&&V[O]!==O&&(V[k]=V[O])),-1!==H&&(V[H]=k),-1!==z&&k!=V[k]&&(V[z]=V[k],G.lastIndexOf(z)<q&&G.push(z)),-1!==O&&k!=V[k]&&(V[O]=V[k],G.lastIndexOf(O)<q&&G.push(O));for(k=1;k<j;++k)V[k]===k&&(-1!==O&&V[O]!==O?V[k]=V[O]:-1!==z&&V[z]!==z&&(V[k]=V[z]));for(k=1;k<j;++k)if(0!==C[k].type){if((q=k)!=V[q])do{b[k]=b[q=V[q]]+"/"+b[k]}while(0!==q&&-1!==V[q]&&q!=V[q]);V[k]=-1}for(b[0]+="/",k=1;k<j;++k)2!==C[k].type&&(b[k]+="/")}(hn,xa,Tt),Tt.shift();var va={FileIndex:hn,FullPaths:xa};return b&&b.raw&&(va.raw={header:de,sectors:Fe}),va}function h(C,b,w){for(var z=C.size,O=[],H=C.start;w&&z>0&&H>=0;)O.push(b.slice(H*L,H*L+L)),z-=L,H=Vr(w,4*H);return 0===O.length?Q(0):Ot(O).slice(0,C.size)}function v(C,b,w,k,z){var O=le;if(C===le){if(0!==b)throw new Error("DIFAT chain shorter than expected")}else if(-1!==C){var H=w[C],q=(k>>>2)-1;if(!H)return;for(var j=0;j<q&&(O=Vr(H,4*j))!==le;++j)z.push(O);v(Vr(H,k-4),b-1,w,k,z)}}function T(C,b,w,k,z){var O=[],H=[];z||(z=[]);var q=k-1,j=0,V=0;for(j=b;j>=0;){z[j]=!0,O[O.length]=j,H.push(C[j]);var G=w[Math.floor(4*j/k)];if(k<4+(V=4*j&q))throw new Error("FAT boundary crossed: "+j+" 4 "+k);if(!C[G])break;j=Vr(C[G],V)}return{nodes:O,data:Oc([H])}}function P(C,b){return new Date(1e3*(Et(C,b+4)/1e7*Math.pow(2,32)+Et(C,b)/1e7-11644473600))}function I(C,b){var w=b||{},k=w.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");0===C.FullPaths.length&&(C.FullPaths[0]=k+"/",C.FileIndex[0]={name:k,type:5}),w.CLSID&&(C.FileIndex[0].clsid=w.CLSID),function B(C){var b="\x01Sh33tJ5";if(!ke.find(C,"/"+b)){var w=Q(4);w[0]=55,w[1]=w[3]=50,w[2]=54,C.FileIndex.push({name:b,type:2,content:w,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+b),R(C)}}(C)}function R(C,b){I(C);for(var w=!1,k=!1,z=C.FullPaths.length-1;z>=0;--z){var O=C.FileIndex[z];switch(O.type){case 0:k?w=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:k=!0,isNaN(O.R*O.L*O.C)&&(w=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(w=!0);break;default:w=!0}}if(w||b){var H=new Date(1987,1,19),q=0,j=Object.create?Object.create(null):{},V=[];for(z=0;z<C.FullPaths.length;++z)j[C.FullPaths[z]]=!0,0!==C.FileIndex[z].type&&V.push([C.FullPaths[z],C.FileIndex[z]]);for(z=0;z<V.length;++z){var G=i(V[z][0]);(k=j[G])||(V.push([G,{name:a(G).replace("/",""),type:1,clsid:Te,ct:H,mt:H,content:null}]),j[G]=!0)}for(V.sort(function(ye,fe){return function e(C,b){for(var w=C.split("/"),k=b.split("/"),z=0,O=0,H=Math.min(w.length,k.length);z<H;++z){if(O=w[z].length-k[z].length)return O;if(w[z]!=k[z])return w[z]<k[z]?-1:1}return w.length-k.length}(ye[0],fe[0])}),C.FullPaths=[],C.FileIndex=[],z=0;z<V.length;++z)C.FullPaths[z]=V[z][0],C.FileIndex[z]=V[z][1];for(z=0;z<V.length;++z){var re=C.FileIndex[z],de=C.FullPaths[z];if(re.name=a(de).replace("/",""),re.L=re.R=re.C=-(re.color=1),re.size=re.content?re.content.length:0,re.start=0,re.clsid=re.clsid||Te,0===z)re.C=V.length>1?1:-1,re.size=0,re.type=5;else if("/"==de.slice(-1)){for(q=z+1;q<V.length&&i(C.FullPaths[q])!=de;++q);for(re.C=q>=V.length?-1:q,q=z+1;q<V.length&&i(C.FullPaths[q])!=i(de);++q);re.R=q>=V.length?-1:q,re.type=1}else i(C.FullPaths[z+1]||"")==i(de)&&(re.R=z+1),re.type=2}}}function W(C,b){var w=b||{};if("mad"==w.fileType)return function kE(C,b){for(var w=b||{},k=w.boundary||"SheetJS",z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(k="------="+k).slice(2)+'"',"","",""],O=C.FullPaths[0],H=O,q=C.FileIndex[0],j=1;j<C.FullPaths.length;++j)if(H=C.FullPaths[j].slice(O.length),(q=C.FileIndex[j]).size&&q.content&&"\x01Sh33tJ5"!=H){H=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Fe){return"_x"+Fe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Fe){return"_u"+Fe.charCodeAt(0).toString(16)+"_"});for(var V=q.content,G=Pe&&Buffer.isBuffer(V)?V.toString("binary"):me(V),re=0,de=Math.min(1024,G.length),ye=0,fe=0;fe<=de;++fe)(ye=G.charCodeAt(fe))>=32&&ye<128&&++re;var he=re>=4*de/5;z.push(k),z.push("Content-Location: "+(w.root||"file:///C:/SheetJS/")+H),z.push("Content-Transfer-Encoding: "+(he?"quoted-printable":"base64")),z.push("Content-Type: "+xE(q,H)),z.push(""),z.push(he?CE(G):vE(G))}return z.push(k+"--\r\n"),z.join("\r\n")}(C,w);if("zip"===(R(C),w.fileType))return function _E(C,b){var w=b||{},k=[],z=[],O=Q(1),H=w.compression?8:0,V=0,G=0,re=0,de=0,ye=C.FullPaths[0],fe=ye,he=C.FileIndex[0],Fe=[],st=0;for(V=1;V<C.FullPaths.length;++V)if(fe=C.FullPaths[V].slice(ye.length),(he=C.FileIndex[V]).size&&he.content&&"\x01Sh33tJ5"!=fe){var an=re,Tt=Q(fe.length);for(G=0;G<fe.length;++G)Tt.write_shift(1,127&fe.charCodeAt(G));Tt=Tt.slice(0,Tt.l),Fe[de]=p1.buf(he.content,0);var hn=he.content;8==H&&(hn=N(hn)),(O=Q(30)).write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,0),O.write_shift(2,H),he.mt?o(O,he.mt):O.write_shift(4,0),O.write_shift(-4,Fe[de]),O.write_shift(4,hn.length),O.write_shift(4,he.content.length),O.write_shift(2,Tt.length),O.write_shift(2,0),re+=O.length,k.push(O),re+=Tt.length,k.push(Tt),re+=hn.length,k.push(hn),(O=Q(46)).write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,0),O.write_shift(2,H),O.write_shift(4,0),O.write_shift(-4,Fe[de]),O.write_shift(4,hn.length),O.write_shift(4,he.content.length),O.write_shift(2,Tt.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,an),st+=O.l,z.push(O),st+=Tt.length,z.push(Tt),++de}return(O=Q(22)).write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,de),O.write_shift(2,de),O.write_shift(4,st),O.write_shift(4,re),O.write_shift(2,0),Ot([Ot(k),Ot(z),O])}(C,w);var k=function(ye){for(var fe=0,he=0,Fe=0;Fe<ye.FileIndex.length;++Fe){var st=ye.FileIndex[Fe];if(st.content){var an=st.content.length;an>0&&(an<4096?fe+=an+63>>6:he+=an+511>>9)}}for(var Tt=ye.FullPaths.length+3>>2,xa=fe+127>>7,va=(fe+7>>3)+he+Tt+xa,ai=va+127>>7,sl=ai<=109?0:Math.ceil((ai-109)/127);va+ai+sl+127>>7>ai;)sl=++ai<=109?0:Math.ceil((ai-109)/127);var lr=[1,sl,ai,xa,Tt,he,fe,0];return ye.FileIndex[0].size=fe<<6,lr[7]=(ye.FileIndex[0].start=lr[0]+lr[1]+lr[2]+lr[3]+lr[4]+lr[5])+(lr[6]+7>>3),lr}(C),z=Q(k[7]<<9),O=0,H=0;for(O=0;O<8;++O)z.write_shift(1,ce[O]);for(O=0;O<8;++O)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),O=0;O<3;++O)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,k[2]),z.write_shift(4,k[0]+k[1]+k[2]+k[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,k[3]?k[0]+k[1]+k[2]-1:le),z.write_shift(4,k[3]),z.write_shift(-4,k[1]?k[0]-1:le),z.write_shift(4,k[1]),O=0;O<109;++O)z.write_shift(-4,O<k[2]?k[1]+O:-1);if(k[1])for(H=0;H<k[1];++H){for(;O<236+127*H;++O)z.write_shift(-4,O<k[2]?k[1]+O:-1);z.write_shift(-4,H===k[1]-1?le:H+1)}var q=function(ye){for(H+=ye;O<H-1;++O)z.write_shift(-4,O+1);ye&&(++O,z.write_shift(-4,le))};for(H=O=0,H+=k[1];O<H;++O)z.write_shift(-4,Ce.DIFSECT);for(H+=k[2];O<H;++O)z.write_shift(-4,Ce.FATSECT);q(k[3]),q(k[4]);for(var j=0,V=0,G=C.FileIndex[0];j<C.FileIndex.length;++j)(G=C.FileIndex[j]).content&&!((V=G.content.length)<4096)&&(G.start=H,q(V+511>>9));for(q(k[6]+7>>3);511&z.l;)z.write_shift(-4,Ce.ENDOFCHAIN);for(H=O=0,j=0;j<C.FileIndex.length;++j)(G=C.FileIndex[j]).content&&(V=G.content.length)&&!(V>=4096)&&(G.start=H,q(V+63>>6));for(;511&z.l;)z.write_shift(-4,Ce.ENDOFCHAIN);for(O=0;O<k[4]<<2;++O){var re=C.FullPaths[O];if(re&&0!==re.length){G=C.FileIndex[O],0===O&&(G.start=G.size?G.start-1:le);var de=0===O&&w.root||G.name;if(V=2*(de.length+1),z.write_shift(64,de,"utf16le"),z.write_shift(2,V),z.write_shift(1,G.type),z.write_shift(1,G.color),z.write_shift(-4,G.L),z.write_shift(-4,G.R),z.write_shift(-4,G.C),G.clsid)z.write_shift(16,G.clsid,"hex");else for(j=0;j<4;++j)z.write_shift(4,0);z.write_shift(4,G.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,G.start),z.write_shift(4,G.size),z.write_shift(4,0)}else{for(j=0;j<17;++j)z.write_shift(4,0);for(j=0;j<3;++j)z.write_shift(4,-1);for(j=0;j<12;++j)z.write_shift(4,0)}}for(O=1;O<C.FileIndex.length;++O)if((G=C.FileIndex[O]).size>=4096)if(z.l=G.start+1<<9,Pe&&Buffer.isBuffer(G.content))G.content.copy(z,z.l,0,G.size),z.l+=G.size+511&-512;else{for(j=0;j<G.size;++j)z.write_shift(1,G.content[j]);for(;511&j;++j)z.write_shift(1,0)}for(O=1;O<C.FileIndex.length;++O)if((G=C.FileIndex[O]).size>0&&G.size<4096)if(Pe&&Buffer.isBuffer(G.content))G.content.copy(z,z.l,0,G.size),z.l+=G.size+63&-64;else{for(j=0;j<G.size;++j)z.write_shift(1,G.content[j]);for(;63&j;++j)z.write_shift(1,0)}if(Pe)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}r.version="1.2.1";var ee,L=64,le=-2,xe="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],Te="00000000000000000000000000000000",Ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:le,FREESECT:-1,HEADER_SIGNATURE:xe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function me(C){for(var b=new Array(C.length),w=0;w<C.length;++w)b[w]=String.fromCharCode(C[w]);return b.join("")}function N(C){return ee?ee.deflateRawSync(C):Le(C)}for(var C,b,A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ae="undefined"!=typeof Uint8Array,te=ae?new Uint8Array(256):[],Ne=0;Ne<256;++Ne)te[Ne]=(void 0,255&((b=139536&((C=Ne)<<1|C<<11)|558144&(C<<5|C<<15))>>16|b>>8|b));function E(C,b){var w=te[255&C];return b<=8?w>>>8-b:(w=w<<8|te[C>>8&255],b<=16?w>>>16-b:(w=w<<8|te[C>>16&255])>>>24-b)}function Qe(C,b){var w=7&b,k=b>>>3;return(C[k]|(w<=6?0:C[k+1]<<8))>>>w&3}function Ue(C,b){var w=7&b,k=b>>>3;return(C[k]|(w<=5?0:C[k+1]<<8))>>>w&7}function He(C,b){var w=7&b,k=b>>>3;return(C[k]|(w<=3?0:C[k+1]<<8))>>>w&31}function ge(C,b){var w=7&b,k=b>>>3;return(C[k]|(w<=1?0:C[k+1]<<8))>>>w&127}function _t(C,b,w){var k=7&b,z=b>>>3,H=C[z]>>>k;return w<8-k||(H|=C[z+1]<<8-k,w<16-k)||(H|=C[z+2]<<16-k,w<24-k)||(H|=C[z+3]<<24-k),H&(1<<w)-1}function In(C,b,w){var k=7&b,z=b>>>3;return k<=5?C[z]|=(7&w)<<k:(C[z]|=w<<k&255,C[z+1]=(7&w)>>8-k),b+3}function Gn(C,b,w){return C[b>>>3]|=w=(1&w)<<(7&b),b+1}function or(C,b,w){var z=b>>>3;return C[z]|=255&(w<<=7&b),C[z+1]=w>>>=8,b+8}function ga(C,b,w){var z=b>>>3;return C[z]|=255&(w<<=7&b),C[z+1]=255&(w>>>=8),C[z+2]=w>>>8,b+16}function Or(C,b){var w=C.length,k=2*w>b?2*w:b+5,z=0;if(w>=b)return C;if(Pe){var O=Zl(k);if(C.copy)C.copy(O);else for(;z<C.length;++z)O[z]=C[z];return O}if(ae){var H=new Uint8Array(k);if(H.set)H.set(C);else for(;z<w;++z)H[z]=C[z];return H}return C.length=k,C}function pn(C){for(var b=new Array(C),w=0;w<C;++w)b[w]=0;return b}function sr(C,b,w){var k=1,z=0,O=0,H=0,q=0,j=C.length,V=ae?new Uint16Array(32):pn(32);for(O=0;O<32;++O)V[O]=0;for(O=j;O<w;++O)C[O]=0;j=C.length;var G=ae?new Uint16Array(j):pn(j);for(O=0;O<j;++O)V[z=C[O]]++,k<z&&(k=z),G[O]=0;for(V[0]=0,O=1;O<=k;++O)V[O+16]=q=q+V[O-1]<<1;for(O=0;O<j;++O)0!=(q=C[O])&&(G[O]=V[q+16]++);var re=0;for(O=0;O<j;++O)if(0!=(re=C[O]))for(q=E(G[O],k)>>k-re,H=(1<<k+4-re)-1;H>=0;--H)b[q|H<<re]=15&re|O<<4;return k}var Er=ae?new Uint16Array(512):pn(512),_a=ae?new Uint16Array(32):pn(32);if(!ae){for(var Kt=0;Kt<512;++Kt)Er[Kt]=0;for(Kt=0;Kt<32;++Kt)_a[Kt]=0}!function(){for(var C=[],b=0;b<32;b++)C.push(5);sr(C,_a,32);var w=[];for(b=0;b<=143;b++)w.push(8);for(;b<=255;b++)w.push(9);for(;b<=279;b++)w.push(7);for(;b<=287;b++)w.push(8);sr(w,Er,288)}();var Wn=function(){for(var b=ae?new Uint8Array(32768):[],w=0,k=0;w<pe.length-1;++w)for(;k<pe[w+1];++k)b[k]=w;for(;k<32768;++k)b[k]=29;var z=ae?new Uint8Array(259):[];for(w=0,k=0;w<X.length-1;++w)for(;k<X[w+1];++k)z[k]=w;return function(j,V){return j.length<8?function O(q,j){for(var V=0;V<q.length;){var G=Math.min(65535,q.length-V);for(j.write_shift(1,+(V+G==q.length)),j.write_shift(2,G),j.write_shift(2,65535&~G);G-- >0;)j[j.l++]=q[V++]}return j.l}(j,V):function H(q,j){for(var V=0,G=0,re=ae?new Uint16Array(32768):[];G<q.length;){var de=Math.min(65535,q.length-G);if(de<10){for(7&(V=In(j,V,+(G+de==q.length)))&&(V+=8-(7&V)),j.l=V/8|0,j.write_shift(2,de),j.write_shift(2,65535&~de);de-- >0;)j[j.l++]=q[G++];V=8*j.l}else{V=In(j,V,+(G+de==q.length)+2);for(var ye=0;de-- >0;){var fe=q[G],he=-1,Fe=0;if((he=re[ye=32767&(ye<<5^fe)])&&((he|=-32768&G)>G&&(he-=32768),he<G))for(;q[he+Fe]==q[G+Fe]&&Fe<250;)++Fe;if(Fe>2){(fe=z[Fe])<=22?V=or(j,V,te[fe+1]>>1)-1:(or(j,V,3),or(j,V+=5,te[fe-23]>>5),V+=3);var st=fe<8?0:fe-4>>2;st>0&&(ga(j,V,Fe-X[fe]),V+=st),V=or(j,V,te[fe=b[G-he]]>>3),V-=3;var an=fe<4?0:fe-2>>1;an>0&&(ga(j,V,G-he-pe[fe]),V+=an);for(var Tt=0;Tt<Fe;++Tt)re[ye]=32767&G,ye=32767&(ye<<5^q[G]),++G;de-=Fe-1}else fe<=143?fe+=48:V=Gn(j,V,1),V=or(j,V,te[fe]),re[ye]=32767&G,++G}V=or(j,V,0)-1}}return j.l=(V+7)/8|0,j.l}(j,V)}}();function Le(C){var b=Q(50+Math.floor(1.1*C.length)),w=Wn(C,b);return b.slice(0,w)}var xt=ae?new Uint16Array(32768):pn(32768),On=ae?new Uint16Array(32768):pn(32768),St=ae?new Uint16Array(128):pn(128),ii=1,Cd=1;function hE(C,b){var w=He(C,b)+257,k=He(C,b+=5)+1,z=function qe(C,b){var w=7&b,k=b>>>3;return(C[k]|(w<=4?0:C[k+1]<<8))>>>w&15}(C,b+=5)+4;b+=4;for(var O=0,H=ae?new Uint8Array(19):pn(19),q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],j=1,V=ae?new Uint8Array(8):pn(8),G=ae?new Uint8Array(8):pn(8),re=H.length,de=0;de<z;++de)H[A[de]]=O=Ue(C,b),j<O&&(j=O),V[O]++,b+=3;var ye=0;for(V[0]=0,de=1;de<=j;++de)G[de]=ye=ye+V[de-1]<<1;for(de=0;de<re;++de)0!=(ye=H[de])&&(q[de]=G[ye]++);var fe=0;for(de=0;de<re;++de)if(0!=(fe=H[de])){ye=te[q[de]]>>8-fe;for(var he=(1<<7-fe)-1;he>=0;--he)St[ye|he<<fe]=7&fe|de<<3}var Fe=[];for(j=1;Fe.length<w+k;)switch(ye=St[ge(C,b)],b+=7&ye,ye>>>=3){case 16:for(O=3+Qe(C,b),b+=2,ye=Fe[Fe.length-1];O-- >0;)Fe.push(ye);break;case 17:for(O=3+Ue(C,b),b+=3;O-- >0;)Fe.push(0);break;case 18:for(O=11+ge(C,b),b+=7;O-- >0;)Fe.push(0);break;default:Fe.push(ye),j<ye&&(j=ye)}var st=Fe.slice(0,w),an=Fe.slice(w);for(de=w;de<286;++de)st[de]=0;for(de=k;de<30;++de)an[de]=0;return ii=sr(st,xt,286),Cd=sr(an,On,30),b}function yd(C,b){var k=function mE(C,b){if(3==C[0]&&!(3&C[1]))return[gr(b),2];for(var w=0,k=0,z=Zl(b||1<<18),O=0,H=z.length>>>0,q=0,j=0;0==(1&k);)if(k=Ue(C,w),w+=3,k>>>1!=0)for(k>>1==1?(q=9,j=5):(w=hE(C,w),q=ii,j=Cd);;){!b&&H<O+32767&&(H=(z=Or(z,O+32767)).length);var G=_t(C,w,q),re=k>>>1==1?Er[G]:xt[G];if(w+=15&re,0==((re>>>=4)>>>8&255))z[O++]=re;else{if(256==re)break;var de=(re-=257)<8?0:re-4>>2;de>5&&(de=0);var ye=O+X[re];de>0&&(ye+=_t(C,w,de),w+=de),G=_t(C,w,j),w+=15&(re=k>>>1==1?_a[G]:On[G]);var fe=(re>>>=4)<4?0:re-2>>1,he=pe[re];for(fe>0&&(he+=_t(C,w,fe),w+=fe),!b&&H<ye&&(H=(z=Or(z,ye+100)).length);O<ye;)z[O]=z[O-he],++O}}else{7&w&&(w+=8-(7&w));var V=C[w>>>3]|C[1+(w>>>3)]<<8;if(w+=32,V>0)for(!b&&H<O+V&&(H=(z=Or(z,O+V)).length);V-- >0;)z[O++]=C[w>>>3],w+=8}return b?[z,w+7>>>3]:[z.slice(0,O),w+7>>>3]}(C.slice(C.l||0),b);return C.l+=k[1],k[0]}function wd(C,b){if(!C)throw new Error(b);"undefined"!=typeof console&&console.error(b)}function Td(C,b){var w=C;Rt(w,0);var O={FileIndex:[],FullPaths:[]};I(O,{root:b.root});for(var H=w.length-4;(80!=w[H]||75!=w[H+1]||5!=w[H+2]||6!=w[H+3])&&H>=0;)--H;w.l=H+4,w.l+=4;var q=w.read_shift(2);w.l+=6;var j=w.read_shift(4);for(w.l=j,H=0;H<q;++H){w.l+=20;var V=w.read_shift(4),G=w.read_shift(4),re=w.read_shift(2),de=w.read_shift(2),ye=w.read_shift(2);w.l+=8;var fe=w.read_shift(4),he=l(w.slice(w.l+re,w.l+re+de));w.l+=re+de+ye;var Fe=w.l;w.l=fe+4,gE(w,V,G,O,he),w.l=Fe}return O}function gE(C,b,w,k,z){C.l+=2;var O=C.read_shift(2),H=C.read_shift(2),q=function s(C){var b=65535&C.read_shift(2),w=65535&C.read_shift(2),k=new Date,z=31&w,O=15&(w>>>=5);w>>>=4,k.setMilliseconds(0),k.setFullYear(w+1980),k.setMonth(O-1),k.setDate(z);var H=31&b,q=63&(b>>>=5);return k.setHours(b>>>=6),k.setMinutes(q),k.setSeconds(H<<1),k}(C);if(8257&O)throw new Error("Unsupported ZIP encryption");C.read_shift(4);for(var V=C.read_shift(4),G=C.read_shift(4),re=C.read_shift(2),de=C.read_shift(2),ye="",fe=0;fe<re;++fe)ye+=String.fromCharCode(C[C.l++]);if(de){var he=l(C.slice(C.l,C.l+de));(he[21589]||{}).mt&&(q=he[21589].mt),((z||{})[21589]||{}).mt&&(q=z[21589].mt)}C.l+=de;var Fe=C.slice(C.l,C.l+V);switch(H){case 8:Fe=function Z(C,b){if(!ee)return yd(C,b);var k=new(0,ee.InflateRaw),z=k._processChunk(C.slice(C.l),k._finishFlushFlag);return C.l+=k.bytesRead,z}(C,G);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+H)}var st=!1;8&O&&(134695760==C.read_shift(4)&&(C.read_shift(4),st=!0),V=C.read_shift(4),G=C.read_shift(4)),V!=b&&wd(st,"Bad compressed size: "+b+" != "+V),G!=w&&wd(st,"Bad uncompressed size: "+w+" != "+G),ol(k,ye,Fe,{unsafe:!0,mt:q})}var Co={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function xE(C,b){if(C.ctype)return C.ctype;var w=C.name||"",k=w.match(/\.([^\.]+)$/);return k&&Co[k[1]]||b&&(k=(w=b).match(/[\.\\]([^\.\\])+$/))&&Co[k[1]]?Co[k[1]]:"application/octet-stream"}function vE(C){for(var b=Pi(C),w=[],k=0;k<b.length;k+=76)w.push(b.slice(k,k+76));return w.join("\r\n")+"\r\n"}function CE(C){var b=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(V){var G=V.charCodeAt(0).toString(16).toUpperCase();return"="+(1==G.length?"0"+G:G)});"\n"==(b=b.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(b="=0D"+b.slice(1));for(var w=[],k=(b=b.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),z=0;z<k.length;++z){var O=k[z];if(0!=O.length)for(var H=0;H<O.length;){var q=76,j=O.slice(H,H+q);"="==j.charAt(q-1)?q--:"="==j.charAt(q-2)?q-=2:"="==j.charAt(q-3)&&(q-=3),j=O.slice(H,H+q),(H+=q)<O.length&&(j+="="),w.push(j)}else w.push("")}return w.join("\r\n")}function wE(C,b,w){for(var H,k="",z="",O="",q=0;q<10;++q){var j=b[q];if(!j||j.match(/^\s*$/))break;var V=j.match(/^(.*?):\s*([^\s].*)$/);if(V)switch(V[1].toLowerCase()){case"content-location":k=V[2].trim();break;case"content-type":O=V[2].trim();break;case"content-transfer-encoding":z=V[2].trim()}}switch(++q,z.toLowerCase()){case"base64":H=cn(ln(b.slice(q).join("")));break;case"quoted-printable":H=function yE(C){for(var b=[],w=0;w<C.length;++w){for(var k=C[w];w<=C.length&&"="==k.charAt(k.length-1);)k=k.slice(0,k.length-1)+C[++w];b.push(k)}for(var z=0;z<b.length;++z)b[z]=b[z].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return cn(b.join("\r\n"))}(b.slice(q));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var G=ol(C,k.slice(w.length),H,{unsafe:!0});O&&(G.ctype=O)}function ol(C,b,w,k){var z=k&&k.unsafe;z||I(C);var O=!z&&ke.find(C,b);if(!O){var H=C.FullPaths[0];b.slice(0,H.length)==H?H=b:("/"!=H.slice(-1)&&(H+="/"),H=(H+b).replace("//","/")),O={name:a(b),type:2},C.FileIndex.push(O),C.FullPaths.push(H),z||ke.utils.cfb_gc(C)}return O.content=w,O.size=w?w.length:0,k&&(k.CLSID&&(O.clsid=k.CLSID),k.mt&&(O.mt=k.mt),k.ct&&(O.ct=k.ct)),O}return r.find=function J(C,b){var w=C.FullPaths.map(function(j){return j.toUpperCase()}),k=w.map(function(j){var V=j.split("/");return V[V.length-("/"==j.slice(-1)?2:1)]}),z=!1;47===b.charCodeAt(0)?(z=!0,b=w[0].slice(0,-1)+b):z=-1!==b.indexOf("/");var O=b.toUpperCase(),H=!0===z?w.indexOf(O):k.indexOf(O);if(-1!==H)return C.FileIndex[H];var q=!O.match(Li);for(O=O.replace(Lt,""),q&&(O=O.replace(Li,"!")),H=0;H<w.length;++H)if((q?w[H].replace(Li,"!"):w[H]).replace(Lt,"")==O||(q?k[H].replace(Li,"!"):k[H]).replace(Lt,"")==O)return C.FileIndex[H];return null},r.read=function M(C,b){var w=b&&b.type;switch(w||Pe&&Buffer.isBuffer(C)&&(w="buffer"),w||"base64"){case"file":return function U(C,b){return u(),d(c.readFileSync(C),b)}(C,b);case"base64":return d(cn(ln(C)),b);case"binary":return d(cn(C),b)}return d(C,b)},r.parse=d,r.write=function we(C,b){var w=W(C,b);switch(b&&b.type||"buffer"){case"file":return u(),c.writeFileSync(b.filename,w),w;case"binary":return"string"==typeof w?w:me(w);case"base64":return Pi("string"==typeof w?w:me(w));case"buffer":if(Pe)return Buffer.isBuffer(w)?w:qn(w);case"array":return"string"==typeof w?cn(w):w}return w},r.writeFile=function Be(C,b,w){u();var k=W(C,w);c.writeFileSync(b,k)},r.utils={cfb_new:function SE(C){var b={};return I(b,C),b},cfb_add:ol,cfb_del:function bE(C,b){I(C);var w=ke.find(C,b);if(w)for(var k=0;k<C.FileIndex.length;++k)if(C.FileIndex[k]==w)return C.FileIndex.splice(k,1),C.FullPaths.splice(k,1),!0;return!1},cfb_mov:function zE(C,b,w){I(C);var k=ke.find(C,b);if(k)for(var z=0;z<C.FileIndex.length;++z)if(C.FileIndex[z]==k)return C.FileIndex[z].name=a(w),C.FullPaths[z]=w,!0;return!1},cfb_gc:function IE(C){R(C,!0)},ReadShift:Yi,CheckField:Hc,prep_blob:Rt,bconcat:Ot,use_zlib:function F(C){try{var w=new(0,C.InflateRaw);if(w._processChunk(new Uint8Array([3,0]),w._finishFlushFlag),!w.bytesRead)throw new Error("zlib does not expose bytesRead");ee=C}catch(k){console.error("cannot use native zlib: "+(k.message||k))}},_deflateRaw:Le,_inflateRaw:yd,consts:Ce},r}();function h1(t){return"string"==typeof t?Bi(t):Array.isArray(t)?function B_(t){if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(t)}(t):t}function Vi(t,r,e){if("undefined"!=typeof Deno){if(e&&"string"==typeof r)switch(e){case"utf8":r=new TextEncoder(e).encode(r);break;case"binary":r=Bi(r);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(t,r)}var i="utf8"==e?Un(r):r;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(i,t);if("undefined"!=typeof Blob){var a=new Blob([h1(i)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if("undefined"!=typeof saveAs)return saveAs(a,t);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:t,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=t,s.href=o,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(r)&&(r=_r(r)),l.write(r),l.close(),r}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function dt(t){for(var r=Object.keys(t),e=[],i=0;i<r.length;++i)Object.prototype.hasOwnProperty.call(t,r[i])&&e.push(r[i]);return e}function lc(t,r){for(var e=[],i=dt(t),a=0;a!==i.length;++a)null==e[t[i[a]][r]]&&(e[t[i[a]][r]]=i[a]);return e}function Ba(t){for(var r=[],e=dt(t),i=0;i!==e.length;++i)r[t[e[i]]]=e[i];return r}function La(t){for(var r=[],e=dt(t),i=0;i!==e.length;++i)r[t[e[i]]]=parseInt(e[i],10);return r}var Ua=new Date(1899,11,30,0,0,0);function kt(t,r){var e=t.getTime();return r&&(e-=1263168e5),(e-(Ua.getTime()+6e4*(t.getTimezoneOffset()-Ua.getTimezoneOffset())))/864e5}var cc=new Date,_1=Ua.getTime()+6e4*(cc.getTimezoneOffset()-Ua.getTimezoneOffset()),uc=cc.getTimezoneOffset();function Ha(t){var r=new Date;return r.setTime(24*t*60*60*1e3+_1),r.getTimezoneOffset()!==uc&&r.setTime(r.getTime()+6e4*(r.getTimezoneOffset()-uc)),r}function x1(t){var r=0,e=0,i=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(e=1,o>3&&(i=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":e*=24;case"H":e*=60;case"M":if(!i)throw new Error("Unsupported ISO Duration Field: M");e*=60}r+=e*parseInt(a[o],10)}return r}var dc=new Date("2017-02-19T19:06:09.000Z"),fc=isNaN(dc.getFullYear())?new Date("2/19/17"):dc,v1=2017==fc.getFullYear();function it(t,r){var e=new Date(t);if(v1)return r>0?e.setTime(e.getTime()+60*e.getTimezoneOffset()*1e3):r<0&&e.setTime(e.getTime()-60*e.getTimezoneOffset()*1e3),e;if(t instanceof Date)return t;if(1917==fc.getFullYear()&&!isNaN(e.getFullYear())){var i=e.getFullYear();return t.indexOf(""+i)>-1||e.setFullYear(e.getFullYear()+100),e}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-60*o.getTimezoneOffset()*1e3)),o}function Hr(t,r){if(Pe&&Buffer.isBuffer(t)){if(r){if(255==t[0]&&254==t[1])return Un(t.slice(2).toString("utf16le"));if(254==t[1]&&255==t[2])return Un(Vl(t.slice(2).toString("binary")))}return t.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(r){if(255==t[0]&&254==t[1])return Un(new TextDecoder("utf-16le").decode(t.slice(2)));if(254==t[0]&&255==t[1])return Un(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"\u20ac":"\x80","\u201a":"\x82",\u0192:"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87",\u02c6:"\x88","\u2030":"\x89",\u0160:"\x8a","\u2039":"\x8b",\u0152:"\x8c",\u017d:"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99",\u0161:"\x9a","\u203a":"\x9b",\u0153:"\x9c",\u017e:"\x9e",\u0178:"\x9f"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(o){return e[o]||o})}catch(o){}for(var i=[],a=0;a!=t.length;++a)i.push(String.fromCharCode(t[a]));return i.join("")}function tt(t){if("undefined"!=typeof JSON&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if("object"!=typeof t||null==t)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=tt(t[e]));return r}function ft(t,r){for(var e="";e.length<r;)e+=t;return e}function Dn(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,i=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return isNaN(r=Number(i))&&(i=i.replace(/[(](.*)[)]/,function(a,o){return e=-e,o}),isNaN(r=Number(i)))?r:r/e}var C1=["january","february","march","april","may","june","july","august","september","october","november","december"];function pi(t){var r=new Date(t),e=new Date(NaN),i=r.getYear(),a=r.getMonth(),o=r.getDate();if(isNaN(o))return e;var s=t.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==C1.indexOf(s))return e}else if(s.match(/[a-z]/))return e;return i<0||i>8099?e:(a>0||o>1)&&101!=i?r:t.match(/[^-0-9:,\/\\]/)?e:r}var y1=function(){var t=5=="abacaba".split(/(:?b)/i).length;return function(e,i,a){if(t||"string"==typeof i)return e.split(i);for(var o=e.split(i),s=[o[0]],l=1;l<o.length;++l)s.push(a),s.push(o[l]);return s}}();function pc(t){return t?t.content&&t.type?Hr(t.content,!0):t.data?ci(t.data):t.asNodeBuffer&&Pe?ci(t.asNodeBuffer().toString("binary")):t.asBinary?ci(t.asBinary()):t._data&&t._data.getContent?ci(Hr(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function hc(t){if(!t)return null;if(t.data)return Na(t.data);if(t.asNodeBuffer&&Pe)return t.asNodeBuffer();if(t._data&&t._data.getContent){var r=t._data.getContent();return"string"==typeof r?Na(r):Array.prototype.slice.call(r)}return t.content&&t.type?t.content:null}function yn(t,r){for(var e=t.FullPaths||dt(t.files),i=r.toLowerCase().replace(/[\/]/g,"\\"),a=i.replace(/\\/g,"/"),o=0;o<e.length;++o){var s=e[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==s||a==s)return t.files?t.files[e[o]]:t.FileIndex[o]}return null}function Lo(t,r){var e=yn(t,r);if(null==e)throw new Error("Cannot find file "+r+" in zip");return e}function vt(t,r,e){if(!e)return function w1(t){return t&&".bin"===t.name.slice(-4)?hc(t):pc(t)}(Lo(t,r));if(!r)return null;try{return vt(t,r)}catch(i){return null}}function dn(t,r,e){if(!e)return pc(Lo(t,r));if(!r)return null;try{return dn(t,r)}catch(i){return null}}function mc(t,r,e){if(!e)return hc(Lo(t,r));if(!r)return null;try{return mc(t,r)}catch(i){return null}}function gc(t){for(var r=t.FullPaths||dt(t.files),e=[],i=0;i<r.length;++i)"/"!=r[i].slice(-1)&&e.push(r[i].replace(/^Root Entry[\/]/,""));return e.sort()}function Me(t,r,e){if(t.FullPaths){var i;if("string"==typeof e)return i=Pe?qn(e):function L_(t){for(var r=[],e=0,i=t.length+250,a=gr(t.length+255),o=0;o<t.length;++o){var s=t.charCodeAt(o);if(s<128)a[e++]=s;else if(s<2048)a[e++]=192|s>>6&31,a[e++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var l=1023&t.charCodeAt(++o);a[e++]=240|s>>8&7,a[e++]=128|s>>2&63,a[e++]=128|l>>6&15|(3&s)<<4,a[e++]=128|63&l}else a[e++]=224|s>>12&15,a[e++]=128|s>>6&63,a[e++]=128|63&s;e>i&&(r.push(a.slice(0,e)),e=0,a=gr(65535),i=65530)}return r.push(a.slice(0,e)),Ot(r)}(e),ke.utils.cfb_add(t,r,i);ke.utils.cfb_add(t,r,e)}else t.file(r,e)}function Uo(){return ke.utils.cfb_new()}function _c(t,r){switch(r.type){case"base64":return ke.read(t,{type:"base64"});case"binary":return ke.read(t,{type:"binary"});case"buffer":case"array":return ke.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Zi(t,r){if("/"==t.charAt(0))return t.slice(1);var e=r.split("/");"/"!=r.slice(-1)&&e.pop();for(var i=t.split("/");0!==i.length;){var a=i.shift();".."===a?e.pop():"."!==a&&e.push(a)}return e.join("/")}var pt='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',T1=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,xc=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Ut=pt.match(xc)?xc:/<[^>]*>/g,S1=/<\w*:/,b1=/<(\/?)\w+:/;function Ie(t,r,e){for(var i={},a=0,o=0;a!==t.length&&32!==(o=t.charCodeAt(a))&&10!==o&&13!==o;++a);if(r||(i[0]=t.slice(0,a)),a===t.length)return i;var s=t.match(T1),l=0,c="",u=0,d="",f="",p=1;if(s)for(u=0;u!=s.length;++u){for(f=s[u],o=0;o!=f.length&&61!==f.charCodeAt(o);++o);for(d=f.slice(0,o).trim();32==f.charCodeAt(o+1);)++o;for(p=34==(a=f.charCodeAt(o+1))||39==a?1:0,c=f.slice(o+1+p,f.length-p),l=0;l!=d.length&&58!==d.charCodeAt(l);++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),i[d]=c,e||(i[d.toLowerCase()]=c);else{var m=(5===l&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(l+1);if(i[m]&&"ext"==d.slice(l-3,l))continue;i[m]=c,e||(i[m.toLowerCase()]=c)}}return i}function Ln(t){return t.replace(b1,"<$1")}var vc={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ho=Ba(vc),Ge=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,r=/_x([\da-fA-F]{4})_/gi;return function e(i){var a=i+"",o=a.indexOf("<![CDATA[");if(-1==o)return a.replace(t,function(l,c){return vc[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(r,function(l,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return e(a.slice(0,o))+a.slice(o+9,s)+e(a.slice(s+3))}}(),Vo=/[&<>'"]/g,z1=/[\u0000-\u0008\u000b-\u001f]/g;function Je(t){return(t+"").replace(Vo,function(e){return Ho[e]}).replace(z1,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Cc(t){return Je(t).replace(/ /g,"_x0020_")}var yc=/[\u0000-\u001f]/g;function Zo(t){return(t+"").replace(Vo,function(e){return Ho[e]}).replace(/\n/g,"<br/>").replace(yc,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var wc=function(){var t=/&#(\d+);/g;function r(e,i){return String.fromCharCode(parseInt(i,10))}return function(i){return i.replace(t,r)}}();function at(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function jo(t){for(var r="",e=0,i=0,a=0,o=0,s=0,l=0;e<t.length;)(i=t.charCodeAt(e++))<128?r+=String.fromCharCode(i):(a=t.charCodeAt(e++),i>191&&i<224?(s=(31&i)<<6,s|=63&a,r+=String.fromCharCode(s)):(o=t.charCodeAt(e++),i<240?r+=String.fromCharCode((15&i)<<12|(63&a)<<6|63&o):(l=((7&i)<<18|(63&a)<<12|(63&o)<<6|63&(s=t.charCodeAt(e++)))-65536,r+=String.fromCharCode(55296+(l>>>10&1023)),r+=String.fromCharCode(56320+(1023&l)))));return r}function Tc(t){var e,i,l,r=gr(2*t.length),a=1,o=0,s=0;for(i=0;i<t.length;i+=a)a=1,(l=t.charCodeAt(i))<128?e=l:l<224?(e=64*(31&l)+(63&t.charCodeAt(i+1)),a=2):l<240?(e=4096*(15&l)+64*(63&t.charCodeAt(i+1))+(63&t.charCodeAt(i+2)),a=3):(a=4,e=262144*(7&l)+4096*(63&t.charCodeAt(i+1))+64*(63&t.charCodeAt(i+2))+(63&t.charCodeAt(i+3)),s=55296+((e-=65536)>>>10&1023),e=56320+(1023&e)),0!==s&&(r[o++]=255&s,r[o++]=s>>>8,s=0),r[o++]=e%256,r[o++]=e>>>8;return r.slice(0,o).toString("ucs2")}function kc(t){return qn(t,"binary").toString("utf8")}var Va="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Xe=Pe&&(kc(Va)==jo(Va)&&kc||Tc(Va)==jo(Va)&&Tc)||jo,Un=Pe?function(t){return qn(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,i=0,a=0;e<t.length;)switch(i=t.charCodeAt(e++),!0){case i<128:r.push(String.fromCharCode(i));break;case i<2048:r.push(String.fromCharCode(192+(i>>6))),r.push(String.fromCharCode(128+(63&i)));break;case i>=55296&&i<57344:i-=55296,a=t.charCodeAt(e++)-56320+(i<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(63&a)));break;default:r.push(String.fromCharCode(224+(i>>12))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(63&i)))}return r.join("")},ji=function(){var t={};return function(e,i){var a=e+"|"+(i||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",i||"")}}(),Sc=function(){var t=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var i=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),a=0;a<t.length;++a)i=i.replace(t[a][0],t[a][1]);return i}}(),E1=function(){var t={};return function(e){return void 0!==t[e]?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),F1=/<\/?(?:vt:)?variant>/g,D1=/<(?:vt:)([^>]*)>([\s\S]*)</;function bc(t,r){var e=Ie(t),i=t.match(E1(e.baseType))||[],a=[];if(i.length!=e.size){if(r.WTF)throw new Error("unexpected vector length "+i.length+" != "+e.size);return a}return i.forEach(function(o){var s=o.replace(F1,"").match(D1);s&&a.push({v:Xe(s[2]),t:s[1]})}),a}var zc=/(^\s|\s$|\n)/;function Mt(t,r){return"<"+t+(r.match(zc)?' xml:space="preserve"':"")+">"+r+"</"+t+">"}function Gi(t){return dt(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function se(t,r,e){return"<"+t+(null!=e?Gi(e):"")+(null!=r?(r.match(zc)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function Go(t,r){try{return t.toISOString().replace(/\.\d*/,"")}catch(e){if(r)throw e}return""}function Wo(t){if(Pe&&Buffer.isBuffer(t))return t.toString("utf8");if("string"==typeof t)return t;if("undefined"!=typeof Uint8Array&&t instanceof Uint8Array)return Xe(_r(Mo(t)));throw new Error("Bad input format: expected Buffer or string")}var Wi=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Ct_CT="http://schemas.openxmlformats.org/package/2006/content-types",Ct_TCMNT="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Ct_r="http://schemas.openxmlformats.org/officeDocument/2006/relationships",Ct_vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Ct_xsi="http://www.w3.org/2001/XMLSchema-instance",yr=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],fn_o="urn:schemas-microsoft-com:office:office",fn_x="urn:schemas-microsoft-com:office:excel",fn_ss="urn:schemas-microsoft-com:office:spreadsheet",Ic=function(t){for(var r=[],i=0;i<t[0].length;++i)if(t[0][i])for(var a=0,o=t[0][i].length;a<o;a+=10240)r.push.apply(r,t[0][i].slice(a,a+10240));return r},Oc=Pe?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:qn(r)})):Ic(t)}:Ic,Ec=function(t,r,e){for(var i=[],a=r;a<e;a+=2)i.push(String.fromCharCode(Kn(t,a)));return i.join("").replace(Lt,"")},Za=Pe?function(t,r,e){return Buffer.isBuffer(t)?t.toString("utf16le",r,e).replace(Lt,""):Ec(t,r,e)}:Ec,Fc=function(t,r,e){for(var i=[],a=r;a<r+e;++a)i.push(("0"+t[a].toString(16)).slice(-2));return i.join("")},Dc=Pe?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):Fc(t,r,e)}:Fc,Ac=function(t,r,e){for(var i=[],a=r;a<e;a++)i.push(String.fromCharCode(mi(t,a)));return i.join("")},hi=Pe?function(r,e,i){return Buffer.isBuffer(r)?r.toString("utf8",e,i):Ac(r,e,i)}:Ac,Nc=function(t,r){var e=Et(t,r);return e>0?hi(t,r+4,r+4+e-1):""},Yo=Nc,Mc=function(t,r){var e=Et(t,r);return e>0?hi(t,r+4,r+4+e-1):""},$o=Mc,Rc=function(t,r){var e=2*Et(t,r);return e>0?hi(t,r+4,r+4+e-1):""},Jo=Rc,Pc=function(r,e){var i=Et(r,e);return i>0?Za(r,e+4,e+4+i):""},Qo=Pc,Bc=function(t,r){var e=Et(t,r);return e>0?hi(t,r+4,r+4+e):""},qo=Bc,Lc=function(t,r){return function N1(t,r){for(var e=1-2*(t[r+7]>>>7),i=((127&t[r+7])<<4)+(t[r+6]>>>4&15),a=15&t[r+6],o=5;o>=0;--o)a=256*a+t[r+o];return 2047==i?0==a?e*(1/0):NaN:(0==i?i=-1022:(i-=1023,a+=Math.pow(2,52)),e*Math.pow(2,i-52)*a)}(t,r)},ja=Lc,Xo=function(r){return Array.isArray(r)||"undefined"!=typeof Uint8Array&&r instanceof Uint8Array};Pe&&(Yo=function(r,e){if(!Buffer.isBuffer(r))return Nc(r,e);var i=r.readUInt32LE(e);return i>0?r.toString("utf8",e+4,e+4+i-1):""},$o=function(r,e){if(!Buffer.isBuffer(r))return Mc(r,e);var i=r.readUInt32LE(e);return i>0?r.toString("utf8",e+4,e+4+i-1):""},Jo=function(r,e){if(!Buffer.isBuffer(r))return Rc(r,e);var i=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+i-1)},Qo=function(r,e){if(!Buffer.isBuffer(r))return Pc(r,e);var i=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+i)},qo=function(r,e){if(!Buffer.isBuffer(r))return Bc(r,e);var i=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+i)},ja=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):Lc(r,e)},Xo=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||"undefined"!=typeof Uint8Array&&r instanceof Uint8Array});var mi=function(t,r){return t[r]},Kn=function(t,r){return 256*t[r+1]+t[r]},R1=function(t,r){var e=256*t[r+1]+t[r];return e<32768?e:-1*(65535-e+1)},Et=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},Vr=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},P1=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function Yi(t,r){var i,a,s,l,c,u,e="",o=[];switch(r){case"dbcs":if(u=this.l,Pe&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)e+=String.fromCharCode(Kn(this,u)),u+=2;t*=2;break;case"utf8":e=hi(this,this.l,this.l+t);break;case"utf16le":e=Za(this,this.l,this.l+(t*=2));break;case"wstr":return Yi.call(this,t,"dbcs");case"lpstr-ansi":e=Yo(this,this.l),t=4+Et(this,this.l);break;case"lpstr-cp":e=$o(this,this.l),t=4+Et(this,this.l);break;case"lpwstr":e=Jo(this,this.l),t=4+2*Et(this,this.l);break;case"lpp4":t=4+Et(this,this.l),e=Qo(this,this.l),2&t&&(t+=2);break;case"8lpp4":t=4+Et(this,this.l),e=qo(this,this.l),3&t&&(t+=4-(3&t));break;case"cstr":for(t=0,e="";0!==(s=mi(this,this.l+t++));)o.push(Mi(s));e=o.join("");break;case"_wstr":for(t=0,e="";0!==(s=Kn(this,this.l+t));)o.push(Mi(s)),t+=2;t+=2,e=o.join("");break;case"dbcs-cont":for(e="",u=this.l,c=0;c<t;++c){if(this.lens&&-1!==this.lens.indexOf(u))return s=mi(this,u),this.l=u+1,l=Yi.call(this,t-c,s?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(Mi(Kn(this,u))),u+=2}e=o.join(""),t*=2;break;case"cpstr":0;case"sbcs-cont":for(e="",u=this.l,c=0;c!=t;++c){if(this.lens&&-1!==this.lens.indexOf(u))return s=mi(this,u),this.l=u+1,l=Yi.call(this,t-c,s?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(Mi(mi(this,u))),u+=1}e=o.join("");break;default:switch(t){case 1:return i=mi(this,this.l),this.l++,i;case 2:return i=("i"===r?R1:Kn)(this,this.l),this.l+=2,i;case 4:case-4:return"i"===r||0==(128&this[this.l+3])?(i=(t>0?Vr:P1)(this,this.l),this.l+=4,i):(a=Et(this,this.l),this.l+=4,a);case 8:case-8:if("f"===r)return a=8==t?ja(this,this.l):ja([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:e=Dc(this,this.l,t)}}return this.l+=t,e}var U1=function(t,r,e){t[e]=255&r,t[e+1]=r>>>8&255};function H1(t,r,e){var i=0,a=0;if("dbcs"===e){for(a=0;a!=r.length;++a)U1(this,r.charCodeAt(a),this.l+2*a);i=2*r.length}else if("sbcs"===e){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=255&r.charCodeAt(a);i=r.length}else{if("hex"===e){for(;a<t;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===e){var s=Math.min(this.l+t,this.length);for(a=0;a<Math.min(r.length,t);++a){var l=r.charCodeAt(a);this[this.l++]=255&l,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(t){case 1:i=1,this[this.l]=255&r;break;case 2:i=2,this[this.l]=255&r,this[this.l+1]=255&(r>>>=8);break;case 3:i=3,this[this.l]=255&r,this[this.l+1]=255&(r>>>=8),this[this.l+2]=255&(r>>>=8);break;case 4:i=4,function(t,r,e){t[e]=255&r,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255}(this,r,this.l);break;case 8:if(i=8,"f"===e){!function M1(t,r,e){var i=(r<0||1/r==-1/0?1:0)<<7,a=0,o=0,s=i?-r:r;isFinite(s)?0==s?a=o=0:(a=Math.floor(Math.log(s)/Math.LN2),o=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(r)?26985:0);for(var l=0;l<=5;++l,o/=256)t[e+l]=255&o;t[e+6]=(15&a)<<4|15&o,t[e+7]=a>>4|i}(this,r,this.l);break}case 16:break;case-4:i=4,function(t,r,e){t[e]=255&r,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255}(this,r,this.l)}}return this.l+=i,this}function Hc(t,r){var e=Dc(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function Rt(t,r){t.l=r,t.read_shift=Yi,t.chk=Hc,t.write_shift=H1}function Ht(t,r){t.l+=r}function Q(t){var r=gr(t);return Rt(r,0),r}function er(t,r,e){if(t){var i,a,o;Rt(t,t.l||0);for(var s=t.length,l=0,c=0;t.l<s;){128&(l=t.read_shift(1))&&(l=(127&l)+((127&t.read_shift(1))<<7));var u=fa[l]||fa[65535];for(o=127&(i=t.read_shift(1)),a=1;a<4&&128&i;++a)o+=(127&(i=t.read_shift(1)))<<7*a;c=t.l+o;var d=u.f&&u.f(t,o,e);if(t.l=c,r(d,u,l))return}}}function Qt(){var t=[],r=Pe?256:2048,e=function(u){var d=Q(u);return Rt(d,0),d},i=e(r),a=function(){!i||(i.length>i.l&&((i=i.slice(0,i.l)).l=i.length),i.length>0&&t.push(i),i=null)},o=function(u){return i&&u<i.length-i.l?i:(a(),i=e(Math.max(u+1,r)))};return{next:o,push:function(u){a(),null==(i=u).l&&(i.l=i.length),o(r)},end:function(){return a(),Ot(t)},_bufs:t}}function ne(t,r,e,i){var o,a=+r;if(!isNaN(a)){i||(i=fa[a].p||(e||[]).length||0),o=1+(a>=128?1:0)+1,i>=128&&++o,i>=16384&&++o,i>=2097152&&++o;var s=t.next(o);a<=127?s.write_shift(1,a):(s.write_shift(1,128+(127&a)),s.write_shift(1,a>>7));for(var l=0;4!=l;++l){if(!(i>=128)){s.write_shift(1,i);break}s.write_shift(1,128+(127&i)),i>>=7}i>0&&Xo(e)&&t.push(e)}}function $i(t,r,e){var i=tt(t);if(r.s?(i.cRel&&(i.c+=r.s.c),i.rRel&&(i.r+=r.s.r)):(i.cRel&&(i.c+=r.c),i.rRel&&(i.r+=r.r)),!e||e.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function Vc(t,r,e){var i=tt(t);return i.s=$i(i.s,r.s,e),i.e=$i(i.e,r.s,e),i}function Ji(t,r){if(t.cRel&&t.c<0)for(t=tt(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=tt(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=ze(t);return!t.cRel&&null!=t.cRel&&(e=function j1(t){return t.replace(/^([A-Z])/,"$$$1")}(e)),!t.rRel&&null!=t.rRel&&(e=function V1(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(e)),e}function Ko(t,r){return 0!=t.s.r||t.s.rRel||t.e.r!=(r.biff>=12?1048575:r.biff>=8?65536:16384)||t.e.rRel?0!=t.s.c||t.s.cRel||t.e.c!=(r.biff>=12?16383:255)||t.e.cRel?Ji(t.s,r.biff)+":"+Ji(t.e,r.biff):(t.s.rRel?"":"$")+ht(t.s.r)+":"+(t.e.rRel?"":"$")+ht(t.e.r):(t.s.cRel?"":"$")+ot(t.s.c)+":"+(t.e.cRel?"":"$")+ot(t.e.c)}function es(t){return parseInt(function Z1(t){return t.replace(/\$(\d+)$/,"$1")}(t),10)-1}function ht(t){return""+(t+1)}function ts(t){for(var r=function G1(t){return t.replace(/^\$([A-Z])/,"$1")}(t),e=0,i=0;i!==r.length;++i)e=26*e+r.charCodeAt(i)-64;return e-1}function ot(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function lt(t){for(var r=0,e=0,i=0;i<t.length;++i){var a=t.charCodeAt(i);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(e=26*e+(a-64))}return{c:e-1,r:r-1}}function ze(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function qt(t){var r=t.indexOf(":");return-1==r?{s:lt(t),e:lt(t)}:{s:lt(t.slice(0,r)),e:lt(t.slice(r+1))}}function De(t,r){return void 0===r||"number"==typeof r?De(t.s,t.e):("string"!=typeof t&&(t=ze(t)),"string"!=typeof r&&(r=ze(r)),t==r?t:t+":"+r)}function Ve(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,i=0,a=0,o=t.length;for(e=0;i<o&&!((a=t.charCodeAt(i)-64)<1||a>26);++i)e=26*e+a;for(r.s.c=--e,e=0;i<o&&!((a=t.charCodeAt(i)-48)<0||a>9);++i)e=10*e+a;if(r.s.r=--e,i===o||10!=a)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++i,e=0;i!=o&&!((a=t.charCodeAt(i)-64)<1||a>26);++i)e=26*e+a;for(r.e.c=--e,e=0;i!=o&&!((a=t.charCodeAt(i)-48)<0||a>9);++i)e=10*e+a;return r.e.r=--e,r}function Hn(t,r,e){return null==t||null==t.t||"z"==t.t?"":void 0!==t.w?t.w:("d"==t.t&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),"e"==t.t?tr[t.v]||t.v:function Zc(t,r){var e="d"==t.t&&r instanceof Date;if(null!=t.z)try{return t.w=un(t.z,e?kt(r):r)}catch(i){}try{return t.w=un((t.XF||{}).numFmtId||(e?14:0),e?kt(r):r)}catch(i){return""+r}}(t,null==r?t.v:r))}function wr(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",i={};return i[e]=t,{SheetNames:[e],Sheets:i}}function jc(t,r,e){var i=e||{},a=t?Array.isArray(t):i.dense,o=t||(a?[]:{}),s=0,l=0;if(o&&null!=i.origin){if("number"==typeof i.origin)s=i.origin;else{var c="string"==typeof i.origin?lt(i.origin):i.origin;s=c.r,l=c.c}o["!ref"]||(o["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var d=Ve(o["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==s&&(u.e.r=s=d.e.r+1)}for(var f=0;f!=r.length;++f)if(r[f]){if(!Array.isArray(r[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=r[f].length;++p)if(void 0!==r[f][p]){var m={v:r[f][p]},x=s+f,h=l+p;if(u.s.r>x&&(u.s.r=x),u.s.c>h&&(u.s.c=h),u.e.r<x&&(u.e.r=x),u.e.c<h&&(u.e.c=h),!r[f][p]||"object"!=typeof r[f][p]||Array.isArray(r[f][p])||r[f][p]instanceof Date)if(Array.isArray(m.v)&&(m.f=r[f][p][1],m.v=m.v[0]),null===m.v)if(m.f)m.t="n";else if(i.nullError)m.t="e",m.v=0;else{if(!i.sheetStubs)continue;m.t="z"}else"number"==typeof m.v?m.t="n":"boolean"==typeof m.v?m.t="b":m.v instanceof Date?(m.z=i.dateNF||Se[14],i.cellDates?(m.t="d",m.w=un(m.z,kt(m.v))):(m.t="n",m.v=kt(m.v),m.w=un(m.z,m.v))):m.t="s";else m=r[f][p];if(a)o[x]||(o[x]=[]),o[x][h]&&o[x][h].z&&(m.z=o[x][h].z),o[x][h]=m;else{var v=ze({c:h,r:x});o[v]&&o[v].z&&(m.z=o[v].z),o[v]=m}}}return u.s.c<1e7&&(o["!ref"]=De(u)),o}function gi(t,r){return jc(null,t,r)}function An(t,r){return r||(r=Q(4)),r.write_shift(4,t),r}function Vt(t){var r=t.read_shift(4);return 0===r?"":t.read_shift(r,"dbcs")}function Ft(t,r){var e=!1;return null==r&&(e=!0,r=Q(4+2*t.length)),r.write_shift(4,t.length),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}function $1(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function ns(t,r){var e=t.l,i=t.read_shift(1),a=Vt(t),o=[],s={t:a,h:a};if(0!=(1&i)){for(var l=t.read_shift(4),c=0;c!=l;++c)o.push($1(t));s.r=o}else s.r=[{ich:0,ifnt:0}];return t.l=e+r,s}var q1=ns;function wn(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function Zr(t,r){return null==r&&(r=Q(8)),r.write_shift(-4,t.c),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}function jr(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}function Gr(t,r){return null==r&&(r=Q(4)),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}var K1=Vt,Gc=Ft;function rs(t){var r=t.read_shift(4);return 0===r||4294967295===r?"":t.read_shift(r,"dbcs")}function Ga(t,r){var e=!1;return null==r&&(e=!0,r=Q(127)),r.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}var ex=Vt,is=rs,as=Ga;function os(t){var r=t.slice(t.l,t.l+4),e=1&r[0],i=2&r[0];t.l+=4;var a=0===i?ja([0,0,0,0,252&r[0],r[1],r[2],r[3]],0):Vr(r,0)>>2;return e?a/100:a}function Wc(t,r){null==r&&(r=Q(4));var e=0,i=0,a=100*t;if(t==(0|t)&&t>=-(1<<29)&&t<1<<29?i=1:a==(0|a)&&a>=-(1<<29)&&a<1<<29&&(i=1,e=1),!i)throw new Error("unsupported RkNumber "+t);r.write_shift(-4,((e?a:t)<<2)+(e+2))}function Yc(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}var Wr=Yc,_i=function tx(t,r){return r||(r=Q(16)),r.write_shift(4,t.s.r),r.write_shift(4,t.e.r),r.write_shift(4,t.s.c),r.write_shift(4,t.e.c),r};function Zt(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Yr(t,r){return(r||Q(8)).write_shift(8,t,"f")}function Wa(t,r){if(r||(r=Q(8)),!t||t.auto)return r.write_shift(4,0),r.write_shift(4,0),r;null!=t.index?(r.write_shift(1,2),r.write_shift(1,t.index)):null!=t.theme?(r.write_shift(1,6),r.write_shift(1,t.theme)):(r.write_shift(1,5),r.write_shift(1,0));var e=t.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),r.write_shift(2,e),t.rgb&&null==t.theme){var i=t.rgb||"FFFFFF";"number"==typeof i&&(i=("000000"+i.toString(16)).slice(-6)),r.write_shift(1,parseInt(i.slice(0,2),16)),r.write_shift(1,parseInt(i.slice(2,4),16)),r.write_shift(1,parseInt(i.slice(4,6),16)),r.write_shift(1,255)}else r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);return r}function $c(t,r){var i=t.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[t.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return t.l-=4,t.read_shift(0,1==r?"lpstr":"lpwstr")}var dx=[80,81],ls={1:{n:"CodePage",t:2},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},cs={1:{n:"CodePage",t:2},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},qc={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},fx=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function px(t){return t.map(function(r){return[r>>16&255,r>>8&255,255&r]})}var $r=tt(px([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),tr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Xc={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},us={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Qa={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Kc(t,r){var a,e=function g1(t){for(var r=[],e=dt(t),i=0;i!==e.length;++i)null==r[t[e[i]]]&&(r[t[e[i]]]=[]),r[t[e[i]]].push(e[i]);return r}(us),i=[];i[i.length]=pt,i[i.length]=se("Types",null,{xmlns:Ct_CT,"xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":Ct_xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return se("Default",null,{Extension:c[0],ContentType:c[1]})}));var o=function(c){t[c]&&t[c].length>0&&(i[i.length]=se("Override",null,{PartName:("/"==(a=t[c][0])[0]?"":"/")+a,ContentType:Qa[c][r.bookType]||Qa[c].xlsx}))},s=function(c){(t[c]||[]).forEach(function(u){i[i.length]=se("Override",null,{PartName:("/"==u[0]?"":"/")+u,ContentType:Qa[c][r.bookType]||Qa[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(u){i[i.length]=se("Override",null,{PartName:("/"==u[0]?"":"/")+u,ContentType:e[c][0]})})};return o("workbooks"),s("sheets"),s("charts"),l("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),s("metadata"),l("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var Ae={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Qi(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function qi(t,r){var e={"!id":{}};if(!t)return e;"/"!==r.charAt(0)&&(r="/"+r);var i={};return(t.match(Ut)||[]).forEach(function(a){var o=Ie(a);if("<Relationship"===o[0]){var s={};s.Type=o.Type,s.Target=o.Target,s.Id=o.Id,o.TargetMode&&(s.TargetMode=o.TargetMode);var l="External"===o.TargetMode?o.Target:Zi(o.Target,r);e[l]=s,i[o.Id]=s}}),e["!id"]=i,e}function xi(t){var r=[pt,se("Relationships",null,{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"})];return dt(t["!id"]).forEach(function(e){r[r.length]=se("Relationship",null,t["!id"][e])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Ye(t,r,e,i,a,o){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),r<0)for(r=t["!idx"];t["!id"]["rId"+r];++r);if(t["!idx"]=r+1,a.Id="rId"+r,a.Type=i,a.Target=e,o?a.TargetMode=o:[Ae.HLINK,Ae.XPATH,Ae.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+r);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,r}function e0(t,r,e){return['  <rdf:Description rdf:about="'+t+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+r+'"/>\n',"  </rdf:Description>\n"].join("")}function vx(t,r){return['  <rdf:Description rdf:about="'+t+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+'"/>\n',"  </rdf:Description>\n"].join("")}function t0(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ni_version+"</meta:generator></office:meta></office:document-meta>"}var Tn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],yx=function(){for(var t=new Array(Tn.length),r=0;r<Tn.length;++r){var e=Tn[r],i="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);t[r]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return t}();function n0(t){var r={};t=Xe(t);for(var e=0;e<Tn.length;++e){var i=Tn[e],a=t.match(yx[e]);null!=a&&a.length>0&&(r[i[1]]=Ge(a[1])),"date"===i[2]&&r[i[1]]&&(r[i[1]]=it(r[i[1]]))}return r}function fs(t,r,e,i,a){null!=a[t]||null==r||""===r||(a[t]=r,r=Je(r),i[i.length]=e?se(t,r,e):Mt(t,r))}function r0(t,r){var e=r||{},i=[pt,se("cp:coreProperties",null,{"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":Ct_xsi})],a={};if(!t&&!e.Props)return i.join("");t&&(null!=t.CreatedDate&&fs("dcterms:created","string"==typeof t.CreatedDate?t.CreatedDate:Go(t.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,a),null!=t.ModifiedDate&&fs("dcterms:modified","string"==typeof t.ModifiedDate?t.ModifiedDate:Go(t.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,a));for(var o=0;o!=Tn.length;++o){var s=Tn[o],l=e.Props&&null!=e.Props[s[1]]?e.Props[s[1]]:t?t[s[1]]:null;!0===l?l="1":!1===l?l="0":"number"==typeof l&&(l=String(l)),null!=l&&fs(s[0],l,null,i,a)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var Jr=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],a0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function o0(t,r,e,i){var a=[];if("string"==typeof t)a=bc(t,i);else for(var o=0;o<t.length;++o)a=a.concat(t[o].map(function(d){return{v:d}}));var s="string"==typeof r?bc(r,i).map(function(d){return d.v}):r,l=0,c=0;if(s.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":e.Worksheets=c,e.SheetNames=s.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":e.NamedRanges=c,e.DefinedNames=s.slice(l,l+c);break;case"Charts":case"Diagramme":e.Chartsheets=c,e.ChartNames=s.slice(l,l+c)}l+=c}}function s0(t){var r=[],e=se;return t||(t={}),t.Application="SheetJS",r[r.length]=pt,r[r.length]=se("Properties",null,{xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":Ct_vt}),Jr.forEach(function(i){if(void 0!==t[i[1]]){var a;switch(i[2]){case"string":a=Je(String(t[i[1]]));break;case"bool":a=t[i[1]]?"true":"false"}void 0!==a&&(r[r.length]=e(i[0],a))}}),r[r.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=e("TitlesOfParts",e("vt:vector",t.SheetNames.map(function(i){return"<vt:lpstr>"+Je(i)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Tx=/<[^>]+>[^<]*/g;function l0(t){var r=[pt,se("Properties",null,{xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties","xmlns:vt":Ct_vt})];if(!t)return r.join("");var e=1;return dt(t).forEach(function(a){++e,r[r.length]=se("property",function A1(t,r){switch(typeof t){case"string":var e=se("vt:lpwstr",Je(t));return r&&(e=e.replace(/&quot;/g,"_x0022_")),e;case"number":return se((0|t)==t?"vt:i4":"vt:r8",Je(String(t)));case"boolean":return se("vt:bool",t?"true":"false")}if(t instanceof Date)return se("vt:filetime",Go(t));throw new Error("Unable to serialize "+t)}(t[a],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Je(a)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var hs,ps={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Sx(t,r,e){hs||(hs=Ba(ps)),t[r=hs[r]||r]=e}function ms(t){var r=t.read_shift(4),e=t.read_shift(4);return new Date(1e3*(e/1e7*Math.pow(2,32)+r/1e7-11644473600)).toISOString().replace(/\.000/,"")}function c0(t,r,e){var i=t.l,a=t.read_shift(0,"lpstr-cp");if(e)for(;t.l-i&3;)++t.l;return a}function u0(t,r,e){var i=t.read_shift(0,"lpwstr");return e&&(t.l+=4-(i.length+1&3)&3),i}function d0(t,r,e){return 31===r?u0(t):c0(t,0,e)}function gs(t,r,e){return d0(t,r,!1===e?0:4)}function Dx(t){var r=t.l,e=qa(t,81);return 0==t[t.l]&&0==t[t.l+1]&&t.l-r&2&&(t.l+=2),[e,qa(t,3)]}function f0(t,r){for(var e=t.read_shift(4),i={},a=0;a!=e;++a){var o=t.read_shift(4),s=t.read_shift(4);i[o]=t.read_shift(s,1200===r?"utf16le":"utf8").replace(Lt,"").replace(Li,"!"),1200===r&&s%2&&(t.l+=2)}return 3&t.l&&(t.l=t.l>>3<<2),i}function p0(t){var r=t.read_shift(4),e=t.slice(t.l,t.l+r);return t.l+=r,(3&r)>0&&(t.l+=4-(3&r)&3),e}function qa(t,r,e){var a,i=t.read_shift(2),o=e||{};if(t.l+=2,12!==r&&i!==r&&-1===dx.indexOf(r)&&(4126!=(65534&r)||4126!=(65534&i)))throw new Error("Expected type "+r+" saw "+i);switch(12===r?i:r){case 2:return a=t.read_shift(2,"i"),o.raw||(t.l+=2),a;case 3:return t.read_shift(4,"i");case 11:return 0!==t.read_shift(4);case 19:return t.read_shift(4);case 30:return c0(t,0,4).replace(Lt,"");case 31:return u0(t);case 64:return ms(t);case 65:return p0(t);case 71:return function Nx(t){var r={};return r.Size=t.read_shift(4),t.l+=r.Size+3-(r.Size-1)%4,r}(t);case 80:return gs(t,i,!o.raw).replace(Lt,"");case 81:return function Ox(t,r){if(!r)throw new Error("VtUnalignedString must have positive length");return d0(t,r,0)}(t,i).replace(Lt,"");case 4108:return function Ax(t){for(var r=t.read_shift(4),e=[],i=0;i<r/2;++i)e.push(Dx(t));return e}(t);case 4126:case 4127:return 4127==i?function Ex(t){for(var r=t.read_shift(4),e=[],i=0;i!=r;++i){var a=t.l;e[i]=t.read_shift(0,"lpwstr").replace(Lt,""),t.l-a&2&&(t.l+=2)}return e}(t):function Fx(t){for(var r=t.read_shift(4),e=[],i=0;i!=r;++i)e[i]=t.read_shift(0,"lpstr-cp").replace(Lt,"");return e}(t);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+i)}}function h0(t,r){var e=Q(4),i=Q(4);switch(e.write_shift(4,80==t?31:t),t){case 3:i.write_shift(-4,r);break;case 5:(i=Q(8)).write_shift(8,r,"f");break;case 11:i.write_shift(4,r?1:0);break;case 64:i=function Ix(t){var e=("string"==typeof t?new Date(Date.parse(t)):t).getTime()/1e3+11644473600,i=e%Math.pow(2,32),a=(e-i)/Math.pow(2,32);a*=1e7;var o=(i*=1e7)/Math.pow(2,32)|0;o>0&&(i%=Math.pow(2,32),a+=o);var s=Q(8);return s.write_shift(4,i),s.write_shift(4,a),s}(r);break;case 31:case 80:for((i=Q(4+2*(r.length+1)+(r.length%2?0:2))).write_shift(4,r.length+1),i.write_shift(0,r,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}return Ot([e,i])}function m0(t,r){var e=t.l,i=t.read_shift(4),a=t.read_shift(4),o=[],s=0,l=0,c=-1,u={};for(s=0;s!=a;++s){var d=t.read_shift(4),f=t.read_shift(4);o[s]=[d,f+e]}o.sort(function(S,y){return S[1]-y[1]});var p={};for(s=0;s!=a;++s){if(t.l!==o[s][1]){var m=!0;if(s>0&&r)switch(r[o[s-1][0]].t){case 2:t.l+2===o[s][1]&&(t.l+=2,m=!1);break;case 80:case 4108:t.l<=o[s][1]&&(t.l=o[s][1],m=!1)}if((!r||0==s)&&t.l<=o[s][1]&&(m=!1,t.l=o[s][1]),m)throw new Error("Read Error: Expected address "+o[s][1]+" at "+t.l+" :"+s)}if(r){var x=r[o[s][0]];if(p[x.n]=qa(t,x.t,{raw:!0}),"version"===x.p&&(p[x.n]=String(p[x.n]>>16)+"."+("0000"+String(65535&p[x.n])).slice(-4)),"CodePage"==x.n)switch(p[x.n]){case 0:p[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:vn(l=p[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[x.n])}}else if(1===o[s][0]){if(l=p.CodePage=qa(t,2),vn(l),-1!==c){var h=t.l;t.l=o[c][1],u=f0(t,l),t.l=h}}else if(0===o[s][0]){if(0===l){c=s,t.l=o[s+1][1];continue}u=f0(t,l)}else{var T,v=u[o[s][0]];switch(t[t.l]){case 65:t.l+=4,T=p0(t);break;case 30:case 31:t.l+=4,T=gs(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=gt(t,4);break;case 64:t.l+=4,T=it(ms(t));break;default:throw new Error("unparsed value: "+t[t.l])}p[v]=T}}return t.l=e+i,p}var g0=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Mx(t){switch(typeof t){case"boolean":return 11;case"number":return(0|t)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64}return-1}function _0(t,r,e){var i=Q(8),a=[],o=[],s=8,l=0,c=Q(8),u=Q(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),o.push(c),a.push(u),s+=8+c.length,!r){(u=Q(8)).write_shift(4,0),a.unshift(u);var d=[Q(4)];for(d[0].write_shift(4,t.length),l=0;l<t.length;++l){var f=t[l][0];for((c=Q(8+2*(f.length+1)+(f.length%2?0:2))).write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Ot(d),o.unshift(c),s+=8+c.length}for(l=0;l<t.length;++l)if((!r||r[t[l][0]])&&!(g0.indexOf(t[l][0])>-1||a0.indexOf(t[l][0])>-1)&&null!=t[l][1]){var p=t[l][1],m=0;if(r){var x=e[m=+r[t[l][0]]];if("version"==x.p&&"string"==typeof p){var h=p.split(".");p=(+h[0]<<16)+(+h[1]||0)}c=h0(x.t,p)}else{var v=Mx(p);-1==v&&(v=31,p=String(p)),c=h0(v,p)}o.push(c),(u=Q(8)).write_shift(4,r?m:2+l),a.push(u),s+=8+c.length}var T=8*(o.length+1);for(l=0;l<o.length;++l)a[l].write_shift(4,T),T+=o[l].length;return i.write_shift(4,s),i.write_shift(4,o.length),Ot([i].concat(a).concat(o))}function x0(t,r,e){var i=t.content;if(!i)return{};Rt(i,0);var a,o,s,l,c=0;i.chk("feff","Byte Order: "),i.read_shift(2);var u=i.read_shift(4),d=i.read_shift(16);if(d!==ke.utils.consts.HEADER_CLSID&&d!==e)throw new Error("Bad PropertySet CLSID "+d);if(1!==(a=i.read_shift(4))&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(o=i.read_shift(16),l=i.read_shift(4),1===a&&l!==i.l)throw new Error("Length mismatch: "+l+" !== "+i.l);2===a&&(s=i.read_shift(16),c=i.read_shift(4));var x,f=m0(i,r),p={SystemIdentifier:u};for(var m in f)p[m]=f[m];if(p.FMTID=o,1===a)return p;if(c-i.l==2&&(i.l+=2),i.l!==c)throw new Error("Length mismatch 2: "+i.l+" !== "+c);try{x=m0(i,null)}catch(h){}for(m in x)p[m]=x[m];return p.FMTID=[o,s],p}function v0(t,r,e,i,a,o){var s=Q(a?68:48),l=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,ke.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,r,"hex"),s.write_shift(4,a?68:48);var c=_0(t,e,i);if(l.push(c),a){var u=_0(a,null,null);s.write_shift(16,o,"hex"),s.write_shift(4,68+c.length),l.push(u)}return Ot(l)}function Tr(t,r){return t.read_shift(r),null}function gt(t,r){return 1===t.read_shift(r)}function Xt(t,r){return r||(r=Q(2)),r.write_shift(2,+!!t),r}function yt(t){return t.read_shift(2,"u")}function kn(t,r){return r||(r=Q(2)),r.write_shift(2,t),r}function C0(t,r){return function Px(t,r,e){for(var i=[],a=t.l+r;t.l<a;)i.push(e(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return i}(t,r,yt)}function y0(t,r,e){return e||(e=Q(2)),e.write_shift(1,"e"==r?+t:+!!t),e.write_shift(1,"e"==r?1:0),e}function Xi(t,r,e){var i=t.read_shift(e&&e.biff>=12?2:1),a="sbcs-cont",o=sn;e&&e.biff>=8&&(sn=1200),e&&8!=e.biff?12==e.biff&&(a="wstr"):t.read_shift(1)&&(a="dbcs-cont"),e.biff>=2&&e.biff<=5&&(a="cpstr");var l=i?t.read_shift(i,a):"";return sn=o,l}function Lx(t){var r=sn;sn=1200;var c,e=t.read_shift(2),i=t.read_shift(1),a=4&i,o=8&i,s=1+(1&i),l=0,u={};o&&(l=t.read_shift(2)),a&&(c=t.read_shift(4));var f=0===e?"":t.read_shift(e,2==s?"dbcs-cont":"sbcs-cont");return o&&(t.l+=4*l),a&&(t.l+=c),u.t=f,o||(u.raw="<t>"+u.t+"</t>",u.r=u.t),sn=r,u}function Ux(t){var r=t.t||"",i=Q(3);i.write_shift(2,r.length),i.write_shift(1,1);var a=Q(2*r.length);return a.write_shift(2*r.length,r,"utf16le"),Ot([i,a])}function Qr(t,r,e){if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var a=t.read_shift(1);return t.read_shift(r,0===a?"sbcs-cont":"dbcs-cont")}function Ki(t,r,e){var i=t.read_shift(e&&2==e.biff?1:2);return 0===i?(t.l++,""):Qr(t,i,e)}function qr(t,r,e){if(e.biff>5)return Ki(t,0,e);var i=t.read_shift(1);return 0===i?(t.l++,""):t.read_shift(i,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function w0(t,r,e){return e||(e=Q(3+2*t.length)),e.write_shift(2,t.length),e.write_shift(1,1),e.write_shift(31,t,"utf16le"),e}function Xa(t){var r=t.read_shift(4);return r>0?t.read_shift(r,"utf16le").replace(Lt,""):""}function T0(t,r){r||(r=Q(6+2*t.length)),r.write_shift(4,1+t.length);for(var e=0;e<t.length;++e)r.write_shift(2,t.charCodeAt(e));return r.write_shift(2,0),r}function Wx(t){var r=Q(512),e=0,i=t.Target;"file://"==i.slice(0,7)&&(i=i.slice(7));var a=i.indexOf("#"),o=a>-1?31:23;switch(i.charAt(0)){case"#":o=28;break;case".":o&=-3}r.write_shift(4,2),r.write_shift(4,o);var s=[8,6815827,6619237,4849780,83];for(e=0;e<s.length;++e)r.write_shift(4,s[e]);if(28==o)T0(i=i.slice(1),r);else if(2&o){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<s.length;++e)r.write_shift(1,parseInt(s[e],16));var l=a>-1?i.slice(0,a):i;for(r.write_shift(4,2*(l.length+1)),e=0;e<l.length;++e)r.write_shift(2,l.charCodeAt(e));r.write_shift(2,0),8&o&&T0(a>-1?i.slice(a+1):"",r)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<s.length;++e)r.write_shift(1,parseInt(s[e],16));for(var c=0;"../"==i.slice(3*c,3*c+3)||"..\\"==i.slice(3*c,3*c+3);)++c;for(r.write_shift(2,c),r.write_shift(4,i.length-3*c+1),e=0;e<i.length-3*c;++e)r.write_shift(1,255&i.charCodeAt(e+3*c));for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),e=0;e<6;++e)r.write_shift(4,0)}return r.slice(0,r.l)}function k0(t){return[t.read_shift(1),t.read_shift(1),t.read_shift(1),t.read_shift(1)]}function S0(t,r){var e=k0(t);return e[3]=0,e}function Vn(t){return{r:t.read_shift(2),c:t.read_shift(2),ixfe:t.read_shift(2)}}function Xr(t,r,e,i){return i||(i=Q(6)),i.write_shift(2,t),i.write_shift(2,r),i.write_shift(2,e||0),i}function Jx(t,r,e){var i=e.biff>8?4:2;return[t.read_shift(i),t.read_shift(i,"i"),t.read_shift(i,"i")]}function b0(t){return[t.read_shift(2),os(t)]}function Ka(t){var r=t.read_shift(2),e=t.read_shift(2);return{s:{c:t.read_shift(2),r},e:{c:t.read_shift(2),r:e}}}function z0(t,r){return r||(r=Q(8)),r.write_shift(2,t.s.r),r.write_shift(2,t.e.r),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c),r}function I0(t){var r=t.read_shift(2),e=t.read_shift(2);return{s:{c:t.read_shift(1),r},e:{c:t.read_shift(1),r:e}}}var qx=I0;function O0(t){t.l+=4;var r=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(2);return t.l+=12,[e,r,i]}function jt(t){t.l+=2,t.l+=t.read_shift(2)}var ev={0:jt,4:jt,5:jt,6:jt,7:function Kx(t){return t.l+=4,t.cf=t.read_shift(2),{}},8:jt,9:jt,10:jt,11:jt,12:jt,13:function Xx(t){var r={};return t.l+=4,t.l+=16,r.fSharedNote=t.read_shift(2),t.l+=4,r},14:jt,15:jt,16:jt,17:jt,18:jt,19:jt,20:jt,21:O0};function eo(t,r){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=t.read_shift(2),(r-=2)>=2&&(e.dt=t.read_shift(2),t.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return t.read_shift(r),e}function _s(t,r,e){var i=1536,a=16;switch(e.bookType){case"biff8":case"xla":break;case"biff5":i=1280,a=8;break;case"biff4":i=4,a=6;break;case"biff3":i=3,a=6;break;case"biff2":i=2,a=4;break;default:throw new Error("unsupported BIFF version")}var o=Q(a);return o.write_shift(2,i),o.write_shift(2,r),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function sv(t,r){var e=!r||r.biff>=8?2:1,i=Q(8+e*t.name.length);i.write_shift(4,t.pos),i.write_shift(1,t.hs||0),i.write_shift(1,t.dt),i.write_shift(1,t.name.length),r.biff>=8&&i.write_shift(1,1),i.write_shift(e*t.name.length,t.name,r.biff<8?"sbcs":"utf16le");var a=i.slice(0,i.l);return a.l=i.l,a}function E0(t,r,e){var i=0;e&&2==e.biff||(i=t.read_shift(2));var a=t.read_shift(2);return e&&2==e.biff&&(i=1-(a>>15),a&=32767),[{Unsynced:1&i,DyZero:(2&i)>>1,ExAsc:(4&i)>>2,ExDsc:(8&i)>>3},a]}function bv(t,r,e,i){var a=e&&5==e.biff;i||(i=Q(a?3+r.length:5+2*r.length)),i.write_shift(2,t),i.write_shift(a?1:2,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le");var o=i.length>i.l?i.slice(0,i.l):i;return null==o.l&&(o.l=o.length),o}var zv=qr;function F0(t,r,e){var i=t.l+r,a=8!=e.biff&&e.biff?2:4,o=t.read_shift(a),s=t.read_shift(a),l=t.read_shift(2),c=t.read_shift(2);return t.l=i,{s:{r:o,c:l},e:{r:s,c}}}function D0(t,r,e,i){var a=e&&5==e.biff;i||(i=Q(a?16:20)),i.write_shift(2,0),t.style?(i.write_shift(2,t.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,t.numFmtId||0),i.write_shift(2,r<<4));var o=0;return t.numFmtId>0&&a&&(o|=1024),i.write_shift(4,o),i.write_shift(4,0),a||i.write_shift(4,0),i.write_shift(2,0),i}function A0(t,r,e){var i=Vn(t);(2==e.biff||9==r)&&++t.l;var a=function Bx(t){var r=t.read_shift(1);return 1===t.read_shift(1)?r:1===r}(t);return i.val=a,i.t=!0===a||!1===a?"b":"e",i}var N0=function $x(t,r,e){return 0===r?"":qr(t,0,e)};function M0(t,r,e){var a,i=t.read_shift(2),o={fBuiltIn:1&i,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return 14849===e.sbcch&&(a=function Qx(t,r,e){t.l+=4;var i=t.l+(r-=4),a=Xi(t,0,e),o=t.read_shift(2);if(o!==(i-=t.l))throw new Error("Malformed AddinUdf: padding = "+i+" != "+o);return t.l+=o,a}(t,r-2,e)),o.body=a||t.read_shift(r-2),"string"==typeof a&&(o.Name=a),o}var Uv=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function R0(t,r,e){var i=t.l+r,a=t.read_shift(2),o=t.read_shift(1),s=t.read_shift(1),l=t.read_shift(e&&2==e.biff?1:2),c=0;(!e||e.biff>=5)&&(5!=e.biff&&(t.l+=2),c=t.read_shift(2),5==e.biff&&(t.l+=2),t.l+=4);var u=Qr(t,s,e);32&a&&(u=Uv[u.charCodeAt(0)]);var d=i-t.l;e&&2==e.biff&&--d;var f=i!=t.l&&0!==l&&d>0?function nT(t,r,e,i){var s,a=t.l+r,o=sa(t,i,e);return a!==t.l&&(s=oa(t,a-t.l,o,e)),[o,s]}(t,d,e,l):[];return{chKey:o,Name:u,itab:c,rgce:f}}function P0(t,r,e){if(e.biff<8)return function Hv(t,r,e){3==t[t.l+1]&&t[t.l]++;var i=Xi(t,0,e);return 3==i.charCodeAt(0)?i.slice(1):i}(t,0,e);for(var i=[],a=t.l+r,o=t.read_shift(e.biff>8?4:2);0!=o--;)i.push(Jx(t,0,e));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return i}function B0(t,r,e){var i=qx(t,6);switch(e.biff){case 2:t.l++,r-=7;break;case 3:case 4:t.l+=2,r-=8;break;default:t.l+=6,r-=12}return[i,eT(t,r,e)]}var Qv={8:function(t,r){var e=t.l+r;t.l+=10;var i=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=e,{fmt:i}}};function eC(t){var r=Q(24),e=lt(t[0]);r.write_shift(2,e.r),r.write_shift(2,e.r),r.write_shift(2,e.c),r.write_shift(2,e.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)r.write_shift(1,parseInt(i[a],16));return Ot([r,Wx(t[1])])}function nC(t){var r=t[1].Tooltip,e=Q(10+2*(r.length+1));e.write_shift(2,2048);var i=lt(t[0]);e.write_shift(2,i.r),e.write_shift(2,i.r),e.write_shift(2,i.c),e.write_shift(2,i.c);for(var a=0;a<r.length;++a)e.write_shift(2,r.charCodeAt(a));return e.write_shift(2,0),e}function L0(t,r,e){if(!e.cellStyles)return Ht(t,r);var i=e&&e.biff>=12?4:2,a=t.read_shift(i),o=t.read_shift(i),s=t.read_shift(i),l=t.read_shift(i),c=t.read_shift(2);2==i&&(t.l+=2);var u={s:a,e:o,w:s,ixfe:l,flags:c};return(e.biff>=5||!e.biff)&&(u.level=c>>8&7),u}var fC=Vn,pC=C0,hC=Ki,kC=[2,3,48,49,131,139,140,245],xs=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Ba({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function i(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=gi(function e(l,c){var u=[],d=gr(1);switch(c.type){case"base64":d=cn(ln(l));break;case"binary":d=cn(l);break;case"buffer":case"array":d=l}Rt(d,0);var f=d.read_shift(1),p=!!(136&f),m=!1,x=!1;switch(f){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:m=!0,p=!0;break;case 140:x=!0;break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var h=0,v=521;2==f&&(h=d.read_shift(2)),d.l+=3,2!=f&&(h=d.read_shift(4)),h>1048576&&(h=1e6),2!=f&&(v=d.read_shift(2));var T=d.read_shift(2),S=c.codepage||1252;2!=f&&(d.l+=16,d.read_shift(1),0!==d[d.l]&&(S=t[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var y=[],P={},U=Math.min(d.length,2==f?521:v-10-(m?264:0)),M=x?32:11;d.l<U&&13!=d[d.l];)switch(P={},P.name=je.utils.decode(S,d.slice(d.l,d.l+M)).replace(/[\u0000\r\n].*$/g,""),d.l+=M,P.type=String.fromCharCode(d.read_shift(1)),2!=f&&!x&&(P.offset=d.read_shift(4)),P.len=d.read_shift(1),2==f&&(P.offset=d.read_shift(2)),P.dec=d.read_shift(1),P.name.length&&y.push(P),2!=f&&(d.l+=x?13:14),P.type){case"B":(!m||8!=P.len)&&c.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(13!==d[d.l]&&(d.l=v-1),13!==d.read_shift(1))throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=v;var I=0,B=0;for(u[0]=[],B=0;B!=y.length;++B)u[0][B]=y[B].name;for(;h-- >0;)if(42!==d[d.l])for(++d.l,u[++I]=[],B=0,B=0;B!=y.length;++B){var R=d.slice(d.l,d.l+y[B].len);d.l+=y[B].len,Rt(R,0);var W=je.utils.decode(S,R);switch(y[B].type){case"C":W.trim().length&&(u[I][B]=W.replace(/\s+$/,""));break;case"D":u[I][B]=8===W.length?new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):W;break;case"F":u[I][B]=parseFloat(W.trim());break;case"+":case"I":u[I][B]=x?2147483648^R.read_shift(-4,"i"):R.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":u[I][B]=!0;break;case"N":case"F":u[I][B]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[I][B]="##MEMO##"+(x?parseInt(W.trim(),10):R.read_shift(4));break;case"N":(W=W.replace(/\u0000/g,"").trim())&&"."!=W&&(u[I][B]=+W||0);break;case"@":u[I][B]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":u[I][B]=new Date(864e5*(R.read_shift(4)-2440588)+R.read_shift(4));break;case"Y":u[I][B]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[I][B]=-R.read_shift(-8,"f");break;case"B":if(m&&8==y[B].len){u[I][B]=R.read_shift(8,"f");break}case"G":case"P":R.l+=y[B].len;break;case"0":if("_NullFlags"===y[B].name)break;default:throw new Error("DBF Unsupported data type "+y[B].type)}}else d.l+=T;if(2!=f&&d.l<d.length&&26!=d[d.l++])throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=y,u}(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}var o={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function a(l,c){try{return wr(i(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}},to_sheet:i,from_sheet:function s(l,c){var u=c||{};if(+u.codepage>=0&&vn(+u.codepage),"string"==u.type)throw new Error("Cannot write DBF to JS string");var d=Qt(),f=fo(l,{header:1,raw:!0,cellDates:!0}),p=f[0],m=f.slice(1),x=l["!cols"]||[],h=0,v=0,T=0,S=1;for(h=0;h<p.length;++h)if(((x[h]||{}).DBF||{}).name)p[h]=x[h].DBF.name,++T;else if(null!=p[h]){if(++T,"number"==typeof p[h]&&(p[h]=p[h].toString(10)),"string"!=typeof p[h])throw new Error("DBF Invalid column name "+p[h]+" |"+typeof p[h]+"|");if(p.indexOf(p[h])!==h)for(v=0;v<1024;++v)if(-1==p.indexOf(p[h]+"_"+v)){p[h]+="_"+v;break}}var y=Ve(l["!ref"]),P=[],U=[],M=[];for(h=0;h<=y.e.c-y.s.c;++h){var I="",B="",R=0,W=[];for(v=0;v<m.length;++v)null!=m[v][h]&&W.push(m[v][h]);if(0!=W.length&&null!=p[h]){for(v=0;v<W.length;++v){switch(typeof W[v]){case"number":B="B";break;case"string":default:B="C";break;case"boolean":B="L";break;case"object":B=W[v]instanceof Date?"D":"C"}R=Math.max(R,String(W[v]).length),I=I&&I!=B?"C":B}R>250&&(R=250),"C"==(B=((x[h]||{}).DBF||{}).type)&&x[h].DBF.len>R&&(R=x[h].DBF.len),"B"==I&&"N"==B&&(I="N",M[h]=x[h].DBF.dec,R=x[h].DBF.len),U[h]="C"==I||"N"==B?R:o[I]||0,S+=U[h],P[h]=I}else P[h]="?"}var J=d.next(32);for(J.write_shift(4,318902576),J.write_shift(4,m.length),J.write_shift(2,296+32*T),J.write_shift(2,S),h=0;h<4;++h)J.write_shift(4,0);for(J.write_shift(4,0|(+r[Br]||3)<<8),h=0,v=0;h<p.length;++h)if(null!=p[h]){var L=d.next(32),le=(p[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,le,"sbcs"),L.write_shift(1,"?"==P[h]?"C":P[h],"sbcs"),L.write_shift(4,v),L.write_shift(1,U[h]||o[P[h]]||0),L.write_shift(1,M[h]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),v+=U[h]||o[P[h]]||0}var xe=d.next(264);for(xe.write_shift(4,13),h=0;h<65;++h)xe.write_shift(4,0);for(h=0;h<m.length;++h){var ce=d.next(S);for(ce.write_shift(1,0),v=0;v<p.length;++v)if(null!=p[v])switch(P[v]){case"L":ce.write_shift(1,null==m[h][v]?63:m[h][v]?84:70);break;case"B":ce.write_shift(8,m[h][v]||0,"f");break;case"N":var Te="0";for("number"==typeof m[h][v]&&(Te=m[h][v].toFixed(M[v]||0)),T=0;T<U[v]-Te.length;++T)ce.write_shift(1,32);ce.write_shift(1,Te,"sbcs");break;case"D":m[h][v]?(ce.write_shift(4,("0000"+m[h][v].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(m[h][v].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+m[h][v].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var Ce=String(null!=m[h][v]?m[h][v]:"").slice(0,U[v]);for(ce.write_shift(1,Ce,"sbcs"),T=0;T<U[v]-Ce.length;++T)ce.write_shift(1,32)}}return d.next(1).write_shift(1,26),d.end()}}}(),U0=function(){var t={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1bN("+dt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(p,m){var x=t[m];return"number"==typeof x?No(x):x},i=function(p,m,x){var h=m.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return 59==h?p:No(h)};function o(p,m){var J,x=p.split(/[\n\r]+/),h=-1,v=-1,T=0,S=0,y=[],P=[],U=null,M={},I=[],B=[],R=[],W=0;for(+m.codepage>=0&&vn(+m.codepage);T!==x.length;++T){W=0;var ce,L=x[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(r,e),le=L.replace(/;;/g,"\0").split(";").map(function(A){return A.replace(/\u0000/g,";")});if(L.length>0)switch(le[0]){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==le[1].charAt(0)&&P.push(L.slice(3).replace(/;;/g,";"));break;case"C":var Te=!1,Ce=!1,Be=!1,me=!1,we=-1,ee=-1;for(S=1;S<le.length;++S)switch(le[S].charAt(0)){case"A":case"G":break;case"X":v=parseInt(le[S].slice(1))-1,Ce=!0;break;case"Y":for(h=parseInt(le[S].slice(1))-1,Ce||(v=0),J=y.length;J<=h;++J)y[J]=[];break;case"K":'"'===(ce=le[S].slice(1)).charAt(0)?ce=ce.slice(1,ce.length-1):"TRUE"===ce?ce=!0:"FALSE"===ce?ce=!1:isNaN(Dn(ce))?isNaN(pi(ce).getDate())||(ce=it(ce)):(ce=Dn(ce),null!==U&&Ur(U)&&(ce=Ha(ce))),Te=!0;break;case"E":me=!0;var F=wi(le[S].slice(1),{r:h,c:v});y[h][v]=[y[h][v],F];break;case"S":Be=!0,y[h][v]=[y[h][v],"S5S"];break;case"R":we=parseInt(le[S].slice(1))-1;break;case"C":ee=parseInt(le[S].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+L)}if(Te&&(y[h][v]&&2==y[h][v].length?y[h][v][0]=ce:y[h][v]=ce,U=null),Be){if(me)throw new Error("SYLK shared formula cannot have own formula");var Z=we>-1&&y[we][ee];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");y[h][v][1]=ou(Z[1],{r:h-we,c:v-ee})}break;case"F":var N=0;for(S=1;S<le.length;++S)switch(le[S].charAt(0)){case"X":v=parseInt(le[S].slice(1))-1,++N;break;case"Y":for(h=parseInt(le[S].slice(1))-1,J=y.length;J<=h;++J)y[J]=[];break;case"M":W=parseInt(le[S].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":U=P[parseInt(le[S].slice(1))];break;case"W":for(R=le[S].slice(1).split(" "),J=parseInt(R[0],10);J<=parseInt(R[1],10);++J)W=parseInt(R[2],10),B[J-1]=0===W?{hidden:!0}:{wch:W},kr(B[J-1]);break;case"C":B[v=parseInt(le[S].slice(1))-1]||(B[v]={});break;case"R":I[h=parseInt(le[S].slice(1))-1]||(I[h]={}),W>0?(I[h].hpt=W,I[h].hpx=Ci(W)):0===W&&(I[h].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+L)}N<1&&(U=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+L)}}return I.length>0&&(M["!rows"]=I),B.length>0&&(M["!cols"]=B),m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),[y,M]}function s(p,m){var x=function a(p,m){switch(m.type){case"base64":return o(ln(p),m);case"binary":return o(p,m);case"buffer":return o(Pe&&Buffer.isBuffer(p)?p.toString("binary"):_r(p),m);case"array":return o(Hr(p),m)}throw new Error("Unrecognized type "+m.type)}(p,m),v=x[1],T=gi(x[0],m);return dt(v).forEach(function(S){T[S]=v[S]}),T}function c(p,m,x,h){var v="C;Y"+(x+1)+";X"+(h+1)+";K";switch(p.t){case"n":v+=p.v||0,p.f&&!p.F&&(v+=";E"+bs(p.f,{r:x,c:h}));break;case"b":v+=p.v?"TRUE":"FALSE";break;case"e":v+=p.w||p.v;break;case"d":v+='"'+(p.w||p.v)+'"';break;case"s":v+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return v}return t["|"]=254,{to_workbook:function l(p,m){return wr(s(p,m),m)},to_sheet:s,from_sheet:function f(p,m){var T,x=["ID;PWXL;N;E"],h=[],v=Ve(p["!ref"]),S=Array.isArray(p),y="\r\n";x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),p["!cols"]&&function u(p,m){m.forEach(function(x,h){var v="F;W"+(h+1)+" "+(h+1)+" ";x.hidden?v+="0":("number"==typeof x.width&&!x.wpx&&(x.wpx=ta(x.width)),"number"==typeof x.wpx&&!x.wch&&(x.wch=na(x.wpx)),"number"==typeof x.wch&&(v+=Math.round(x.wch)))," "!=v.charAt(v.length-1)&&p.push(v)})}(x,p["!cols"]),p["!rows"]&&function d(p,m){m.forEach(function(x,h){var v="F;";x.hidden?v+="M0;":x.hpt?v+="M"+20*x.hpt+";":x.hpx&&(v+="M"+20*ra(x.hpx)+";"),v.length>2&&p.push(v+"R"+(h+1))})}(x,p["!rows"]),x.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var P=v.s.r;P<=v.e.r;++P)for(var U=v.s.c;U<=v.e.c;++U){var M=ze({r:P,c:U});(T=S?(p[P]||[])[U]:p[M])&&(null!=T.v||T.f&&!T.F)&&h.push(c(T,0,P,U))}return x.join(y)+y+h.join(y)+y+"E"+y}}}(),H0=function(){function r(o,s){for(var l=o.split("\n"),c=-1,u=-1,d=0,f=[];d!==l.length;++d)if("BOT"!==l[d].trim()){if(!(c<0)){for(var p=l[d].trim().split(","),m=p[0],x=p[1],h=l[++d]||"";1&(h.match(/["]/g)||[]).length&&d<l.length-1;)h+="\n"+l[++d];switch(h=h.trim(),+m){case-1:if("BOT"===h){f[++c]=[],u=0;continue}if("EOD"!==h)throw new Error("Unrecognized DIF special command "+h);break;case 0:f[c][u]="TRUE"===h||"FALSE"!==h&&(isNaN(Dn(x))?isNaN(pi(x).getDate())?x:it(x):Dn(x)),++u;break;case 1:(h=(h=h.slice(1,h.length-1)).replace(/""/g,'"'))&&h.match(/^=".*"$/)&&(h=h.slice(2,-1)),f[c][u++]=""!==h?h:null}if("EOD"===h)break}}else f[++c]=[],u=0;return s&&s.sheetRows&&(f=f.slice(0,s.sheetRows)),f}function e(o,s){return gi(function t(o,s){switch(s.type){case"base64":return r(ln(o),s);case"binary":return r(o,s);case"buffer":return r(Pe&&Buffer.isBuffer(o)?o.toString("binary"):_r(o),s);case"array":return r(Hr(o),s)}throw new Error("Unrecognized type "+s.type)}(o,s),s)}return{to_workbook:function i(o,s){return wr(e(o,s),s)},to_sheet:e,from_sheet:function(){var o=function(c,u,d,f,p){c.push(u),c.push(d+","+f),c.push('"'+p.replace(/"/g,'""')+'"')},s=function(c,u,d,f){c.push(u+","+d),c.push(1==u?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var f,u=[],d=Ve(c["!ref"]),p=Array.isArray(c);o(u,"TABLE",0,1,"sheetjs"),o(u,"VECTORS",0,d.e.r-d.s.r+1,""),o(u,"TUPLES",0,d.e.c-d.s.c+1,""),o(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){s(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var h=ze({r:m,c:x});if(f=p?(c[m]||[])[x]:c[h])switch(f.t){case"n":var v=f.w;!v&&null!=f.v&&(v=f.v),null==v?s(u,1,0,f.f&&!f.F?"="+f.f:""):s(u,0,v,"V");break;case"b":s(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=un(f.z||Se[14],kt(it(f.v)))),s(u,0,f.w,"V");break;default:s(u,1,0,"")}else s(u,1,0,"")}}return s(u,-1,0,"EOD"),u.join("\r\n")}}()}}(),V0=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function r(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function i(f,p){return gi(function e(f,p){for(var m=f.split("\n"),x=-1,h=-1,v=0,T=[];v!==m.length;++v){var S=m[v].trim().split(":");if("cell"===S[0]){var y=lt(S[1]);if(T.length<=y.r)for(x=T.length;x<=y.r;++x)T[x]||(T[x]=[]);switch(x=y.r,h=y.c,S[2]){case"t":T[x][h]=t(S[3]);break;case"v":T[x][h]=+S[3];break;case"vtf":var P=S[S.length-1];case"vtc":T[x][h]="nl"===S[3]?!!+S[4]:+S[4],"vtf"==S[2]&&(T[x][h]=[T[x][h],P])}}}return p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),T}(f,p),p)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var x,p=[],m=[],h="",v=qt(f["!ref"]),T=Array.isArray(f),S=v.s.r;S<=v.e.r;++S)for(var y=v.s.c;y<=v.e.c;++y)if(h=ze({r:S,c:y}),(x=T?(f[S]||[])[y]:f[h])&&null!=x.v&&"z"!==x.t){switch(m=["cell",h,"t"],x.t){case"s":case"str":m.push(r(x.v));break;case"n":x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=r(x.f)):(m[2]="v",m[3]=x.v);break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=r(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var P=kt(it(x.v));m[2]="vtc",m[3]="nd",m[4]=""+P,m[5]=x.w||un(x.z||Se[14],P);break;case"e":continue}p.push(m.join(":"))}return p.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join("\n")}return{to_workbook:function a(f,p){return wr(i(f,p),p)},to_sheet:i,from_sheet:function d(f){return[o,s,l,s,u(f),c].join("\n")}}}(),vi=function(){function t(d,f,p,m,x){x.raw?f[p][m]=d:""===d||(f[p][m]="TRUE"===d||"FALSE"!==d&&(isNaN(Dn(d))?isNaN(pi(d).getDate())?d:it(d):Dn(d)))}var e={44:",",9:"\t",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function a(d){for(var f={},p=!1,m=0,x=0;m<d.length;++m)34==(x=d.charCodeAt(m))?p=!p:!p&&x in e&&(f[x]=(f[x]||0)+1);for(m in x=[],f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m]);if(!x.length)for(m in f=i)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m]);return x.sort(function(h,v){return h[0]-v[0]||i[h[1]]-i[v[1]]}),e[x.pop()[1]]||44}function s(d,f){return!f||!f.PRN||f.FS||"sep="==d.slice(0,4)||d.indexOf("\t")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?function o(d,f){var p=f||{},m="",x=p.dense?[]:{},h={s:{c:0,r:0},e:{c:0,r:0}};"sep="==d.slice(0,4)?13==d.charCodeAt(5)&&10==d.charCodeAt(6)?(m=d.charAt(4),d=d.slice(7)):13==d.charCodeAt(5)||10==d.charCodeAt(5)?(m=d.charAt(4),d=d.slice(6)):m=a(d.slice(0,1024)):m=p&&p.FS?p.FS:a(d.slice(0,1024));var v=0,T=0,S=0,y=0,P=0,U=m.charCodeAt(0),M=!1,I=0,B=d.charCodeAt(0);d=d.replace(/\r\n/gm,"\n");var R=null!=p.dateNF?function d1(t){var r="number"==typeof t?Se[t]:t;return r=r.replace(sc,"(\\d+)"),new RegExp("^"+r+"$")}(p.dateNF):null;function W(){var J=d.slice(y,P),L={};if('"'==J.charAt(0)&&'"'==J.charAt(J.length-1)&&(J=J.slice(1,-1).replace(/""/g,'"')),0===J.length)L.t="z";else if(p.raw)L.t="s",L.v=J;else if(0===J.trim().length)L.t="s",L.v=J;else if(61==J.charCodeAt(0))34==J.charCodeAt(1)&&34==J.charCodeAt(J.length-1)?(L.t="s",L.v=J.slice(2,-1).replace(/""/g,'"')):function Uy(t){return 1!=t.length}(J)?(L.t="n",L.f=J.slice(1)):(L.t="s",L.v=J);else if("TRUE"==J)L.t="b",L.v=!0;else if("FALSE"==J)L.t="b",L.v=!1;else if(isNaN(S=Dn(J)))if(!isNaN(pi(J).getDate())||R&&J.match(R)){L.z=p.dateNF||Se[14];var le=0;R&&J.match(R)&&(J=function f1(t,r,e){var i=-1,a=-1,o=-1,s=-1,l=-1,c=-1;(r.match(sc)||[]).forEach(function(f,p){var m=parseInt(e[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":i=m;break;case"d":o=m;break;case"h":s=m;break;case"s":c=m;break;case"m":s>=0?l=m:a=m}}),c>=0&&-1==l&&a>=0&&(l=a,a=-1);var u=(""+(i>=0?i:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);7==u.length&&(u="0"+u),8==u.length&&(u="20"+u);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return-1==s&&-1==l&&-1==c?u:-1==i&&-1==a&&-1==o?d:u+"T"+d}(0,p.dateNF,J.match(R)||[]),le=1),p.cellDates?(L.t="d",L.v=it(J,le)):(L.t="n",L.v=kt(it(J,le))),!1!==p.cellText&&(L.w=un(L.z,L.v instanceof Date?kt(L.v):L.v)),p.cellNF||delete L.z}else L.t="s",L.v=J;else L.t="n",!1!==p.cellText&&(L.w=J),L.v=S;if("z"==L.t||(p.dense?(x[v]||(x[v]=[]),x[v][T]=L):x[ze({c:T,r:v})]=L),B=d.charCodeAt(y=P+1),h.e.c<T&&(h.e.c=T),h.e.r<v&&(h.e.r=v),I==U)++T;else if(T=0,++v,p.sheetRows&&p.sheetRows<=v)return!0}e:for(;P<d.length;++P)switch(I=d.charCodeAt(P)){case 34:34===B&&(M=!M);break;case U:case 10:case 13:if(!M&&W())break e}return P-y>0&&W(),x["!ref"]=De(h),x}(d,f):gi(function r(d,f){var p=f||{},m=[];if(!d||0===d.length)return m;for(var x=d.split(/[\r\n]/),h=x.length-1;h>=0&&0===x[h].length;)--h;for(var v=10,T=0,S=0;S<=h;++S)-1==(T=x[S].indexOf(" "))?T=x[S].length:T++,v=Math.max(v,T);for(S=0;S<=h;++S){m[S]=[];var y=0;for(t(x[S].slice(0,v).trim(),m,S,y,p),y=1;y<=(x[S].length-v)/10+1;++y)t(x[S].slice(v+10*(y-1),v+10*y).trim(),m,S,y,p)}return p.sheetRows&&(m=m.slice(0,p.sheetRows)),m}(d,f),f)}function l(d,f){var p="",m="string"==f.type?[0,0,0,0]:Zs(d,f);switch(f.type){case"base64":p=ln(d);break;case"binary":case"string":p=d;break;case"buffer":p=65001==f.codepage?d.toString("utf8"):Pe&&Buffer.isBuffer(d)?d.toString("binary"):_r(d);break;case"array":p=Hr(d);break;default:throw new Error("Unrecognized type "+f.type)}return 239==m[0]&&187==m[1]&&191==m[2]?p=Xe(p.slice(3)):"string"!=f.type&&"buffer"!=f.type&&65001==f.codepage&&(p=Xe(p)),"socialcalc:version:"==p.slice(0,19)?V0.to_sheet("string"==f.type?p:Xe(p),f):s(p,f)}return{to_workbook:function c(d,f){return wr(l(d,f),f)},to_sheet:l,from_sheet:function u(d){for(var m,f=[],p=Ve(d["!ref"]),x=Array.isArray(d),h=p.s.r;h<=p.e.r;++h){for(var v=[],T=p.s.c;T<=p.e.c;++T){var S=ze({r:h,c:T});if((m=x?(d[h]||[])[T]:d[S])&&null!=m.v){for(var y=(m.w||(Hn(m),m.w)||"").slice(0,10);y.length<10;)y+=" ";v.push(y+(0===T?" ":""))}else v.push("          ")}f.push(v.join(""))}return f.join("\n")}}}(),Kr=function(){function t(F,Z,N){if(F){Rt(F,F.l||0);for(var A=N.Enum||we;F.l<F.length;){var X=F.read_shift(2),pe=A[X]||A[65535],ie=F.read_shift(2),ae=F.l+ie,te=pe.f&&pe.f(F,ie,N);if(F.l=ae,Z(te,pe,X))return}}}function e(F,Z){if(!F)return F;var N=Z||{},A=N.dense?[]:{},X="Sheet1",pe="",ie=0,ae={},te=[],Ne=[],E={s:{r:0,c:0},e:{r:0,c:0}},Qe=N.sheetRows||0;if(0==F[2]&&(8==F[3]||9==F[3])&&F.length>=16&&5==F[14]&&108===F[15])throw new Error("Unsupported Works 3 for Mac file");if(2==F[2])N.Enum=we,t(F,function(ge,_t,In){switch(In){case 0:N.vers=ge,ge>=4096&&(N.qpro=!0);break;case 6:E=ge;break;case 204:ge&&(pe=ge);break;case 222:pe=ge;break;case 15:case 51:N.qpro||(ge[1].v=ge[1].v.slice(1));case 13:case 14:case 16:14==In&&112==(112&ge[2])&&(15&ge[2])>1&&(15&ge[2])<15&&(ge[1].z=N.dateNF||Se[14],N.cellDates&&(ge[1].t="d",ge[1].v=Ha(ge[1].v))),N.qpro&&ge[3]>ie&&(A["!ref"]=De(E),ae[X]=A,te.push(X),A=N.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},ie=ge[3],X=pe||"Sheet"+(ie+1),pe="");var Gn=N.dense?(A[ge[0].r]||[])[ge[0].c]:A[ze(ge[0])];if(Gn){Gn.t=ge[1].t,Gn.v=ge[1].v,null!=ge[1].z&&(Gn.z=ge[1].z),null!=ge[1].f&&(Gn.f=ge[1].f);break}N.dense?(A[ge[0].r]||(A[ge[0].r]=[]),A[ge[0].r][ge[0].c]=ge[1]):A[ze(ge[0])]=ge[1]}},N);else{if(26!=F[2]&&14!=F[2])throw new Error("Unrecognized LOTUS BOF "+F[2]);N.Enum=ee,14==F[2]&&(N.qpro=!0,F.l=0),t(F,function(ge,_t,In){switch(In){case 204:X=ge;break;case 22:ge[1].v=ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ge[3]>ie&&(A["!ref"]=De(E),ae[X]=A,te.push(X),A=N.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},X="Sheet"+((ie=ge[3])+1)),Qe>0&&ge[0].r>=Qe)break;N.dense?(A[ge[0].r]||(A[ge[0].r]=[]),A[ge[0].r][ge[0].c]=ge[1]):A[ze(ge[0])]=ge[1],E.e.c<ge[0].c&&(E.e.c=ge[0].c),E.e.r<ge[0].r&&(E.e.r=ge[0].r);break;case 27:ge[14e3]&&(Ne[ge[14e3][0]]=ge[14e3][1]);break;case 1537:Ne[ge[0]]=ge[1],ge[0]==ie&&(X=ge[1])}},N)}if(A["!ref"]=De(E),ae[pe||X]=A,te.push(pe||X),!Ne.length)return{SheetNames:te,Sheets:ae};for(var Ue={},qe=[],He=0;He<Ne.length;++He)ae[te[He]]?(qe.push(Ne[He]||te[He]),Ue[Ne[He]]=ae[Ne[He]]||ae[te[He]]):(qe.push(Ne[He]),Ue[Ne[He]]={"!ref":"A1"});return{SheetNames:qe,Sheets:Ue}}function u(F,Z,N){var A=[{c:0,r:0},{t:"n",v:0},0,0];return N.qpro&&20768!=N.vers?(A[0].c=F.read_shift(1),A[3]=F.read_shift(1),A[0].r=F.read_shift(2),F.l+=2):(A[2]=F.read_shift(1),A[0].c=F.read_shift(2),A[0].r=F.read_shift(2)),A}function d(F,Z,N){var A=F.l+Z,X=u(F,0,N);if(X[1].t="s",20768==N.vers){F.l++;var pe=F.read_shift(1);return X[1].v=F.read_shift(pe,"utf8"),X}return N.qpro&&F.l++,X[1].v=F.read_shift(A-F.l,"cstr"),X}function f(F,Z,N){var A=Q(7+N.length);A.write_shift(1,255),A.write_shift(2,Z),A.write_shift(2,F),A.write_shift(1,39);for(var X=0;X<A.length;++X){var pe=N.charCodeAt(X);A.write_shift(1,pe>=128?95:pe)}return A.write_shift(1,0),A}function m(F,Z,N){var A=Q(7);return A.write_shift(1,255),A.write_shift(2,Z),A.write_shift(2,F),A.write_shift(2,N,"i"),A}function h(F,Z,N){var A=Q(13);return A.write_shift(1,255),A.write_shift(2,Z),A.write_shift(2,F),A.write_shift(8,N,"f"),A}function T(F,Z,N){var A=32768&Z;return Z=(A?F:0)+((Z&=-32769)>=8192?Z-16384:Z),(A?"":"$")+(N?ot(Z):ht(Z))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(F){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=F.read_shift(2),Z[3]=F[F.l++],Z[0].c=F[F.l++],Z}function I(F,Z,N,A){var X=Q(6+A.length);X.write_shift(2,F),X.write_shift(1,N),X.write_shift(1,Z),X.write_shift(1,39);for(var pe=0;pe<A.length;++pe){var ie=A.charCodeAt(pe);X.write_shift(1,ie>=128?95:ie)}return X.write_shift(1,0),X}function R(F,Z){var N=U(F),A=F.read_shift(4),X=F.read_shift(4),pe=F.read_shift(2);if(65535==pe)return 0===A&&3221225472===X?(N[1].t="e",N[1].v=15):0===A&&3489660928===X?(N[1].t="e",N[1].v=42):N[1].v=0,N;var ie=32768&pe;return pe=(32767&pe)-16446,N[1].v=(1-2*ie)*(X*Math.pow(2,pe+32)+A*Math.pow(2,pe)),N}function W(F,Z,N,A){var X=Q(14);if(X.write_shift(2,F),X.write_shift(1,N),X.write_shift(1,Z),0==A)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var pe=0,ie=0,te=0;return A<0&&(pe=1,A=-A),ie=0|Math.log2(A),0==(2147483648&(te=(A/=Math.pow(2,ie-31))>>>0))&&(++ie,te=(A/=2)>>>0),A-=te,te|=2147483648,te>>>=0,A*=Math.pow(2,32),X.write_shift(4,A>>>0),X.write_shift(4,te),X.write_shift(2,ie+=16383+(pe?32768:0)),X}function le(F,Z){var N=U(F),A=F.read_shift(8,"f");return N[1].v=A,N}function ce(F,Z){return 0==F[F.l+Z-1]?F.read_shift(Z,"cstr"):""}function me(F,Z){var N=Q(5+F.length);N.write_shift(2,14e3),N.write_shift(2,Z);for(var A=0;A<F.length;++A){var X=F.charCodeAt(A);N[N.l++]=X>127?95:X}return N[N.l++]=0,N}var we={0:{n:"BOF",f:yt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function l(F,Z,N){var A={s:{c:0,r:0},e:{c:0,r:0}};return 8==Z&&N.qpro?(A.s.c=F.read_shift(1),F.l++,A.s.r=F.read_shift(2),A.e.c=F.read_shift(1),F.l++,A.e.r=F.read_shift(2),A):(A.s.c=F.read_shift(2),A.s.r=F.read_shift(2),12==Z&&N.qpro&&(F.l+=2),A.e.c=F.read_shift(2),A.e.r=F.read_shift(2),12==Z&&N.qpro&&(F.l+=2),65535==A.s.c&&(A.s.c=A.e.c=A.s.r=A.e.r=0),A)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function p(F,Z,N){var A=u(F,0,N);return A[1].v=F.read_shift(2,"i"),A}},14:{n:"NUMBER",f:function x(F,Z,N){var A=u(F,0,N);return A[1].v=F.read_shift(8,"f"),A}},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:function v(F,Z,N){var A=F.l+Z,X=u(F,0,N);if(X[1].v=F.read_shift(8,"f"),N.qpro)F.l=A;else{var pe=F.read_shift(2);(function P(F,Z){Rt(F,0);for(var N=[],A=0,X="",pe="",ie="",ae="";F.l<F.length;){var te=F[F.l++];switch(te){case 0:N.push(F.read_shift(8,"f"));break;case 1:pe=T(Z[0].c,F.read_shift(2),!0),X=T(Z[0].r,F.read_shift(2),!1),N.push(pe+X);break;case 2:var Ne=T(Z[0].c,F.read_shift(2),!0),E=T(Z[0].r,F.read_shift(2),!1);pe=T(Z[0].c,F.read_shift(2),!0),X=T(Z[0].r,F.read_shift(2),!1),N.push(Ne+E+":"+pe+X);break;case 3:if(F.l<F.length)return void console.error("WK1 premature formula end");break;case 4:N.push("("+N.pop()+")");break;case 5:N.push(F.read_shift(2));break;case 6:for(var Qe="";te=F[F.l++];)Qe+=String.fromCharCode(te);N.push('"'+Qe.replace(/"/g,'""')+'"');break;case 8:N.push("-"+N.pop());break;case 23:N.push("+"+N.pop());break;case 22:N.push("NOT("+N.pop()+")");break;case 20:case 21:ae=N.pop(),ie=N.pop(),N.push(["AND","OR"][te-20]+"("+ie+","+ae+")");break;default:if(te<32&&y[te])ae=N.pop(),ie=N.pop(),N.push(ie+y[te]+ae);else{if(!S[te])return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16));if(69==(A=S[te][1])&&(A=F[F.l++]),A>N.length)return void console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+N.join("|")+"|");var Ue=N.slice(-A);N.length-=A,N.push(S[te][0]+"("+Ue.join(",")+")")}}}1==N.length?Z[1].f=""+N[0]:console.error("WK1 bad formula parse |"+N.join("|")+"|")})(F.slice(F.l,F.l+pe),X),F.l+=pe}return X}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:function Te(F,Z){var N=F[F.l++];N>Z-1&&(N=Z-1);for(var A="";A.length<N;)A+=String.fromCharCode(F[F.l++]);return A}},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function M(F,Z){var N=U(F);return N[1].t="s",N[1].v=F.read_shift(Z-4,"cstr"),N}},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:function B(F,Z){var N=U(F);N[1].v=F.read_shift(2);var A=N[1].v>>1;if(1&N[1].v)switch(7&A){case 0:A=5e3*(A>>3);break;case 1:A=500*(A>>3);break;case 2:A=(A>>3)/20;break;case 3:A=(A>>3)/200;break;case 4:A=(A>>3)/2e3;break;case 5:A=(A>>3)/2e4;break;case 6:A=(A>>3)/16;break;case 7:A=(A>>3)/64}return N[1].v=A,N}},25:{n:"FORMULA19",f:function J(F,Z){var N=R(F);return F.l+=Z-14,N}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function Be(F,Z){for(var N={},A=F.l+Z;F.l<A;){var X=F.read_shift(2);if(14e3==X){for(N[X]=[0,""],N[X][0]=F.read_shift(2);F[F.l];)N[X][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return N}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function L(F,Z){var N=U(F),A=F.read_shift(4);return N[1].v=A>>6,N}},38:{n:"??"},39:{n:"NUMBER27",f:le},40:{n:"FORMULA28",f:function xe(F,Z){var N=le(F);return F.l+=Z-10,N}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function Ce(F,Z,N){if(N.qpro&&!(Z<21)){var A=F.read_shift(1);return F.l+=17,F.l+=1,F.l+=2,[A,F.read_shift(Z-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function i(F,Z){var N=Z||{};if(+N.codepage>=0&&vn(+N.codepage),"string"==N.type)throw new Error("Cannot write WK1 to JS string");var A=Qt(),X=Ve(F["!ref"]),pe=Array.isArray(F),ie=[];ue(A,0,function o(F){var Z=Q(2);return Z.write_shift(2,F),Z}(1030)),ue(A,6,function c(F){var Z=Q(8);return Z.write_shift(2,F.s.c),Z.write_shift(2,F.s.r),Z.write_shift(2,F.e.c),Z.write_shift(2,F.e.r),Z}(X));for(var ae=Math.min(X.e.r,8191),te=X.s.r;te<=ae;++te)for(var Ne=ht(te),E=X.s.c;E<=X.e.c;++E){te===X.s.r&&(ie[E]=ot(E));var Ue=pe?(F[te]||[])[E]:F[ie[E]+Ne];Ue&&"z"!=Ue.t&&("n"==Ue.t?(0|Ue.v)==Ue.v&&Ue.v>=-32768&&Ue.v<=32767?ue(A,13,m(te,E,Ue.v)):ue(A,14,h(te,E,Ue.v)):ue(A,15,f(te,E,Hn(Ue).slice(0,239))))}return ue(A,1),A.end()},book_to_wk3:function a(F,Z){var N=Z||{};if(+N.codepage>=0&&vn(+N.codepage),"string"==N.type)throw new Error("Cannot write WK3 to JS string");var A=Qt();ue(A,0,function s(F){var Z=Q(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var N=0,A=0,X=0,pe=0;pe<F.SheetNames.length;++pe){var ae=F.Sheets[F.SheetNames[pe]];if(ae&&ae["!ref"]){++X;var te=qt(ae["!ref"]);N<te.e.r&&(N=te.e.r),A<te.e.c&&(A=te.e.c)}}return N>8191&&(N=8191),Z.write_shift(2,N),Z.write_shift(1,X),Z.write_shift(1,A),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}(F));for(var X=0,pe=0;X<F.SheetNames.length;++X)(F.Sheets[F.SheetNames[X]]||{})["!ref"]&&ue(A,27,me(F.SheetNames[X],pe++));var ie=0;for(X=0;X<F.SheetNames.length;++X){var ae=F.Sheets[F.SheetNames[X]];if(ae&&ae["!ref"]){for(var te=Ve(ae["!ref"]),Ne=Array.isArray(ae),E=[],Qe=Math.min(te.e.r,8191),Ue=te.s.r;Ue<=Qe;++Ue)for(var qe=ht(Ue),He=te.s.c;He<=te.e.c;++He){Ue===te.s.r&&(E[He]=ot(He));var _t=Ne?(ae[Ue]||[])[He]:ae[E[He]+qe];_t&&"z"!=_t.t&&("n"==_t.t?ue(A,23,W(Ue,He,ie,_t.v)):ue(A,22,I(Ue,He,ie,Hn(_t).slice(0,239))))}++ie}}return ue(A,1),A.end()},to_workbook:function r(F,Z){switch(Z.type){case"base64":return e(cn(ln(F)),Z);case"binary":return e(cn(F),Z);case"buffer":case"array":return e(F,Z)}throw"Unsupported type "+Z.type}}}(),zC=function(){var t=ji("t"),r=ji("rPr");function e(o){var s=o.match(t);if(!s)return{t:"s",v:""};var l={t:"s",v:Ge(s[1])},c=o.match(r);return c&&(l.s=function bC(t){var r={},e=t.match(Ut),i=0,a=!1;if(e)for(;i!=e.length;++i){var o=Ie(e[i]);switch(o[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==o.val)break;r.cp=Ao[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=o.val;break;case"<sz":r.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting"}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if("0"==o.val)break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if("0"==o.val)break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":o.rgb&&(r.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==o[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+o[0])}}return r}(c[1])),l}var i=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(i,"").split(a).map(e).filter(function(l){return l.v})}}(),IC=function(){var r=/(\r\n|\n)/g;function i(a){var o=[[],a.v,[]];return a.v?(a.s&&function e(a,o,s){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),o.push('<span style="'+l.join("")+'">'),a.b&&(o.push("<b>"),s.push("</b>")),a.i&&(o.push("<i>"),s.push("</i>")),a.strike&&(o.push("<s>"),s.push("</s>"));var c=a.valign||"";"superscript"==c||"super"==c?c="sup":"subscript"==c&&(c="sub"),""!=c&&(o.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>")}(a.s,o[0],o[2]),o[0].join("")+o[1].replace(r,"<br/>")+o[2].join("")):""}return function(o){return o.map(i).join("")}}(),OC=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,EC=/<(?:\w+:)?r>/,FC=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function vs(t,r){var e=!r||r.cellHTML,i={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=Ge(Xe(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=Xe(t),e&&(i.h=Zo(i.t))):t.match(EC)&&(i.r=Xe(t),i.t=Ge(Xe((t.replace(FC,"").match(OC)||[]).join("").replace(Ut,""))),e&&(i.h=IC(zC(i.r)))),i):{t:""}}var DC=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,AC=/<(?:\w+:)?(?:si|sstItem)>/g,NC=/<\/(?:\w+:)?(?:si|sstItem)>/,RC=/^\s|\s$|[\t\n\r]/;function Z0(t,r){if(!r.bookSST)return"";var e=[pt];e[e.length]=se("sst",null,{xmlns:yr[0],count:t.Count,uniqueCount:t.Unique});for(var i=0;i!=t.length;++i)if(null!=t[i]){var a=t[i],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(RC)&&(o+=' xml:space="preserve"'),o+=">"+Je(a.t)+"</t>"),e[e.length]=o+="</si>"}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}var UC=function Q1(t,r){var e=!1;return null==r&&(e=!0,r=Q(15+4*t.t.length)),r.write_shift(1,0),Ft(t.t,r),e?r.slice(0,r.l):r};function HC(t){var r=Qt();ne(r,159,function LC(t,r){return r||(r=Q(8)),r.write_shift(4,t.Count),r.write_shift(4,t.Unique),r}(t));for(var e=0;e<t.length;++e)ne(r,19,UC(t[e]));return ne(r,160),r.end()}function j0(t){for(var r=[],e=t.split(""),i=0;i<e.length;++i)r[i]=e[i].charCodeAt(0);return r}function nr(t,r){var e={};return e.Major=t.read_shift(2),e.Minor=t.read_shift(2),r>=4&&(t.l+=r-4),e}function ZC(t){for(var r=t.read_shift(4),e=t.l+r-4,i={},a=t.read_shift(4),o=[];a-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(i.name=t.read_shift(0,"lpp4"),i.comps=o,t.l!=e)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+e);return i}function G0(t,r){var e=t.l+r,i={};i.Flags=63&t.read_shift(4),t.l+=4,i.AlgID=t.read_shift(4);var a=!1;switch(i.AlgID){case 26126:case 26127:case 26128:a=36==i.Flags;break;case 26625:a=4==i.Flags;break;case 0:a=16==i.Flags||4==i.Flags||36==i.Flags;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=t.read_shift(4),i.KeySize=t.read_shift(4),i.ProviderType=t.read_shift(4),t.l+=8,i.CSPName=t.read_shift(e-t.l>>1,"utf16le"),t.l=e,i}function W0(t,r){var e={},i=t.l+r;return t.l+=4,e.Salt=t.slice(t.l,t.l+16),t.l+=16,e.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),e.VerifierHash=t.slice(t.l,i),t.l=i,e}function JC(t){if(36!=(63&t.read_shift(4)))throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4);return{t:"Std",h:G0(t,e),v:W0(t,t.length-t.l)}}function QC(){throw new Error("File is password-protected: ECMA-376 Extensible")}function qC(t){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var e=t.read_shift(t.length-t.l,"utf8"),i={};return e.replace(Ut,function(o){var s=Ie(o);switch(Ln(s[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":r.forEach(function(l){i[l]=s[l]});break;case"<dataIntegrity":i.encryptedHmacKey=s.encryptedHmacKey,i.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"<keyEncryptor":i.uri=s.uri;break;case"<encryptedKey":i.encs.push(s);break;default:throw s[0]}}),i}function Cs(t){var e,o,r=0,i=j0(t),a=i.length+1;for((e=gr(a))[0]=i.length,o=1;o!=a;++o)e[o]=i[o-1];for(o=a-1;o>=0;--o)r=((0==(16384&r)?0:1)|r<<1&32767)^e[o];return 52811^r}var Y0=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(s,l){return function(s){return 255&(s/2|128*s)}(s^l)};return function(s){for(var l=j0(s),c=function(s){for(var l=r[s.length-1],c=104,u=s.length-1;u>=0;--u)for(var d=s[u],f=0;7!=f;++f)64&d&&(l^=e[c]),d*=2,--c;return l}(l),u=l.length,d=gr(16),f=0;16!=f;++f)d[f]=0;var x;for(1==(1&u)&&(d[u]=a(t[0],c>>8),d[--u]=a(l[l.length-1],255&c));u>0;)d[--u]=a(l[u],c>>8),d[--u]=a(l[u],255&c);for(u=15,x=15-l.length;x>0;)d[u]=a(t[x],c>>8),--x,d[--u]=a(l[u],255&c),--u,--x;return d}}();var $0=function(){function t(a,o){switch(o.type){case"base64":return r(ln(a),o);case"binary":return r(a,o);case"buffer":return r(Pe&&Buffer.isBuffer(a)?a.toString("binary"):_r(a),o);case"array":return r(Hr(a),o)}throw new Error("Unrecognized type "+o.type)}function r(a,o){var l=(o||{}).dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var x,p=/\\\w+\b/g,m=0,h=-1;x=p.exec(d);){if("\\cell"===x[0]){var v=d.slice(m,p.lastIndex-x[0].length);if(" "==v[0]&&(v=v.slice(1)),++h,v.length){var T={v,t:"s"};Array.isArray(l)?l[f][h]=T:l[ze({r:f,c:h})]=T}}m=p.lastIndex}h>u.e.c&&(u.e.c=h)}),l["!ref"]=De(u),l}return{to_workbook:function e(a,o){return wr(t(a,o),o)},to_sheet:t,from_sheet:function i(a){for(var l,o=["{\\rtf1\\ansi"],s=Ve(a["!ref"]),c=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){o.push("\\trowd\\trautofit1");for(var d=s.s.c;d<=s.e.c;++d)o.push("\\cellx"+(d+1));for(o.push("\\pard\\intbl"),d=s.s.c;d<=s.e.c;++d){var f=ze({r:u,c:d});(l=c?(a[u]||[])[d]:a[f])&&(null!=l.v||l.f&&!l.F)&&(o.push(" "+(l.w||(Hn(l),l.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}}}();function ea(t){for(var r=0,e=1;3!=r;++r)e=256*e+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}function to(t,r){if(0===r)return t;var e=function s2(t){var r=t[0]/255,e=t[1]/255,i=t[2]/255,a=Math.max(r,e,i),o=Math.min(r,e,i),s=a-o;if(0===s)return[0,0,r];var c,l=0,u=a+o;switch(c=s/(u>1?2-u:u),a){case r:l=((e-i)/s+6)%6;break;case e:l=(i-r)/s+2;break;case i:l=(r-e)/s+4}return[l/6,c,u/2]}(function o2(t){var r=t.slice("#"===t[0]?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}(t));return e[2]=r<0?e[2]*(1+r):1-(1-e[2])*(1-r),ea(function l2(t){var c,e=t[1],i=t[2],a=2*e*(i<.5?i:1-i),o=i-a/2,s=[o,o,o],l=6*t[0];if(0!==e)switch(0|l){case 0:case 6:c=a*l,s[0]+=a,s[1]+=c;break;case 1:s[0]+=c=a*(2-l),s[1]+=a;break;case 2:c=a*(l-2),s[1]+=a,s[2]+=c;break;case 3:s[1]+=c=a*(4-l),s[2]+=a;break;case 4:c=a*(l-4),s[2]+=a,s[0]+=c;break;case 5:s[2]+=c=a*(6-l),s[0]+=a}for(var u=0;3!=u;++u)s[u]=Math.round(255*s[u]);return s}(e))}var Gt=6;function ta(t){return Math.floor((t+Math.round(128/Gt)/256)*Gt)}function na(t){return Math.floor((t-5)/Gt*100+.5)/100}function no(t){return Math.round((t*Gt+5)/Gt*256)/256}function ys(t){return no(na(ta(t)))}function ws(t){var r=Math.abs(t-ys(t)),e=Gt;if(r>.005)for(Gt=1;Gt<15;++Gt)Math.abs(t-ys(t))<=r&&(r=Math.abs(t-ys(t)),e=Gt);Gt=e}function kr(t){t.width?(t.wpx=ta(t.width),t.wch=na(t.wpx),t.MDW=Gt):t.wpx?(t.wch=na(t.wpx),t.width=no(t.wch),t.MDW=Gt):"number"==typeof t.wch&&(t.width=no(t.wch),t.wpx=ta(t.width),t.MDW=Gt),t.customWidth&&delete t.customWidth}function ra(t){return 96*t/96}function Ci(t){return 96*t/96}var f2={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},ro=["numFmtId","fillId","fontId","borderId","xfId"],io=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],C2=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var f,d={};return l?((f=(l=l.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(r))&&function g2(t,r,e){r.NumberFmt=[];for(var i=dt(Se),a=0;a<i.length;++a)r.NumberFmt[i[a]]=Se[i[a]];var o=t[0].match(Ut);if(o)for(a=0;a<o.length;++a){var s=Ie(o[a]);switch(Ln(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var l=Ge(Xe(s.formatCode)),c=parseInt(s.numFmtId,10);if(r.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&null!=r.NumberFmt[c];--c);r.NumberFmt[c]=l}Bn(l,c)}break;default:if(e.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}(f,d,u),(f=l.match(a))&&function m2(t,r,e,i){r.Fonts=[];var a={},o=!1;(t[0].match(Ut)||[]).forEach(function(s){var l=Ie(s);switch(Ln(l[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=Xe(l.val));break;case"<b":a.bold=l.val?at(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?at(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?at(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?at(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?at(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?at(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?at(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<charset":if("1"==l.val)break;l.codepage=Ao[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=at(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=$r[a.color.index];81==a.color.index&&(c=$r[1]),c||(c=$r[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&e.themeElements&&e.themeElements.clrScheme&&(a.color.rgb=to(e.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<AlternateContent":case"<ext":o=!0;break;case"</AlternateContent>":case"</ext>":o=!1;break;default:if(i&&i.WTF&&!o)throw new Error("unrecognized "+l[0]+" in fonts")}})}(f,d,c,u),(f=l.match(i))&&function h2(t,r,e,i){r.Fills=[];var a={},o=!1;(t[0].match(Ut)||[]).forEach(function(s){var l=Ie(s);switch(Ln(l[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":r.Fills.push(a={});break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),null!=l.rgb&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(i&&i.WTF&&!o)throw new Error("unrecognized "+l[0]+" in fills")}})}(f,d,0,u),(f=l.match(o))&&function p2(t,r,e,i){r.Borders=[];var a={},o=!1;(t[0].match(Ut)||[]).forEach(function(s){var l=Ie(s);switch(Ln(l[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=at(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=at(l.diagonalDown)),r.Borders.push(a);break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(i&&i.WTF&&!o)throw new Error("unrecognized "+l[0]+" in borders")}})}(f,d,0,u),(f=l.match(e))&&function x2(t,r,e){r.CellXf=[];var i,a=!1;(t[0].match(Ut)||[]).forEach(function(o){var s=Ie(o),l=0;switch(Ln(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(i=s)[0],l=0;l<ro.length;++l)i[ro[l]]&&(i[ro[l]]=parseInt(i[ro[l]],10));for(l=0;l<io.length;++l)i[io[l]]&&(i[io[l]]=at(i[io[l]]));if(r.NumberFmt&&i.numFmtId>392)for(l=392;l>60;--l)if(r.NumberFmt[i.numFmtId]==r.NumberFmt[l]){i.numFmtId=l;break}r.CellXf.push(i);break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),null!=s.textRotation&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=at(s.wrapText)),i.alignment=c;break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(e&&e.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}(f,d,u),d):d}}();function q0(t,r){var i,e=[pt,se("styleSheet",null,{xmlns:yr[0],"xmlns:vt":Ct_vt})];return t.SSF&&null!=(i=function _2(t){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var i=e[0];i<=e[1];++i)null!=t[i]&&(r[r.length]=se("numFmt",null,{numFmtId:i,formatCode:Je(t[i])}))}),1===r.length?"":(r[r.length]="</numFmts>",r[0]=se("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}(t.SSF))&&(e[e.length]=i),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=function v2(t){var r=[];return r[r.length]=se("cellXfs",null),t.forEach(function(e){r[r.length]=se("xf",null,e)}),r[r.length]="</cellXfs>",2===r.length?"":(r[0]=se("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}(r.cellXfs))&&(e[e.length]=i),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function w2(t,r,e){e||(e=Q(6+4*r.length)),e.write_shift(2,t),Ft(r,e);var i=e.length>e.l?e.slice(0,e.l):e;return null==e.l&&(e.l=e.length),i}var Ts,S2=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],b2=Ht;function X0(t,r){r||(r=Q(84)),Ts||(Ts=Ba(S2));var e=Ts[t.patternType];null==e&&(e=40),r.write_shift(4,e);var i=0;if(40!=e)for(Wa({auto:1},r),Wa({auto:1},r);i<12;++i)r.write_shift(4,0);else{for(;i<4;++i)r.write_shift(4,0);for(;i<12;++i)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function K0(t,r,e){return e||(e=Q(16)),e.write_shift(2,r||0),e.write_shift(2,t.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function ia(t,r){return r||(r=Q(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var I2=Ht;function V2(t,r){var e=Qt();return ne(e,278),function A2(t,r){if(r){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var a=i[0];a<=i[1];++a)null!=r[a]&&++e}),0!=e&&(ne(t,615,An(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var a=i[0];a<=i[1];++a)null!=r[a]&&ne(t,44,w2(a,r[a]))}),ne(t,616))}}(e,t.SSF),function N2(t){ne(t,611,An(1)),ne(t,43,function k2(t,r){r||(r=Q(153)),r.write_shift(2,20*t.sz),function ix(t,r){r||(r=Q(2)),r.write_shift(1,(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0)),r.write_shift(1,0)}(t,r),r.write_shift(2,t.bold?700:400);var e=0;"superscript"==t.vertAlign?e=1:"subscript"==t.vertAlign&&(e=2),r.write_shift(2,e),r.write_shift(1,t.underline||0),r.write_shift(1,t.family||0),r.write_shift(1,t.charset||0),r.write_shift(1,0),Wa(t.color,r);var i=0;return"major"==t.scheme&&(i=1),"minor"==t.scheme&&(i=2),r.write_shift(1,i),Ft(t.name,r),r.length>r.l?r.slice(0,r.l):r}({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ne(t,612)}(e),function M2(t){ne(t,603,An(2)),ne(t,45,X0({patternType:"none"})),ne(t,45,X0({patternType:"gray125"})),ne(t,604)}(e),function R2(t){ne(t,613,An(1)),ne(t,46,function O2(t,r){return r||(r=Q(51)),r.write_shift(1,0),ia(0,r),ia(0,r),ia(0,r),ia(0,r),ia(0,r),r.length>r.l?r.slice(0,r.l):r}()),ne(t,614)}(e),function P2(t){ne(t,626,An(1)),ne(t,47,K0({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ne(t,627)}(e),function B2(t,r){ne(t,617,An(r.length)),r.forEach(function(e){ne(t,47,K0(e,0))}),ne(t,618)}(e,r.cellXfs),function L2(t){ne(t,619,An(1)),ne(t,48,function E2(t,r){return r||(r=Q(52)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,+t.builtinId),r.write_shift(1,0),Ga(t.name||"",r),r.length>r.l?r.slice(0,r.l):r}({xfId:0,builtinId:0,name:"Normal"})),ne(t,620)}(e),function U2(t){ne(t,505,An(0)),ne(t,506)}(e),function H2(t){ne(t,508,function F2(t,r,e){var i=Q(2052);return i.write_shift(4,t),Ga(r,i),Ga(e,i),i.length>i.l?i.slice(0,i.l):i}(0,"TableStyleMedium9","PivotStyleMedium4")),ne(t,509)}(e),ne(e,279),e.end()}var Z2=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function j2(t,r,e){r.themeElements.clrScheme=[];var i={};(t[0].match(Ut)||[]).forEach(function(a){var o=Ie(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=o.val;break;case"<a:sysClr":i.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===o[0].charAt(1)?(r.themeElements.clrScheme[Z2.indexOf(o[0])]=i,i={}):i.name=o[0].slice(3,o[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function G2(){}function W2(){}var Y2=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,$2=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,J2=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,q2=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function eu(t,r){(!t||0===t.length)&&(t=ks());var e,i={};if(!(e=t.match(q2)))throw new Error("themeElements not found in theme");return function Q2(t,r,e){var i;r.themeElements={},[["clrScheme",Y2,j2],["fontScheme",$2,G2],["fmtScheme",J2,W2]].forEach(function(a){if(!(i=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](i,r,e)})}(e[0],i,r),i.raw=t,i}function ks(t,r){if(r&&r.themeXLSX)return r.themeXLSX;if(t&&"string"==typeof t.raw)return t.raw;var e=[pt];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',e[e.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',e[e.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',e[e.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',e[e.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',e[e.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',e[e.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function ry(t){var r=t.read_shift(2),e=t.read_shift(2)-4,i=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=function ey(t){var r={};switch(r.xclrType=t.read_shift(2),r.nTintShade=t.read_shift(2),r.xclrType){case 0:case 4:t.l+=4;break;case 1:r.xclrValue=function ty(t,r){return Ht(t,r)}(t,4);break;case 2:r.xclrValue=k0(t);break;case 3:r.xclrValue=function K2(t){return t.read_shift(4)}(t)}return t.l+=8,r}(t);break;case 6:i[1]=function ny(t,r){return Ht(t,r)}(t,e);break;case 14:case 15:i[1]=t.read_shift(1===e?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+e)}return i}function ay(t,r){r.forEach(function(e){})}function hy(){var t=Qt();return ne(t,332),ne(t,334,An(1)),ne(t,335,function sy(t){var r=Q(12+2*t.name.length);return r.write_shift(4,t.flags),r.write_shift(4,t.version),Ft(t.name,r),r.slice(0,r.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),ne(t,336),ne(t,339,function uy(t,r){var e=Q(8+2*r.length);return e.write_shift(4,t),Ft(r,e),e.slice(0,e.l)}(1,"XLDAPR")),ne(t,52),ne(t,35,An(514)),ne(t,4096,An(0)),ne(t,4097,kn(1)),ne(t,36),ne(t,53),ne(t,340),ne(t,337,function fy(t,r){var e=Q(8);return e.write_shift(4,t),e.write_shift(4,r?1:0),e}(1,!0)),ne(t,51,function cy(t){var r=Q(4+8*t.length);r.write_shift(4,t.length);for(var e=0;e<t.length;++e)r.write_shift(4,t[e][0]),r.write_shift(4,t[e][1]);return r}([[1,0]])),ne(t,338),ne(t,333),t.end()}function tu(){var t=[pt];return t.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),t.join("")}var yi=1024;function nu(t,r){for(var e=[21600,21600],i=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),a=[se("xml",null,{"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":fn_o,"xmlns:x":fn_x,"xmlns:mv":"http://macVmlSchemaUri"}).replace(/\/>/,">"),se("o:shapelayout",se("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),se("v:shapetype",[se("v:stroke",null,{joinstyle:"miter"}),se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:i})];yi<1e3*t;)yi+=1e3;return r.forEach(function(o){var s=lt(o[0]),l={color2:"#BEFF82",type:"gradient"};"gradient"==l.type&&(l.angle="-180");var c="gradient"==l.type?se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=se("v:fill",c,l);++yi,a=a.concat(["<v:shape"+Gi({id:"_x0000_s"+yi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,se("v:shadow",null,{on:"t",obscured:"t"}),se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Mt("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Mt("x:AutoFill","False"),Mt("x:Row",String(s.r)),Mt("x:Column",String(s.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function ru(t,r,e,i){var o,a=Array.isArray(t);r.forEach(function(s){var l=lt(s.ref);if(a?(t[l.r]||(t[l.r]=[]),o=t[l.r][l.c]):o=t[s.ref],!o){o={t:"z"},a?t[l.r][l.c]=o:t[s.ref]=o;var c=Ve(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=De(c);u!==t["!ref"]&&(t["!ref"]=u)}o.c||(o.c=[]);var d={a:s.author,t:s.t,r:s.r,T:e};s.h&&(d.h=s.h);for(var f=o.c.length-1;f>=0;--f){if(!e&&o.c[f].T)return;e&&!o.c[f].T&&o.c.splice(f,1)}if(e&&i)for(f=0;f<i.length;++f)if(d.a==i[f].id){d.a=i[f].name||d.a;break}o.c.push(d)})}function iu(t){var r=[pt,se("comments",null,{xmlns:yr[0]})],e=[];return r.push("<authors>"),t.forEach(function(i){i[1].forEach(function(a){var o=Je(a.a);-1==e.indexOf(o)&&(e.push(o),r.push("<author>"+o+"</author>")),a.T&&a.ID&&-1==e.indexOf("tc="+a.ID)&&(e.push("tc="+a.ID),r.push("<author>tc="+a.ID+"</author>"))})}),0==e.length&&(e.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),t.forEach(function(i){var a=0,o=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?a=e.indexOf("tc="+i[1][0].ID):i[1].forEach(function(c){c.a&&(a=e.indexOf(Je(c.a))),o.push(c.t||"")}),r.push('<comment ref="'+i[0]+'" authorId="'+a+'"><text>'),o.length<=1)r.push(Mt("t",Je(o[0]||"")));else{for(var s="Comment:\n    "+o[0]+"\n",l=1;l<o.length;++l)s+="Reply:\n    "+o[l]+"\n";r.push(Mt("t",Je(s)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Ty(t,r,e){var i=[pt,se("ThreadedComments",null,{xmlns:Ct_TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var o="";(a[1]||[]).forEach(function(s,l){if(s.T){s.a&&-1==r.indexOf(s.a)&&r.push(s.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};0==l?o=c.id:c.parentId=o,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(s.a)).slice(-12)+"}"),i.push(se("threadedComment",Mt("text",s.t||""),c))}else delete s.ID})}),i.push("</ThreadedComments>"),i.join("")}var Iy=Vt;function Fy(t){var r=Qt(),e=[];return ne(r,628),ne(r,630),t.forEach(function(i){i[1].forEach(function(a){e.indexOf(a.a)>-1||(e.push(a.a.slice(0,54)),ne(r,632,function Oy(t){return Ft(t.slice(0,54))}(a.a)))})}),ne(r,631),ne(r,633),t.forEach(function(i){i[1].forEach(function(a){a.iauthor=e.indexOf(a.a);var o={s:lt(i[0]),e:lt(i[0])};ne(r,635,function zy(t,r){return null==r&&(r=Q(36)),r.write_shift(4,t[1].iauthor),_i(t[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}([o,a])),a.t&&a.t.length>0&&ne(r,637,function X1(t,r){var e=!1;return null==r&&(e=!0,r=Q(23+4*t.t.length)),r.write_shift(1,1),Ft(t.t,r),r.write_shift(4,1),function J1(t,r){r||(r=Q(4)),r.write_shift(2,t.ich||0),r.write_shift(2,t.ifnt||0)}({ich:0,ifnt:0},r),e?r.slice(0,r.l):r}(a)),ne(r,636),delete a.iauthor})}),ne(r,634),ne(r,629),r.end()}var au=["xlsb","xlsm","xlam","biff8","xla"],wi=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(i,a,o,s){var l=!1,c=!1;0==o.length?c=!0:"["==o.charAt(0)&&(c=!0,o=o.slice(1,-1)),0==s.length?l=!0:"["==s.charAt(0)&&(l=!0,s=s.slice(1,-1));var u=o.length>0?0|parseInt(o,10):0,d=s.length>0?0|parseInt(s,10):0;return l?d+=r.c:--d,c?u+=r.r:--u,a+(l?"":"$")+ot(d)+(c?"":"$")+ht(u)}return function(a,o){return r=o,a.replace(t,e)}}(),Ss=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,bs=function(){return function(r,e){return r.replace(Ss,function(i,a,o,s,l,c){var u=ts(s)-(o?0:e.c),d=es(c)-(l?0:e.r);return a+"R"+(0==d?"":l?d+1:"["+d+"]")+"C"+(0==u?"":o?u+1:"["+u+"]")})}}();function ou(t,r){return t.replace(Ss,function(e,i,a,o,s,l){return i+("$"==a?a+o:ot(ts(o)+r.c))+("$"==s?s+l:ht(es(l)+r.r))})}function Ly(t,r,e){var a=qt(r).s,o=lt(e);return ou(t,{r:o.r-a.r,c:o.c-a.c})}function su(t){return t.replace(/_xlfn\./g,"")}function wt(t){t.l+=1}function Sr(t,r){var e=t.read_shift(1==r?1:2);return[16383&e,e>>14&1,e>>15&1]}function lu(t,r,e){var i=2;if(e){if(e.biff>=2&&e.biff<=5)return cu(t);12==e.biff&&(i=4)}var a=t.read_shift(i),o=t.read_shift(i),s=Sr(t,2),l=Sr(t,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:o,c:l[0],cRel:l[1],rRel:l[2]}}}function cu(t){var r=Sr(t,2),e=Sr(t,2),i=t.read_shift(1),a=t.read_shift(1);return{s:{r:r[0],c:i,cRel:r[1],rRel:r[2]},e:{r:e[0],c:a,cRel:e[1],rRel:e[2]}}}function uu(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return function Vy(t){var r=Sr(t,2),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}(t);var i=t.read_shift(e&&12==e.biff?4:2),a=Sr(t,2);return{r:i,c:a[0],cRel:a[1],rRel:a[2]}}function Zy(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:255&e,fQuoted:!!(16384&e),cRel:e>>15,rRel:e>>15}}function du(t){var r=1&t[t.l+1];return t.l+=4,[r,1]}function fu(t){return[t.read_shift(1),t.read_shift(1)]}function xw(t,r){var e=[t.read_shift(1)];if(12==r)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2}switch(e[0]){case 4:e[1]=gt(t,1)?"TRUE":"FALSE",12!=r&&(t.l+=7);break;case 37:case 16:e[1]=tr[t[t.l]],t.l+=12==r?4:8;break;case 0:t.l+=8;break;case 1:e[1]=Zt(t);break;case 2:e[1]=qr(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function vw(t,r,e){for(var i=t.read_shift(12==e.biff?4:2),a=[],o=0;o!=i;++o)a.push((12==e.biff?Wr:Ka)(t,8));return a}function Cw(t,r,e){var i=0,a=0;12==e.biff?(i=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),i=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--i,0==--a&&(a=256));for(var o=0,s=[];o!=i&&(s[o]=[]);++o)for(var l=0;l!=a;++l)s[o][l]=xw(t,e.biff);return s}function aa(t,r,e){return t.l+=2,[Zy(t)]}function zs(t){return t.l+=6,[]}function pu(t){return t.l+=2,[yt(t),1&t.read_shift(2)]}var Uw=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],hu={1:{n:"PtgExp",f:function fw(t,r,e){return t.l++,e&&12==e.biff?[t.read_shift(4,"i"),0]:[t.read_shift(2),t.read_shift(e&&2==e.biff?1:2)]}},2:{n:"PtgTbl",f:Ht},3:{n:"PtgAdd",f:wt},4:{n:"PtgSub",f:wt},5:{n:"PtgMul",f:wt},6:{n:"PtgDiv",f:wt},7:{n:"PtgPower",f:wt},8:{n:"PtgConcat",f:wt},9:{n:"PtgLt",f:wt},10:{n:"PtgLe",f:wt},11:{n:"PtgEq",f:wt},12:{n:"PtgGe",f:wt},13:{n:"PtgGt",f:wt},14:{n:"PtgNe",f:wt},15:{n:"PtgIsect",f:wt},16:{n:"PtgUnion",f:wt},17:{n:"PtgRange",f:wt},18:{n:"PtgUplus",f:wt},19:{n:"PtgUminus",f:wt},20:{n:"PtgPercent",f:wt},21:{n:"PtgParen",f:wt},22:{n:"PtgMissArg",f:wt},23:{n:"PtgStr",f:function _w(t,r,e){return t.l++,Xi(t,0,e)}},26:{n:"PtgSheet",f:function Zw(t,r,e){return t.l+=5,t.l+=2,t.l+=2==e.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function jw(t,r,e){return t.l+=2==e.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function pw(t){return t.l++,tr[t.read_shift(1)]}},29:{n:"PtgBool",f:function mw(t){return t.l++,0!==t.read_shift(1)}},30:{n:"PtgInt",f:function hw(t){return t.l++,t.read_shift(2)}},31:{n:"PtgNum",f:function gw(t){return t.l++,Zt(t)}},32:{n:"PtgArray",f:function qy(t,r,e){var i=(96&t[t.l++])>>5;return t.l+=2==e.biff?6:12==e.biff?14:7,[i]}},33:{n:"PtgFunc",f:function lw(t,r,e){var i=(96&t[t.l])>>5;t.l+=1;var a=t.read_shift(e&&e.biff<=3?1:2);return[dT[a],_u[a],i]}},34:{n:"PtgFuncVar",f:function cw(t,r,e){var i=t[t.l++],a=t.read_shift(1),o=e&&e.biff<=3?[88==i?-1:0,t.read_shift(1)]:function uw(t){return[t[t.l+1]>>7,32767&t.read_shift(2)]}(t);return[a,(0===o[0]?_u:uT)[o[1]]]}},35:{n:"PtgName",f:function yw(t,r,e){var i=t.read_shift(1)>>>5&3,o=t.read_shift(!e||e.biff>=8?4:2);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12}return[i,0,o]}},36:{n:"PtgRef",f:function aw(t,r,e){var i=(96&t[t.l])>>5;return t.l+=1,[i,uu(t,0,e)]}},37:{n:"PtgArea",f:function Wy(t,r,e){return[(96&t[t.l++])>>5,lu(t,0,e)]}},38:{n:"PtgMemArea",f:function kw(t,r,e){var i=t.read_shift(1)>>>5&3;return t.l+=e&&2==e.biff?3:4,[i,t.read_shift(e&&2==e.biff?1:2)]}},39:{n:"PtgMemErr",f:Ht},40:{n:"PtgMemNoMem",f:Ht},41:{n:"PtgMemFunc",f:function Sw(t,r,e){return[t.read_shift(1)>>>5&3,t.read_shift(e&&2==e.biff?1:2)]}},42:{n:"PtgRefErr",f:function bw(t,r,e){var i=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,12==e.biff&&(t.l+=2),[i]}},43:{n:"PtgAreaErr",f:function $y(t,r,e){var i=(96&t[t.l++])>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[i]}},44:{n:"PtgRefN",f:function ow(t,r,e){var i=(96&t[t.l])>>5;t.l+=1;var a=function jy(t,r,e){var i=e&&e.biff?e.biff:8;if(i>=2&&i<=5)return function Gy(t){var r=t.read_shift(2),e=t.read_shift(1),i=(32768&r)>>15,a=(16384&r)>>14;return r&=16383,1==i&&r>=8192&&(r-=16384),1==a&&e>=128&&(e-=256),{r,c:e,cRel:a,rRel:i}}(t);var a=t.read_shift(i>=12?4:2),o=t.read_shift(2),s=(16384&o)>>14,l=(32768&o)>>15;if(o&=16383,1==l)for(;a>524287;)a-=1048576;if(1==s)for(;o>8191;)o-=16384;return{r:a,c:o,cRel:s,rRel:l}}(t,0,e);return[i,a]}},45:{n:"PtgAreaN",f:function Qy(t,r,e){var i=(96&t[t.l++])>>5,a=function Hy(t,r,e){if(e.biff<8)return cu(t);var i=t.read_shift(12==e.biff?4:2),a=t.read_shift(12==e.biff?4:2),o=Sr(t,2),s=Sr(t,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}(t,0,e);return[i,a]}},46:{n:"PtgMemAreaN",f:function Gw(t){return[t.read_shift(1)>>>5&3,t.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function Ww(t){return[t.read_shift(1)>>>5&3,t.read_shift(2)]}},57:{n:"PtgNameX",f:function ww(t,r,e){return 5==e.biff?function Tw(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var i=t.read_shift(2);return t.l+=12,[r,e,i]}(t):[t.read_shift(1)>>>5&3,t.read_shift(2),t.read_shift(4)]}},58:{n:"PtgRef3d",f:function sw(t,r,e){var i=(96&t[t.l])>>5;t.l+=1;var a=t.read_shift(2);return e&&5==e.biff&&(t.l+=12),[i,a,uu(t,0,e)]}},59:{n:"PtgArea3d",f:function Yy(t,r,e){var i=(96&t[t.l++])>>5,a=t.read_shift(2,"i");if(e&&5===e.biff)t.l+=12;return[i,a,lu(t,0,e)]}},60:{n:"PtgRefErr3d",f:function zw(t,r,e){var i=(96&t[t.l++])>>5,a=t.read_shift(2),o=4;if(e)switch(e.biff){case 5:o=15;break;case 12:o=6}return t.l+=o,[i,a]}},61:{n:"PtgAreaErr3d",f:function Jy(t,r,e){var i=(96&t[t.l++])>>5,a=t.read_shift(2),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12}return t.l+=o,[i,a]}},255:{}},$w={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Jw={1:{n:"PtgElfLel",f:pu},2:{n:"PtgElfRw",f:aa},3:{n:"PtgElfCol",f:aa},6:{n:"PtgElfRwV",f:aa},7:{n:"PtgElfColV",f:aa},10:{n:"PtgElfRadical",f:aa},11:{n:"PtgElfRadicalS",f:zs},13:{n:"PtgElfColS",f:zs},15:{n:"PtgElfColSV",f:zs},16:{n:"PtgElfRadicalLel",f:pu},25:{n:"PtgList",f:function Hw(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(4),a=t.read_shift(2),o=t.read_shift(2);return{ixti:r,coltype:3&e,rt:Uw[e>>2&31],idx:i,c:a,C:o}}},29:{n:"PtgSxName",f:function Vw(t){return t.l+=2,[t.read_shift(4)]}},255:{}},Qw={0:{n:"PtgAttrNoop",f:function Yw(t){return t.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function nw(t,r,e){var i=255&t[t.l+1]?1:0;return t.l+=e&&2==e.biff?3:4,[i]}},2:{n:"PtgAttrIf",f:function ew(t,r,e){var i=255&t[t.l+1]?1:0;return t.l+=2,[i,t.read_shift(e&&2==e.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function Xy(t,r,e){t.l+=2;for(var i=t.read_shift(e&&2==e.biff?1:2),a=[],o=0;o<=i;++o)a.push(t.read_shift(e&&2==e.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function Ky(t,r,e){var i=255&t[t.l+1]?1:0;return t.l+=2,[i,t.read_shift(e&&2==e.biff?1:2)]}},16:{n:"PtgAttrSum",f:function dw(t,r,e){t.l+=e&&2==e.biff?3:4}},32:{n:"PtgAttrBaxcel",f:du},33:{n:"PtgAttrBaxcel",f:du},64:{n:"PtgAttrSpace",f:function rw(t){return t.read_shift(2),fu(t)}},65:{n:"PtgAttrSpaceSemi",f:function iw(t){return t.read_shift(2),fu(t)}},128:{n:"PtgAttrIfError",f:function tw(t){var r=255&t[t.l+1]?1:0;return t.l+=2,[r,t.read_shift(2)]}},255:{}};function oa(t,r,e,i){if(i.biff<8)return Ht(t,r);for(var a=t.l+r,o=[],s=0;s!==e.length;++s)switch(e[s][0]){case"PtgArray":e[s][1]=Cw(t,0,i),o.push(e[s][1]);break;case"PtgMemArea":e[s][2]=vw(t,0,i),o.push(e[s][2]);break;case"PtgExp":i&&12==i.biff&&(e[s][1][1]=t.read_shift(4),o.push(e[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[s][0]}return 0!=(r=a-t.l)&&o.push(Ht(t,r)),o}function sa(t,r,e){for(var a,o,i=t.l+r,s=[];i!=t.l;)r=i-t.l,a=hu[o=t[t.l]]||hu[$w[o]],(24===o||25===o)&&(a=(24===o?Jw:Qw)[t[t.l+1]]),a&&a.f?s.push([a.n,a.f(t,r,e)]):Ht(t,r);return s}function qw(t){for(var r=[],e=0;e<t.length;++e){for(var i=t[e],a=[],o=0;o<i.length;++o){var s=i[o];a.push(s?2===s[0]?'"'+s[1].replace(/"/g,'""')+'"':s[1]:"")}r.push(a.join(","))}return r.join(";")}var Xw={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function mu(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var i=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),0==r?"":t.XTI[r-1];if(!i)return"SH33TJSERR1";var a="";if(e.biff>8)switch(t[i[0]][0]){case 357:return a=-1==i[1]?"#REF":t.SheetNames[i[1]],i[1]==i[2]?a:a+":"+t.SheetNames[i[2]];case 358:return null!=e.SID?t.SheetNames[e.SID]:"SH33TJSSAME"+t[i[0]][0];default:return"SH33TJSSRC"+t[i[0]][0]}switch(t[i[0]][0][0]){case 1025:return a=-1==i[1]?"#REF":t.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?a:a+":"+t.SheetNames[i[2]];case 14849:return t[i[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[i[0]][0][3]?(a=-1==i[1]?"#REF":t[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?a:a+":"+t[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function gu(t,r,e){var i=mu(t,r,e);return"#REF"==i?i:function Kw(t,r){if(!(t||r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}(i,e)}function Wt(t,r,e,i,a){var c,u,d,m,o=a&&a.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},l=[],f=0,p=0,x="";if(!t[0]||!t[0][0])return"";for(var h=-1,v="",T=0,S=t[0].length;T<S;++T){var y=t[0][T];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),h>=0){switch(t[0][h][1][0]){case 0:v=ft(" ",t[0][h][1][1]);break;case 1:v=ft("\r",t[0][h][1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][h][1][0])}u+=v,h=-1}l.push(u+Xw[y[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":d=$i(y[1][1],s,a),l.push(Ji(d,o));break;case"PtgRefN":d=e?$i(y[1][1],e,a):y[1][1],l.push(Ji(d,o));break;case"PtgRef3d":f=y[1][1],d=$i(y[1][2],s,a),x=gu(i,f,a),l.push(x+"!"+Ji(d,o));break;case"PtgFunc":case"PtgFuncVar":var U=y[1][0],M=y[1][1];U||(U=0);var I=0==(U&=127)?[]:l.slice(-U);l.length-=U,"User"===M&&(M=I.shift()),l.push(M+"("+I.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":m=Vc(y[1][1],e?{s:e}:s,a),l.push(Ko(m,a));break;case"PtgArea":m=Vc(y[1][1],s,a),l.push(Ko(m,a));break;case"PtgArea3d":m=y[1][2],x=gu(i,f=y[1][1],a),l.push(x+"!"+Ko(m,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgName":var B=(i.names||[])[(p=y[1][2])-1]||(i[0]||[])[p],R=B?B.Name:"SH33TJSNAME"+String(p);R&&"_xlfn."==R.slice(0,6)&&!a.xlfn&&(R=R.slice(6)),l.push(R);break;case"PtgNameX":var J,W=y[1][1];if(p=y[1][2],!(a.biff<=5)){var L="";if(14849==((i[W]||[])[0]||[])[0]||(1025==((i[W]||[])[0]||[])[0]?i[W][p]&&i[W][p].itab>0&&(L=i.SheetNames[i[W][p].itab-1]+"!"):L=i.SheetNames[p-1]+"!"),i[W]&&i[W][p])L+=i[W][p].Name;else if(i[0]&&i[0][p])L+=i[0][p].Name;else{var le=(mu(i,W,a)||"").split(";;");le[p-1]?L=le[p-1]:L+="SH33TJSERRX"}l.push(L);break}W<0&&(W=-W),i[W]&&(J=i[W][p]),J||(J={Name:"SH33TJSERRY"}),l.push(J.Name);break;case"PtgParen":var xe="(",ce=")";if(h>=0){switch(v="",t[0][h][1][0]){case 2:xe=ft(" ",t[0][h][1][1])+xe;break;case 3:xe=ft("\r",t[0][h][1][1])+xe;break;case 4:ce=ft(" ",t[0][h][1][1])+ce;break;case 5:ce=ft("\r",t[0][h][1][1])+ce;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][h][1][0])}h=-1}l.push(xe+l.pop()+ce);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":l.push("#REF!");break;case"PtgExp":var Te={c:e.c,r:e.r};if(i.sharedf[ze(d={c:y[1][1],r:y[1][0]})]){var Ce=i.sharedf[ze(d)];l.push(Wt(Ce,0,Te,i,a))}else{var Be=!1;for(c=0;c!=i.arrayf.length;++c)if(!(d.c<(u=i.arrayf[c])[0].s.c||d.c>u[0].e.c||d.r<u[0].s.r||d.r>u[0].e.r)){l.push(Wt(u[1],0,Te,i,a)),Be=!0;break}Be||l.push(y[1])}break;case"PtgArray":l.push("{"+qw(y[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":h=T;break;case"PtgMissArg":l.push("");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(y))}if(3!=a.biff&&h>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(t[0][T][0])){var we=!0;switch((y=t[0][h])[1][0]){case 4:we=!1;case 0:v=ft(" ",y[1][1]);break;case 5:we=!1;case 1:v=ft("\r",y[1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((we?v:"")+l.pop()+(we?"":v)),h=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function eT(t,r,e){var o,i=t.l+r,a=2==e.biff?1:2,s=t.read_shift(a);if(65535==s)return[[],Ht(t,r-2)];var l=sa(t,s,e);return r!==s+a&&(o=oa(t,r-s-a,l,e)),t.l=i,[l,o]}function rT(t,r,e){var a,i=t.l+r,o=t.read_shift(2),s=sa(t,o,e);return 65535==o?[[],Ht(t,r-2)]:(r!==o+2&&(a=oa(t,i-o-2,s,e)),[s,a])}function Is(t,r,e){var i=t.l+r,a=Vn(t);2==e.biff&&++t.l;var o=function iT(t){var r;if(65535!==Kn(t,t.l+6))return[Zt(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return r=1===t[t.l+2],t.l+=8,[r,"b"];case 2:return r=t[t.l+2],t.l+=8,[r,"e"];case 3:return t.l+=8,["","s"]}return[]}(t),s=t.read_shift(1);2!=e.biff&&(t.read_shift(1),e.biff>=5&&t.read_shift(4));var l=function tT(t,r,e){var o,i=t.l+r,a=2==e.biff?1:2,s=t.read_shift(a);if(65535==s)return[[],Ht(t,r-2)];var l=sa(t,s,e);return r!==s+a&&(o=oa(t,r-s-a,l,e)),t.l=i,[l,o]}(t,i-t.l,e);return{cell:a,val:o[0],formula:l,shared:s>>3&1,tt:o[1]}}function ao(t,r,e){var i=t.read_shift(4),a=sa(t,i,e),o=t.read_shift(4);return[a,o>0?oa(t,o,a,e):null]}var sT=ao,oo=ao,lT=ao,cT=ao,uT={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},_u={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dT={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function xu(t){return"of:"==t.slice(0,3)&&(t=t.slice(3)),61==t.charCodeAt(0)&&61==(t=t.slice(1)).charCodeAt(0)&&(t=t.slice(1)),(t=(t=(t=t.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,e){return e.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function fT(t){return("of:="+t.replace(Ss,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function Os(t){var r=t.split(":");return[r[0].split(".")[0],r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function pT(t){return t.replace(/\./,"!")}var la={},Ti={},ca="undefined"!=typeof Map;function Es(t,r,e){var i=0,a=t.length;if(e){if(ca?e.has(r):Object.prototype.hasOwnProperty.call(e,r))for(var o=ca?e.get(r):e[r];i<o.length;++i)if(t[o[i]].t===r)return t.Count++,o[i]}else for(;i<a;++i)if(t[i].t===r)return t.Count++,i;return t[a]={t:r},t.Count++,t.Unique++,e&&(ca?(e.has(r)||e.set(r,[]),e.get(r).push(a)):(Object.prototype.hasOwnProperty.call(e,r)||(e[r]=[]),e[r].push(a))),a}function so(t,r){var e={min:t+1,max:t+1},i=-1;return r.MDW&&(Gt=r.MDW),null!=r.width?e.customWidth=1:null!=r.wpx?i=na(r.wpx):null!=r.wch&&(i=r.wch),i>-1?(e.width=no(i),e.customWidth=1):null!=r.width&&(e.width=r.width),r.hidden&&(e.hidden=!0),null!=r.level&&(e.outlineLevel=e.level=r.level),e}function ei(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];"xlml"==r&&(e=[1,1,1,1,.5,.5]),null==t.left&&(t.left=e[0]),null==t.right&&(t.right=e[1]),null==t.top&&(t.top=e[2]),null==t.bottom&&(t.bottom=e[3]),null==t.header&&(t.header=e[4]),null==t.footer&&(t.footer=e[5])}}function br(t,r,e){var i=e.revssf[null!=r.z?r.z:"General"],a=60,o=t.length;if(null==i&&e.ssf)for(;a<392;++a)if(null==e.ssf[a]){Bn(r.z,a),e.ssf[a]=r.z,e.revssf[r.z]=i=a;break}for(a=0;a!=o;++a)if(t[a].numFmtId===i)return a;return t[o]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function vu(t,r,e,i,a,o){try{i.cellNF&&(t.z=Se[r])}catch(l){if(i.WTF)throw l}if("z"!==t.t||i.cellStyles){if("d"===t.t&&"string"==typeof t.v&&(t.v=it(t.v)),(!i||!1!==i.cellText)&&"z"!==t.t)try{if(null==Se[r]&&Bn(u1[r]||"General",r),"e"===t.t)t.w=t.w||tr[t.v];else if(0===r)if("n"===t.t)t.w=(0|t.v)===t.v?t.v.toString(10):Ui(t.v);else if("d"===t.t){var s=kt(t.v);t.w=(0|s)===s?s.toString(10):Ui(s)}else{if(void 0===t.v)return"";t.w=Lr(t.v,Ti)}else t.w=un(r,"d"===t.t?kt(t.v):t.v,Ti)}catch(l){if(i.WTF)throw l}if(i.cellStyles&&null!=e)try{t.s=o.Fills[e],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=to(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),i.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=to(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),i.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(i.WTF&&o.Fills)throw l}}}function hT(t,r,e){if(t&&t["!ref"]){var i=Ve(t["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+e+"): "+t["!ref"])}}var gT=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,_T=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,xT=/<(?:\w:)?hyperlink [^>]*>/gm,vT=/"(\w*:\w*)"/,CT=/<(?:\w:)?col\b[^>]*[\/]?>/g,yT=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,wT=/<(?:\w:)?pageMargins[^>]*\/>/g,Cu=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,TT=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,kT=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Fs(t,r,e,i){var a=Ie(t);e.Sheets[i]||(e.Sheets[i]={}),a.codeName&&(e.Sheets[i].CodeName=Ge(Xe(a.codeName)))}var OT=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ET=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],LT=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function VT(t,r,e,i){if(t.c&&e["!comments"].push([r,t.c]),void 0===t.v&&"string"!=typeof t.f||"z"===t.t&&!t.f)return"";var a="",o=t.t,s=t.v;if("z"!==t.t)switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=tr[t.v];break;case"d":i&&i.cellDates?a=it(t.v,-1).toISOString():((t=tt(t)).t="n",a=""+(t.v=kt(it(t.v)))),void 0===t.z&&(t.z=Se[14]);break;default:a=t.v}var l=Mt("v",Je(a)),c={r},u=br(i.cellXfs,t,i);switch(0!==u&&(c.s=u),t.t){case"n":case"z":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;default:if(null==t.v){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){l=Mt("v",""+Es(i.Strings,t.v,i.revStrings)),c.t="s";break}c.t="str"}if(t.t!=o&&(t.t=o,t.v=s),"string"==typeof t.f&&t.f){var d=t.F&&t.F.slice(0,r.length)==r?{t:"array",ref:t.F}:null;l=se("f",Je(t.f),d)+(null!=t.v?l:"")}return t.l&&e["!links"].push([r,t.l]),t.D&&(c.cm=1),se("c",l,c)}var ZT=function(){var t=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=ji("v"),s=ji("f");return function(c,u,d,f,p,m){for(var M,I,W,J,ce,x=0,h="",v=[],T=[],S=0,y=0,P=0,U="",B=0,R=0,L=0,le=0,xe=Array.isArray(m.CellXf),Te=[],Ce=[],Be=Array.isArray(u),me=[],we={},ee=!1,F=!!d.sheetStubs,Z=c.split(r),N=0,A=Z.length;N!=A;++N){var X=(h=Z[N].trim()).length;if(0!==X){var pe=0;e:for(x=0;x<X;++x)switch(h[x]){case">":if("/"!=h[x-1]){++x;break e}if(d&&d.cellStyles){if(B=null!=(I=Ie(h.slice(pe,x),!0)).r?parseInt(I.r,10):B+1,R=-1,d.sheetRows&&d.sheetRows<B)continue;we={},ee=!1,I.ht&&(ee=!0,we.hpt=parseFloat(I.ht),we.hpx=Ci(we.hpt)),"1"==I.hidden&&(ee=!0,we.hidden=!0),null!=I.outlineLevel&&(ee=!0,we.level=+I.outlineLevel),ee&&(me[B-1]=we)}break;case"<":pe=x}if(pe>=x)break;if(B=null!=(I=Ie(h.slice(pe,x),!0)).r?parseInt(I.r,10):B+1,R=-1,!(d.sheetRows&&d.sheetRows<B)){f.s.r>B-1&&(f.s.r=B-1),f.e.r<B-1&&(f.e.r=B-1),d&&d.cellStyles&&(we={},ee=!1,I.ht&&(ee=!0,we.hpt=parseFloat(I.ht),we.hpx=Ci(we.hpt)),"1"==I.hidden&&(ee=!0,we.hidden=!0),null!=I.outlineLevel&&(ee=!0,we.level=+I.outlineLevel),ee&&(me[B-1]=we)),v=h.slice(x).split(t);for(var ie=0;ie!=v.length&&"<"==v[ie].trim().charAt(0);++ie);for(v=v.slice(ie),x=0;x!=v.length;++x)if(0!==(h=v[x].trim()).length){if(T=h.match(e),S=x,y=0,P=0,h="<c "+("<"==h.slice(0,1)?">":"")+h,null!=T&&2===T.length){for(S=0,U=T[1],y=0;y!=U.length&&!((P=U.charCodeAt(y)-64)<1||P>26);++y)S=26*S+P;R=--S}else++R;for(y=0;y!=h.length&&62!==h.charCodeAt(y);++y);if(++y,(I=Ie(h.slice(0,y),!0)).r||(I.r=ze({r:B-1,c:R})),M={t:""},null!=(T=(U=h.slice(y)).match(o))&&""!==T[1]&&(M.v=Ge(T[1])),d.cellFormula){if(null!=(T=U.match(s))&&""!==T[1]){if(M.f=Ge(Xe(T[1])).replace(/\r\n/g,"\n"),d.xlfn||(M.f=su(M.f)),T[0].indexOf('t="array"')>-1)M.F=(U.match(a)||[])[1],M.F.indexOf(":")>-1&&Te.push([Ve(M.F),M.F]);else if(T[0].indexOf('t="shared"')>-1){J=Ie(T[0]);var ae=Ge(Xe(T[1]));d.xlfn||(ae=su(ae)),Ce[parseInt(J.si,10)]=[J,ae,I.r]}}else(T=U.match(/<f[^>]*\/>/))&&Ce[(J=Ie(T[0])).si]&&(M.f=Ly(Ce[J.si][1],Ce[J.si][2],I.r));var te=lt(I.r);for(y=0;y<Te.length;++y)te.r>=Te[y][0].s.r&&te.r<=Te[y][0].e.r&&te.c>=Te[y][0].s.c&&te.c<=Te[y][0].e.c&&(M.F=Te[y][1])}if(null==I.t&&void 0===M.v)if(M.f||M.F)M.v=0,M.t="n";else{if(!F)continue;M.t="z"}else M.t=I.t||"n";switch(f.s.c>R&&(f.s.c=R),f.e.c<R&&(f.e.c=R),M.t){case"n":if(""==M.v||null==M.v){if(!F)continue;M.t="z"}else M.v=parseFloat(M.v);break;case"s":if(void 0===M.v){if(!F)continue;M.t="z"}else W=la[parseInt(M.v,10)],M.v=W.t,M.r=W.r,d.cellHTML&&(M.h=W.h);break;case"str":M.t="s",M.v=null!=M.v?Xe(M.v):"",d.cellHTML&&(M.h=Zo(M.v));break;case"inlineStr":T=U.match(i),M.t="s",null!=T&&(W=vs(T[1]))?(M.v=W.t,d.cellHTML&&(M.h=W.h)):M.v="";break;case"b":M.v=at(M.v);break;case"d":d.cellDates?M.v=it(M.v,1):(M.v=kt(it(M.v,1)),M.t="n");break;case"e":(!d||!1!==d.cellText)&&(M.w=M.v),M.v=Xc[M.v]}if(L=le=0,ce=null,xe&&void 0!==I.s&&null!=(ce=m.CellXf[I.s])&&(null!=ce.numFmtId&&(L=ce.numFmtId),d.cellStyles&&null!=ce.fillId&&(le=ce.fillId)),vu(M,L,le,d,p,m),d.cellDates&&xe&&"n"==M.t&&Ur(Se[L])&&(M.t="d",M.v=Ha(M.v)),I.cm&&d.xlmeta){var Ne=(d.xlmeta.Cell||[])[+I.cm-1];Ne&&"XLDAPR"==Ne.type&&(M.D=!0)}if(Be){var E=lt(I.r);u[E.r]||(u[E.r]=[]),u[E.r][E.c]=M}else u[I.r]=M}}}}me.length>0&&(u["!rows"]=me)}}();function yu(t,r,e,i){var s,a=[pt,se("worksheet",null,{xmlns:yr[0],"xmlns:r":Ct_r})],l="",c=e.Sheets[e.SheetNames[t]];null==c&&(c={});var u=c["!ref"]||"A1",d=Ve(u);if(d.e.c>16383||d.e.r>1048575){if(r.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=De(d)}i||(i={}),c["!comments"]=[];var f=[];(function IT(t,r,e,i,a){var o=!1,s={},l=null;if("xlsx"!==i.bookType&&r.vbaraw){var c=r.SheetNames[e];try{r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch(d){}o=!0,s.codeName=Un(Je(c))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),l=(l||"")+se("outlinePr",null,u)}!o&&!l||(a[a.length]=se("sheetPr",l,s))})(c,e,t,r,a),a[a.length]=se("dimension",null,{ref:u}),a[a.length]=function HT(t,r,e,i){var a={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),se("sheetViews",se("sheetView",null,a),{})}(0,0,0,e),r.sheetFormat&&(a[a.length]=se("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),null!=c["!cols"]&&c["!cols"].length>0&&(a[a.length]=function RT(t,r){for(var i,e=["<cols>"],a=0;a!=r.length;++a)!(i=r[a])||(e[e.length]=se("col",null,so(a,i)));return e[e.length]="</cols>",e.join("")}(0,c["!cols"])),a[s=a.length]="<sheetData/>",c["!links"]=[],null!=c["!ref"]&&(l=function jT(t,r,e,i){var c,v,a=[],o=[],s=Ve(t["!ref"]),l="",u="",d=[],f=0,p=0,m=t["!rows"],x=Array.isArray(t),h={r:u},T=-1;for(p=s.s.c;p<=s.e.c;++p)d[p]=ot(p);for(f=s.s.r;f<=s.e.r;++f){for(o=[],u=ht(f),p=s.s.c;p<=s.e.c;++p){c=d[p]+u;var S=x?(t[f]||[])[p]:t[c];void 0!==S&&null!=(l=VT(S,c,t,r))&&o.push(l)}(o.length>0||m&&m[f])&&(h={r:u},m&&m[f]&&((v=m[f]).hidden&&(h.hidden=1),T=-1,v.hpx?T=ra(v.hpx):v.hpt&&(T=v.hpt),T>-1&&(h.ht=T,h.customHeight=1),v.level&&(h.outlineLevel=v.level)),a[a.length]=se("row",o.join(""),h))}if(m)for(;f<m.length;++f)m&&m[f]&&(h={r:f+1},(v=m[f]).hidden&&(h.hidden=1),T=-1,v.hpx?T=ra(v.hpx):v.hpt&&(T=v.hpt),T>-1&&(h.ht=T,h.customHeight=1),v.level&&(h.outlineLevel=v.level),a[a.length]=se("row","",h));return a.join("")}(c,r),l.length>0&&(a[a.length]=l)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),c["!protect"]&&(a[a.length]=function FT(t){var r={sheet:1};return OT.forEach(function(e){null!=t[e]&&t[e]&&(r[e]="1")}),ET.forEach(function(e){null!=t[e]&&!t[e]&&(r[e]="0")}),t.password&&(r.password=Cs(t.password).toString(16).toUpperCase()),se("sheetProtection",null,r)}(c["!protect"])),null!=c["!autofilter"]&&(a[a.length]=function BT(t,r,e,i){var a="string"==typeof t.ref?t.ref:De(t.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var o=e.Workbook.Names,s=qt(a);s.s.r==s.e.r&&(s.e.r=qt(r["!ref"]).e.r,a=De(s));for(var l=0;l<o.length;++l){var c=o[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==i){c.Ref="'"+e.SheetNames[i]+"'!"+a;break}}return l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+a}),se("autoFilter",null,{ref:a})}(c["!autofilter"],c,e,t)),null!=c["!merges"]&&c["!merges"].length>0&&(a[a.length]=function bT(t){if(0===t.length)return"";for(var r='<mergeCells count="'+t.length+'">',e=0;e!=t.length;++e)r+='<mergeCell ref="'+De(t[e])+'"/>';return r+"</mergeCells>"}(c["!merges"]));var m,p=-1,x=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(h){!h[1].Target||(m={ref:h[0]},"#"!=h[1].Target.charAt(0)&&(x=Ye(i,-1,Je(h[1].Target).replace(/#.*$/,""),Ae.HLINK),m["r:id"]="rId"+x),(p=h[1].Target.indexOf("#"))>-1&&(m.location=Je(h[1].Target.slice(p+1))),h[1].Tooltip&&(m.tooltip=Je(h[1].Tooltip)),a[a.length]=se("hyperlink",null,m))}),a[a.length]="</hyperlinks>"),delete c["!links"],null!=c["!margins"]&&(a[a.length]=function NT(t){return ei(t),se("pageMargins",null,t)}(c["!margins"])),(!r||r.ignoreEC||null==r.ignoreEC)&&(a[a.length]=Mt("ignoredErrors",se("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(x=Ye(i,-1,"../drawings/drawing"+(t+1)+".xml",Ae.DRAW),a[a.length]=se("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=Ye(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ae.VML),a[a.length]=se("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function YT(t,r,e,i){var a=function WT(t,r,e){var i=Q(145),a=(e["!rows"]||[])[t]||{};i.write_shift(4,t),i.write_shift(4,0);var o=320;a.hpx?o=20*ra(a.hpx):a.hpt&&(o=20*a.hpt),i.write_shift(2,o),i.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),i.write_shift(1,s),i.write_shift(1,0);var l=0,c=i.l;i.l+=4;for(var u={r:t,c:0},d=0;d<16;++d)if(!(r.s.c>d+1<<10||r.e.c<d<<10)){for(var f=-1,p=-1,m=d<<10;m<d+1<<10;++m)u.c=m,(Array.isArray(e)?(e[u.r]||[])[u.c]:e[ze(u)])&&(f<0&&(f=m),p=m);f<0||(++l,i.write_shift(4,f),i.write_shift(4,p))}var h=i.l;return i.l=c,i.write_shift(4,l),i.l=h,i.length>i.l?i.slice(0,i.l):i}(i,e,r);(a.length>17||(r["!rows"]||[])[i])&&ne(t,0,a)}var $T=Wr,JT=_i;function wu(t){return[jr(t),Zt(t),"n"]}var Fk=Wr,Dk=_i,Tu=["left","right","top","bottom","header","footer"];function Jk(t,r,e,i,a,o,s){if(void 0===r.v)return!1;var l="";switch(r.t){case"b":l=r.v?"1":"0";break;case"d":(r=tt(r)).z=r.z||Se[14],r.v=kt(it(r.v)),r.t="n";break;case"n":case"e":l=""+r.v;break;default:l=r.v}var c={r:e,c:i};switch(c.s=br(a.cellXfs,r,a),r.l&&o["!links"].push([ze(c),r.l]),r.c&&o["!comments"].push([ze(c),r.c]),r.t){case"s":case"str":return a.bookSST?(l=Es(a.Strings,r.v,a.revStrings),c.t="s",c.v=l,s?ne(t,18,function hk(t,r,e){return null==e&&(e=Q(8)),Gr(r,e),e.write_shift(4,r.v),e}(0,c)):ne(t,7,function fk(t,r,e){return null==e&&(e=Q(12)),Zr(r,e),e.write_shift(4,r.v),e}(0,c))):(c.t="str",s?ne(t,17,function bk(t,r,e){return null==e&&(e=Q(8+4*t.v.length)),Gr(r,e),Ft(t.v,e),e.length>e.l?e.slice(0,e.l):e}(r,c)):ne(t,6,function kk(t,r,e){return null==e&&(e=Q(12+4*t.v.length)),Zr(r,e),Ft(t.v,e),e.length>e.l?e.slice(0,e.l):e}(r,c))),!0;case"n":return r.v==(0|r.v)&&r.v>-1e3&&r.v<1e3?s?ne(t,13,function yk(t,r,e){return null==e&&(e=Q(8)),Gr(r,e),Wc(t.v,e),e}(r,c)):ne(t,2,function vk(t,r,e){return null==e&&(e=Q(12)),Zr(r,e),Wc(t.v,e),e}(r,c)):s?ne(t,16,function _k(t,r,e){return null==e&&(e=Q(12)),Gr(r,e),Yr(t.v,e),e}(r,c)):ne(t,5,function gk(t,r,e){return null==e&&(e=Q(16)),Zr(r,e),Yr(t.v,e),e}(r,c)),!0;case"b":return c.t="b",s?ne(t,15,function ok(t,r,e){return null==e&&(e=Q(5)),Gr(r,e),e.write_shift(1,t.v?1:0),e}(r,c)):ne(t,4,function ik(t,r,e){return null==e&&(e=Q(9)),Zr(r,e),e.write_shift(1,t.v?1:0),e}(r,c)),!0;case"e":return c.t="e",s?ne(t,14,function uk(t,r,e){return null==e&&(e=Q(8)),Gr(r,e),e.write_shift(1,t.v),e.write_shift(2,0),e.write_shift(1,0),e}(r,c)):ne(t,3,function lk(t,r,e){return null==e&&(e=Q(9)),Zr(r,e),e.write_shift(1,t.v),e}(r,c)),!0}return s?ne(t,12,function nk(t,r,e){return null==e&&(e=Q(4)),Gr(r,e)}(0,c)):ne(t,1,function ek(t,r,e){return null==e&&(e=Q(8)),Zr(r,e)}(0,c)),!0}function aS(t,r,e,i){var a=Qt(),o=e.SheetNames[t],s=e.Sheets[o]||{},l=o;try{e&&e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch(u){}var c=Ve(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],ne(a,129),(e.vbaraw||s["!outline"])&&ne(a,147,function XT(t,r,e){null==e&&(e=Q(84+4*t.length));var i=192;r&&(r.above&&(i&=-65),r.left&&(i&=-129)),e.write_shift(1,i);for(var a=1;a<3;++a)e.write_shift(1,0);return Wa({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),Gc(t,e),e.slice(0,e.l)}(l,s["!outline"])),ne(a,148,JT(c)),function rS(t,r,e){ne(t,133),ne(t,137,function Zk(t,r,e){null==e&&(e=Q(30));var i=924;return(((r||{}).Views||[])[0]||{}).RTL&&(i|=32),e.write_shift(2,i),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}(0,e)),ne(t,138),ne(t,134)}(a,0,e.Workbook),function Xk(t,r){!r||!r["!cols"]||(ne(t,390),r["!cols"].forEach(function(e,i){e&&ne(t,60,function Lk(t,r,e){null==e&&(e=Q(18));var i=so(t,r);e.write_shift(-4,t),e.write_shift(-4,t),e.write_shift(4,256*(i.width||10)),e.write_shift(4,0);var a=0;return r.hidden&&(a|=1),"number"==typeof i.width&&(a|=2),r.level&&(a|=r.level<<8),e.write_shift(2,a),e}(i,e))}),ne(t,391))}(a,s),function Qk(t,r,e,i){var a=Ve(r["!ref"]||"A1"),s="",l=[];ne(t,145);var c=Array.isArray(r),u=a.e.r;r["!rows"]&&(u=Math.max(a.e.r,r["!rows"].length-1));for(var d=a.s.r;d<=u;++d){s=ht(d),YT(t,r,a,d);var f=!1;if(d<=a.e.r)for(var p=a.s.c;p<=a.e.c;++p){d===a.s.r&&(l[p]=ot(p));var m=c?(r[d]||[])[p]:r[l[p]+s];f=!!m&&Jk(t,m,d,p,i,r,f)}}ne(t,146)}(a,s,0,r),function iS(t,r){!r["!protect"]||ne(t,535,function Gk(t,r){return null==r&&(r=Q(66)),r.write_shift(2,t.password?Cs(t.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){r.write_shift(4,e[1]?null==t[e[0]]||t[e[0]]?0:1:null!=t[e[0]]&&t[e[0]]?0:1)}),r}(r["!protect"]))}(a,s),function nS(t,r,e,i){if(r["!autofilter"]){var a=r["!autofilter"],o="string"==typeof a.ref?a.ref:De(a.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var s=e.Workbook.Names,l=qt(o);l.s.r==l.e.r&&(l.e.r=qt(r["!ref"]).e.r,o=De(l));for(var c=0;c<s.length;++c){var u=s[c];if("_xlnm._FilterDatabase"==u.Name&&u.Sheet==i){u.Ref="'"+e.SheetNames[i]+"'!"+o;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+o}),ne(t,161,_i(Ve(o))),ne(t,162)}}(a,s,e,t),function qk(t,r){!r||!r["!merges"]||(ne(t,177,function Ak(t,r){return null==r&&(r=Q(4)),r.write_shift(4,t),r}(r["!merges"].length)),r["!merges"].forEach(function(e){ne(t,176,Dk(e))}),ne(t,178))}(a,s),function eS(t,r,e){r["!links"].forEach(function(i){if(i[1].Target){var a=Ye(e,-1,i[1].Target.replace(/#.*$/,""),Ae.HLINK);ne(t,494,function Mk(t,r){var e=Q(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));_i({s:lt(t[0]),e:lt(t[0])},e),as("rId"+r,e);var i=t[1].Target.indexOf("#");return Ft((-1==i?"":t[1].Target.slice(i+1))||"",e),Ft(t[1].Tooltip||"",e),Ft("",e),e.slice(0,e.l)}(i,a))}}),delete r["!links"]}(a,s,i),s["!margins"]&&ne(a,476,function Hk(t,r){return null==r&&(r=Q(48)),ei(t),Tu.forEach(function(e){Yr(t[e],r)}),r}(s["!margins"])),(!r||r.ignoreEC||null==r.ignoreEC)&&function Kk(t,r){!r||!r["!ref"]||(ne(t,648),ne(t,649,function jk(t){var r=Q(24);return r.write_shift(4,4),r.write_shift(4,1),_i(t,r),r}(Ve(r["!ref"]))),ne(t,650))}(a,s),function tS(t,r,e,i){if(r["!comments"].length>0){var a=Ye(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ae.VML);ne(t,551,as("rId"+a)),r["!legacy"]=a}}(a,s,t,i),ne(a,130),a.end()}var Ds=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],pS=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],hS=[],mS=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ku(t,r){for(var e=0;e!=t.length;++e)for(var i=t[e],a=0;a!=r.length;++a){var o=r[a];if(null==i[o[0]])i[o[0]]=o[1];else switch(o[2]){case"bool":"string"==typeof i[o[0]]&&(i[o[0]]=at(i[o[0]]));break;case"int":"string"==typeof i[o[0]]&&(i[o[0]]=parseInt(i[o[0]],10))}}}function Su(t,r){for(var e=0;e!=r.length;++e){var i=r[e];if(null==t[i[0]])t[i[0]]=i[1];else switch(i[2]){case"bool":"string"==typeof t[i[0]]&&(t[i[0]]=at(t[i[0]]));break;case"int":"string"==typeof t[i[0]]&&(t[i[0]]=parseInt(t[i[0]],10))}}}function bu(t){Su(t.WBProps,Ds),Su(t.CalcPr,mS),ku(t.WBView,pS),ku(t.Sheets,hS),Ti.date1904=at(t.WBProps.date1904)}var _S="][*?/\\".split("");function zu(t,r){if(t.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var e=!0;return _S.forEach(function(i){if(-1!=t.indexOf(i)){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");e=!1}}),e}var vS=/<\w+:workbook/;function Ou(t){var r=[pt];r[r.length]=se("workbook",null,{xmlns:yr[0],"xmlns:r":Ct_r});var e=t.Workbook&&(t.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Ds.forEach(function(l){null!=t.Workbook.WBProps[l[0]]&&t.Workbook.WBProps[l[0]]!=l[1]&&(i[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(i.codeName=t.Workbook.WBProps.CodeName,delete i.CodeName)),r[r.length]=se("workbookPr",null,i);var a=t.Workbook&&t.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(r[r.length]="<bookViews>",o=0;o!=t.SheetNames.length&&a[o]&&a[o].Hidden;++o);o==t.SheetNames.length&&(o=0),r[r.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var s={name:Je(t.SheetNames[o].slice(0,31))};if(s.sheetId=""+(o+1),s["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}r[r.length]=se("sheet",null,s)}return r[r.length]="</sheets>",e&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),null!=l.Sheet&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(r[r.length]=se("definedName",Je(l.Ref),c))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function wS(t,r){return r||(r=Q(127)),r.write_shift(4,t.Hidden),r.write_shift(4,t.iTabID),as(t.strRelID,r),Ft(t.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function SS(t,r){var e={};return t.read_shift(4),e.ArchID=t.read_shift(4),t.l+=r-8,e}function DS(t,r){var e=Qt();return ne(e,131),ne(e,128,function OS(t,r){r||(r=Q(127));for(var e=0;4!=e;++e)r.write_shift(4,0);return Ft("SheetJS",r),Ft(Ni_version,r),Ft(Ni_version,r),Ft("7262",r),r.length>r.l?r.slice(0,r.l):r}()),ne(e,153,function kS(t,r){r||(r=Q(72));var e=0;return t&&t.filterPrivacy&&(e|=8),r.write_shift(4,e),r.write_shift(4,0),Gc(t&&t.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}(t.Workbook&&t.Workbook.WBProps||null)),function FS(t,r){if(r.Workbook&&r.Workbook.Sheets){for(var e=r.Workbook.Sheets,i=0,a=-1,o=-1;i<e.length;++i)!e[i]||!e[i].Hidden&&-1==a?a=i:1==e[i].Hidden&&-1==o&&(o=i);o>a||(ne(t,135),ne(t,158,function ES(t,r){return r||(r=Q(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,t),r.write_shift(4,t),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r}(a)),ne(t,136))}}(e,t),function IS(t,r){ne(t,143);for(var e=0;e!=r.SheetNames.length;++e)ne(t,156,wS({Hidden:r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[e]&&r.Workbook.Sheets[e].Hidden||0,iTabID:e+1,strRelID:"rId"+(e+1),name:r.SheetNames[e]}));ne(t,144)}(e,t),ne(e,132),e.end()}function NS(t,r,e,i,a,o,s,l){return".bin"===r.slice(-4)?function $k(t,r,e,i,a,o,s){if(!t)return t;var l=r||{};i||(i={"!id":{}});var u,x,h,v,T,S,y,P,U,M,c=l.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=[],p=!1,m=!1,I=[];l.biff=12,l["!row"]=0;var B=0,R=!1,W=[],J={},L=l.supbooks||a.supbooks||[[]];if(L.sharedf=J,L.arrayf=W,L.SheetNames=a.SheetNames||a.Sheets.map(function(we){return we.name}),!l.supbooks&&(l.supbooks=L,a.Names))for(var le=0;le<a.Names.length;++le)L[0][le+1]=a.Names[le];var Ce,Be,xe=[],ce=[],Te=!1;if(fa[16]={n:"BrtShortReal",f:wu},er(t,function(ee,F,Z){if(!m)switch(Z){case 148:u=ee;break;case 0:x=ee,l.sheetRows&&l.sheetRows<=x.r&&(m=!0),U=ht(T=x.r),l["!row"]=x.r,(ee.hidden||ee.hpt||null!=ee.level)&&(ee.hpt&&(ee.hpx=Ci(ee.hpt)),ce[ee.r]=ee);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(h={t:ee[2]},ee[2]){case"n":h.v=ee[1];break;case"s":h.v=(P=la[ee[1]]).t,h.r=P.r;break;case"b":h.v=!!ee[1];break;case"e":h.v=ee[1],!1!==l.cellText&&(h.w=tr[h.v]);break;case"str":h.t="s",h.v=ee[1];break;case"is":h.t="s",h.v=ee[1].t}if((v=s.CellXf[ee[0].iStyleRef])&&vu(h,v.numFmtId,null,l,o,s),S=-1==ee[0].c?S+1:ee[0].c,l.dense?(c[T]||(c[T]=[]),c[T][S]=h):c[ot(S)+U]=h,l.cellFormula){for(R=!1,B=0;B<W.length;++B){var N=W[B];x.r>=N[0].s.r&&x.r<=N[0].e.r&&S>=N[0].s.c&&S<=N[0].e.c&&(h.F=De(N[0]),R=!0)}!R&&ee.length>3&&(h.f=ee[3])}if(d.s.r>x.r&&(d.s.r=x.r),d.s.c>S&&(d.s.c=S),d.e.r<x.r&&(d.e.r=x.r),d.e.c<S&&(d.e.c=S),l.cellDates&&v&&"n"==h.t&&Ur(Se[v.numFmtId])){var A=xr(h.v);A&&(h.t="d",h.v=new Date(A.y,A.m-1,A.d,A.H,A.M,A.S,A.u))}Ce&&("XLDAPR"==Ce.type&&(h.D=!0),Ce=void 0),Be&&(Be=void 0);break;case 1:case 12:if(!l.sheetStubs||p)break;h={t:"z",v:void 0},S=-1==ee[0].c?S+1:ee[0].c,l.dense?(c[T]||(c[T]=[]),c[T][S]=h):c[ot(S)+U]=h,d.s.r>x.r&&(d.s.r=x.r),d.s.c>S&&(d.s.c=S),d.e.r<x.r&&(d.e.r=x.r),d.e.c<S&&(d.e.c=S),Ce&&("XLDAPR"==Ce.type&&(h.D=!0),Ce=void 0),Be&&(Be=void 0);break;case 176:I.push(ee);break;case 49:Ce=((l.xlmeta||{}).Cell||[])[ee-1];break;case 494:var X=i["!id"][ee.relId];for(X?(ee.Target=X.Target,ee.loc&&(ee.Target+="#"+ee.loc),ee.Rel=X):""==ee.relId&&(ee.Target="#"+ee.loc),T=ee.rfx.s.r;T<=ee.rfx.e.r;++T)for(S=ee.rfx.s.c;S<=ee.rfx.e.c;++S)l.dense?(c[T]||(c[T]=[]),c[T][S]||(c[T][S]={t:"z",v:void 0}),c[T][S].l=ee):(y=ze({c:S,r:T}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=ee);break;case 426:if(!l.cellFormula)break;W.push(ee),(M=l.dense?c[T][S]:c[ot(S)+U]).f=Wt(ee[1],0,{r:x.r,c:S},L,l),M.F=De(ee[0]);break;case 427:if(!l.cellFormula)break;J[ze(ee[0].s)]=ee[1],(M=l.dense?c[T][S]:c[ot(S)+U]).f=Wt(ee[1],0,{r:x.r,c:S},L,l);break;case 60:if(!l.cellStyles)break;for(;ee.e>=ee.s;)xe[ee.e--]={width:ee.w/256,hidden:!!(1&ee.flags),level:ee.level},Te||(Te=!0,ws(ee.w/256)),kr(xe[ee.e+1]);break;case 161:c["!autofilter"]={ref:De(ee)};break;case 476:c["!margins"]=ee;break;case 147:a.Sheets[e]||(a.Sheets[e]={}),ee.name&&(a.Sheets[e].CodeName=ee.name),(ee.above||ee.left)&&(c["!outline"]={above:ee.above,left:ee.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ee.RTL&&(a.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:f.push(Z),p=!0;break;case 38:f.pop(),p=!1;break;default:if(!F.T&&(!p||l.WTF))throw new Error("Unexpected record 0x"+Z.toString(16))}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=De(u||d)),l.sheetRows&&c["!ref"]){var me=Ve(c["!ref"]);l.sheetRows<=+me.e.r&&(me.e.r=l.sheetRows-1,me.e.r>d.e.r&&(me.e.r=d.e.r),me.e.r<me.s.r&&(me.s.r=me.e.r),me.e.c>d.e.c&&(me.e.c=d.e.c),me.e.c<me.s.c&&(me.s.c=me.e.c),c["!fullref"]=c["!ref"],c["!ref"]=De(me))}return I.length>0&&(c["!merges"]=I),xe.length>0&&(c["!cols"]=xe),ce.length>0&&(c["!rows"]=ce),c}(t,i,e,a,o,s,l):function ST(t,r,e,i,a,o,s){if(!t)return t;i||(i={"!id":{}});var l=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=t.match(_T);f?(u=t.slice(0,f.index),d=t.slice(f.index+f[0].length)):u=d=t;var p=u.match(Cu);p?Fs(p[0],0,a,e):(p=u.match(TT))&&function zT(t,r,e,i,a){Fs(t.slice(0,t.indexOf(">")),0,i,a)}(p[0],0,0,a,e);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var x=u.slice(m,m+50).match(vT);x&&function mT(t,r){var e=Ve(r);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(t["!ref"]=De(e))}(l,x[1])}var h=u.match(kT);h&&h[1]&&function UT(t,r){r.Views||(r.Views=[{}]),(t.match(LT)||[]).forEach(function(e,i){var a=Ie(e);r.Views[i]||(r.Views[i]={}),+a.zoomScale&&(r.Views[i].zoom=+a.zoomScale),at(a.rightToLeft)&&(r.Views[i].RTL=!0)})}(h[1],a);var v=[];if(r.cellStyles){var T=u.match(CT);T&&function MT(t,r){for(var e=!1,i=0;i!=r.length;++i){var a=Ie(r[i],!0);a.hidden&&(a.hidden=at(a.hidden));var o=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!e&&a.width&&(e=!0,ws(a.width)),kr(a);o<=s;)t[o++]=tt(a)}}(v,T)}f&&ZT(f[1],l,r,c,o,s);var S=d.match(yT);S&&(l["!autofilter"]=function PT(t){return{ref:(t.match(/ref="([^"]*)"/)||[])[1]}}(S[0]));var y=[],P=d.match(gT);if(P)for(m=0;m!=P.length;++m)y[m]=Ve(P[m].slice(P[m].indexOf('"')+1));var U=d.match(xT);U&&function DT(t,r,e){for(var i=Array.isArray(t),a=0;a!=r.length;++a){var o=Ie(Xe(r[a]),!0);if(!o.ref)return;var s=((e||{})["!id"]||[])[o.id];s?(o.Target=s.Target,o.location&&(o.Target+="#"+Ge(o.location))):(o.Target="#"+Ge(o.location),s={Target:o.Target,TargetMode:"Internal"}),o.Rel=s,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var l=Ve(o.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=ze({c:u,r:c});i?(t[c]||(t[c]=[]),t[c][u]||(t[c][u]={t:"z",v:void 0}),t[c][u].l=o):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=o)}}}(l,U,i);var M=d.match(wT);if(M&&(l["!margins"]=function AT(t){var r={};return["left","right","top","bottom","header","footer"].forEach(function(e){t[e]&&(r[e]=parseFloat(t[e]))}),r}(Ie(M[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=De(c)),r.sheetRows>0&&l["!ref"]){var I=Ve(l["!ref"]);r.sheetRows<=+I.e.r&&(I.e.r=r.sheetRows-1,I.e.r>c.e.r&&(I.e.r=c.e.r),I.e.r<I.s.r&&(I.s.r=I.e.r),I.e.c>c.e.c&&(I.e.c=c.e.c),I.e.c<I.s.c&&(I.s.c=I.e.c),l["!fullref"]=l["!ref"],l["!ref"]=De(I))}return v.length>0&&(l["!cols"]=v),y.length>0&&(l["!merges"]=y),l}(t,i,e,a,o,s,l)}function WS(t,r,e,i,a){return(".bin"===r.slice(-4)?aS:yu)(t,e,i,a)}function JS(t,r,e){return(".bin"===r.slice(-4)?Fy:iu)(t,e)}var ua,Eu=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Fu=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Nn(t,r){var e=t.split(/\s+/),i=[];if(r||(i[0]=e[0]),1===e.length)return i;var o,s,c,a=t.match(Eu);if(a)for(c=0;c!=a.length;++c)-1===(s=(o=a[c].match(Fu))[1].indexOf(":"))?i[o[1]]=o[2].slice(1,o[2].length-1):i["xmlns:"===o[1].slice(0,6)?"xmlns"+o[1].slice(6):o[1].slice(s+1)]=o[2].slice(1,o[2].length-1);return i}function qS(t){var e={};if(1===t.split(/\s+/).length)return e;var a,o,l,i=t.match(Eu);if(i)for(l=0;l!=i.length;++l)-1===(o=(a=i[l].match(Fu))[1].indexOf(":"))?e[a[1]]=a[2].slice(1,a[2].length-1):e["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(o+1)]=a[2].slice(1,a[2].length-1);return e}function KS(t,r,e,i){var a=i;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=at(i);break;case"i2":case"int":a=parseInt(i,10);break;case"r4":case"float":a=parseFloat(i);break;case"date":case"dateTime.tz":a=it(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}t[Ge(r)]=a}function tb(t,r,e){if(e.cellStyles&&r.Interior){var i=r.Interior;i.Pattern&&(i.patternType=f2[i.Pattern]||i.Pattern)}t[r.ID]=r}function nb(t,r,e,i,a,o,s,l,c,u){var d="General",f=i.StyleID,p={};u=u||{};var m=[],x=0;for(void 0===f&&l&&(f=l.StyleID),void 0===f&&s&&(f=s.StyleID);void 0!==o[f]&&(o[f].nf&&(d=o[f].nf),o[f].Interior&&m.push(o[f].Interior),o[f].Parent);)f=o[f].Parent;switch(e.Type){case"Boolean":i.t="b",i.v=at(t);break;case"String":i.t="s",i.r=wc(Ge(t)),i.v=t.indexOf("<")>-1?Ge(r||t).replace(/<.*?>/g,""):i.r;break;case"DateTime":"Z"!=t.slice(-1)&&(t+="Z"),i.v=(it(t)-new Date(Date.UTC(1899,11,30)))/864e5,i.v!=i.v?i.v=Ge(t):i.v<60&&(i.v=i.v-1),(!d||"General"==d)&&(d="yyyy-mm-dd");case"Number":void 0===i.v&&(i.v=+t),i.t||(i.t="n");break;case"Error":i.t="e",i.v=Xc[t],!1!==u.cellText&&(i.w=t);break;default:""==t&&""==r?i.t="z":(i.t="s",i.v=wc(r||t))}if(function eb(t,r,e){if("z"!==t.t){if(!e||!1!==e.cellText)try{t.w="e"===t.t?t.w||tr[t.v]:"General"===r?"n"===t.t?(0|t.v)===t.v?t.v.toString(10):Ui(t.v):Lr(t.v):function XS(t,r){var e=ua[t]||Ge(t);return"General"===e?Lr(r):un(e,r)}(r||"General",t.v)}catch(o){if(e.WTF)throw o}try{var i=ua[r]||r||"General";if(e.cellNF&&(t.z=i),e.cellDates&&"n"==t.t&&Ur(i)){var a=xr(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(e.WTF)throw o}}}(i,d,u),!1!==u.cellFormula)if(i.Formula){var h=Ge(i.Formula);61==h.charCodeAt(0)&&(h=h.slice(1)),i.f=wi(h,a),delete i.Formula,"RC"==i.ArrayRange?i.F=wi("RC:RC",a):i.ArrayRange&&(i.F=wi(i.ArrayRange,a),c.push([Ve(i.F),i.F]))}else for(x=0;x<c.length;++x)a.r>=c[x][0].s.r&&a.r<=c[x][0].e.r&&a.c>=c[x][0].s.c&&a.c<=c[x][0].e.c&&(i.F=c[x][1]);u.cellStyles&&(m.forEach(function(v){!p.patternType&&v.patternType&&(p.patternType=v.patternType)}),i.s=p),void 0!==i.StyleID&&(i.ixfe=i.StyleID)}function rb(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.v=t.w=t.ixfe=void 0}function As(t,r){var e=r||{};fi();var i=ci(Wo(t));("binary"==e.type||"array"==e.type||"base64"==e.type)&&(i=Xe(i));var a=i.slice(0,1024).toLowerCase(),o=!1;if((1023&(a=a.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&a.indexOf(","),1023&a.indexOf(";"))){var s=tt(e);return s.type="string",vi.to_workbook(i,s)}if(-1==a.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(_t){a.indexOf("<"+_t)>=0&&(o=!0)}),o)return function Lb(t,r){var e=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||0==e.length)throw new Error("Invalid HTML: could not find <table>");if(1==e.length)return wr(Mu(e[0],r),r);var i={SheetNames:[],Sheets:{}};return e.forEach(function(a,o){Js(i,Mu(a,r),"Sheet"+(o+1))}),i}(i,e);ua={"General Number":"General","General Date":Se[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Se[15],"Short Date":Se[14],"Long Time":Se[19],"Medium Time":Se[18],"Short Time":Se[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Se[2],Standard:Se[4],Percent:Se[10],Scientific:Se[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u,Ce,c=[],d={},f=[],p=e.dense?[]:{},m="",x={},h={},v=Nn('<Data ss:Type="String">'),T=0,S=0,y=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},U={},M={},I="",B=0,R=[],W={},J={},L=0,le=[],xe=[],ce={},Te=[],Be=!1,me=[],we=[],ee={},F=0,Z=0,N={Sheets:[],WBProps:{date1904:!1}},A={};Wi.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/gm,"");for(var X="";l=Wi.exec(i);)switch(l[3]=(X=l[3]).toLowerCase()){case"data":if("data"==X){if("/"===l[1]){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else"/"!==l[0].charAt(l[0].length-2)&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;"/"===l[1]?nb(i.slice(T,l.index),I,v,"comment"==c[c.length-1][0]?ce:x,{c:S,r:y},U,Te[S],h,me,e):(I="",v=Nn(l[0]),T=l.index+l[0].length);break;case"cell":if("/"===l[1])if(xe.length>0&&(x.c=xe),(!e.sheetRows||e.sheetRows>y)&&void 0!==x.v&&(e.dense?(p[y]||(p[y]=[]),p[y][S]=x):p[ot(S)+ht(y)]=x),x.HRef&&(x.l={Target:Ge(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(F=S+(0|parseInt(x.MergeAcross,10)),Z=y+(0|parseInt(x.MergeDown,10)),R.push({s:{c:S,r:y},e:{c:F,r:Z}})),e.sheetStubs)if(x.MergeAcross||x.MergeDown){for(var pe=S;pe<=F;++pe)for(var ie=y;ie<=Z;++ie)(pe>S||ie>y)&&(e.dense?(p[ie]||(p[ie]=[]),p[ie][pe]={t:"z"}):p[ot(pe)+ht(ie)]={t:"z"});S=F+1}else++S;else x.MergeAcross?S=F+1:++S;else(x=qS(l[0])).Index&&(S=+x.Index-1),S<P.s.c&&(P.s.c=S),S>P.e.c&&(P.e.c=S),"/>"===l[0].slice(-2)&&++S,xe=[];break;case"row":"/"===l[1]||"/>"===l[0].slice(-2)?(y<P.s.r&&(P.s.r=y),y>P.e.r&&(P.e.r=y),"/>"===l[0].slice(-2)&&(h=Nn(l[0])).Index&&(y=+h.Index-1),S=0,++y):((h=Nn(l[0])).Index&&(y=+h.Index-1),ee={},("0"==h.AutoFitHeight||h.Height)&&(ee.hpx=parseInt(h.Height,10),ee.hpt=ra(ee.hpx),we[y]=ee),"1"==h.Hidden&&(ee.hidden=!0,we[y]=ee));break;case"worksheet":if("/"===l[1]){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(m),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(p["!ref"]=De(P),e.sheetRows&&e.sheetRows<=P.e.r&&(p["!fullref"]=p["!ref"],P.e.r=e.sheetRows-1,p["!ref"]=De(P))),R.length&&(p["!merges"]=R),Te.length>0&&(p["!cols"]=Te),we.length>0&&(p["!rows"]=we),d[m]=p}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=S=0,c.push([l[3],!1]),u=Nn(l[0]),m=Ge(u.Name),p=e.dense?[]:{},R=[],me=[],we=[],N.Sheets.push(A={name:m,Hidden:0});break;case"table":if("/"===l[1]){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if("/>"==l[0].slice(-2))break;c.push([l[3],!1]),Te=[],Be=!1}break;case"style":"/"===l[1]?tb(U,M,e):M=Nn(l[0]);break;case"numberformat":M.nf=Ge(Nn(l[0]).Format||"General"),ua[M.nf]&&(M.nf=ua[M.nf]);for(var ae=0;392!=ae&&Se[ae]!=M.nf;++ae);if(392==ae)for(ae=57;392!=ae;++ae)if(null==Se[ae]){Bn(M.nf,ae);break}break;case"column":if("table"!==c[c.length-1][0])break;if((Ce=Nn(l[0])).Hidden&&(Ce.hidden=!0,delete Ce.Hidden),Ce.Width&&(Ce.wpx=parseInt(Ce.Width,10)),!Be&&Ce.wpx>10){Be=!0,Gt=6;for(var te=0;te<Te.length;++te)Te[te]&&kr(Te[te])}Be&&kr(Ce),Te[Ce.Index-1||Te.length]=Ce;for(var Ne=0;Ne<+Ce.Span;++Ne)Te[Te.length]=tt(Ce);break;case"namedrange":if("/"===l[1])break;N.Names||(N.Names=[]);var E=Ie(l[0]),Qe={Name:E.Name,Ref:wi(E.RefersTo.slice(1),{r:0,c:0})};N.Sheets.length>0&&(Qe.Sheet=N.Sheets.length-1),N.Names.push(Qe);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===l[0].slice(-2))break;"/"===l[1]?I+=i.slice(B,l.index):B=l.index+l[0].length;break;case"interior":if(!e.cellStyles)break;M.Interior=Nn(l[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===l[0].slice(-2))break;"/"===l[1]?Sx(W,X,i.slice(L,l.index)):L=l.index+l[0].length;break;case"styles":case"workbook":if("/"===l[1]){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if("/"===l[1]){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));rb(ce),xe.push(ce)}else c.push([l[3],!1]),ce={a:(u=Nn(l[0])).Author};break;case"autofilter":if("/"===l[1]){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if("/"!==l[0].charAt(l[0].length-2)){var Ue=Nn(l[0]);p["!autofilter"]={ref:wi(Ue.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"datavalidation":if("/"===l[1]){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else"/"!==l[0].charAt(l[0].length-2)&&c.push([l[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===l[1]){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else"/"!==l[0].charAt(l[0].length-2)&&c.push([l[3],!0]);break;default:if(0==c.length&&"document"==l[3]||0==c.length&&"uof"==l[3])return Yu(i,e);var qe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:qe=!1}break;case"componentoptions":switch(l[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:qe=!1}break;case"excelworkbook":switch(l[3]){case"date1904":N.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:qe=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":case"height":case"width":break;default:qe=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if("/>"!==l[0].slice(-2))if("/"===l[1])switch(i.slice(L,l.index)){case"SheetHidden":A.Hidden=1;break;case"SheetVeryHidden":A.Hidden=2}else L=l.index+l[0].length;break;case"header":p["!margins"]||ei(p["!margins"]={},"xlml"),isNaN(+Ie(l[0]).Margin)||(p["!margins"].header=+Ie(l[0]).Margin);break;case"footer":p["!margins"]||ei(p["!margins"]={},"xlml"),isNaN(+Ie(l[0]).Margin)||(p["!margins"].footer=+Ie(l[0]).Margin);break;case"pagemargins":var He=Ie(l[0]);p["!margins"]||ei(p["!margins"]={},"xlml"),isNaN(+He.Top)||(p["!margins"].top=+He.Top),isNaN(+He.Left)||(p["!margins"].left=+He.Left),isNaN(+He.Right)||(p["!margins"].right=+He.Right),isNaN(+He.Bottom)||(p["!margins"].bottom=+He.Bottom);break;case"displayrighttoleft":N.Views||(N.Views=[]),N.Views[0]||(N.Views[0]={}),N.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;default:qe=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:qe=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:qe=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:qe=!1}break;case"querytable":switch(l[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:qe=!1}break;case"datavalidation":switch(l[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:qe=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:qe=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:qe=!1}break;case"smarttags":break;default:qe=!1}if(qe||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===l[0].slice(-2))break;"/"===l[1]?KS(J,X,le,i.slice(L,l.index)):(le=l,L=l.index+l[0].length);break}if(e.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ge={};return!e.bookSheets&&!e.bookProps&&(ge.Sheets=d),ge.SheetNames=f,ge.Workbook=N,ge.SSF=tt(Se),ge.Props=W,ge.Custprops=J,ge}function Ns(t,r){switch(Hs(r=r||{}),r.type||"base64"){case"base64":return As(ln(t),r);case"binary":case"buffer":case"file":return As(t,r);case"array":return As(_r(t),r)}}function Du(t){return se("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+bs(t.Ref,{r:0,c:0})})}function db(t,r,e,i,a,o,s){if(!t||null==t.v&&null==t.f)return"";var l={};if(t.f&&(l["ss:Formula"]="="+Je(bs(t.f,s))),t.F&&t.F.slice(0,r.length)==r){var c=lt(t.F.slice(r.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=Je(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=Je(t.l.Tooltip))),e["!merges"])for(var u=e["!merges"],d=0;d!=u.length;++d)u[d].s.c!=s.c||u[d].s.r!=s.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",p="";switch(t.t){case"z":if(!i.sheetStubs)return"";break;case"n":f="Number",p=String(t.v);break;case"b":f="Boolean",p=t.v?"1":"0";break;case"e":f="Error",p=tr[t.v];break;case"d":f="DateTime",p=new Date(t.v).toISOString(),null==t.z&&(t.z=t.z||Se[14]);break;case"s":f="String",p=function I1(t){return(t+"").replace(Vo,function(e){return Ho[e]}).replace(yc,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}(t.v||"")}var m=br(i.cellXfs,t,i);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=s.c+1;var h="z"==t.t?"":'<Data ss:Type="'+f+'">'+(null!=t.v?p:"")+"</Data>";return(t.c||[]).length>0&&(h+=function ub(t){return t.map(function(r){var e=function O1(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}(r.t||""),i=se("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return se("Comment",i,{"ss:Author":r.a})}).join("")}(t.c)),se("Cell",h,l)}function fb(t,r){var e='<Row ss:Index="'+(t+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Ci(r.hpt)),r.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(e+=' ss:Hidden="1"')),e+">"}function hb(t,r,e){var i=[],o=e.Sheets[e.SheetNames[t]],s=o?function lb(t,r,e,i){if(!t||!((i||{}).Workbook||{}).Names)return"";for(var a=i.Workbook.Names,o=[],s=0;s<a.length;++s){var l=a[s];l.Sheet==e&&(l.Name.match(/^_xlfn\./)||o.push(Du(l)))}return o.join("")}(o,0,t,e):"";return s.length>0&&i.push("<Names>"+s+"</Names>"),s=o?function pb(t,r,e,i){if(!t["!ref"])return"";var a=Ve(t["!ref"]),o=t["!merges"]||[],s=0,l=[];t["!cols"]&&t["!cols"].forEach(function(v,T){kr(v);var S=!!v.width,y=so(T,v),P={"ss:Index":T+1};S&&(P["ss:Width"]=ta(y.width)),v.hidden&&(P["ss:Hidden"]="1"),l.push(se("Column",null,P))});for(var c=Array.isArray(t),u=a.s.r;u<=a.e.r;++u){for(var d=[fb(u,(t["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var p=!1;for(s=0;s!=o.length;++s)if(!(o[s].s.c>f||o[s].s.r>u||o[s].e.c<f||o[s].e.r<u)){(o[s].s.c!=f||o[s].s.r!=u)&&(p=!0);break}if(!p){var m={r:u,c:f},x=ze(m);d.push(db(c?(t[u]||[])[f]:t[x],x,t,r,0,0,m))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}(o,r):"",s.length>0&&i.push("<Table>"+s+"</Table>"),i.push(function cb(t,r,e,i){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(se("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(se("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(se("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[e])if(i.Workbook.Sheets[e].Hidden)a.push(se("Visible",1==i.Workbook.Sheets[e].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<e&&(!i.Workbook.Sheets[o]||i.Workbook.Sheets[o].Hidden);++o);o==e&&a.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(Mt("ProtectContents","True")),t["!protect"].objects&&a.push(Mt("ProtectObjects","True")),t["!protect"].scenarios&&a.push(Mt("ProtectScenarios","True")),null==t["!protect"].selectLockedCells||t["!protect"].selectLockedCells?null!=t["!protect"].selectUnlockedCells&&!t["!protect"].selectUnlockedCells&&a.push(Mt("EnableSelection","UnlockedCells")):a.push(Mt("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){t["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),0==a.length?"":se("WorksheetOptions",a.join(""),{xmlns:fn_x})}(o,0,t,e)),i.join("")}function mb(t,r){r||(r={}),t.SSF||(t.SSF=tt(Se)),t.SSF&&(fi(),Hi(t.SSF),r.revssf=La(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF,r.cellXfs=[],br(r.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(function ib(t,r){var e=[];return t.Props&&e.push(function bx(t,r){var e=[];return dt(ps).map(function(i){for(var a=0;a<Tn.length;++a)if(Tn[a][1]==i)return Tn[a];for(a=0;a<Jr.length;++a)if(Jr[a][1]==i)return Jr[a];throw i}).forEach(function(i){if(null!=t[i[1]]){var a=r&&r.Props&&null!=r.Props[i[1]]?r.Props[i[1]]:t[i[1]];"date"===i[2]&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof a?a=String(a):!0===a||!1===a?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),e.push(Mt(ps[i[1]]||i[1],a))}}),se("DocumentProperties",e.join(""),{xmlns:fn_o})}(t.Props,r)),t.Custprops&&e.push(function zx(t,r){var e=["Worksheets","SheetNames"],i="CustomDocumentProperties",a=[];return t&&dt(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)){for(var s=0;s<Tn.length;++s)if(o==Tn[s][1])return;for(s=0;s<Jr.length;++s)if(o==Jr[s][1])return;for(s=0;s<e.length;++s)if(o==e[s])return;var l=t[o],c="string";"number"==typeof l?(c="float",l=String(l)):!0===l||!1===l?(c="boolean",l=l?"1":"0"):l=String(l),a.push(se(Cc(o),l,{"dt:dt":c}))}}),r&&dt(r).forEach(function(o){if(Object.prototype.hasOwnProperty.call(r,o)&&(!t||!Object.prototype.hasOwnProperty.call(t,o))){var s=r[o],l="string";"number"==typeof s?(l="float",s=String(s)):!0===s||!1===s?(l="boolean",s=s?"1":"0"):s instanceof Date?(l="dateTime.tz",s=s.toISOString()):s=String(s),a.push(se(Cc(o),s,{"dt:dt":l}))}}),"<"+i+' xmlns="'+fn_o+'">'+a.join("")+"</"+i+">"}(t.Props,t.Custprops)),e.join("")}(t,r)),e.push(""),e.push(""),e.push("");for(var i=0;i<t.SheetNames.length;++i)e.push(se("Worksheet",hb(i,r,t),{"ss:Name":Je(t.SheetNames[i])}));return e[2]=function ob(t,r){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(i,a){var o=[];o.push(se("NumberFormat",null,{"ss:Format":Je(Se[i.numFmtId])}));var s={"ss:ID":"s"+(21+a)};e.push(se("Style",o.join(""),s))}),se("Styles",e.join(""))}(0,r),e[3]=function sb(t){if(!((t||{}).Workbook||{}).Names)return"";for(var r=t.Workbook.Names,e=[],i=0;i<r.length;++i){var a=r[i];null==a.Sheet&&(a.Name.match(/^_xlfn\./)||e.push(Du(a)))}return se("Names",e.join(""))}(t),pt+se("Workbook",e.join(""),{xmlns:fn_ss,"xmlns:o":fn_o,"xmlns:x":fn_x,"xmlns:ss":fn_ss,"xmlns:dt":"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882","xmlns:html":"http://www.w3.org/TR/REC-html40"})}var _b=[60,1084,2066,2165,2175];function xb(t,r,e,i,a){var o=i,s=[],l=e.slice(e.l,e.l+o);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:a.enc.insitu(l)}s.push(l),e.l+=o;for(var c=Kn(e,e.l),u=Ms[c],d=0;null!=u&&_b.indexOf(c)>-1;)o=Kn(e,e.l+2),d=e.l+4,2066==c?d+=4:(2165==c||2175==c)&&(d+=12),l=e.slice(d,e.l+4+o),s.push(l),e.l+=4+o,u=Ms[c=Kn(e,e.l)];var f=Ot(s);Rt(f,0);var p=0;f.lens=[];for(var m=0;m<s.length;++m)f.lens.push(p),p+=s[m].length;if(f.length<i)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+i;return r.f(f,f.length,a)}function Zn(t,r,e){if("z"!==t.t&&t.XF){var i=0;try{i=t.z||t.XF.numFmtId||0,r.cellNF&&(t.z=Se[i])}catch(o){if(r.WTF)throw o}if(!r||!1!==r.cellText)try{t.w="e"===t.t?t.w||tr[t.v]:0===i||"General"==i?"n"===t.t?(0|t.v)===t.v?t.v.toString(10):Ui(t.v):Lr(t.v):un(i,t.v,{date1904:!!e,dateNF:r&&r.dateNF})}catch(o){if(r.WTF)throw o}if(r.cellDates&&i&&"n"==t.t&&Ur(Se[i]||String(i))){var a=xr(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function lo(t,r,e){return{v:t,ixfe:r,t:e}}var da_SI="e0859ff2f94f6810ab9108002b27b3d9",da_DSI="02d5cdd59c2e1b10939708002b2cf9ae";function Au(t,r){var e,i,a,o;if(r||(r={}),Hs(r),Aa(),r.codepage&&Da(r.codepage),t.FullPaths){if(ke.find(t,"/encryption"))throw new Error("File is password-protected");e=ke.find(t,"!CompObj"),i=ke.find(t,"/Workbook")||ke.find(t,"/Book")}else{switch(r.type){case"base64":t=cn(ln(t));break;case"binary":t=cn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t))}Rt(t,0),i={content:t}}if(e&&function gb(t){var r={},e=t.content;if(e.l=28,r.AnsiUserType=e.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=function ax(t){return $c(t,1)}(e),e.length-e.l<=4)return r;var i=e.read_shift(4);if(0==i||i>40||(e.l-=4,r.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||1907505652!==(i=e.read_shift(4))||(r.UnicodeClipboardFormat=function ox(t){return $c(t,2)}(e),0==(i=e.read_shift(4))||i>40))return r;e.l-=4,r.Reserved2=e.read_shift(0,"lpwstr")}(e),r.bookProps&&!r.bookSheets)a={};else{var s=Pe?"buffer":"array";if(i&&i.content)a=function vb(t,r){var f,m,h,v,y,P,e={opts:{}},i={},a=r.dense?[]:{},o={},s={},l=null,c=[],u="",d={},p="",T={},S=[],U=[],M=[],I={Sheets:[],WBProps:{date1904:!1},Views:[{}]},B={},R=function(Le){return Le<8?$r[Le]:Le<64&&M[Le-8]||$r[Le]},J=function(Le,xt,On){if(!(ee>1||On.sheetRows&&Le.r>=On.sheetRows)){if(On.cellStyles&&xt.XF&&xt.XF.data&&function(Le,xt,On){var ii,St=xt.XF.data;St&&St.patternType&&On&&On.cellStyles&&(xt.s={},xt.s.patternType=St.patternType,(ii=ea(R(St.icvFore)))&&(xt.s.fgColor={rgb:ii}),(ii=ea(R(St.icvBack)))&&(xt.s.bgColor={rgb:ii}))}(0,xt,On),delete xt.ixfe,delete xt.XF,f=Le,p=ze(Le),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Le.r<s.s.r&&(s.s.r=Le.r),Le.c<s.s.c&&(s.s.c=Le.c),Le.r+1>s.e.r&&(s.e.r=Le.r+1),Le.c+1>s.e.c&&(s.e.c=Le.c+1),On.cellFormula&&xt.f)for(var St=0;St<S.length;++St)if(!(S[St][0].s.c>Le.c||S[St][0].s.r>Le.r||S[St][0].e.c<Le.c||S[St][0].e.r<Le.r)){xt.F=De(S[St][0]),(S[St][0].s.c!=Le.c||S[St][0].s.r!=Le.r)&&delete xt.f,xt.f&&(xt.f=""+Wt(S[St][1],0,Le,me,L));break}On.dense?(a[Le.r]||(a[Le.r]=[]),a[Le.r][Le.c]=xt):a[p]=xt}},L={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(L.password=r.password);var le,xe=[],ce=[],Te=[],Ce=[],Be=!1,me=[];me.SheetNames=L.snames,me.sharedf=L.sharedf,me.arrayf=L.arrayf,me.names=[],me.XTI=[];var A,we=0,ee=0,F=0,Z=[],N=[];L.codepage=1200,vn(1200);for(var X=!1;t.l<t.length-1;){var pe=t.l,ie=t.read_shift(2);if(0===ie&&10===we)break;var ae=t.l===t.length?0:t.read_shift(2),te=Ms[ie];if(te&&te.f){if(r.bookSheets&&133===we&&133!==ie)break;if(we=ie,2===te.r||12==te.r){var Ne=t.read_shift(2);if(ae-=2,!L.enc&&Ne!==ie&&((255&Ne)<<8|Ne>>8)!==ie)throw new Error("rt mismatch: "+Ne+"!="+ie);12==te.r&&(t.l+=10,ae-=10)}var E={};if(E=10===ie?te.f(t,ae,L):xb(ie,te,t,ae,L),0==ee&&-1===[9,521,1033,2057].indexOf(we))continue;switch(ie){case 34:e.opts.Date1904=I.WBProps.date1904=E;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(L.enc||(t.l=0),L.enc=E,!r.password)throw new Error("File is password-protected");if(null==E.valid)throw new Error("Encryption scheme unsupported");if(!E.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=E;break;case 66:var Qe=Number(E);switch(Qe){case 21010:Qe=1200;break;case 32768:Qe=1e4;break;case 32769:Qe=1252}vn(L.codepage=Qe),X=!0;break;case 317:L.rrtabid=E;break;case 25:L.winlocked=E;break;case 439:e.opts.RefreshAll=E;break;case 12:e.opts.CalcCount=E;break;case 16:e.opts.CalcDelta=E;break;case 17:e.opts.CalcIter=E;break;case 13:e.opts.CalcMode=E;break;case 14:e.opts.CalcPrecision=E;break;case 95:e.opts.CalcSaveRecalc=E;break;case 15:L.CalcRefMode=E;break;case 2211:e.opts.FullCalc=E;break;case 129:E.fDialog&&(a["!type"]="dialog"),E.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),E.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:U.push(E);break;case 430:me.push([E]),me[me.length-1].XTI=[];break;case 35:case 547:me[me.length-1].push(E);break;case 24:case 536:A={Name:E.Name,Ref:Wt(E.rgce,0,null,me,L)},E.itab>0&&(A.Sheet=E.itab-1),me.names.push(A),me[0]||(me[0]=[],me[0].XTI=[]),me[me.length-1].push(E),"_xlnm._FilterDatabase"==E.Name&&E.itab>0&&E.rgce&&E.rgce[0]&&E.rgce[0][0]&&"PtgArea3d"==E.rgce[0][0][0]&&(N[E.itab-1]={ref:De(E.rgce[0][0][1][2])});break;case 22:L.ExternCount=E;break;case 23:0==me.length&&(me[0]=[],me[0].XTI=[]),me[me.length-1].XTI=me[me.length-1].XTI.concat(E),me.XTI=me.XTI.concat(E);break;case 2196:if(L.biff<8)break;null!=A&&(A.Comment=E[1]);break;case 18:a["!protect"]=E;break;case 19:0!==E&&L.WTF&&console.error("Password verifier: "+E);break;case 133:o[E.pos]=E,L.snames.push(E.name);break;case 10:if(--ee)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=De(s),r.sheetRows&&r.sheetRows<=s.e.r){var Ue=s.e.r;s.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=De(s),s.e.r=Ue}s.e.r++,s.e.c++}xe.length>0&&(a["!merges"]=xe),ce.length>0&&(a["!objects"]=ce),Te.length>0&&(a["!cols"]=Te),Ce.length>0&&(a["!rows"]=Ce),I.Sheets.push(B)}""===u?d=a:i[u]=a,a=r.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===L.biff&&(L.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[E.BIFFVer]||8),L.biffguess=0==E.BIFFVer,0==E.BIFFVer&&4096==E.dt&&(L.biff=5,X=!0,vn(L.codepage=28591)),8==L.biff&&0==E.BIFFVer&&16==E.dt&&(L.biff=2),ee++)break;if(a=r.dense?[]:{},L.biff<8&&!X&&(X=!0,vn(L.codepage=r.codepage||1252)),L.biff<5||0==E.BIFFVer&&4096==E.dt){""===u&&(u="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var qe={pos:t.l-ae,name:u};o[qe.pos]=qe,L.snames.push(u)}else u=(o[pe]||{name:""}).name;32==E.dt&&(a["!type"]="chart"),64==E.dt&&(a["!type"]="macro"),xe=[],ce=[],L.arrayf=S=[],Te=[],Ce=[],Be=!1,B={Hidden:(o[pe]||{hs:0}).hs,name:u};break;case 515:case 3:case 2:"chart"==a["!type"]&&(r.dense?(a[E.r]||[])[E.c]:a[ze({c:E.c,r:E.r})])&&++E.c,y={ixfe:E.ixfe,XF:U[E.ixfe]||{},v:E.val,t:"n"},F>0&&(y.z=Z[y.ixfe>>8&63]),Zn(y,r,e.opts.Date1904),J({c:E.c,r:E.r},y,r);break;case 5:case 517:y={ixfe:E.ixfe,XF:U[E.ixfe],v:E.val,t:E.t},F>0&&(y.z=Z[y.ixfe>>8&63]),Zn(y,r,e.opts.Date1904),J({c:E.c,r:E.r},y,r);break;case 638:y={ixfe:E.ixfe,XF:U[E.ixfe],v:E.rknum,t:"n"},F>0&&(y.z=Z[y.ixfe>>8&63]),Zn(y,r,e.opts.Date1904),J({c:E.c,r:E.r},y,r);break;case 189:for(var He=E.c;He<=E.C;++He){var ge=E.rkrec[He-E.c][0];y={ixfe:ge,XF:U[ge],v:E.rkrec[He-E.c][1],t:"n"},F>0&&(y.z=Z[y.ixfe>>8&63]),Zn(y,r,e.opts.Date1904),J({c:He,r:E.r},y,r)}break;case 6:case 518:case 1030:if("String"==E.val){l=E;break}if((y=lo(E.val,E.cell.ixfe,E.tt)).XF=U[y.ixfe],r.cellFormula){var _t=E.formula;if(_t&&_t[0]&&_t[0][0]&&"PtgExp"==_t[0][0][0]){var In=_t[0][0][1][0],Gn=_t[0][0][1][1],or=ze({r:In,c:Gn});T[or]?y.f=""+Wt(E.formula,0,E.cell,me,L):y.F=((r.dense?(a[In]||[])[Gn]:a[or])||{}).F}else y.f=""+Wt(E.formula,0,E.cell,me,L)}F>0&&(y.z=Z[y.ixfe>>8&63]),Zn(y,r,e.opts.Date1904),J(E.cell,y,r),l=E;break;case 7:case 519:if(!l)throw new Error("String record expects Formula");l.val=E,(y=lo(E,l.cell.ixfe,"s")).XF=U[y.ixfe],r.cellFormula&&(y.f=""+Wt(l.formula,0,l.cell,me,L)),F>0&&(y.z=Z[y.ixfe>>8&63]),Zn(y,r,e.opts.Date1904),J(l.cell,y,r),l=null;break;case 33:case 545:S.push(E);var ga=ze(E[0].s);if(m=r.dense?(a[E[0].s.r]||[])[E[0].s.c]:a[ga],r.cellFormula&&m){if(!l||!ga||!m)break;m.f=""+Wt(E[1],0,E[0],me,L),m.F=De(E[0])}break;case 1212:if(!r.cellFormula)break;if(p){if(!l)break;T[ze(l.cell)]=E[0],((m=r.dense?(a[l.cell.r]||[])[l.cell.c]:a[ze(l.cell)])||{}).f=""+Wt(E[0],0,f,me,L)}break;case 253:y=lo(c[E.isst].t,E.ixfe,"s"),c[E.isst].h&&(y.h=c[E.isst].h),y.XF=U[y.ixfe],F>0&&(y.z=Z[y.ixfe>>8&63]),Zn(y,r,e.opts.Date1904),J({c:E.c,r:E.r},y,r);break;case 513:r.sheetStubs&&(y={ixfe:E.ixfe,XF:U[E.ixfe],t:"z"},F>0&&(y.z=Z[y.ixfe>>8&63]),Zn(y,r,e.opts.Date1904),J({c:E.c,r:E.r},y,r));break;case 190:if(r.sheetStubs)for(var Or=E.c;Or<=E.C;++Or){var pn=E.ixfe[Or-E.c];y={ixfe:pn,XF:U[pn],t:"z"},F>0&&(y.z=Z[y.ixfe>>8&63]),Zn(y,r,e.opts.Date1904),J({c:Or,r:E.r},y,r)}break;case 214:case 516:case 4:(y=lo(E.val,E.ixfe,"s")).XF=U[y.ixfe],F>0&&(y.z=Z[y.ixfe>>8&63]),Zn(y,r,e.opts.Date1904),J({c:E.c,r:E.r},y,r);break;case 0:case 512:1===ee&&(s=E);break;case 252:c=E;break;case 1054:if(4==L.biff){Z[F++]=E[1];for(var sr=0;sr<F+163&&Se[sr]!=E[1];++sr);sr>=163&&Bn(E[1],F+163)}else Bn(E[1],E[0]);break;case 30:Z[F++]=E;for(var Er=0;Er<F+163&&Se[Er]!=E;++Er);Er>=163&&Bn(E,F+163);break;case 229:xe=xe.concat(E);break;case 93:ce[E.cmo[0]]=L.lastobj=E;break;case 438:L.lastobj.TxO=E;break;case 127:L.lastobj.ImData=E;break;case 440:for(v=E[0].s.r;v<=E[0].e.r;++v)for(h=E[0].s.c;h<=E[0].e.c;++h)(m=r.dense?(a[v]||[])[h]:a[ze({c:h,r:v})])&&(m.l=E[1]);break;case 2048:for(v=E[0].s.r;v<=E[0].e.r;++v)for(h=E[0].s.c;h<=E[0].e.c;++h)(m=r.dense?(a[v]||[])[h]:a[ze({c:h,r:v})])&&m.l&&(m.l.Tooltip=E[1]);break;case 28:if(L.biff<=5&&L.biff>=2)break;m=r.dense?(a[E[0].r]||[])[E[0].c]:a[ze(E[0])];var _a=ce[E[2]];m||(r.dense?(a[E[0].r]||(a[E[0].r]=[]),m=a[E[0].r][E[0].c]={t:"z"}):m=a[ze(E[0])]={t:"z"},s.e.r=Math.max(s.e.r,E[0].r),s.s.r=Math.min(s.s.r,E[0].r),s.e.c=Math.max(s.e.c,E[0].c),s.s.c=Math.min(s.s.c,E[0].c)),m.c||(m.c=[]),m.c.push({a:E[1],t:_a.TxO.t});break;case 2173:ay(0,E.ext);break;case 125:if(!L.cellStyles)break;for(;E.e>=E.s;)Te[E.e--]={width:E.w/256,level:E.level||0,hidden:!!(1&E.flags)},Be||(Be=!0,ws(E.w/256)),kr(Te[E.e+1]);break;case 520:var Kt={};null!=E.level&&(Ce[E.r]=Kt,Kt.level=E.level),E.hidden&&(Ce[E.r]=Kt,Kt.hidden=!0),E.hpt&&(Ce[E.r]=Kt,Kt.hpt=E.hpt,Kt.hpx=Ci(E.hpt));break;case 38:case 39:case 40:case 41:a["!margins"]||ei(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=E;break;case 161:a["!margins"]||ei(a["!margins"]={}),a["!margins"].header=E.header,a["!margins"].footer=E.footer;break;case 574:E.RTL&&(I.Views[0].RTL=!0);break;case 146:M=E;break;case 2198:le=E;break;case 140:P=E;break;case 442:u?B.CodeName=E||B.name:I.WBProps.CodeName=E||"ThisWorkbook"}}else te||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),t.l+=ae}return e.SheetNames=dt(o).sort(function(Wn,Le){return Number(Wn)-Number(Le)}).map(function(Wn){return o[Wn].name}),r.bookSheets||(e.Sheets=i),!e.SheetNames.length&&d["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=d)):e.Preamble=d,e.Sheets&&N.forEach(function(Wn,Le){e.Sheets[e.SheetNames[Le]]["!autofilter"]=Wn}),e.Strings=c,e.SSF=tt(Se),L.enc&&(e.Encryption=L.enc),le&&(e.Themes=le),e.Metadata={},void 0!==P&&(e.Metadata.Country=P),me.names.length>0&&(I.Names=me.names),e.Workbook=I,e}(i.content,r);else if((o=ke.find(t,"PerfectOffice_MAIN"))&&o.content)a=Kr.to_workbook(o.content,(r.type=s,r));else{if(!(o=ke.find(t,"NativeContent_MAIN"))||!o.content)throw(o=ke.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=Kr.to_workbook(o.content,(r.type=s,r))}r.bookVBA&&t.FullPaths&&ke.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=function Ay(t){var r=ke.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(e,i){if("/"!==e.slice(-1)&&e.match(/_VBA_PROJECT_CUR/)){var a=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ke.utils.cfb_add(r,a,t.FileIndex[i].content)}}),ke.write(r)}(t))}var l={};return t.FullPaths&&function Cb(t,r,e){var i=ke.find(t,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var a=x0(i,ls,da_DSI);for(var o in a)r[o]=a[o]}catch(u){if(e.WTF)throw u}var s=ke.find(t,"/!SummaryInformation");if(s&&s.size>0)try{var l=x0(s,cs,da_SI);for(var c in l)null==r[c]&&(r[c]=l[c])}catch(u){if(e.WTF)throw u}r.HeadingPairs&&r.TitlesOfParts&&(o0(r.HeadingPairs,r.TitlesOfParts,r,e),delete r.HeadingPairs,delete r.TitlesOfParts)}(t,l,r),a.Props=a.Custprops=l,r.bookFiles&&(a.cfb=t),a}var fa={0:{f:function GT(t,r){var e={},i=t.l+r;e.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=i,7&o&&(e.level=7&o),16&o&&(e.hidden=!0),32&o&&(e.hpt=a/20),e}},1:{f:function KT(t){return[wn(t)]}},2:{f:function xk(t){return[wn(t),os(t),"n"]}},3:{f:function sk(t){return[wn(t),t.read_shift(1),"e"]}},4:{f:function rk(t){return[wn(t),t.read_shift(1),"b"]}},5:{f:function mk(t){return[wn(t),Zt(t),"n"]}},6:{f:function Tk(t){return[wn(t),Vt(t),"str"]}},7:{f:function dk(t){return[wn(t),t.read_shift(4),"s"]}},8:{f:function Ek(t,r,e){var i=t.l+r,a=wn(t);a.r=e["!row"];var s=[a,Vt(t),"str"];if(e.cellFormula){t.l+=2;var l=oo(t,i-t.l,e);s[3]=Wt(l,0,a,e.supbooks,e)}else t.l=i;return s}},9:{f:function Ok(t,r,e){var i=t.l+r,a=wn(t);a.r=e["!row"];var s=[a,Zt(t),"n"];if(e.cellFormula){t.l+=2;var l=oo(t,i-t.l,e);s[3]=Wt(l,0,a,e.supbooks,e)}else t.l=i;return s}},10:{f:function zk(t,r,e){var i=t.l+r,a=wn(t);a.r=e["!row"];var s=[a,t.read_shift(1),"b"];if(e.cellFormula){t.l+=2;var l=oo(t,i-t.l,e);s[3]=Wt(l,0,a,e.supbooks,e)}else t.l=i;return s}},11:{f:function Ik(t,r,e){var i=t.l+r,a=wn(t);a.r=e["!row"];var s=[a,t.read_shift(1),"e"];if(e.cellFormula){t.l+=2;var l=oo(t,i-t.l,e);s[3]=Wt(l,0,a,e.supbooks,e)}else t.l=i;return s}},12:{f:function tk(t){return[jr(t)]}},13:{f:function Ck(t){return[jr(t),os(t),"n"]}},14:{f:function ck(t){return[jr(t),t.read_shift(1),"e"]}},15:{f:function ak(t){return[jr(t),t.read_shift(1),"b"]}},16:{f:wu},17:{f:function Sk(t){return[jr(t),Vt(t),"str"]}},18:{f:function pk(t){return[jr(t),t.read_shift(4),"s"]}},19:{f:ns},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function bS(t,r,e){var i=t.l+r;t.l+=4,t.l+=1;var a=t.read_shift(4),o=ex(t),s=lT(t,0,e),l=rs(t);t.l=i;var c={Name:o,Ptg:s};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}},40:{},42:{},43:{f:function T2(t,r,e){var i={};i.sz=t.read_shift(2)/20;var a=function rx(t){var r=t.read_shift(1);return t.l++,{fBold:1&r,fItalic:2&r,fUnderline:4&r,fStrikeout:8&r,fOutline:16&r,fShadow:32&r,fCondense:64&r,fExtend:128&r}}(t);switch(a.fItalic&&(i.italic=1),a.fCondense&&(i.condense=1),a.fExtend&&(i.extend=1),a.fShadow&&(i.shadow=1),a.fOutline&&(i.outline=1),a.fStrikeout&&(i.strike=1),700===t.read_shift(2)&&(i.bold=1),t.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript"}var s=t.read_shift(1);0!=s&&(i.underline=s);var l=t.read_shift(1);l>0&&(i.family=l);var c=t.read_shift(1);switch(c>0&&(i.charset=c),t.l++,i.color=function nx(t){var r={},i=t.read_shift(1)>>>1,a=t.read_shift(1),o=t.read_shift(2,"i"),s=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,i){case 0:r.auto=1;break;case 1:r.index=a;var u=$r[a];u&&(r.rgb=ea(u));break;case 2:r.rgb=ea([s,l,c]);break;case 3:r.theme=a}return 0!=o&&(r.tint=o>0?o/32767:o/32768),r}(t),t.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor"}return i.name=Vt(t),i}},44:{f:function y2(t,r){return[t.read_shift(2),Vt(t)]}},45:{f:b2},46:{f:I2},47:{f:function z2(t,r){var e=t.l+r,i=t.read_shift(2),a=t.read_shift(2);return t.l=e,{ixfe:i,numFmtId:a}}},48:{},49:{f:function Y1(t){return t.read_shift(4,"i")}},50:{},51:{f:function ly(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:L0},62:{f:function wk(t){return[wn(t),ns(t),"is"]}},63:{f:function _y(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=ze(e);var i=t.read_shift(1);return 2&i&&(r.l="1"),8&i&&(r.a="1"),r}},64:{f:function Wk(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ht,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function Vk(t){var r=t.read_shift(2);return t.l+=28,{RTL:32&r}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function qT(t,r){var e={},i=t[t.l];return++t.l,e.above=!(64&i),e.left=!(128&i),t.l+=18,e.name=K1(t,r-19),e}},148:{f:$T,p:16},151:{f:function Rk(){}},152:{},153:{f:function TS(t,r){var e={},i=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var a=r>8?Vt(t):"";return a.length>0&&(e.CodeName=a),e.autoCompressPictures=!!(65536&i),e.backupFile=!!(64&i),e.checkCompatibility=!!(4096&i),e.date1904=!!(1&i),e.filterPrivacy=!!(8&i),e.hidePivotFieldList=!!(1024&i),e.promptedSolutions=!!(16&i),e.publishItems=!!(2048&i),e.refreshAllConnections=!!(262144&i),e.saveExternalLinkValues=!!(128&i),e.showBorderUnselectedTables=!!(4&i),e.showInkAnnotation=!!(32&i),e.showObjects=["all","placeholders","none"][i>>13&3],e.showPivotChartFilter=!!(32768&i),e.updateLinks=["userSet","never","always"][i>>8&3],e}},154:{},155:{},156:{f:function yS(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=is(t,r-8),e.name=Vt(t),e}},157:{},158:{},159:{T:1,f:function PC(t){return[t.read_shift(4),t.read_shift(4)]}},160:{T:-1},161:{T:1,f:Wr},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Fk},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function oy(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:Vt(t)}}},336:{T:-1},337:{f:function dy(t){return t.l+=4,0!=t.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:is},357:{},358:{},359:{},360:{T:1},361:{},362:{f:P0},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function Pk(t,r,e){var i=t.l+r,a=Yc(t),o=t.read_shift(1),s=[a];if(s[2]=o,e.cellFormula){var l=sT(t,i-t.l,e);s[1]=l}else t.l=i;return s}},427:{f:function Bk(t,r,e){var i=t.l+r,o=[Wr(t,16)];if(e.cellFormula){var s=cT(t,i-t.l,e);o[1]=s,t.l=i}else t.l=i;return o}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function Uk(t){var r={};return Tu.forEach(function(e){r[e]=Zt(t)}),r}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function QT(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function Nk(t,r){var e=t.l+r,i=Wr(t,16),a=rs(t),o=Vt(t),s=Vt(t),l=Vt(t);t.l=e;var c={rfx:i,relId:a,loc:o,display:l};return s&&(c.Tooltip=s),c}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:is},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Iy},633:{T:1},634:{T:-1},635:{T:1,f:function by(t){var r={};r.iauthor=t.read_shift(4);var e=Wr(t,16);return r.rfx=e.s,r.ref=ze(e.s),t.l+=16,r}},636:{T:-1},637:{f:q1},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function uS(t,r){return t.l+=10,{name:Vt(t)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function Yk(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ms={6:{f:Is},10:{f:Tr},12:{f:yt},13:{f:yt},14:{f:gt},15:{f:gt},16:{f:Zt},17:{f:gt},18:{f:gt},19:{f:yt},20:{f:N0},21:{f:N0},23:{f:P0},24:{f:R0},25:{f:gt},26:{},27:{},28:{f:function Wv(t,r,e){return function Gv(t,r,e){if(!(e.biff<8)){var i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),s=t.read_shift(2),l=qr(t,0,e);return e.biff<8&&t.read_shift(1),[{r:i,c:a},l,s,o]}}(t,0,e)}},29:{},34:{f:gt},35:{f:M0},38:{f:Zt},39:{f:Zt},40:{f:Zt},41:{f:Zt},42:{f:gt},43:{f:gt},47:{f:function a2(t,r,e){var i={Type:e.biff>=8?t.read_shift(2):0};return i.Type?function r2(t,r,e){var i=e||{};return i.Info=t.read_shift(2),t.l-=2,i.Data=1===i.Info?function KC(t){var r={},e=r.EncryptionVersionInfo=nr(t,4);if(1!=e.Major||1!=e.Minor)throw"unrecognized version code "+e.Major+" : "+e.Minor;return r.Salt=t.read_shift(16),r.EncryptedVerifier=t.read_shift(16),r.EncryptedVerifierHash=t.read_shift(16),r}(t):function XC(t,r){var e={},i=e.EncryptionVersionInfo=nr(t,4);if(r-=4,2!=i.Minor)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);e.Flags=t.read_shift(4),r-=4;var a=t.read_shift(4);return r-=4,e.EncryptionHeader=G0(t,a),e.EncryptionVerifier=W0(t,r-=a),e}(t,r),i}(t,r-2,i):function n2(t,r,e,i){var a={key:yt(t),verificationBytes:yt(t)};e.password&&(a.verifier=Cs(e.password)),i.valid=a.verificationBytes===a.verifier,i.valid&&(i.insitu=function(t){var r=0,e=Y0(t);return function(i){var a=function(t,r,e,i,a){var o,s;for(a||(a=r),i||(i=Y0("")),o=0;o!=r.length;++o)s=r[o],a[o]=s=255&((s^=i[e])>>5|s<<3),++e;return[a,e,i]}(0,i,r,e);return r=a[1],a[0]}}(e.password))}(t,0,e,i),i}},49:{f:function vv(t,r,e){var i={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10}return i.name=Xi(t,0,e),i}},51:{f:yt},60:{},61:{f:function hv(t){return{Pos:[t.read_shift(2),t.read_shift(2)],Dim:[t.read_shift(2),t.read_shift(2)],Flags:t.read_shift(2),CurTab:t.read_shift(2),FirstTab:t.read_shift(2),Selected:t.read_shift(2),TabRatio:t.read_shift(2)}}},64:{f:gt},65:{f:function xv(){}},66:{f:yt},77:{},80:{},81:{},82:{},85:{f:yt},89:{},90:{},91:{},92:{f:function rv(t,r,e){if(e.enc)return t.l+=r,"";var i=t.l,a=qr(t,0,e);return t.read_shift(r+i-t.l),a}},93:{f:function Jv(t,r,e){if(e&&e.biff<8)return function qv(t,r,e){t.l+=4;var i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6;var s=[];return s.push((Qv[i]||Ht)(t,r-=36,e)),{cmo:[a,i,o],ft:s}}(t,r,e);var i=O0(t),a=function tv(t,r){for(var e=t.l+r,i=[];t.l<e;){var a=t.read_shift(2);t.l-=2;try{i.push(ev[a](t,e-t.l))}catch(o){return t.l=e,i}}return t.l!=e&&(t.l=e),i}(t,r-22);return{cmo:i,ft:a}}},94:{},95:{f:gt},96:{},97:{},99:{f:gt},125:{f:L0},128:{f:function Nv(t){t.l+=4;var r=[t.read_shift(2),t.read_shift(2)];if(0!==r[0]&&r[0]--,0!==r[1]&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}},129:{f:function av(t,r,e){var i=e&&8==e.biff||2==r?t.read_shift(2):(t.l+=r,0);return{fDialog:16&i,fBelow:64&i,fRight:128&i}}},130:{f:yt},131:{f:gt},132:{f:gt},133:{f:function ov(t,r,e){var i=t.read_shift(4),a=3&t.read_shift(1),o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule"}var s=Xi(t,0,e);return 0===s.length&&(s="Sheet1"),{pos:i,hs:a,dt:o,name:s}}},134:{},140:{f:function rC(t){var e,r=[0,0];return e=t.read_shift(2),r[0]=qc[e]||e,e=t.read_shift(2),r[1]=qc[e]||e,r}},141:{f:yt},144:{},146:{f:function oC(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(S0(t));return e}},151:{},152:{},153:{},154:{},155:{},156:{f:yt},157:{},158:{},160:{f:pC},161:{f:function cC(t,r){var e={};return r<32||(t.l+=16,e.header=Zt(t),e.footer=Zt(t),t.l+=2),e}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function Ev(t,r){for(var e=t.l+r-2,i=t.read_shift(2),a=t.read_shift(2),o=[];t.l<e;)o.push(b0(t));if(t.l!==e)throw new Error("MulRK read error");var s=t.read_shift(2);if(o.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:i,c:a,C:s,rkrec:o}}},190:{f:function Fv(t,r){for(var e=t.l+r-2,i=t.read_shift(2),a=t.read_shift(2),o=[];t.l<e;)o.push(t.read_shift(2));if(t.l!==e)throw new Error("MulBlank read error");var s=t.read_shift(2);if(o.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:i,c:a,C:s,ixfe:o}}},193:{f:Tr},197:{},198:{},199:{},200:{},201:{},202:{f:gt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:yt},220:{},221:{f:gt},222:{},224:{f:function Av(t,r,e){var i={};return i.ifnt=t.read_shift(2),i.numFmtId=t.read_shift(2),i.flags=t.read_shift(2),i.fStyle=i.flags>>2&1,i.data=function Dv(t,r,e,i){var a={},o=t.read_shift(4),s=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return a.patternType=fx[l>>26],i.cellStyles&&(a.alc=7&o,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=15&s,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=127&l,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=127&c,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}(t,0,0,e),i}},225:{f:function nv(t,r){return 0===r||t.read_shift(2),1200}},226:{f:Tr},227:{},229:{f:function Yv(t,r){for(var e=[],i=t.read_shift(2);i--;)e.push(Ka(t));return e}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function lv(t,r){for(var e=t.l+r,i=t.read_shift(4),a=t.read_shift(4),o=[],s=0;s!=a&&t.l<e;++s)o.push(Lx(t));return o.Count=i,o.Unique=a,o}},253:{f:function yv(t){var r=Vn(t);return r.isst=t.read_shift(4),r}},255:{f:function uv(t,r){var e={};return e.dsst=t.read_shift(2),t.l+=r-2,e}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:C0},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gt},353:{f:Tr},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function Lv(t,r,e){var i=t.l+r,a=t.read_shift(2),o=t.read_shift(2);if(e.sbcch=o,1025==o||14849==o)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var s=Qr(t,o),l=[];i>t.l;)l.push(Ki(t));return[o,a,s,l]}},431:{f:gt},432:{},433:{},434:{},437:{},438:{f:function Xv(t,r,e){var i=t.l,a="";try{t.l+=4,-1==[0,5,7,11,12,14].indexOf((e.lastobj||{cmo:[0,0]}).cmo[1])?t.l+=6:function Hx(t){var r=t.read_shift(1);t.l++;var e=t.read_shift(2);t.l+=2}(t);var l=t.read_shift(2);t.read_shift(2),yt(t);var c=t.read_shift(2);t.l+=c;for(var u=1;u<t.lens.length-1;++u){if(t.l-i!=t.lens[u])throw new Error("TxO: bad continue record");var d=t[t.l];if((a+=Qr(t,t.lens[u+1]-t.lens[u]-1)).length>=(d?l:2*l))break}if(a.length!==l&&a.length!==2*l)throw new Error("cchText: "+l+" != "+a.length);return t.l=i+r,{t:a}}catch(p){return t.l=i+r,{t:a}}}},439:{f:gt},440:{f:function Kv(t,r){var e=Ka(t);t.l+=16;var i=function Gx(t,r){var e=t.l+r,i=t.read_shift(4);if(2!==i)throw new Error("Unrecognized streamVersion: "+i);var a=t.read_shift(2);t.l+=2;var o,s,l,c,d,f,u="";16&a&&(o=Xa(t)),128&a&&(s=Xa(t)),257==(257&a)&&(l=Xa(t)),1==(257&a)&&(c=function jx(t,r){var e=t.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return function Vx(t){var r=t.read_shift(4),e=t.l,i=!1;r>24&&(t.l+=r-24,"795881f43b1d7f48af2c825dc4852763"===t.read_shift(16)&&(i=!0),t.l=e);var a=t.read_shift((i?r-24:r)>>1,"utf16le").replace(Lt,"");return i&&(t.l+=24),a}(t);case"0303000000000000c000000000000046":return function Zx(t){for(var r=t.read_shift(2),e="";r-- >0;)e+="../";var i=t.read_shift(0,"lpstr-ansi");if(t.l+=2,57005!=t.read_shift(2))throw new Error("Bad FileMoniker");if(0===t.read_shift(4))return e+i.replace(/\\/g,"/");var o=t.read_shift(4);if(3!=t.read_shift(2))throw new Error("Bad FileMoniker");return e+t.read_shift(o>>1,"utf16le").replace(Lt,"")}(t);default:throw new Error("Unsupported Moniker "+e)}}(t)),8&a&&(u=Xa(t)),32&a&&(d=t.read_shift(16)),64&a&&(f=ms(t)),t.l=e;var p=s||l||c||"";p&&u&&(p+="#"+u),p||(p="#"+u),2&a&&"/"==p.charAt(0)&&"/"!=p.charAt(1)&&(p="file://"+p);var m={Target:p};return d&&(m.guid=d),f&&(m.time=f),o&&(m.Tooltip=o),m}(t,r-24);return[e,i]}},441:{},442:{f:Ki},443:{},444:{f:yt},445:{},446:{},448:{f:Tr},449:{f:function pv(t){return t.read_shift(2),t.read_shift(4)},r:2},450:{f:Tr},512:{f:F0},513:{f:fC},515:{f:function Pv(t,r,e){e.biffguess&&2==e.biff&&(e.biff=5);var i=Vn(t),a=Zt(t);return i.val=a,i}},516:{f:function Tv(t,r,e){e.biffguess&&2==e.biff&&(e.biff=5);var a=Vn(t);2==e.biff&&t.l++;var o=Ki(t,0,e);return a.val=o,a}},517:{f:A0},519:{f:hC},520:{f:function dv(t){var r={};r.r=t.read_shift(2),r.c=t.read_shift(2),r.cnt=t.read_shift(2)-r.c;var e=t.read_shift(2);t.l+=4;var i=t.read_shift(1);return t.l+=3,7&i&&(r.level=7&i),32&i&&(r.hidden=!0),64&i&&(r.hpt=e/20),r}},523:{},545:{f:B0},549:{f:E0},566:{},574:{f:function gv(t,r,e){return e&&e.biff>=2&&e.biff<5?{}:{RTL:64&t.read_shift(2)}}},638:{f:function Ov(t){var r=t.read_shift(2),e=t.read_shift(2),i=b0(t);return{r,c:e,ixfe:i[0],rknum:i[1]}}},659:{},1048:{},1054:{f:function Sv(t,r,e){return[t.read_shift(2),qr(t,0,e)]}},1084:{},1212:{f:function Zv(t,r,e){var i=I0(t);t.l++;var a=t.read_shift(1);return[rT(t,r-=8,e),a,i]}},2048:{f:function tC(t,r){t.read_shift(2);var e=Ka(t),i=t.read_shift((r-10)/2,"dbcs-cont");return[e,i=i.replace(Lt,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:eo},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Tr},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function sC(t){t.l+=2;var r={cxfs:0,crc:0};return r.cxfs=t.read_shift(2),r.crc=t.read_shift(4),r},r:12},2173:{f:function iy(t,r){t.l+=2;var i=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),o=[];a-- >0;)o.push(ry(t));return{ixfe:i,ext:o}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function Vv(t,r,e){if(!(e.biff<8)){var i=t.read_shift(2),a=t.read_shift(2);return[Qr(t,i,e),Qr(t,a,e)]}t.l+=r},r:12},2197:{},2198:{f:function X2(t,r,e){var i=t.l+r;if(124226!==t.read_shift(4)){if(!e.cellStyles)return void(t.l=i);var s,o=t.slice(t.l);t.l=i;try{s=_c(o,{type:"array"})}catch(c){return}var l=dn(s,"theme/theme/theme1.xml",!0);if(l)return eu(l,e)}},r:12},2199:{},2200:{},2201:{},2202:{f:function jv(t){return[0!==t.read_shift(4),0!==t.read_shift(4),t.read_shift(4)]},r:12},2203:{f:Tr},2204:{},2205:{},2206:{},2207:{},2211:{f:function fv(t){var r=function Yx(t){var r=t.read_shift(2),e=t.read_shift(2);return t.l+=8,{type:r,flags:e}}(t);if(2211!=r.type)throw new Error("Invalid Future Record "+r.type);return 0!==t.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:yt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function uC(t,r,e){var i={area:!1};if(5!=e.biff)return t.l+=r,i;var a=t.read_shift(1);return t.l+=3,16&a&&(i.area=!0),i}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function aC(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(S0(t));return e}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:F0},1:{},2:{f:function vC(t){var r=Vn(t);++t.l;var e=t.read_shift(2);return r.t="n",r.val=e,r}},3:{f:function _C(t){var r=Vn(t);++t.l;var e=Zt(t);return r.t="n",r.val=e,r}},4:{f:function gC(t,r,e){e.biffguess&&5==e.biff&&(e.biff=2);var i=Vn(t);++t.l;var a=qr(t,0,e);return i.t="str",i.val=a,i}},5:{f:A0},7:{f:function yC(t){var r=t.read_shift(1);return 0===r?(t.l++,""):t.read_shift(r,"sbcs-cont")}},8:{},9:{f:eo},11:{},22:{f:yt},30:{f:zv},31:{},32:{},33:{f:B0},36:{},37:{f:E0},50:{f:function wC(t,r){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=r-13}},62:{},52:{},67:{},68:{f:yt},69:{},86:{},126:{},127:{f:function mC(t){var r=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(4),a={fmt:r,env:e,len:i,data:t.slice(t.l,t.l+i)};return t.l+=i,a}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function TC(t,r,e){var i=t.l+r,a=Vn(t),o=t.read_shift(2),s=Qr(t,o,e);return t.l=i,a.t="str",a.val=s,a}},223:{},234:{},354:{},421:{},518:{f:Is},521:{f:eo},536:{f:R0},547:{f:M0},561:{},579:{},1030:{f:Is},1033:{f:eo},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ue(t,r,e,i){var a=r;if(!isNaN(a)){var o=i||(e||[]).length||0,s=t.next(4);s.write_shift(2,a),s.write_shift(2,o),o>0&&Xo(e)&&t.push(e)}}function pa(t,r,e){return t||(t=Q(7)),t.write_shift(2,r),t.write_shift(2,e),t.write_shift(2,0),t.write_shift(1,0),t}function bb(t,r,e,i){if(null!=r.v)switch(r.t){case"d":case"n":var a="d"==r.t?kt(it(r.v)):r.v;return void(a==(0|a)&&a>=0&&a<65536?ue(t,2,function CC(t,r,e){var i=Q(9);return pa(i,t,r),i.write_shift(2,e),i}(e,i,a)):ue(t,3,function xC(t,r,e){var i=Q(15);return pa(i,t,r),i.write_shift(8,e,"f"),i}(e,i,a)));case"b":case"e":return void ue(t,5,function kb(t,r,e,i){var a=Q(9);return pa(a,t,r),y0(e,i||"b",a),a}(e,i,r.v,r.t));case"s":case"str":return void ue(t,4,function Sb(t,r,e){var i=Q(8+2*e.length);return pa(i,t,r),i.write_shift(1,e.length),i.write_shift(e.length,e,"sbcs"),i.l<i.length?i.slice(0,i.l):i}(e,i,(r.v||"").slice(0,255)))}ue(t,1,pa(null,e,i))}function Mb(t,r,e,i,a){var o=16+br(a.cellXfs,r,a);if(null!=r.v||r.bf)if(r.bf)ue(t,6,function oT(t,r,e,i,a){var o=Xr(r,e,a),s=function aT(t){if(null==t){var r=Q(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}return Yr("number"==typeof t?t:0)}(t.v),l=Q(6);l.write_shift(2,33),l.write_shift(4,0);for(var u=Q(t.bf.length),d=0;d<t.bf.length;++d)u[d]=t.bf[d];return Ot([o,s,l,u])}(r,e,i,0,o));else switch(r.t){case"d":case"n":ue(t,515,function Bv(t,r,e,i){var a=Q(14);return Xr(t,r,i,a),Yr(e,a),a}(e,i,"d"==r.t?kt(it(r.v)):r.v,o));break;case"b":case"e":ue(t,517,function Rv(t,r,e,i,a,o){var s=Q(8);return Xr(t,r,i,s),y0(e,o,s),s}(e,i,r.v,o,0,r.t));break;case"s":case"str":a.bookSST?ue(t,253,function wv(t,r,e,i){var a=Q(10);return Xr(t,r,i,a),a.write_shift(4,e),a}(e,i,Es(a.Strings,r.v,a.revStrings),o)):ue(t,516,function kv(t,r,e,i,a){var o=!a||8==a.biff,s=Q(+o+8+(1+o)*e.length);return Xr(t,r,i,s),s.write_shift(2,e.length),o&&s.write_shift(1,1),s.write_shift((1+o)*e.length,e,o?"utf16le":"sbcs"),s}(e,i,(r.v||"").slice(0,255),o,a));break;default:ue(t,513,Xr(e,i,o))}else ue(t,513,Xr(e,i,o))}function Rb(t,r,e){var d,i=Qt(),a=e.SheetNames[t],o=e.Sheets[a]||{},s=(e||{}).Workbook||{},l=(s.Sheets||[])[t]||{},c=Array.isArray(o),u=8==r.biff,f="",p=[],m=Ve(o["!ref"]||"A1"),x=u?65536:16384;if(m.e.c>255||m.e.r>=x){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,x-1)}ue(i,2057,_s(0,16,r)),ue(i,13,kn(1)),ue(i,12,kn(100)),ue(i,15,Xt(!0)),ue(i,17,Xt(!1)),ue(i,16,Yr(.001)),ue(i,95,Xt(!0)),ue(i,42,Xt(!1)),ue(i,43,Xt(!1)),ue(i,130,kn(1)),ue(i,128,function Mv(t){var r=Q(8);return r.write_shift(4,0),r.write_shift(2,t[0]?t[0]+1:0),r.write_shift(2,t[1]?t[1]+1:0),r}([0,0])),ue(i,131,Xt(!1)),ue(i,132,Xt(!1)),u&&function Nb(t,r){if(r){var e=0;r.forEach(function(i,a){++e<=256&&i&&ue(t,125,function lC(t,r){var e=Q(12);e.write_shift(2,r),e.write_shift(2,r),e.write_shift(2,256*t.width),e.write_shift(2,0);var i=0;return t.hidden&&(i|=1),e.write_shift(1,i),e.write_shift(1,i=t.level||0),e.write_shift(2,0),e}(so(a,i),a))})}}(i,o["!cols"]),ue(i,512,function Iv(t,r){var e=8!=r.biff&&r.biff?2:4,i=Q(2*e+6);return i.write_shift(e,t.s.r),i.write_shift(e,t.e.r+1),i.write_shift(2,t.s.c),i.write_shift(2,t.e.c+1),i.write_shift(2,0),i}(m,r)),u&&(o["!links"]=[]);for(var h=m.s.r;h<=m.e.r;++h){f=ht(h);for(var v=m.s.c;v<=m.e.c;++v){h===m.s.r&&(p[v]=ot(v)),d=p[v]+f;var T=c?(o[h]||[])[v]:o[d];!T||(Mb(i,T,h,v,r),u&&T.l&&o["!links"].push([d,T.l]))}}var S=l.CodeName||l.name||a;return u&&ue(i,574,function _v(t){var r=Q(18),e=1718;return t&&t.RTL&&(e|=64),r.write_shift(2,e),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}((s.Views||[])[0])),u&&(o["!merges"]||[]).length&&ue(i,229,function $v(t){var r=Q(2+8*t.length);r.write_shift(2,t.length);for(var e=0;e<t.length;++e)z0(t[e],r);return r}(o["!merges"])),u&&function Ab(t,r){for(var e=0;e<r["!links"].length;++e){var i=r["!links"][e];ue(t,440,eC(i)),i[1].Tooltip&&ue(t,2048,nC(i))}delete r["!links"]}(i,o),ue(i,442,w0(S)),u&&function Fb(t,r){var e=Q(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),ue(t,2151,e),(e=Q(39)).write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),z0(Ve(r["!ref"]||"A1"),e),e.write_shift(4,4),ue(t,2152,e)}(i,o),ue(i,10),i.end()}function Pb(t,r,e){var i=Qt(),a=(t||{}).Workbook||{},o=a.Sheets||[],s=a.WBProps||{},l=8==e.biff,c=5==e.biff;ue(i,2057,_s(0,5,e)),"xla"==e.bookType&&ue(i,135),ue(i,225,l?kn(1200):null),ue(i,193,function Rx(t,r){r||(r=Q(t));for(var e=0;e<t;++e)r.write_shift(1,0);return r}(2)),c&&ue(i,191),c&&ue(i,192),ue(i,226),ue(i,92,function iv(t,r){var e=!r||8==r.biff,i=Q(e?112:54);for(i.write_shift(8==r.biff?2:1,7),e&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(e?0:536870912));i.l<i.length;)i.write_shift(1,e?0:32);return i}(0,e)),ue(i,66,kn(l?1200:1252)),l&&ue(i,353,kn(0)),l&&ue(i,448),ue(i,317,function dC(t){for(var r=Q(2*t),e=0;e<t;++e)r.write_shift(2,e+1);return r}(t.SheetNames.length)),l&&t.vbaraw&&ue(i,211),l&&t.vbaraw&&ue(i,442,w0(s.CodeName||"ThisWorkbook")),ue(i,156,kn(17)),ue(i,25,Xt(!1)),ue(i,18,Xt(!1)),ue(i,19,kn(0)),l&&ue(i,431,Xt(!1)),l&&ue(i,444,kn(0)),ue(i,61,function mv(){var t=Q(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}()),ue(i,64,Xt(!1)),ue(i,141,kn(0)),ue(i,34,Xt("true"==function gS(t){return t.Workbook&&t.Workbook.WBProps&&at(t.Workbook.WBProps.date1904)?"true":"false"}(t))),ue(i,14,Xt(!0)),l&&ue(i,439,Xt(!1)),ue(i,218,kn(0)),function Ob(t,r,e){ue(t,49,function Cv(t,r){var e=t.name||"Arial",i=r&&5==r.biff,o=Q(i?15+e.length:16+2*e.length);return o.write_shift(2,20*(t.sz||12)),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,e.length),i||o.write_shift(1,1),o.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le"),o}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},e))}(i,0,e),function Eb(t,r,e){!r||[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var a=i[0];a<=i[1];++a)null!=r[a]&&ue(t,1054,bv(a,r[a],e))})}(i,t.SSF,e),function Db(t,r){for(var e=0;e<16;++e)ue(t,224,D0({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(i){ue(t,224,D0(i,0,r))})}(i,e),l&&ue(i,352,Xt(!1));var d=i.end(),f=Qt();l&&ue(f,140,function iC(t){return t||(t=Q(4)),t.write_shift(2,1),t.write_shift(2,1),t}()),l&&e.Strings&&function Tb(t,r,e,i){var a=i||(e||[]).length||0;if(a<=8224)return ue(t,r,e,a);var o=r;if(!isNaN(o)){for(var s=e.parts||[],l=0,c=0,u=0;u+(s[l]||8224)<=8224;)u+=s[l]||8224,l++;var d=t.next(4);for(d.write_shift(2,o),d.write_shift(2,u),t.push(e.slice(c,c+u)),c+=u;c<a;){for((d=t.next(4)).write_shift(2,60),u=0;u+(s[l]||8224)<=8224;)u+=s[l]||8224,l++;d.write_shift(2,u),t.push(e.slice(c,c+u)),c+=u}}}(f,252,function cv(t,r){var e=Q(8);e.write_shift(4,t.Count),e.write_shift(4,t.Unique);for(var i=[],a=0;a<t.length;++a)i[a]=Ux(t[a]);var o=Ot([e].concat(i));return o.parts=[e.length].concat(i.map(function(s){return s.length})),o}(e.Strings)),ue(f,10);var p=f.end(),m=Qt(),x=0,h=0;for(h=0;h<t.SheetNames.length;++h)x+=(l?12:11)+(l?2:1)*t.SheetNames[h].length;var v=d.length+x+p.length;for(h=0;h<t.SheetNames.length;++h)ue(m,133,sv({pos:v,hs:(o[h]||{}).Hidden||0,dt:0,name:t.SheetNames[h]},e)),v+=r[h].length;var S=m.end();if(x!=S.length)throw new Error("BS8 "+x+" != "+S.length);var y=[];return d.length&&y.push(d),S.length&&y.push(S),p.length&&y.push(p),Ot(y)}function Nu(t,r){for(var e=0;e<=t.SheetNames.length;++e){var i=t.Sheets[t.SheetNames[e]];i&&i["!ref"]&&qt(i["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+t.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}var o=r||{};switch(o.biff||2){case 8:case 5:return function Bb(t,r){var e=r||{},i=[];t&&!t.SSF&&(t.SSF=tt(Se)),t&&t.SSF&&(fi(),Hi(t.SSF),e.revssf=La(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Vs(e),e.cellXfs=[],br(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)i[i.length]=Rb(a,e,t);return i.unshift(Pb(t,i,e)),Ot(i)}(t,r);case 4:case 3:case 2:return function Ib(t,r){for(var e=r||{},i=Qt(),a=0,o=0;o<t.SheetNames.length;++o)t.SheetNames[o]==e.sheet&&(a=o);if(0==a&&e.sheet&&t.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return ue(i,4==e.biff?1033:3==e.biff?521:9,_s(0,16,e)),function zb(t,r,e,i){var s,a=Array.isArray(r),o=Ve(r["!ref"]||"A1"),l="",c=[];if(o.e.c>255||o.e.r>16383){if(i.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),s=De(o)}for(var u=o.s.r;u<=o.e.r;++u){l=ht(u);for(var d=o.s.c;d<=o.e.c;++d){u===o.s.r&&(c[d]=ot(d)),s=c[d]+l;var f=a?(r[u]||[])[d]:r[s];!f||bb(t,f,u,d)}}}(i,t.Sheets[t.SheetNames[a]],0,e),ue(i,10),i.end()}(t,r)}throw new Error("invalid type "+o.bookType+" for BIFF")}function Mu(t,r){var e=r||{},i=e.dense?[]:{},a=(t=t.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),s=a.index,l=o&&o.index||t.length,c=y1(t.slice(s,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,p=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(s=0;s<c.length;++s){var h=c[s].trim(),v=h.slice(0,3).toLowerCase();if("<tr"!=v){if("<td"==v||"<th"==v){var T=h.split(/<\/t[dh]>/i);for(l=0;l<T.length;++l){var S=T[l].trim();if(S.match(/<t[dh]/i)){for(var y=S,P=0;"<"==y.charAt(0)&&(P=y.indexOf(">"))>-1;)y=y.slice(P+1);for(var U=0;U<x.length;++U){var M=x[U];M.s.c==d&&M.s.r<u&&u<=M.e.r&&(d=M.e.c+1,U=-1)}var I=Ie(S.slice(0,S.indexOf(">")));p=I.colspan?+I.colspan:1,((f=+I.rowspan)>1||p>1)&&x.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+p-1}});var B=I.t||I["data-t"]||"";if(!y.length){d+=p;continue}if(y=Sc(y),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!y.length){d+=p;continue}var R={t:"s",v:y};e.raw||!y.trim().length||"s"==B||("TRUE"===y?R={t:"b",v:!0}:"FALSE"===y?R={t:"b",v:!1}:isNaN(Dn(y))?isNaN(pi(y).getDate())||(R={t:"d",v:it(y)},e.cellDates||(R={t:"n",v:kt(R.v)}),R.z=e.dateNF||Se[14]):R={t:"n",v:Dn(y)}),e.dense?(i[u]||(i[u]=[]),i[u][d]=R):i[ze({r:u,c:d})]=R,d+=p}}}}else{if(++u,e.sheetRows&&e.sheetRows<=u){--u;break}d=0}}return i["!ref"]=De(m),x.length&&(i["!merges"]=x),i}function Ru(t,r,e,i){for(var a=t["!merges"]||[],o=[],s=r.s.c;s<=r.e.c;++s){for(var l=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>e||a[u].s.c>s||a[u].e.r<e||a[u].e.c<s)){if(a[u].s.r<e||a[u].s.c<s){l=-1;break}l=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(l<0)){var d=ze({r:e,c:s}),f=i.dense?(t[e]||[])[s]:t[d],p=f&&null!=f.v&&(f.h||Zo(f.w||(Hn(f),f.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),i.editable?p='<span contenteditable="true">'+p+"</span>":f&&(m["data-t"]=f&&f.t||"z",null!=f.v&&(m["data-v"]=f.v),null!=f.z&&(m["data-z"]=f.z),f.l&&"#"!=(f.l.Target||"#").charAt(0)&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),m.id=(i.id||"sjs")+"-"+d,o.push(se("td",p,m))}}return"<tr>"+o.join("")+"</tr>"}function Uu(t,r){var e=r||{},a=null!=e.footer?e.footer:"</body></html>",o=[null!=e.header?e.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>'],s=qt(t["!ref"]);e.dense=Array.isArray(t),o.push(function Lu(t,r,e){return[].join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}(0,0,e));for(var l=s.s.r;l<=s.e.r;++l)o.push(Ru(t,s,l,e));return o.push("</table>"+a),o.join("")}function Hu(t,r,e){var i=e||{},a=0,o=0;if(null!=i.origin)if("number"==typeof i.origin)a=i.origin;else{var s="string"==typeof i.origin?lt(i.origin):i.origin;a=s.r,o=s.c}var l=r.getElementsByTagName("tr"),c=Math.min(i.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:a,c:o}};if(t["!ref"]){var d=qt(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),-1==a&&(u.e.r=a=d.e.r+1)}var f=[],p=0,m=t["!rows"]||(t["!rows"]=[]),x=0,h=0,v=0,T=0,S=0,y=0;for(t["!cols"]||(t["!cols"]=[]);x<l.length&&h<c;++x){var P=l[x];if(Zu(P)){if(i.display)continue;m[h]={hidden:!0}}var U=P.children;for(v=T=0;v<U.length;++v){var M=U[v];if(!i.display||!Zu(M)){var I=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):Sc(M.innerHTML),B=M.getAttribute("data-z")||M.getAttribute("z");for(p=0;p<f.length;++p){var R=f[p];R.s.c==T+o&&R.s.r<h+a&&h+a<=R.e.r&&(T=R.e.c+1-o,p=-1)}y=+M.getAttribute("colspan")||1,((S=+M.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:h+a,c:T+o},e:{r:h+a+(S||1)-1,c:T+o+(y||1)-1}});var W={t:"s",v:I},J=M.getAttribute("data-t")||M.getAttribute("t")||"";null!=I&&(0==I.length?W.t=J||"z":i.raw||0==I.trim().length||"s"==J||("TRUE"===I?W={t:"b",v:!0}:"FALSE"===I?W={t:"b",v:!1}:isNaN(Dn(I))?isNaN(pi(I).getDate())||(W={t:"d",v:it(I)},i.cellDates||(W={t:"n",v:kt(W.v)}),W.z=i.dateNF||Se[14]):W={t:"n",v:Dn(I)})),void 0===W.z&&null!=B&&(W.z=B);var L="",le=M.getElementsByTagName("A");if(le&&le.length)for(var xe=0;xe<le.length&&(!le[xe].hasAttribute("href")||"#"==(L=le[xe].getAttribute("href")).charAt(0));++xe);L&&"#"!=L.charAt(0)&&(W.l={Target:L}),i.dense?(t[h+a]||(t[h+a]=[]),t[h+a][T+o]=W):t[ze({c:T+o,r:h+a})]=W,u.e.c<T+o&&(u.e.c=T+o),T+=y}}++h}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,h-1+a),t["!ref"]=De(u),h>=c&&(t["!fullref"]=De((u.e.r=l.length-x+h-1+a,u))),t}function Vu(t,r){return Hu((r||{}).dense?[]:{},t,r)}function Zu(t){var r="",e=function Hb(t){return t.ownerDocument.defaultView&&"function"==typeof t.ownerDocument.defaultView.getComputedStyle?t.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),"none"===r}function Vb(t){var r=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(i,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[Ge(r.replace(/<[^>]*>/g,""))]}var ju={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Gu(t,r){var o,s,d,f,h,v,e=r||{},i=Wo(t),a=[],l={name:""},c="",u=0,p={},m=[],x=e.dense?[]:{},T={value:""},S="",y=0,U=[],M=-1,I=-1,B={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,W={},J=[],L={},le=0,xe=0,ce=[],Te=1,Ce=1,Be=[],me={Names:[]},we={},ee=["",""],F=[],Z={},N="",A=0,X=!1,pe=!1,ie=0;for(Wi.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");h=Wi.exec(i);)switch(h[3]=h[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===h[1]?(x["!ref"]=B.e.c>=B.s.c&&B.e.r>=B.s.r?De(B):"A1:A1",e.sheetRows>0&&e.sheetRows<=B.e.r&&(x["!fullref"]=x["!ref"],B.e.r=e.sheetRows-1,x["!ref"]=De(B)),J.length&&(x["!merges"]=J),ce.length&&(x["!rows"]=ce),d.name=d.\u540d\u79f0||d.name,"undefined"!=typeof JSON&&JSON.stringify(d),m.push(d.name),p[d.name]=x,pe=!1):"/"!==h[0].charAt(h[0].length-2)&&(d=Ie(h[0],!1),M=I=-1,B.s.r=B.s.c=1e7,B.e.r=B.e.c=0,x=e.dense?[]:{},J=[],ce=[],pe=!0);break;case"table-row-group":"/"===h[1]?--R:++R;break;case"table-row":case"\u884c":if("/"===h[1]){M+=Te,Te=1;break}if((f=Ie(h[0],!1)).\u884c\u53f7?M=f.\u884c\u53f7-1:-1==M&&(M=0),(Te=+f["number-rows-repeated"]||1)<10)for(ie=0;ie<Te;++ie)R>0&&(ce[M+ie]={level:R});I=-1;break;case"covered-table-cell":"/"!==h[1]&&++I,e.sheetStubs&&(e.dense?(x[M]||(x[M]=[]),x[M][I]={t:"z"}):x[ze({r:M,c:I})]={t:"z"}),S="",U=[];break;case"table-cell":case"\u6570\u636e":if("/"===h[0].charAt(h[0].length-2))++I,T=Ie(h[0],!1),Ce=parseInt(T["number-columns-repeated"]||"1",10),v={t:"z",v:null},T.formula&&0!=e.cellFormula&&(v.f=xu(Ge(T.formula))),"string"==(T.\u6570\u636e\u7c7b\u578b||T["value-type"])&&(v.t="s",v.v=Ge(T["string-value"]||""),e.dense?(x[M]||(x[M]=[]),x[M][I]=v):x[ze({r:M,c:I})]=v),I+=Ce-1;else if("/"!==h[1]){S="",y=0,U=[],Ce=1;var ae=Te?M+Te-1:M;if(++I>B.e.c&&(B.e.c=I),I<B.s.c&&(B.s.c=I),M<B.s.r&&(B.s.r=M),ae>B.e.r&&(B.e.r=ae),F=[],Z={},v={t:(T=Ie(h[0],!1)).\u6570\u636e\u7c7b\u578b||T["value-type"],v:null},e.cellFormula)if(T.formula&&(T.formula=Ge(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(le=parseInt(T["number-matrix-rows-spanned"],10)||0,xe=parseInt(T["number-matrix-columns-spanned"],10)||0,v.F=De(L={s:{r:M,c:I},e:{r:M+le-1,c:I+xe-1}}),Be.push([L,v.F])),T.formula)v.f=xu(T.formula);else for(ie=0;ie<Be.length;++ie)M>=Be[ie][0].s.r&&M<=Be[ie][0].e.r&&I>=Be[ie][0].s.c&&I<=Be[ie][0].e.c&&(v.F=Be[ie][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(le=parseInt(T["number-rows-spanned"],10)||0,xe=parseInt(T["number-columns-spanned"],10)||0,J.push(L={s:{r:M,c:I},e:{r:M+le-1,c:I+xe-1}})),T["number-columns-repeated"]&&(Ce=parseInt(T["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=at(T["boolean-value"]);break;case"float":case"percentage":case"currency":v.t="n",v.v=parseFloat(T.value);break;case"date":v.t="d",v.v=it(T["date-value"]),e.cellDates||(v.t="n",v.v=kt(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=x1(T["time-value"])/86400,e.cellDates&&(v.t="d",v.v=Ha(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(T.\u6570\u636e\u6570\u503c);break;default:if("string"!==v.t&&"text"!==v.t&&v.t)throw new Error("Unsupported value type "+v.t);v.t="s",null!=T["string-value"]&&(S=Ge(T["string-value"]),U=[])}}else{if(X=!1,"s"===v.t&&(v.v=S||"",U.length&&(v.R=U),X=0==y),we.Target&&(v.l=we),F.length>0&&(v.c=F,F=[]),S&&!1!==e.cellText&&(v.w=S),X&&(v.t="z",delete v.v),(!X||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=M))for(var te=0;te<Te;++te){if(Ce=parseInt(T["number-columns-repeated"]||"1",10),e.dense)for(x[M+te]||(x[M+te]=[]),x[M+te][I]=0==te?v:tt(v);--Ce>0;)x[M+te][I+Ce]=tt(v);else for(x[ze({r:M+te,c:I})]=v;--Ce>0;)x[ze({r:M+te,c:I+Ce})]=tt(v);B.e.c<=I&&(B.e.c=I)}I+=(Ce=parseInt(T["number-columns-repeated"]||"1",10))-1,Ce=0,v={},S="",U=[]}we={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===h[1]){if((o=a.pop())[0]!==h[3])throw"Bad state: "+o}else"/"!==h[0].charAt(h[0].length-2)&&a.push([h[3],!0]);break;case"annotation":if("/"===h[1]){if((o=a.pop())[0]!==h[3])throw"Bad state: "+o;Z.t=S,U.length&&(Z.R=U),Z.a=N,F.push(Z)}else"/"!==h[0].charAt(h[0].length-2)&&a.push([h[3],!1]);N="",A=0,S="",y=0,U=[];break;case"creator":"/"===h[1]?N=i.slice(A,h.index):A=h.index+h[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===h[1]){if((o=a.pop())[0]!==h[3])throw"Bad state: "+o}else"/"!==h[0].charAt(h[0].length-2)&&a.push([h[3],!1]);S="",y=0,U=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===h[1]){if(W[l.name]=c,(o=a.pop())[0]!==h[3])throw"Bad state: "+o}else"/"!==h[0].charAt(h[0].length-2)&&(c="",l=Ie(h[0],!1),a.push([h[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Ie(h[0],!1),c+=ju[h[3]]["long"===s.style?1:0]}break;case"text":if("/>"===h[0].slice(-2))break;if("/"===h[1])switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=i.slice(u,h.index)}else u=h.index+h[0].length;break;case"named-range":ee=Os((s=Ie(h[0],!1))["cell-range-address"]);var Ne={Name:s.name,Ref:ee[0]+"!"+ee[1]};pe&&(Ne.Sheet=m.length),me.Names.push(Ne);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if("/"!==h[1]||T&&T["string-value"])Ie(h[0],!1),y=h.index+h[0].length;else{var E=Vb(i.slice(y,h.index));S=(S.length>0?S+"\n":"")+E[0]}break;case"database-range":if("/"===h[1])break;try{p[(ee=Os(Ie(h[0])["target-range-address"]))[0]]["!autofilter"]={ref:ee[1]}}catch(Ue){}break;case"a":if("/"!==h[1]){if(!(we=Ie(h[0],!1)).href)break;we.Target=Ge(we.href),delete we.href,"#"==we.Target.charAt(0)&&we.Target.indexOf(".")>-1?(ee=Os(we.Target.slice(1)),we.Target="#"+ee[0]+"!"+ee[1]):we.Target.match(/^\.\.[\\\/]/)&&(we.Target=we.Target.slice(3))}break;default:switch(h[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(e.WTF)throw new Error(h)}}var Qe={Sheets:p,SheetNames:m,Workbook:me};return e.bookSheets&&delete Qe.Sheets,Qe}function Yu(t,r){return Gu(t,r)}var Zb=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Gi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return pt+r}}(),$u=function(){var t=function(o){return Je(o).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r="          <table:table-cell />\n",i=function(o,s,l){var c=[];c.push('      <table:table table:name="'+Je(s.SheetNames[l])+'" table:style-name="ta1">\n');var u=0,d=0,f=qt(o["!ref"]||"A1"),p=o["!merges"]||[],m=0,x=Array.isArray(o);if(o["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(o["!cols"][d]?' table:style-name="co'+o["!cols"][d].ods+'"':"")+"></table:table-column>\n");var v=o["!rows"]||[];for(u=0;u<f.s.r;++u)c.push("        <table:table-row"+(v[u]?' table:style-name="ro'+v[u].ods+'"':"")+"></table:table-row>\n");for(;u<=f.e.r;++u){for(c.push("        <table:table-row"+(v[u]?' table:style-name="ro'+v[u].ods+'"':"")+">\n"),d=0;d<f.s.c;++d)c.push(r);for(;d<=f.e.c;++d){var T=!1,S={},y="";for(m=0;m!=p.length;++m)if(!(p[m].s.c>d||p[m].s.r>u||p[m].e.c<d||p[m].e.r<u)){(p[m].s.c!=d||p[m].s.r!=u)&&(T=!0),S["table:number-columns-spanned"]=p[m].e.c-p[m].s.c+1,S["table:number-rows-spanned"]=p[m].e.r-p[m].s.r+1;break}if(T)c.push("          <table:covered-table-cell/>\n");else{var P=ze({r:u,c:d}),U=x?(o[u]||[])[d]:o[P];if(U&&U.f&&(S["table:formula"]=Je(fT(U.f)),U.F&&U.F.slice(0,P.length)==P)){var M=qt(U.F);S["table:number-matrix-columns-spanned"]=M.e.c-M.s.c+1,S["table:number-matrix-rows-spanned"]=M.e.r-M.s.r+1}if(U){switch(U.t){case"b":y=U.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=U.v?"true":"false";break;case"n":y=U.w||String(U.v||0),S["office:value-type"]="float",S["office:value"]=U.v||0;break;case"s":case"str":y=null==U.v?"":U.v,S["office:value-type"]="string";break;case"d":y=U.w||it(U.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=it(U.v).toISOString(),S["table:style-name"]="ce1";break;default:c.push(r);continue}var I=t(y);if(U.l&&U.l.Target){var B=U.l.Target;"#"!=(B="#"==B.charAt(0)?"#"+pT(B.slice(1)):B).charAt(0)&&!B.match(/^\w+:/)&&(B="../"+B),I=se("text:a",I,{"xlink:href":B.replace(/&/g,"&amp;")})}c.push("          "+se("table:table-cell",se("text:p",I,{}),S)+"\n")}else c.push(r)}}c.push("        </table:table-row>\n")}return c.push("      </table:table>\n"),c.join("")};return function(s,l){var c=[pt],u=Gi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Gi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==l.bookType?(c.push("<office:document"+u+d+">\n"),c.push(t0().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+">\n"),function(o,s){o.push(" <office:automatic-styles>\n"),o.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),o.push('   <number:month number:style="long"/>\n'),o.push("   <number:text>/</number:text>\n"),o.push('   <number:day number:style="long"/>\n'),o.push("   <number:text>/</number:text>\n"),o.push("   <number:year/>\n"),o.push("  </number:date-style>\n");var l=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"])for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(null==f.width&&null==f.wpx&&null==f.wch)continue;kr(f),f.ods=l;var p=u["!cols"][d].wpx+"px";o.push('  <style:style style:name="co'+l+'" style:family="table-column">\n'),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+'"/>\n'),o.push("  </style:style>\n"),++l}});var c=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"])for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";o.push('  <style:style style:name="ro'+c+'" style:family="table-row">\n'),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+'"/>\n'),o.push("  </style:style>\n"),++c}}),o.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),o.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),o.push("  </style:style>\n"),o.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),o.push(" </office:automatic-styles>\n")}(c,s),c.push("  <office:body>\n"),c.push("    <office:spreadsheet>\n");for(var f=0;f!=s.SheetNames.length;++f)c.push(i(s.Sheets[s.SheetNames[f]],s,f));return c.push("    </office:spreadsheet>\n"),c.push("  </office:body>\n"),c.push("fods"==l.bookType?"</office:document>":"</office:document-content>"),c.join("")}}();function Ju(t,r){if("fods"==r.bookType)return $u(t,r);var e=Uo(),i="",a=[],o=[];return Me(e,i="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Me(e,i="content.xml",$u(t,r)),a.push([i,"text/xml"]),o.push([i,"ContentFile"]),Me(e,i="styles.xml",Zb(t,r)),a.push([i,"text/xml"]),o.push([i,"StylesFile"]),Me(e,i="meta.xml",pt+t0()),a.push([i,"text/xml"]),o.push([i,"MetadataFile"]),Me(e,i="manifest.rdf",function Cx(t){var r=[pt];r.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var e=0;e!=t.length;++e)r.push(e0(t[e][0],t[e][1])),r.push(vx("",t[e][0]));return r.push(e0("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}(o)),a.push([i,"application/rdf+xml"]),Me(e,i="META-INF/manifest.xml",function xx(t){var r=[pt];r.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),r.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var e=0;e<t.length;++e)r.push('  <manifest:file-entry manifest:full-path="'+t[e][0]+'" manifest:media-type="'+t[e][1]+'"/>\n');return r.push("</manifest:manifest>"),r.join("")}(a)),e}function ti(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Rs(t){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(t):Xe(_r(t))}function jb(t){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(t):cn(Un(t))}function zr(t){var r=t.reduce(function(a,o){return a+o.length},0),e=new Uint8Array(r),i=0;return t.forEach(function(a){e.set(a,i),i+=a.length}),e}function Qu(t){return 16843009*((t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135)>>>24}function ha(t,r){var e=r?r[0]:0,i=127&t[e];e:if(t[e++]>=128&&(i|=(127&t[e])<<7,t[e++]<128||(i|=(127&t[e])<<14,t[e++]<128)||(i|=(127&t[e])<<21,t[e++]<128)||(i+=(127&t[e])*Math.pow(2,28),++e,t[e++]<128)||(i+=(127&t[e])*Math.pow(2,35),++e,t[e++]<128)||(i+=(127&t[e])*Math.pow(2,42),++e,t[e++]<128)))break e;return r&&(r[0]=e),i}function $e(t){var r=new Uint8Array(7);r[0]=127&t;var e=1;e:if(t>127){if(r[e-1]|=128,r[e]=t>>7&127,++e,t<=16383||(r[e-1]|=128,r[e]=t>>14&127,++e,t<=2097151)||(r[e-1]|=128,r[e]=t>>21&127,++e,t<=268435455)||(r[e-1]|=128,r[e]=t/256>>>21&127,++e,t<=34359738367)||(r[e-1]|=128,r[e]=t/65536>>>21&127,++e,t<=4398046511103))break e;r[e-1]|=128,r[e]=t/16777216>>>21&127,++e}return r.slice(0,e)}function mt(t){var r=0,e=127&t[r];e:if(t[r++]>=128){if(e|=(127&t[r])<<7,t[r++]<128||(e|=(127&t[r])<<14,t[r++]<128)||(e|=(127&t[r])<<21,t[r++]<128))break e;e|=(127&t[r])<<28}return e}function We(t){for(var r=[],e=[0];e[0]<t.length;){var l,i=e[0],a=ha(t,e),o=7&a,s=0;if(0==(a=Math.floor(a/8)))break;switch(o){case 0:for(var c=e[0];t[e[0]++]>=128;);l=t.slice(c,e[0]);break;case 5:l=t.slice(e[0],e[0]+(s=4)),e[0]+=s;break;case 1:l=t.slice(e[0],e[0]+(s=8)),e[0]+=s;break;case 2:s=ha(t,e),l=t.slice(e[0],e[0]+s),e[0]+=s;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(i))}var u={data:l,type:o};null==r[a]?r[a]=[u]:r[a].push(u)}return r}function At(t){var r=[];return t.forEach(function(e,i){e.forEach(function(a){!a.data||(r.push($e(8*i+a.type)),2==a.type&&r.push($e(a.data.length)),r.push(a.data))})}),zr(r)}function Ps(t,r){return(null==t?void 0:t.map(function(e){return r(e.data)}))||[]}function Sn(t){for(var r,e=[],i=[0];i[0]<t.length;){var a=ha(t,i),o=We(t.slice(i[0],i[0]+a));i[0]+=a;var s={id:mt(o[1][0].data),messages:[]};o[2].forEach(function(l){var c=We(l.data),u=mt(c[3][0].data);s.messages.push({meta:c,data:t.slice(i[0],i[0]+u)}),i[0]+=u}),(null==(r=o[3])?void 0:r[0])&&(s.merge=mt(o[3][0].data)>>>0>0),e.push(s)}return e}function ki(t){var r=[];return t.forEach(function(e){var i=[];i[1]=[{data:$e(e.id),type:0}],i[2]=[],null!=e.merge&&(i[3]=[{data:$e(+!!e.merge),type:0}]);var a=[];e.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:$e(s.data.length)}],i[2].push({data:At(s.meta),type:2})});var o=At(i);r.push($e(o.length)),r.push(o),a.forEach(function(s){return r.push(s)})}),zr(r)}function $b(t,r){if(0!=t)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],i=ha(r,e),a=[];e[0]<r.length;){var o=3&r[e[0]];if(0!=o){var c=0,u=0;if(1==o?(u=4+(r[e[0]]>>2&7),c=(224&r[e[0]++])<<3,c|=r[e[0]++]):(u=1+(r[e[0]++]>>2),2==o?(c=r[e[0]]|r[e[0]+1]<<8,e[0]+=2):(c=(r[e[0]]|r[e[0]+1]<<8|r[e[0]+2]<<16|r[e[0]+3]<<24)>>>0,e[0]+=4)),a=[zr(a)],0==c)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}else{var s=r[e[0]++]>>2;if(s<60)++s;else{var l=s-59;s=r[e[0]],l>1&&(s|=r[e[0]+1]<<8),l>2&&(s|=r[e[0]+2]<<16),l>3&&(s|=r[e[0]+3]<<24),s>>>=0,s++,e[0]+=l}a.push(r.slice(e[0],e[0]+s)),e[0]+=s}}var d=zr(a);if(d.length!=i)throw new Error("Unexpected length: ".concat(d.length," != ").concat(i));return d}function bn(t){for(var r=[],e=0;e<t.length;){var i=t[e++],a=t[e]|t[e+1]<<8|t[e+2]<<16;r.push($b(i,t.slice(e+=3,e+a))),e+=a}if(e!==t.length)throw new Error("data is not a valid framed stream!");return zr(r)}function Si(t){for(var r=[],e=0;e<t.length;){var i=Math.min(t.length-e,268435455),a=new Uint8Array(4);r.push(a);var o=$e(i),s=o.length;r.push(o),i<=60?(s++,r.push(new Uint8Array([i-1<<2]))):i<=256?(s+=2,r.push(new Uint8Array([240,i-1&255]))):i<=65536?(s+=3,r.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(s+=4,r.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(s+=5,r.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),r.push(t.slice(e,e+i)),s+=i,a[0]=0,a[1]=255&s,a[2]=s>>8&255,a[3]=s>>16&255,e+=i}return zr(r)}function Bs(t,r){var e=new Uint8Array(32),i=ti(e),a=12,o=0;switch(e[0]=5,t.t){case"n":e[1]=2,function Yb(t,r,e){var i=Math.floor(0==e?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,a=e/Math.pow(10,i-6176);t[r+15]|=i>>7,t[r+14]|=(127&i)<<1;for(var o=0;a>=1;++o,a/=256)t[r+o]=255&a;t[r+15]|=e>=0?0:128}(e,a,t.v),o|=1,a+=16;break;case"b":e[1]=6,i.setFloat64(a,t.v?1:0,!0),o|=2,a+=8;break;case"s":if(-1==r.indexOf(t.v))throw new Error("Value ".concat(t.v," missing from SST!"));e[1]=3,i.setUint32(a,r.indexOf(t.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return i.setUint32(8,o,!0),e.slice(0,a)}function Ls(t,r){var e=new Uint8Array(32),i=ti(e),a=12,o=0;switch(e[0]=3,t.t){case"n":e[2]=2,i.setFloat64(a,t.v,!0),o|=32,a+=8;break;case"b":e[2]=6,i.setFloat64(a,t.v?1:0,!0),o|=32,a+=8;break;case"s":if(-1==r.indexOf(t.v))throw new Error("Value ".concat(t.v," missing from SST!"));e[2]=3,i.setUint32(a,r.indexOf(t.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return i.setUint32(4,o,!0),e.slice(0,a)}function qb(t,r,e){switch(t[0]){case 0:case 1:case 2:case 3:return function Jb(t,r,e,i){var f,a=ti(t),o=a.getUint32(4,!0),s=(i>1?12:8)+4*Qu(o&(i>1?3470:398)),l=-1,c=-1,u=NaN,d=new Date(2001,0,1);switch(512&o&&(l=a.getUint32(s,!0),s+=4),s+=4*Qu(o&(i>1?12288:4096)),16&o&&(c=a.getUint32(s,!0),s+=4),32&o&&(u=a.getFloat64(s,!0),s+=8),64&o&&(d.setTime(d.getTime()+1e3*a.getFloat64(s,!0)),s+=8),t[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:r[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:e[l]};else if(c>-1)f={t:"s",v:r[c]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(t.slice(0,4)));f={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}(t,r,e,t[0]);case 5:return function Qb(t,r,e){var f,i=ti(t),a=i.getUint32(8,!0),o=12,s=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);switch(1&a&&(c=function Wb(t,r){for(var e=(127&t[r+15])<<7|t[r+14]>>1,i=1&t[r+14],a=r+13;a>=r;--a)i=256*i+t[a];return(128&t[r+15]?-i:i)*Math.pow(10,e-6176)}(t,o),o+=16),2&a&&(u=i.getFloat64(o,!0),o+=8),4&a&&(d.setTime(d.getTime()+1e3*i.getFloat64(o,!0)),o+=8),8&a&&(l=i.getUint32(o,!0),o+=4),16&a&&(s=i.getUint32(o,!0),o+=4),t[1]){case 0:break;case 2:case 10:f={t:"n",v:c};break;case 3:f={t:"s",v:r[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(!(s>-1))throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(31&a," : ").concat(t.slice(0,4)));f={t:"s",v:e[s]};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(31&a," : ").concat(t.slice(0,4)))}return f}(t,r,e);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Yt(t){return ha(We(t)[1][0].data)}function qu(t,r){var e=We(r.data),i=mt(e[1][0].data),o=[];return(e[3]||[]).forEach(function(s){var l=We(s.data),c=mt(l[1][0].data)>>>0;switch(i){case 1:o[c]=Rs(l[3][0].data);break;case 8:var d=We(t[Yt(l[9][0].data)][0].data),f=t[Yt(d[1][0].data)][0],p=mt(f.meta[1][0].data);if(2001!=p)throw new Error("2000 unexpected reference to ".concat(p));var m=We(f.data);o[c]=m[3].map(function(x){return Rs(x.data)}).join("")}}),o}function tz(t,r){var i={"!ref":"A1"},a=t[Yt(We(r.data)[2][0].data)],o=mt(a[0].meta[1][0].data);if(6001!=o)throw new Error("6000 unexpected reference to ".concat(o));return function ez(t,r,e){var i,a=We(r.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(mt(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(mt(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));e["!ref"]=De(o);var s=We(a[4][0].data),l=qu(t,t[Yt(s[4][0].data)][0]),c=(null==(i=s[17])?void 0:i[0])?qu(t,t[Yt(s[17][0].data)][0]):[],u=We(s[3][0].data),d=0;u[1].forEach(function(f){var p=We(f.data),m=t[Yt(p[2][0].data)][0],x=mt(m.meta[1][0].data);if(6002!=x)throw new Error("6001 unexpected reference to ".concat(x));var h=function Kb(t,r){var e,i=We(r.data),a=(null==(e=null==i?void 0:i[7])?void 0:e[0])?mt(i[7][0].data)>>>0>0?1:0:-1,o=Ps(i[5],function(s){return function Xb(t,r){var e,i,a,o,s,l,c,u,d,f,p,m,x,h,P,U,v=We(t),T=mt(v[1][0].data)>>>0,S=mt(v[2][0].data)>>>0,y=(null==(i=null==(e=v[8])?void 0:e[0])?void 0:i.data)&&mt(v[8][0].data)>0||!1;if((null==(o=null==(a=v[7])?void 0:a[0])?void 0:o.data)&&0!=r)P=null==(l=null==(s=v[7])?void 0:s[0])?void 0:l.data,U=null==(u=null==(c=v[6])?void 0:c[0])?void 0:u.data;else{if(!(null==(f=null==(d=v[4])?void 0:d[0])?void 0:f.data)||1==r)throw"NUMBERS Tile missing ".concat(r," cell storage");P=null==(m=null==(p=v[4])?void 0:p[0])?void 0:m.data,U=null==(h=null==(x=v[3])?void 0:x[0])?void 0:h.data}for(var M=y?4:1,I=ti(P),B=[],R=0;R<P.length/2;++R){var W=I.getUint16(2*R,!0);W<65535&&B.push([R,W])}if(B.length!=S)throw"Expected ".concat(S," cells, found ").concat(B.length);var J=[];for(R=0;R<B.length-1;++R)J[B[R][0]]=U.subarray(B[R][1]*M,B[R+1][1]*M);return B.length>=1&&(J[B[B.length-1][0]]=U.subarray(B[B.length-1][1]*M)),{R:T,cells:J}}(s,a)});return{nrows:mt(i[4][0].data)>>>0,data:o.reduce(function(s,l){return s[l.R]||(s[l.R]=[]),l.cells.forEach(function(c,u){if(s[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));s[l.R][u]=c}),s},[])}}(0,m);h.data.forEach(function(v,T){v.forEach(function(S,y){var P=ze({r:d+T,c:y}),U=qb(S,l,c);U&&(e[P]=U)})}),d+=h.nrows})}(t,a[0],i),i}function Us(t){var r,e,i,a,o={},s=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u,d;try{u=bn(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}try{d=Sn(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){o[f.id]=f.messages,s.push(f.id)})}}),!s.length)throw new Error("File has no messages");var l=(null==(a=null==(i=null==(e=null==(r=null==o?void 0:o[1])?void 0:r[0])?void 0:e.meta)?void 0:i[1])?void 0:a[0].data)&&1==mt(o[1][0].meta[1][0].data)&&o[1][0];if(l||s.forEach(function(c){o[c].forEach(function(u){if(1==mt(u.meta[1][0].data)>>>0){if(l)throw new Error("Document has multiple roots");l=u}})}),!l)throw new Error("Cannot find Document root");return function rz(t,r){var e={SheetNames:[],Sheets:{}};if(Ps(We(r.data)[1],Yt).forEach(function(o){t[o].forEach(function(s){if(2==mt(s.meta[1][0].data)){var c=function nz(t,r){var e,i=We(r.data),a={name:(null==(e=i[1])?void 0:e[0])?Rs(i[1][0].data):"",sheets:[]};return Ps(i[2],Yt).forEach(function(s){t[s].forEach(function(l){6e3==mt(l.meta[1][0].data)&&a.sheets.push(tz(t,l))})}),a}(t,s);c.sheets.forEach(function(u,d){Js(e,u,0==d?c.name:c.name+"_"+d,!0)})}})}),0==e.SheetNames.length)throw new Error("Empty NUMBERS file");return e}(o,l)}function iz(t,r,e){var i,a,o,s;if(!(null==(i=t[6])?void 0:i[0])||!(null==(a=t[7])?void 0:a[0]))throw"Mutation only works on post-BNC storages!";if((null==(s=null==(o=t[8])?void 0:o[0])?void 0:s.data)&&mt(t[8][0].data)>0)throw"Math only works with normal offsets";for(var c=0,u=ti(t[7][0].data),d=0,f=[],p=ti(t[4][0].data),m=0,x=[],h=0;h<r.length;++h)if(null!=r[h]){var v,T;switch(u.setUint16(2*h,d,!0),p.setUint16(2*h,m,!0),typeof r[h]){case"string":v=Bs({t:"s",v:r[h]},e),T=Ls({t:"s",v:r[h]},e);break;case"number":v=Bs({t:"n",v:r[h]},e),T=Ls({t:"n",v:r[h]},e);break;case"boolean":v=Bs({t:"b",v:r[h]},e),T=Ls({t:"b",v:r[h]},e);break;default:throw new Error("Unsupported value "+r[h])}f.push(v),d+=v.length,x.push(T),m+=T.length,++c}else u.setUint16(2*h,65535,!0),p.setUint16(2*h,65535);for(t[2][0].data=$e(c);h<t[7][0].data.length/2;++h)u.setUint16(2*h,65535,!0),p.setUint16(2*h,65535,!0);return t[6][0].data=zr(f),t[3][0].data=zr(x),c}function Xu(t){return function(e){for(var i=0;i!=t.length;++i){var a=t[i];void 0===e[a[0]]&&(e[a[0]]=a[1]),"n"===a[2]&&(e[a[0]]=Number(e[a[0]]))}}}function Hs(t){Xu([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Vs(t){Xu([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function oz(t){return Ae.WS.indexOf(t)>-1?"sheet":Ae.CS&&t==Ae.CS?"chart":Ae.DS&&t==Ae.DS?"dialog":Ae.MS&&t==Ae.MS?"macro":t&&t.length?t:"sheet"}function lz(t,r,e,i,a,o,s,l,c,u,d,f){try{o[i]=qi(dn(t,e,!0),r);var m,p=vt(t,r);switch(l){case"sheet":m=NS(p,r,a,c,o[i],u,d,f);break;case"chart":if(!(m=function MS(t,r,e,i,a,o,s,l){return".bin"===r.slice(-4)?function dS(t,r,e,i,a){if(!t)return t;i||(i={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s=[],l=!1;return er(t,function(u,d,f){switch(f){case 550:o["!rel"]=u;break;case 651:a.Sheets[e]||(a.Sheets[e]={}),u.name&&(a.Sheets[e].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(f);break;case 38:s.pop();break;default:if(d.T>0)s.push(f);else if(d.T<0)s.pop();else if(!l||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}},r),i["!id"][o["!rel"]]&&(o["!drawel"]=i["!id"][o["!rel"]]),o}(t,i,e,a,o):function lS(t,r,e,i,a){if(!t)return t;i||(i={"!id":{}});var s,o={"!type":"chart","!drawel":null,"!rel":""},l=t.match(Cu);return l&&Fs(l[0],0,a,e),(s=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=s[1]),i["!id"][o["!rel"]]&&(o["!drawel"]=i["!id"][o["!rel"]]),o}(t,0,e,a,o)}(p,r,a,c,o[i],u))||!m["!drawel"])break;var x=Zi(m["!drawel"].Target,r),h=Qi(x),v=function Cy(t,r){if(!t)return"??";var e=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][e].Target}(dn(t,x,!0),qi(dn(t,h,!0),x)),T=Zi(v,x),S=Qi(T);m=function sS(t,r,e,i,a,o){var s=o||{"!type":"chart"};if(!t)return o;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var p=function oS(t){var i,r=[],e=t.match(/^<c:numCache>/);(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(o){var s=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);!s||(r[+s[1]]=e?+s[2]:s[2])});var a=Ge((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(o){i=o.replace(/<.*?>/g,"")}),[r,a,i]}(f);d.s.r=d.s.c=0,d.e.c=l,u=ot(l),p[0].forEach(function(m,x){s[u+ht(x)]={t:"n",v:m,z:p[1]},c=x}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(s["!ref"]=De(d)),s}(dn(t,T,!0),0,0,qi(dn(t,S,!0),T),0,m);break;case"macro":m=function RS(t,r,e,i,a,o,s,l){return r.slice(-4),{"!type":"macro"}}(0,r);break;case"dialog":m=function PS(t,r,e,i,a,o,s,l){return r.slice(-4),{"!type":"dialog"}}(0,r);break;default:throw new Error("Unrecognized sheet type "+l)}s[i]=m;var y=[];o&&o[i]&&dt(o[i]).forEach(function(P){var U="";if(o[i][P].Type==Ae.CMNT){U=Zi(o[i][P].Target,r);var M=function HS(t,r,e){return".bin"===r.slice(-4)?function Ey(t,r){var e=[],i=[],a={},o=!1;return er(t,function(l,c,u){switch(u){case 632:i.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=i[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,e.push(a);break;case 3072:case 37:case 38:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!c.T&&(!o||r.WTF))throw new Error("Unexpected record 0x"+u.toString(16))}}),e}(t,e):function yy(t,r){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],i=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(""!==s&&""!==s.trim()){var l=s.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&e.push(l[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(s){if(""!==s&&""!==s.trim()){var l=s.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Ie(l[0]),u={author:c.authorId&&e[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=lt(c.ref);if(!(r.sheetRows&&r.sheetRows<=d.r)){var f=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!f&&!!f[1]&&vs(f[1])||{r:"",t:"",h:""};u.r=p.r,"<t></t>"==p.r&&(p.t=p.h=""),u.t=(p.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),r.cellHTML&&(u.h=p.h),i.push(u)}}}}),i}(t,e)}(vt(t,U,!0),U,c);if(!M||!M.length)return;ru(m,M,!1)}o[i][P].Type==Ae.TCMNT&&(U=Zi(o[i][P].Target,r),y=y.concat(function wy(t,r){var e=[],i=!1,a={},o=0;return t.replace(Ut,function(l,c){var u=Ie(l);switch(Ln(u[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":null!=a.t&&e.push(a);break;case"<text>":case"<text":o=c+l.length;break;case"</text>":a.t=t.slice(o,c).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":i=!0;break;case"</mentions>":case"</ext>":i=!1;break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),e}(vt(t,U,!0),c)))}),y&&y.length&&ru(m,y,!0,c.people||[])}catch(P){if(c.WTF)throw P}}function zn(t){return"/"==t.charAt(0)?t.slice(1):t}function cz(t,r){if(fi(),Hs(r=r||{}),yn(t,"META-INF/manifest.xml")||yn(t,"objectdata.xml"))return function Wu(t,r){r=r||{},yn(t,"META-INF/manifest.xml")&&function _x(t,r){for(var i,a,e=Wo(t);i=Wi.exec(e);)switch(i[3]){case"manifest":break;case"file-entry":if("/"==(a=Ie(i[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==a.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw i}}(vt(t,"META-INF/manifest.xml"),r);var e=dn(t,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var i=Gu(Xe(e),r);return yn(t,"meta.xml")&&(i.Props=n0(vt(t,"meta.xml"))),i}(t,r);if(yn(t,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(void 0!==Us){if(t.FileIndex)return Us(t);var e=ke.utils.cfb_new();return gc(t).forEach(function(xe){Me(e,xe,mc(t,xe))}),Us(e)}throw new Error("Unsupported NUMBERS file")}if(!yn(t,"[Content_Types].xml"))throw yn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):yn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s,l,i=gc(t),a=function mx(t){var r={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!t||!t.match)return r;var e={};if((t.match(Ut)||[]).forEach(function(i){var a=Ie(i);switch(a[0].replace(S1,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[a.Extension]=a.ContentType;break;case"<Override":void 0!==r[us[a.ContentType]]&&r[us[a.ContentType]].push(a.PartName)}}),r.xmlns!==Ct_CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=e,delete r.calcchains,r}(dn(t,"[Content_Types].xml")),o=!1;if(0===a.workbooks.length&&vt(t,l="xl/workbook.xml",!0)&&a.workbooks.push(l),0===a.workbooks.length){if(!vt(t,l="xl/workbook.bin",!0))throw new Error("Could not find workbook");a.workbooks.push(l),o=!0}"bin"==a.workbooks[0].slice(-3)&&(o=!0);var c={},u={};if(!r.bookSheets&&!r.bookProps){if(la=[],a.sst)try{la=function US(t,r,e){return".bin"===r.slice(-4)?function BC(t,r){var e=[],i=!1;return er(t,function(o,s,l){switch(l){case 159:e.Count=o[0],e.Unique=o[1];break;case 19:e.push(o);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(!i||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),e}(t,e):function MC(t,r){var e=[],i="";if(!t)return e;var a=t.match(DC);if(a){i=a[2].replace(AC,"").split(NC);for(var o=0;o!=i.length;++o){var s=vs(i[o].trim(),r);null!=s&&(e[e.length]=s)}a=Ie(a[1]),e.Count=a.count,e.Unique=a.uniqueCount}return e}(t,e)}(vt(t,zn(a.sst)),a.sst,r)}catch(xe){if(r.WTF)throw xe}r.cellStyles&&a.themes.length&&(c=function LS(t,r,e){return eu(t,e)}(dn(t,a.themes[0].replace(/^\//,""),!0)||"",0,r)),a.style&&(u=function BS(t,r,e,i){return".bin"===r.slice(-4)?function D2(t,r,e){var i={NumberFmt:[]};for(var a in Se)i.NumberFmt[a]=Se[a];i.CellXf=[],i.Fonts=[];var o=[],s=!1;return er(t,function(c,u,d){switch(d){case 44:i.NumberFmt[c[0]]=c[1],Bn(c[1],c[0]);break;case 43:i.Fonts.push(c),null!=c.color.theme&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=to(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==o[o.length-1]&&i.CellXf.push(c);break;case 35:s=!0;break;case 36:s=!1;break;case 37:o.push(d),s=!0;break;case 38:o.pop(),s=!1;break;default:if(u.T>0)o.push(d);else if(u.T<0)o.pop();else if(!s||e.WTF&&37!=o[o.length-1])throw new Error("Unexpected record 0x"+d.toString(16))}}),i}(t,e,i):C2(t,e,i)}(vt(t,zn(a.style)),a.style,c,r))}a.links.map(function(xe){try{return qi(dn(t,Qi(zn(xe))),xe),function ZS(t,r,e,i){return".bin"===e.slice(-4)?function vy(t,r,e,i){if(!t)return t;var a=i||{},o=!1;er(t,function(c,u,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!u.T&&(!o||a.WTF))throw new Error("Unexpected record 0x"+d.toString(16))}},a)}(t,0,0,i):void 0}(vt(t,zn(xe)),0,xe,r)}catch(Te){}});var d=function AS(t,r,e){return".bin"===r.slice(-4)?function zS(t,r){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],a=!1;r||(r={}),r.biff=12;var o=[],s=[[]];return s.SheetNames=[],s.XTI=[],fa[16]={n:"BrtFRTArchID$",f:SS},er(t,function(c,u,d){switch(d){case 156:s.SheetNames.push(c.name),e.Sheets.push(c);break;case 153:e.WBProps=c;break;case 39:null!=c.Sheet&&(r.SID=c.Sheet),c.Ref=Wt(c.Ptg,0,null,s,r),delete r.SID,delete c.Ptg,o.push(c);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:s[0].length?s.push([d,c]):s[0]=[d,c],s[s.length-1].XTI=[];break;case 362:0===s.length&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 35:case 37:i.push(d),a=!0;break;case 36:case 38:i.pop(),a=!1;break;default:if(!u.T&&(!a||r.WTF&&37!=i[i.length-1]&&35!=i[i.length-1]))throw new Error("Unexpected record 0x"+d.toString(16))}},r),bu(e),e.Names=o,e.supbooks=s,e}(t,e):function CS(t,r){if(!t)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,a="xmlns",o={},s=0;if(t.replace(Ut,function(c,u){var d=Ie(c);switch(Ln(d[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":c.match(vS)&&(a="xmlns"+c.match(/<(\w+):/)[1]),e.xmlns=d[a];break;case"<fileVersion":delete d[0],e.AppVersion=d;break;case"<workbookPr":case"<workbookPr/>":Ds.forEach(function(f){if(null!=d[f[0]])switch(f[2]){case"bool":e.WBProps[f[0]]=at(d[f[0]]);break;case"int":e.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:e.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(e.WBProps.CodeName=Xe(d.codeName));break;case"<workbookView":case"<workbookView/>":delete d[0],e.WBView.push(d);break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Ge(Xe(d.name)),delete d[0],e.Sheets.push(d);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":i=!1;break;case"<definedName":(o={}).Name=Xe(d.name),d.comment&&(o.Comment=d.comment),d.localSheetId&&(o.Sheet=+d.localSheetId),at(d.hidden||"0")&&(o.Hidden=!0),s=u+c.length;break;case"</definedName>":o.Ref=Ge(Xe(t.slice(s,u))),e.Names.push(o);break;case"<calcPr":case"<calcPr/>":delete d[0],e.CalcPr=d;break;default:if(!i&&r.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),-1===yr.indexOf(e.xmlns))throw new Error("Unknown Namespace: "+e.xmlns);return bu(e),e}(t,e)}(vt(t,zn(a.workbooks[0])),a.workbooks[0],r),f={},p="";a.coreprops.length&&((p=vt(t,zn(a.coreprops[0]),!0))&&(f=n0(p)),0!==a.extprops.length&&(p=vt(t,zn(a.extprops[0]),!0))&&function wx(t,r,e){var i={};r||(r={}),t=Xe(t),Jr.forEach(function(a){var o=(t.match(ji(a[0]))||[])[1];switch(a[2]){case"string":o&&(r[a[1]]=Ge(o));break;case"bool":r[a[1]]="true"===o;break;case"raw":var s=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(i[a[1]]=s[1])}}),i.HeadingPairs&&i.TitlesOfParts&&o0(i.HeadingPairs,i.TitlesOfParts,r,e)}(p,f,r));var m={};(!r.bookSheets||r.bookProps)&&0!==a.custprops.length&&(p=dn(t,zn(a.custprops[0]),!0))&&(m=function kx(t,r){var e={},i="",a=t.match(Tx);if(a)for(var o=0;o!=a.length;++o){var s=a[o],l=Ie(s);switch(l[0]){case"<?xml":case"<Properties":break;case"<property":i=Ge(l.name);break;case"</property>":i=null;break;default:if(0===s.indexOf("<vt:")){var c=s.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":e[i]=Ge(d);break;case"bool":e[i]=at(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[i]=parseInt(d,10);break;case"r4":case"r8":case"decimal":e[i]=parseFloat(d);break;case"filetime":case"date":e[i]=it(d);break;default:if("/"==u.slice(-1))break;r.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",s,u,c)}}else if("</"!==s.slice(0,2)&&r.WTF)throw new Error(s)}}return e}(p,r));var x={};if((r.bookSheets||r.bookProps)&&(d.Sheets?s=d.Sheets.map(function(ce){return ce.name}):f.Worksheets&&f.SheetNames.length>0&&(s=f.SheetNames),r.bookProps&&(x.Props=f,x.Custprops=m),r.bookSheets&&void 0!==s&&(x.SheetNames=s),r.bookSheets?x.SheetNames:r.bookProps))return x;s={};var h={};r.bookDeps&&a.calcchain&&(h=function VS(t,r,e){return".bin"===r.slice(-4)?function xy(t,r,e){var i=[];return er(t,function(s,l,c){if(63===c)i.push(s);else if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}),i}(t):function gy(t){var r=[];if(!t)return r;var e=1;return(t.match(Ut)||[]).forEach(function(i){var a=Ie(i);switch(a[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?e=a.i:a.i=e,r.push(a)}}),r}(t)}(vt(t,zn(a.calcchain)),a.calcchain));var S,y,v=0,T={},P=d.Sheets;f.Worksheets=P.length,f.SheetNames=[];for(var U=0;U!=P.length;++U)f.SheetNames[U]=P[U].name;var M=o?"bin":"xml",I=a.workbooks[0].lastIndexOf("/"),B=(a.workbooks[0].slice(0,I+1)+"_rels/"+a.workbooks[0].slice(I+1)+".rels").replace(/^\//,"");yn(t,B)||(B="xl/_rels/workbook."+M+".rels");var R=qi(dn(t,B,!0),B.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=function jS(t,r,e){return".bin"===r.slice(-4)?function py(t,r,e){var i={Types:[],Cell:[],Value:[]},a=e||{},o=[],s=!1,l=2;return er(t,function(c,u,d){switch(d){case 335:i.Types.push({name:c.name});break;case 51:c.forEach(function(f){1==l?i.Cell.push({type:i.Types[f[0]-1].name,index:f[1]}):0==l&&i.Value.push({type:i.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:o.push(d),s=!0;break;case 36:o.pop(),s=!1;break;default:if(!u.T&&(!s||a.WTF&&35!=o[o.length-1]))throw new Error("Unexpected record 0x"+d.toString(16))}}),i}(t,0,e):function my(t,r,e){var i={Types:[],Cell:[],Value:[]};if(!t)return i;var s,a=!1,o=2;return t.replace(Ut,function(l){var c=Ie(l);switch(Ln(c[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":i.Types.push({name:c.name});break;case"<futureMetadata":for(var u=0;u<i.Types.length;++u)i.Types[u].name==c.name&&(s=i.Types[u]);break;case"<rc":1==o?i.Cell.push({type:i.Types[c.t-1].name,index:+c.v}):0==o&&i.Value.push({type:i.Types[c.t-1].name,index:+c.v});break;case"<cellMetadata":o=1;break;case"</cellMetadata>":case"</valueMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&e.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),i}(t,0,e)}(vt(t,zn(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=function ky(t,r){var e=[],i=!1;return t.replace(Ut,function(o){var s=Ie(o);switch(Ln(s[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":e.push({name:s.displayname,id:s.id});break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&r.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return o}),e}(vt(t,zn(a.people[0])),r)),R&&(R=function sz(t,r){if(!t)return 0;try{t=r.map(function(i){return i.id||(i.id=i.strRelID),[i.name,t["!id"][i.id].Target,oz(t["!id"][i.id].Type)]})}catch(e){return null}return t&&0!==t.length?t:null}(R,d.Sheets));var W=vt(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=f.Worksheets;++v){var J="sheet";if(R&&R[v]?(S="xl/"+R[v][1].replace(/[\/]?xl\//,""),yn(t,S)||(S=R[v][1]),yn(t,S)||(S=B.replace(/_rels\/.*$/,"")+R[v][1]),J=R[v][2]):S=(S="xl/worksheets/sheet"+(v+1-W)+"."+M).replace(/sheet0\./,"sheet."),y=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&null!=r.sheets)switch(typeof r.sheets){case"number":if(v!=r.sheets)continue e;break;case"string":if(f.SheetNames[v].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var L=!1,le=0;le!=r.sheets.length;++le)"number"==typeof r.sheets[le]&&r.sheets[le]==v&&(L=1),"string"==typeof r.sheets[le]&&r.sheets[le].toLowerCase()==f.SheetNames[v].toLowerCase()&&(L=1);if(!L)continue e}}lz(t,S,y,f.SheetNames[v],v,T,s,J,r,d,c,u)}return x={Directory:a,Workbook:d,Props:f,Custprops:m,Deps:h,Sheets:s,SheetNames:f.SheetNames,Strings:la,Styles:u,Themes:c,SSF:tt(Se)},r&&r.bookFiles&&(t.files?(x.keys=i,x.files=t.files):(x.keys=[],x.files={},t.FullPaths.forEach(function(xe,ce){xe=xe.replace(/^Root Entry[\/]/,""),x.keys.push(xe),x.files[xe]=t.FileIndex[ce]}))),r&&r.bookVBA&&(a.vba.length>0?x.vbaraw=vt(t,zn(a.vba[0]),!0):a.defaults&&"application/vnd.ms-office.vbaProject"===a.defaults.bin&&(x.vbaraw=vt(t,"xl/vbaProject.bin",!0))),x}function uz(t,r){var e=r||{},i="Workbook",a=ke.find(t,i);try{if(!(a=ke.find(t,i="/!DataSpaces/Version"))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(function VC(t){var r={};r.id=t.read_shift(0,"lpp4"),r.R=nr(t,4),r.U=nr(t,4),r.W=nr(t,4)}(a.content),!(a=ke.find(t,i="/!DataSpaces/DataSpaceMap"))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+i);var o=function jC(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(ZC(t));return r}(a.content);if(1!==o.length||1!==o[0].comps.length||0!==o[0].comps[0].t||"StrongEncryptionDataSpace"!==o[0].name||"EncryptedPackage"!==o[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+i);if(!(a=ke.find(t,i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace"))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+i);var s=function GC(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(t.read_shift(0,"lpp4"));return r}(a.content);if(1!=s.length||"StrongEncryptionTransform"!=s[0])throw new Error("ECMA-376 Encrypted file bad "+i);if(!(a=ke.find(t,i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary"))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+i);!function YC(t){var r=function WC(t){var r={};return t.read_shift(4),t.l+=4,r.id=t.read_shift(0,"lpp4"),r.name=t.read_shift(0,"lpp4"),r.R=nr(t,4),r.U=nr(t,4),r.W=nr(t,4),r}(t);if(r.ename=t.read_shift(0,"8lpp4"),r.blksz=t.read_shift(4),r.cmode=t.read_shift(4),4!=t.read_shift(4))throw new Error("Bad !Primary record");return r}(a.content)}catch(c){}if(!(a=ke.find(t,i="/EncryptionInfo"))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+i);var l=function $C(t){var r=nr(t);switch(r.Minor){case 2:return[r.Minor,JC(t)];case 3:return[r.Minor,QC()];case 4:return[r.Minor,qC(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}(a.content);if(!(a=ke.find(t,i="/EncryptedPackage"))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(4==l[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(l[1],a.content,e.password||"",e);if(2==l[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(l[1],a.content,e.password||"",e);throw new Error("File is password-protected")}function dz(t,r){return"ods"==r.bookType?Ju(t,r):"numbers"==r.bookType?function az(t,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=qt(e["!ref"]);i.s.r=i.s.c=0;var a=!1;i.e.c>9&&(a=!0,i.e.c=9),i.e.r>49&&(a=!0,i.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(De(i)));var o=fo(e,{range:i,header:1}),s=["~Sh33tJ5~"];o.forEach(function(N){return N.forEach(function(A){"string"==typeof A&&s.push(A)})});var l={},c=[],u=ke.read(r.numbers,{type:"base64"});u.FileIndex.map(function(N,A){return[N,u.FullPaths[A]]}).forEach(function(N){var A=N[0],X=N[1];2==A.type&&A.name.match(/\.iwa/)&&Sn(bn(A.content)).forEach(function(te){c.push(te.id),l[te.id]={deps:[],location:X,type:mt(te.messages[0].meta[1][0].data)}})}),c.sort(function(N,A){return N-A});var d=c.filter(function(N){return N>1}).map(function(N){return[N,$e(N)]});u.FileIndex.map(function(N,A){return[N,u.FullPaths[A]]}).forEach(function(N){var A=N[0];A.name.match(/\.iwa/)&&Sn(bn(A.content)).forEach(function(ie){ie.messages.forEach(function(ae){d.forEach(function(te){ie.messages.some(function(Ne){return 11006!=mt(Ne.meta[1][0].data)&&function Gb(t,r){e:for(var e=0;e<=t.length-r.length;++e){for(var i=0;i<r.length;++i)if(t[e+i]!=r[i])continue e;return!0}return!1}(Ne.data,te[1])})&&l[te[0]].deps.push(ie.id)})})})});for(var x,p=ke.find(u,l[1].location),m=Sn(bn(p.content)),h=0;h<m.length;++h){var v=m[h];1==v.id&&(x=v)}var T=Yt(We(x.messages[0].data)[1][0].data);for(m=Sn(bn((p=ke.find(u,l[T].location)).content)),h=0;h<m.length;++h)(v=m[h]).id==T&&(x=v);for(T=Yt(We(x.messages[0].data)[2][0].data),m=Sn(bn((p=ke.find(u,l[T].location)).content)),h=0;h<m.length;++h)(v=m[h]).id==T&&(x=v);for(T=Yt(We(x.messages[0].data)[2][0].data),m=Sn(bn((p=ke.find(u,l[T].location)).content)),h=0;h<m.length;++h)(v=m[h]).id==T&&(x=v);var S=We(x.messages[0].data);S[6][0].data=$e(i.e.r+1),S[7][0].data=$e(i.e.c+1);for(var y=Yt(S[46][0].data),P=ke.find(u,l[y].location),U=Sn(bn(P.content)),M=0;M<U.length&&U[M].id!=y;++M);if(U[M].id!=y)throw"Bad ColumnRowUIDMapArchive";var I=We(U[M].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var B=0;B<=i.e.c;++B){var R=[];R[1]=R[2]=[{type:0,data:$e(B+420690)}],I[1].push({type:2,data:At(R)}),I[2].push({type:0,data:$e(B)}),I[3].push({type:0,data:$e(B)})}I[4]=[],I[5]=[],I[6]=[];for(var W=0;W<=i.e.r;++W)(R=[])[1]=R[2]=[{type:0,data:$e(W+726270)}],I[4].push({type:2,data:At(R)}),I[5].push({type:0,data:$e(W)}),I[6].push({type:0,data:$e(W)});U[M].messages[0].data=At(I),P.content=Si(ki(U)),P.size=P.content.length,delete S[46];var J=We(S[4][0].data);J[7][0].data=$e(i.e.r+1);var le=Yt(We(J[1][0].data)[2][0].data);if((U=Sn(bn((P=ke.find(u,l[le].location)).content)))[0].id!=le)throw"Bad HeaderStorageBucket";var xe=We(U[0].messages[0].data);for(W=0;W<o.length;++W){var ce=We(xe[2][0].data);ce[1][0].data=$e(W),ce[4][0].data=$e(o[W].length),xe[2][W]={type:xe[2][0].type,data:At(ce)}}U[0].messages[0].data=At(xe),P.content=Si(ki(U)),P.size=P.content.length;var Te=Yt(J[2][0].data);if((U=Sn(bn((P=ke.find(u,l[Te].location)).content)))[0].id!=Te)throw"Bad HeaderStorageBucket";for(xe=We(U[0].messages[0].data),B=0;B<=i.e.c;++B)(ce=We(xe[2][0].data))[1][0].data=$e(B),ce[4][0].data=$e(i.e.r+1),xe[2][B]={type:xe[2][0].type,data:At(ce)};U[0].messages[0].data=At(xe),P.content=Si(ki(U)),P.size=P.content.length;var Ce=Yt(J[4][0].data);!function(){for(var X,N=ke.find(u,l[Ce].location),A=Sn(bn(N.content)),pe=0;pe<A.length;++pe){var ie=A[pe];ie.id==Ce&&(X=ie)}var ae=We(X.messages[0].data);ae[3]=[];var te=[];s.forEach(function(Qe,Ue){te[1]=[{type:0,data:$e(Ue)}],te[2]=[{type:0,data:$e(1)}],te[3]=[{type:2,data:jb(Qe)}],ae[3].push({type:2,data:At(te)})}),X.messages[0].data=At(ae);var E=Si(ki(A));N.content=E,N.size=N.content.length}();var Be=We(J[3][0].data),me=Be[1][0];delete Be[2];var we=We(me.data),ee=Yt(we[2][0].data);!function(){for(var X,N=ke.find(u,l[ee].location),A=Sn(bn(N.content)),pe=0;pe<A.length;++pe){var ie=A[pe];ie.id==ee&&(X=ie)}var ae=We(X.messages[0].data);delete ae[6],delete Be[7];var te=new Uint8Array(ae[5][0].data);ae[5]=[];for(var Ne=0,E=0;E<=i.e.r;++E){var Qe=We(te);Ne+=iz(Qe,o[E],s),Qe[1][0].data=$e(E),ae[5].push({data:At(Qe),type:2})}ae[1]=[{type:0,data:$e(i.e.c+1)}],ae[2]=[{type:0,data:$e(i.e.r+1)}],ae[3]=[{type:0,data:$e(Ne)}],ae[4]=[{type:0,data:$e(i.e.r+1)}],X.messages[0].data=At(ae);var qe=Si(ki(A));N.content=qe,N.size=N.content.length}(),me.data=At(we),J[3][0].data=At(Be),S[4][0].data=At(J),x.messages[0].data=At(S);var Z=Si(ki(m));return p.content=Z,p.size=p.content.length,u}(t,r):"xlsb"==r.bookType?function fz(t,r){yi=1024,t&&!t.SSF&&(t.SSF=tt(Se)),t&&t.SSF&&(fi(),Hi(t.SSF),r.revssf=La(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ca?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e="xlsb"==r.bookType?"bin":"xml",i=au.indexOf(r.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Vs(r=r||{});var o=Uo(),s="",l=0;if(r.cellXfs=[],br(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),Me(o,s="docProps/core.xml",r0(t.Props,r)),a.coreprops.push(s),Ye(r.rels,2,s,Ae.CORE_PROPS),s="docProps/app.xml",!t.Props||!t.Props.SheetNames)if(t.Workbook&&t.Workbook.Sheets){for(var c=[],u=0;u<t.SheetNames.length;++u)2!=(t.Workbook.Sheets[u]||{}).Hidden&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}else t.Props.SheetNames=t.SheetNames;for(t.Props.Worksheets=t.Props.SheetNames.length,Me(o,s,s0(t.Props)),a.extprops.push(s),Ye(r.rels,3,s,Ae.EXT_PROPS),t.Custprops!==t.Props&&dt(t.Custprops||{}).length>0&&(Me(o,s="docProps/custom.xml",l0(t.Custprops)),a.custprops.push(s),Ye(r.rels,4,s,Ae.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var d={"!id":{}},f=t.Sheets[t.SheetNames[l-1]];if(Me(o,s="xl/worksheets/sheet"+l+"."+e,WS(l-1,s,r,t,d)),a.sheets.push(s),Ye(r.wbrels,-1,"worksheets/sheet"+l+"."+e,Ae.WS[0]),f){var m=f["!comments"],x=!1,h="";m&&m.length>0&&(Me(o,h="xl/comments"+l+"."+e,JS(m,h,r)),a.comments.push(h),Ye(d,-1,"../comments"+l+"."+e,Ae.CMNT),x=!0),f["!legacy"]&&x&&Me(o,"xl/drawings/vmlDrawing"+l+".vml",nu(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Me(o,Qi(s),xi(d))}return null!=r.Strings&&r.Strings.length>0&&(Me(o,s="xl/sharedStrings."+e,function $S(t,r,e){return(".bin"===r.slice(-4)?HC:Z0)(t,e)}(r.Strings,s,r)),a.strs.push(s),Ye(r.wbrels,-1,"sharedStrings."+e,Ae.SST)),Me(o,s="xl/workbook."+e,function GS(t,r,e){return(".bin"===r.slice(-4)?DS:Ou)(t,e)}(t,s,r)),a.workbooks.push(s),Ye(r.rels,1,s,Ae.WB),Me(o,s="xl/theme/theme1.xml",ks(t.Themes,r)),a.themes.push(s),Ye(r.wbrels,-1,"theme/theme1.xml",Ae.THEME),Me(o,s="xl/styles."+e,function YS(t,r,e){return(".bin"===r.slice(-4)?V2:q0)(t,e)}(t,s,r)),a.styles.push(s),Ye(r.wbrels,-1,"styles."+e,Ae.STY),t.vbaraw&&i&&(Me(o,s="xl/vbaProject.bin",t.vbaraw),a.vba.push(s),Ye(r.wbrels,-1,"vbaProject.bin",Ae.VBA)),Me(o,s="xl/metadata."+e,function QS(t){return(".bin"===t.slice(-4)?hy:tu)()}(s)),a.metadata.push(s),Ye(r.wbrels,-1,"metadata."+e,Ae.XLMETA),Me(o,"[Content_Types].xml",Kc(a,r)),Me(o,"_rels/.rels",xi(r.rels)),Me(o,"xl/_rels/workbook."+e+".rels",xi(r.wbrels)),delete r.revssf,delete r.ssf,o}(t,r):function Ku(t,r){yi=1024,t&&!t.SSF&&(t.SSF=tt(Se)),t&&t.SSF&&(fi(),Hi(t.SSF),r.revssf=La(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ca?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e="xml",i=au.indexOf(r.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Vs(r=r||{});var o=Uo(),s="",l=0;if(r.cellXfs=[],br(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),Me(o,s="docProps/core.xml",r0(t.Props,r)),a.coreprops.push(s),Ye(r.rels,2,s,Ae.CORE_PROPS),s="docProps/app.xml",!t.Props||!t.Props.SheetNames)if(t.Workbook&&t.Workbook.Sheets){for(var c=[],u=0;u<t.SheetNames.length;++u)2!=(t.Workbook.Sheets[u]||{}).Hidden&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}else t.Props.SheetNames=t.SheetNames;t.Props.Worksheets=t.Props.SheetNames.length,Me(o,s,s0(t.Props)),a.extprops.push(s),Ye(r.rels,3,s,Ae.EXT_PROPS),t.Custprops!==t.Props&&dt(t.Custprops||{}).length>0&&(Me(o,s="docProps/custom.xml",l0(t.Custprops)),a.custprops.push(s),Ye(r.rels,4,s,Ae.CUST_PROPS));var d=["SheetJ5"];for(r.tcid=0,l=1;l<=t.SheetNames.length;++l){var f={"!id":{}},p=t.Sheets[t.SheetNames[l-1]];if(Me(o,s="xl/worksheets/sheet"+l+"."+e,yu(l-1,r,t,f)),a.sheets.push(s),Ye(r.wbrels,-1,"worksheets/sheet"+l+"."+e,Ae.WS[0]),p){var x=p["!comments"],h=!1,v="";if(x&&x.length>0){var T=!1;x.forEach(function(S){S[1].forEach(function(y){1==y.T&&(T=!0)})}),T&&(Me(o,v="xl/threadedComments/threadedComment"+l+"."+e,Ty(x,d,r)),a.threadedcomments.push(v),Ye(f,-1,"../threadedComments/threadedComment"+l+"."+e,Ae.TCMNT)),Me(o,v="xl/comments"+l+"."+e,iu(x)),a.comments.push(v),Ye(f,-1,"../comments"+l+"."+e,Ae.CMNT),h=!0}p["!legacy"]&&h&&Me(o,"xl/drawings/vmlDrawing"+l+".vml",nu(l,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&Me(o,Qi(s),xi(f))}return null!=r.Strings&&r.Strings.length>0&&(Me(o,s="xl/sharedStrings."+e,Z0(r.Strings,r)),a.strs.push(s),Ye(r.wbrels,-1,"sharedStrings."+e,Ae.SST)),Me(o,s="xl/workbook."+e,Ou(t)),a.workbooks.push(s),Ye(r.rels,1,s,Ae.WB),Me(o,s="xl/theme/theme1.xml",ks(t.Themes,r)),a.themes.push(s),Ye(r.wbrels,-1,"theme/theme1.xml",Ae.THEME),Me(o,s="xl/styles."+e,q0(t,r)),a.styles.push(s),Ye(r.wbrels,-1,"styles."+e,Ae.STY),t.vbaraw&&i&&(Me(o,s="xl/vbaProject.bin",t.vbaraw),a.vba.push(s),Ye(r.wbrels,-1,"vbaProject.bin",Ae.VBA)),Me(o,s="xl/metadata."+e,tu()),a.metadata.push(s),Ye(r.wbrels,-1,"metadata."+e,Ae.XLMETA),d.length>1&&(Me(o,s="xl/persons/person.xml",function Sy(t){var r=[pt,se("personList",null,{xmlns:Ct_TCMNT,"xmlns:x":yr[0]}).replace(/[\/]>/,">")];return t.forEach(function(e,i){r.push(se("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:e,providerId:"None"}))}),r.push("</personList>"),r.join("")}(d)),a.people.push(s),Ye(r.wbrels,-1,"persons/person.xml",Ae.PEOPLE)),Me(o,"[Content_Types].xml",Kc(a,r)),Me(o,"_rels/.rels",xi(r.rels)),Me(o,"xl/_rels/workbook.xml.rels",xi(r.wbrels)),delete r.revssf,delete r.ssf,o}(t,r)}function Zs(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=ln(t.slice(0,12));break;case"binary":e=t;break;default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function ed(t,r){var e=0;e:for(;e<t.length;)switch(t.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return Ns(t.slice(e),r);default:break e}return vi.to_workbook(t,r)}function js(t,r,e,i){return i?(e.type="string",vi.to_workbook(t,e)):vi.to_workbook(r,e)}function co(t,r){Aa();var e=r||{};if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer)return co(new Uint8Array(t),((e=tt(e)).type="array",e));"undefined"!=typeof Uint8Array&&t instanceof Uint8Array&&!e.type&&(e.type="undefined"!=typeof Deno?"buffer":"array");var a,i=t,o=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),Ti={},e.dateNF&&(Ti.dateNF=e.dateNF),e.type||(e.type=Pe&&Buffer.isBuffer(t)?"buffer":"base64"),"file"==e.type&&(e.type=Pe?"buffer":"binary",i=function m1(t){if("undefined"!=typeof Deno)return Deno.readFileSync(t);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var r=File(t);r.open("r"),r.encoding="binary";var e=r.read();return r.close(),e}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+t)}(t),"undefined"!=typeof Uint8Array&&!Pe&&(e.type="array")),"string"==e.type&&(o=!0,e.type="binary",e.codepage=65001,i=function _z(t){return t.match(/[^\x00-\x7F]/)?Un(t):t}(t)),"array"==e.type&&"undefined"!=typeof Uint8Array&&t instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var s=new ArrayBuffer(3),l=new Uint8Array(s);if(l.foo="bar",!l.foo)return(e=tt(e)).type="array",co(Mo(i),e)}switch((a=Zs(i,e))[0]){case 208:if(207===a[1]&&17===a[2]&&224===a[3]&&161===a[4]&&177===a[5]&&26===a[6]&&225===a[7])return function pz(t,r){return ke.find(t,"EncryptedPackage")?uz(t,r):Au(t,r)}(ke.read(i,e),e);break;case 9:if(a[1]<=8)return Au(i,e);break;case 60:return Ns(i,e);case 73:if(73===a[1]&&42===a[2]&&0===a[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===a[1])return function SC(t,r){var e=r||{},i=!!e.WTF;e.WTF=!0;try{var a=U0.to_workbook(t,e);return e.WTF=i,a}catch(o){if(e.WTF=i,!o.message.match(/SYLK bad record ID/)&&i)throw o;return vi.to_workbook(t,r)}}(i,e);break;case 84:if(65===a[1]&&66===a[2]&&76===a[3])return H0.to_workbook(i,e);break;case 80:return 75===a[1]&&a[2]<9&&a[3]<9?function hz(t,r){var i=t,a=r||{};return a.type||(a.type=Pe&&Buffer.isBuffer(t)?"buffer":"base64"),cz(_c(i,a),a)}(i,e):js(t,i,e,o);case 239:return 60===a[3]?Ns(i,e):js(t,i,e,o);case 255:if(254===a[1])return function gz(t,r){var e=t;return"base64"==r.type&&(e=ln(e)),e=je.utils.decode(1200,e.slice(2),"str"),r.type="binary",ed(e,r)}(i,e);if(0===a[1]&&2===a[2]&&0===a[3])return Kr.to_workbook(i,e);break;case 0:if(0===a[1]&&(a[2]>=2&&0===a[3]||0===a[2]&&(8===a[3]||9===a[3])))return Kr.to_workbook(i,e);break;case 3:case 131:case 139:case 140:return xs.to_workbook(i,e);case 123:if(92===a[1]&&114===a[2]&&116===a[3])return $0.to_workbook(i,e);break;case 10:case 13:case 32:return function mz(t,r){var e="",i=Zs(t,r);switch(r.type){case"base64":e=ln(t);break;case"binary":e=t;break;case"buffer":e=t.toString("binary");break;case"array":e=Hr(t);break;default:throw new Error("Unrecognized type "+r.type)}return 239==i[0]&&187==i[1]&&191==i[2]&&(e=Xe(e)),r.type="binary",ed(e,r)}(i,e);case 137:if(80===a[1]&&78===a[2]&&71===a[3])throw new Error("PNG Image File is not a spreadsheet")}return kC.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?xs.to_workbook(i,e):js(t,i,e,o)}function td(t,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Vi(r.file,ke.write(t,{type:Pe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return ke.write(t,r)}function jn(t,r,e){e||(e="");var i=e+t;switch(r.type){case"base64":return Pi(Un(i));case"binary":return Un(i);case"string":return t;case"file":return Vi(r.file,i,"utf8");case"buffer":return Pe?qn(i,"utf8"):"undefined"!=typeof TextEncoder?(new TextEncoder).encode(i):jn(i,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function uo(t,r){switch(r.type){case"string":case"base64":case"binary":for(var e="",i=0;i<t.length;++i)e+=String.fromCharCode(t[i]);return"base64"==r.type?Pi(e):"string"==r.type?Xe(e):e;case"file":return Vi(r.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+r.type)}}function Gs(t,r){Aa(),function Iu(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");!function xS(t,r,e){t.forEach(function(i,a){zu(i);for(var o=0;o<a;++o)if(i==t[o])throw new Error("Duplicate Sheet Name: "+i);if(e){var s=r&&r[a]&&r[a].CodeName||i;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}(t.SheetNames,t.Workbook&&t.Workbook.Sheets||[],!!t.vbaraw);for(var e=0;e<t.SheetNames.length;++e)hT(t.Sheets[t.SheetNames[e]],0,e)}(t);var e=tt(r||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),"array"==e.type){e.type="binary";var i=Gs(t,e);return e.type="array",Bi(i)}var a=0;if(e.sheet&&(a="number"==typeof e.sheet?e.sheet:t.SheetNames.indexOf(e.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return jn(mb(t,e),e);case"slk":case"sylk":return jn(U0.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"htm":case"html":return jn(Uu(t.Sheets[t.SheetNames[a]],e),e);case"txt":return function yz(t,r){switch(r.type){case"base64":return Pi(t);case"binary":case"string":return t;case"file":return Vi(r.file,t,"binary");case"buffer":return Pe?qn(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}(sd(t.Sheets[t.SheetNames[a]],e),e);case"csv":return jn(Ys(t.Sheets[t.SheetNames[a]],e),e,"\ufeff");case"dif":return jn(H0.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"dbf":return uo(xs.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"prn":return jn(vi.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"rtf":return jn($0.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"eth":return jn(V0.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"fods":return jn(Ju(t,e),e);case"wk1":return uo(Kr.sheet_to_wk1(t.Sheets[t.SheetNames[a]],e),e);case"wk3":return uo(Kr.book_to_wk3(t,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),uo(Nu(t,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),function Cz(t,r){var e=r||{};return td(function wb(t,r){var e=r||{},i=ke.utils.cfb_new({root:"R"}),a="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":a="/Workbook",e.biff=8;break;case"biff5":a="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return ke.utils.cfb_add(i,a,Nu(t,e)),8==e.biff&&(t.Props||t.Custprops)&&function yb(t,r){var s,e=[],i=[],a=[],o=0,l=lc(ls,"n"),c=lc(cs,"n");if(t.Props)for(s=dt(t.Props),o=0;o<s.length;++o)(Object.prototype.hasOwnProperty.call(l,s[o])?e:Object.prototype.hasOwnProperty.call(c,s[o])?i:a).push([s[o],t.Props[s[o]]]);if(t.Custprops)for(s=dt(t.Custprops),o=0;o<s.length;++o)Object.prototype.hasOwnProperty.call(t.Props||{},s[o])||(Object.prototype.hasOwnProperty.call(l,s[o])?e:Object.prototype.hasOwnProperty.call(c,s[o])?i:a).push([s[o],t.Custprops[s[o]]]);var u=[];for(o=0;o<a.length;++o)g0.indexOf(a[o][0])>-1||a0.indexOf(a[o][0])>-1||null!=a[o][1]&&u.push(a[o]);i.length&&ke.utils.cfb_add(r,"/\x05SummaryInformation",v0(i,da_SI,c,cs)),(e.length||u.length)&&ke.utils.cfb_add(r,"/\x05DocumentSummaryInformation",v0(e,da_DSI,l,ls,u.length?u:null,"05d5cdd59c2e1b10939708002b2cf9ae"))}(t,i),8==e.biff&&t.vbaraw&&function Ny(t,r){r.FullPaths.forEach(function(e,i){if(0!=i){var a=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==a.slice(-1)&&ke.utils.cfb_add(t,a,r.FileIndex[i].content)}})}(i,ke.read(t.vbaraw,{type:"string"==typeof t.vbaraw?"binary":"buffer"})),i}(t,e),e)}(t,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function xz(t,r){var e=tt(r||{});return function nd(t,r){var e={},i=Pe?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";if(r.compression&&(e.compression="DEFLATE"),r.password)e.type=i;else switch(r.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":e.type=i;break;default:throw new Error("Unrecognized type "+r.type)}var a=t.FullPaths?ke.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!r.compression}):t.generate(e);if("undefined"!=typeof Deno&&"string"==typeof a){if("binary"==r.type||"base64"==r.type)return a;a=new Uint8Array(Bi(a))}return r.password&&"undefined"!=typeof encrypt_agile?td(encrypt_agile(a,r.password),r):"file"===r.type?Vi(r.file,a):"string"==r.type?Xe(a):a}(dz(t,e),e)}(t,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function id(t,r,e,i,a,o,s,l){var c=ht(e),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,p=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:e,enumerable:!1})}catch(v){p.__rowNum__=e}else p.__rowNum__=e;if(!s||t[e])for(var m=r.s.c;m<=r.e.c;++m){var x=s?t[e][m]:t[i[m]+c];if(void 0!==x&&void 0!==x.t){var h=x.v;switch(x.t){case"z":if(null==h)break;continue;case"e":h=0==h?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(null!=o[m]){if(null==h)if("e"==x.t&&null===h)p[o[m]]=null;else if(void 0!==u)p[o[m]]=u;else{if(!d||null!==h)continue;p[o[m]]=null}else p[o[m]]=d&&("n"!==x.t||"n"===x.t&&!1!==l.rawNumbers)?h:Hn(x,h,l);null!=h&&(f=!1)}}else{if(void 0===u)continue;null!=o[m]&&(p[o[m]]=u)}}return{row:p,isempty:f}}function fo(t,r){if(null==t||null==t["!ref"])return[];var e={t:"n",v:0},i=0,a=1,o=[],s=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=r||{},d=null!=u.range?u.range:t["!ref"];switch(1===u.header?i=1:"A"===u.header?i=2:Array.isArray(u.header)?i=3:null==u.header&&(i=0),typeof d){case"string":c=Ve(d);break;case"number":(c=Ve(t["!ref"])).s.r=d;break;default:c=d}i>0&&(a=0);var f=ht(c.s.r),p=[],m=[],x=0,h=0,v=Array.isArray(t),T=c.s.r,S=0,y={};v&&!t[T]&&(t[T]=[]);var P=u.skipHidden&&t["!cols"]||[],U=u.skipHidden&&t["!rows"]||[];for(S=c.s.c;S<=c.e.c;++S)if(!(P[S]||{}).hidden)switch(p[S]=ot(S),e=v?t[T][S]:t[p[S]+f],i){case 1:o[S]=S-c.s.c;break;case 2:o[S]=p[S];break;case 3:o[S]=u.header[S-c.s.c];break;default:if(null==e&&(e={w:"__EMPTY",t:"s"}),l=s=Hn(e,null,u),h=y[s]||0){do{l=s+"_"+h++}while(y[l]);y[s]=h,y[l]=1}else y[s]=1;o[S]=l}for(T=c.s.r+a;T<=c.e.r;++T)if(!(U[T]||{}).hidden){var M=id(t,c,T,p,i,o,v,u);(!1===M.isempty||(1===i?!1!==u.blankrows:u.blankrows))&&(m[x++]=M.row)}return m.length=x,m}var ad=/"/g;function od(t,r,e,i,a,o,s,l){for(var c=!0,u=[],d="",f=ht(e),p=r.s.c;p<=r.e.c;++p)if(i[p]){var m=l.dense?(t[e]||[])[p]:t[i[p]+f];if(null==m)d="";else if(null!=m.v){c=!1,d=""+(l.rawNumbers&&"n"==m.t?m.v:Hn(m,null,l));for(var x=0,h=0;x!==d.length;++x)if((h=d.charCodeAt(x))===a||h===o||34===h||l.forceQuotes){d='"'+d.replace(ad,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==m.f||m.F?d="":(c=!1,(d="="+m.f).indexOf(",")>=0&&(d='"'+d.replace(ad,'""')+'"'));u.push(d)}return!1===l.blankrows&&c?null:u.join(s)}function Ys(t,r){var e=[],i=null==r?{}:r;if(null==t||null==t["!ref"])return"";var a=Ve(t["!ref"]),o=void 0!==i.FS?i.FS:",",s=o.charCodeAt(0),l=void 0!==i.RS?i.RS:"\n",c=l.charCodeAt(0),u=new RegExp(("|"==o?"\\|":o)+"+$"),d="",f=[];i.dense=Array.isArray(t);for(var p=i.skipHidden&&t["!cols"]||[],m=i.skipHidden&&t["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(p[x]||{}).hidden||(f[x]=ot(x));for(var h=0,v=a.s.r;v<=a.e.r;++v)(m[v]||{}).hidden||null!=(d=od(t,a,v,f,s,c,o,i))&&(i.strip&&(d=d.replace(u,"")),(d||!1!==i.blankrows)&&e.push((h++?l:"")+d));return delete i.dense,e.join("")}function sd(t,r){r||(r={}),r.FS="\t",r.RS="\n";var e=Ys(t,r);return e}function ld(t,r,e){var i=e||{},a=+!i.skipHeader,o=t||{},s=0,l=0;if(o&&null!=i.origin)if("number"==typeof i.origin)s=i.origin;else{var c="string"==typeof i.origin?lt(i.origin):i.origin;s=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:s+r.length-1+a}};if(o["!ref"]){var f=Ve(o["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),-1==s&&(d.e.r=(s=f.e.r+1)+r.length-1+a)}else-1==s&&(s=0,d.e.r=r.length-1+a);var p=i.header||[],m=0;r.forEach(function(h,v){dt(h).forEach(function(T){-1==(m=p.indexOf(T))&&(p[m=p.length]=T);var S=h[T],y="z",P="",U=ze({c:l+m,r:s+v+a});u=ma(o,U),!S||"object"!=typeof S||S instanceof Date?("number"==typeof S?y="n":"boolean"==typeof S?y="b":"string"==typeof S?y="s":S instanceof Date?(y="d",i.cellDates||(y="n",S=kt(S)),P=i.dateNF||Se[14]):null===S&&i.nullError&&(y="e",S=0),u?(u.t=y,u.v=S,delete u.w,delete u.R,P&&(u.z=P)):o[U]=u={t:y,v:S},P&&(u.z=P)):o[U]=S})}),d.e.c=Math.max(d.e.c,l+p.length-1);var x=ht(s);if(a)for(m=0;m<p.length;++m)o[ot(m+l)+x]={t:"s",v:p[m]};return o["!ref"]=De(d),o}function ma(t,r,e){if("string"==typeof r){if(Array.isArray(t)){var i=lt(r);return t[i.r]||(t[i.r]=[]),t[i.r][i.c]||(t[i.r][i.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return ma(t,ze("number"!=typeof r?r:{r,c:e||0}))}function Js(t,r,e,i){var a=1;if(!e)for(;a<=65535&&-1!=t.SheetNames.indexOf(e="Sheet"+a);++a,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&t.SheetNames.indexOf(e)>=0){var o=e.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var s=o&&o[1]||e;for(++a;a<=65535&&-1!=t.SheetNames.indexOf(e=s+a);++a);}if(zu(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function cd(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}var po={encode_col:ot,encode_row:ht,encode_cell:ze,encode_range:De,decode_col:ts,decode_row:es,split_cell:function W1(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:lt,decode_range:qt,format_cell:Hn,sheet_add_aoa:jc,sheet_add_json:ld,sheet_add_dom:Hu,aoa_to_sheet:gi,json_to_sheet:function kz(t,r){return ld(null,t,r)},table_to_sheet:Vu,table_to_book:function Ub(t,r){return wr(Vu(t,r),r)},sheet_to_csv:Ys,sheet_to_txt:sd,sheet_to_json:fo,sheet_to_html:Uu,sheet_to_formulae:function Tz(t){var e,r="",i="";if(null==t||null==t["!ref"])return[];var l,a=Ve(t["!ref"]),o="",s=[],c=[],u=Array.isArray(t);for(l=a.s.c;l<=a.e.c;++l)s[l]=ot(l);for(var d=a.s.r;d<=a.e.r;++d)for(o=ht(d),l=a.s.c;l<=a.e.c;++l)if(r=s[l]+o,i="",void 0!==(e=u?(t[d]||[])[l]:t[r])){if(null!=e.F){if(r=e.F,!e.f)continue;i=e.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=e.f)i=e.f;else{if("z"==e.t)continue;if("n"==e.t&&null!=e.v)i=""+e.v;else if("b"==e.t)i=e.v?"TRUE":"FALSE";else if(void 0!==e.w)i="'"+e.w;else{if(void 0===e.v)continue;i="s"==e.t?"'"+e.v:""+e.v}}c[c.length]=r+"="+i}return c},sheet_to_row_object_array:fo,sheet_get_cell:ma,book_new:function $s(){return{SheetNames:[],Sheets:{}}},book_append_sheet:Js,book_set_sheet_visibility:function bz(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var i=function Sz(t,r){if("number"==typeof r){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}if("string"==typeof r){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}throw new Error("Cannot find sheet |"+r+"|")}(t,r);switch(t.Workbook.Sheets[i]||(t.Workbook.Sheets[i]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[i].Hidden=e},cell_set_number_format:function zz(t,r){return t.z=r,t},cell_set_hyperlink:cd,cell_set_internal_link:function Iz(t,r,e){return cd(t,"#"+r,e)},cell_add_comment:function Oz(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})},sheet_set_array_formula:function Ez(t,r,e,i){for(var a="string"!=typeof r?r:Ve(r),o="string"==typeof r?r:De(r),s=a.s.r;s<=a.e.r;++s)for(var l=a.s.c;l<=a.e.c;++l){var c=ma(t,s,l);c.t="n",c.F=o,delete c.v,s==a.s.r&&l==a.s.c&&(c.f=e,i&&(c.D=!0))}return t},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Mz=oe(4327);let ud=(()=>{class t{constructor(e){this.inj=e,this.reader=void 0,this.dataUrl=void 0}http(){return this.inj.get(N_.C)}shared(){return this.inj.get(li.W)}writeFromJson(e,i){i=Object.assign({fileName:"REPORT_KPI",sheetName:"data"},i);let a=po.json_to_sheet(e,{cellStyles:!0}),o=po.book_new();po.book_append_sheet(o,a,i.sheetName),function wz(t,r,e){var i=e||{};i.type="file",i.file=r,function Ws(t){if(!t.bookType){var e=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(t.bookType=e.slice(1)),t.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[t.bookType]||t.bookType}}(i),Gs(t,i)}(o,`${i.fileName}.xlsx`,{cellStyles:!0})}loadFromFile(e){return Nt.y.create(i=>{(0,D.Ft)(e)&&i.error("B\u1ea1n ch\u01b0a nh\u1eadp t\u1eadp tin."),this.reader=new FileReader,this.reader.readAsDataURL(e),this.reader.onerror=a=>{let o=this.reader.error,s="L\u1ed7i kh\xf4ng x\xe1c \u0111\u1ecbnh.",l="000000000";(0,D.Ft)(o)||(s=D.h0.getMessage(e,o),l=o.name),i.error({message:s,code:l,evt:a})},this.reader.onload=a=>{if(2===this.reader.readyState){let s=this.reader.result;"string"==typeof s?s=s.split(",")[1]:(console.log("Can check data"),console.log(s));let l=co(s,{type:"base64",cellStyles:!0});i.next(l),i.complete()}}})}getSheetByName(e,i,a,o){let s=e.Sheets[i];if((0,D.Ft)(s))return(0,Pr._)({code:"NO_SHEET",message:`Kh\xf4ng c\xf3 sheet "${i}".`});let l=po.sheet_to_json(s);if(l.length<=1)return(0,Pr._)({code:"NO_DATA",message:`Sheet "${i}" kh\xf4ng c\xf3 d\u1eef li\u1ec7u.`});let c=l.shift(),d=Object.keys(c).filter(f=>"__EMPTY"!==f).map((f,p)=>({field:f,title:c[f]})).reduce((f,p)=>(f[p.field]=p.title,f),{});return l=l.slice(a=a?a-1:0,1+(o=o?o-1:l.length-1)),(0,Ke.of)({header:d,items:l,begin:a+1,end:o+1})}exportExcelXlsx(e,i){let o=e.columnController.columnApi.getAllDisplayedColumns().map(s=>({data:{value:s.getColId(),type:"String"}}));e.exportDataAsExcel({fileName:"ReportKPIV2",exportMode:"xlsx",sheetName:"data",headerRowHeight:0,customHeader:[o]})}downloadFile(e,i){return(i=i||{}).type=i.type||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",i.fileName=i.fileName||"FileMau.xlsx",this.http().get(e,{responseType:"arraybuffer"}).pipe((0,zt.w)(a=>{let o=new Blob([a],{type:i.type});return(0,Mz.saveAs)(o,i.fileName),(0,Ke.of)(o)}),(0,Do.K)(a=>(this.shared().alert.error("X\u1ea3y ra l\u1ed7i"),console.warn(a),(0,Pr._)(a))))}}return t.\u0275fac=function(e){return new(e||t)(n.LFG(n.zs3))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Rz(t,r){1&t&&n._UZ(0,"i",16)}function Pz(t,r){1&t&&n._UZ(0,"i",17)}function Bz(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"button",11),n.NdJ("click",function(){return n.CHM(e),n.oxw().onLoadExcel(!0)}),n.YNc(1,Rz,1,0,"i",12),n.YNc(2,Pz,1,0,"i",15),n.TgZ(3,"span"),n._uU(4,"N\u1ea1p v\xe0 L\u01b0u l\u1ea1i"),n.qZA()()}if(2&t){const e=n.oxw();n.Q6J("disabled",e.disabledAction),n.xp6(1),n.Q6J("ngIf",e.isLoading),n.xp6(1),n.Q6J("ngIf",!e.isLoading)}}function Lz(t,r){1&t&&n._UZ(0,"i",16)}function Uz(t,r){1&t&&n._UZ(0,"i",18)}let Hz=(()=>{class t{constructor(e,i,a){this.shared=e,this.modal=i,this.excel=a,this.isLoading=!1,this.file=void 0,this.config={labelImport:"Ch\u1ecdn file excel (*.xlsx)",fileTemplate:"/assets/reportkpi_mau.xlsx",fileType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},this.isImportAndSave=!1,this.sheetName="DATA",this.fileMau="#",this.nzBeforeUpload=o=>(this.file=o.originFileObj,!1)}get lblFile(){return(0,D.Ft)(this.file)?this.config.labelImport:`\u0110\xe3 ch\u1ecdn: <i class="text-danger">${this.file.name}</i>`}get disabledAction(){return this.isLoading||(0,D.Ft)(this.file)}downloadFileMau(){this.excel.downloadFile(this.config.fileTemplate,{type:this.config.fileType}).subscribe()}onLoadExcel(e=!1){(0,D.Ft)(this.file)?this.shared.alert.warning("Vui l\xf2ng ch\u1ecdn t\u1ec7p tin."):(this.isLoading=!0,this.excel.loadFromFile(this.file).pipe(si(1e3),(0,zt.w)(a=>this.excel.getSheetByName(a,this.sheetName))).subscribe({next:a=>{console.log(a),this.isLoading=!1,this.modal.destroy({act:"import",data:a,isSave:e})},error:a=>{console.warn(a),this.isLoading=!1,this.shared.showError(a)}}))}onExist(){this.isLoading=!1,this.modal.destroy({act:"exist"})}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(li.W),n.Y36(Qn.Lf),n.Y36(ud))},t.\u0275cmp=n.Xpm({type:t,selectors:[["cy-select-file"]],inputs:{config:["options","config"]},decls:29,vars:9,consts:[[1,"select-file"],[1,"body"],["id","empty-success"],[1,"empty-success__text"],["target","_blank"],["id","chose-file"],["nzType","drag",3,"nzAccept","nzBeforeUpload"],[1,"fa-regular","fa-cloud-arrow-up"],[1,"ant-upload-text",3,"innerHTML"],[1,"ant-modal-footer"],["nz-button","",3,"disabled","click",4,"ngIf"],["nz-button","",3,"disabled","click"],["class","fa-regular fa-arrows-spin fa-spin",4,"ngIf"],["class","fa-regular fa-cloud-arrow-down",4,"ngIf"],[1,"fa-regular","fa-power-off"],["class","fa-regular fa-floppy-disk-circle-arrow-right",4,"ngIf"],[1,"fa-regular","fa-arrows-spin","fa-spin"],[1,"fa-regular","fa-floppy-disk-circle-arrow-right"],[1,"fa-regular","fa-cloud-arrow-down"]],template:function(e,i){1&e&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),n._uU(4,"Ch\xfa \xfd: "),n.qZA(),n.TgZ(5,"div",3),n._uU(6,"- H\u01b0\u1edbng d\u1eabn nh\u1eadp li\u1ec7u trong file m\u1eabu."),n.qZA(),n.TgZ(7,"div",3),n._uU(8,"- File m\u1eabu l\xe0 file excel xlsx ho\u1eb7c xls."),n.qZA(),n.TgZ(9,"div",3),n._uU(10,"- T\u1ea3i file m\u1eabu "),n.TgZ(11,"a",4),n._uU(12,"t\u1ea1i \u0111\xe2y"),n.qZA(),n._uU(13," n\u1ebfu ch\u01b0a c\xf3."),n.qZA()(),n.TgZ(14,"div",5)(15,"nz-upload",6),n._UZ(16,"i",7)(17,"span",8),n.qZA()()(),n.TgZ(18,"div",9),n.YNc(19,Bz,5,3,"button",10),n.TgZ(20,"button",11),n.NdJ("click",function(){return i.onLoadExcel(!1)}),n.YNc(21,Lz,1,0,"i",12),n.YNc(22,Uz,1,0,"i",13),n.TgZ(23,"span"),n._uU(24,"N\u1ea1p"),n.qZA()(),n.TgZ(25,"button",11),n.NdJ("click",function(){return i.onExist()}),n._UZ(26,"i",14),n.TgZ(27,"span"),n._uU(28,"Tho\xe1t"),n.qZA()()()()),2&e&&(n.xp6(11),n.uIk("href",i.fileMau,n.LSH),n.xp6(4),n.Q6J("nzAccept",i.config.fileType)("nzBeforeUpload",i.nzBeforeUpload),n.xp6(2),n.Q6J("innerHTML",i.lblFile,n.oJD),n.xp6(2),n.Q6J("ngIf",i.isImportAndSave),n.xp6(1),n.Q6J("disabled",i.disabledAction),n.xp6(1),n.Q6J("ngIf",i.isLoading),n.xp6(1),n.Q6J("ngIf",!i.isLoading),n.xp6(3),n.Q6J("disabled",i.isLoading))},directives:[Tl,K.O5,It.ix,Mr.dQ,Mn.w],styles:[".select-file .body{padding:5px 20px}.select-file .empty-success__text{padding-top:6px;padding-bottom:6px}.select-file .ant-upload-drag-container{display:flex!important;align-items:center}.select-file .ant-upload-drag-container .icon{margin-left:.5rem!important;margin-right:.5rem!important}\n"],encapsulation:2}),t})();const Vz=["ticketDetail"],Zz=["ticketLog"];function jz(t,r){1&t&&n._UZ(0,"i",9)}function Gz(t,r){1&t&&n._UZ(0,"i",10)}function Wz(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"a",11),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).showAlert()}),n._UZ(1,"i",12),n.qZA()}}function Yz(t,r){if(1&t&&(n.TgZ(0,"i"),n._uU(1),n.qZA()),2&t){const e=n.oxw(2);n.xp6(1),n.Oqu(e.cellValue)}}function $z(t,r){if(1&t&&(n.ynx(0,4),n.YNc(1,jz,1,0,"i",5),n.YNc(2,Gz,1,0,"i",6),n.YNc(3,Wz,2,0,"a",7),n.YNc(4,Yz,2,1,"i",8),n.BQk()),2&t){const e=n.oxw();n.Q6J("ngSwitch",e.cellValue),n.xp6(1),n.Q6J("ngSwitchCase",!0),n.xp6(1),n.Q6J("ngSwitchCase","success"),n.xp6(1),n.Q6J("ngSwitchCase","error")}}function Jz(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"a",11),n.NdJ("click",function(){return n.CHM(e),n.oxw().showTicketDetail()}),n._uU(2),n.qZA(),n.BQk()}if(2&t){const e=n.oxw();n.xp6(2),n.hij("#",e.cellValue,"")}}function Qz(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"a",11),n.NdJ("click",function(){return n.CHM(e),n.oxw().showLogs()}),n._UZ(2,"i",13),n.qZA(),n.BQk()}}function qz(t,r){1&t&&n.GkF(0)}function Xz(t,r){if(1&t&&(n.TgZ(0,"div",14)(1,"div",15)(2,"div",16)(3,"label"),n._uU(4,"Ng\xe0y g\u1eedi: "),n.qZA(),n.TgZ(5,"label",17),n._uU(6),n.qZA()()(),n.TgZ(7,"div",15)(8,"div",16)(9,"label"),n._uU(10,"Ticket ID: "),n.qZA(),n.TgZ(11,"label",17),n._uU(12),n.qZA()()(),n.TgZ(13,"div",15)(14,"div",16)(15,"label"),n._uU(16,"T\xecnh tr\u1ea1ng: "),n.qZA(),n.TgZ(17,"label",17),n._uU(18),n.qZA()()(),n.TgZ(19,"div",15)(20,"div",16)(21,"label"),n._uU(22,"Ticket Text: "),n.qZA(),n.TgZ(23,"label",17),n._uU(24),n.qZA()()(),n.TgZ(25,"div",18)(26,"div",16)(27,"label"),n._uU(28,"Ti\xeau \u0111\u1ec1"),n.qZA(),n._UZ(29,"input",19),n.qZA()(),n.TgZ(30,"div",18)(31,"div",16)(32,"label"),n._uU(33,"N\u1ed9i dung"),n.qZA(),n._UZ(34,"textarea",19),n.qZA()(),n.TgZ(35,"div",18)(36,"div",16)(37,"label"),n._uU(38,"Ghi ch\xfa"),n.qZA(),n._UZ(39,"textarea",19),n.qZA()()()),2&t){const e=n.oxw();n.xp6(6),n.Oqu(e.data.send_on),n.xp6(6),n.Oqu(e.data.ticket_number),n.xp6(6),n.Oqu(e.status),n.xp6(6),n.Oqu(e.data.ticket_text),n.xp6(5),n.Q6J("value",e.data.subject||""),n.xp6(5),n.Q6J("value",e.data.body||""),n.xp6(5),n.Q6J("value",e.data.note||"")}}function Kz(t,r){if(1&t&&(n.TgZ(0,"div",21)(1,"div",14)(2,"div",18)(3,"label",22)(4,"span",23),n._uU(5,"Ng\xe0y: "),n.qZA(),n.TgZ(6,"span",24),n._uU(7),n.ALo(8,"date"),n.qZA()(),n.TgZ(9,"label",25)(10,"span",23),n._uU(11,"S\u1ef1 ki\u1ec7n: "),n.qZA(),n.TgZ(12,"span",24),n._uU(13),n.qZA()()()(),n.TgZ(14,"div",14)(15,"div",18)(16,"label",26),n._uU(17),n.qZA()()()()),2&t){const e=r.$implicit;n.xp6(7),n.Oqu(n.xi3(8,3,e.date,"dd/MM/yyyy HH:mm:ss")),n.xp6(6),n.Oqu(e.act),n.xp6(4),n.Oqu(e.message)}}const eI=function(){return[]};function tI(t,r){if(1&t&&n.YNc(0,Kz,18,6,"ng-template",20),2&t){const e=n.oxw();n.Q6J("ngForOf",e.data.logs||n.DdM(1,eI))}}let Qs=(()=>{class t{constructor(e){this.inj=e}get data(){return this.param.data}get colId(){return this.param.colDef.colId}get cellValue(){let e=this.data.index_stt;return"index_stt"!==this.colId||(0,D.Ft)(e)?this.param.value:e}get popup(){return this.inj.get(Qn.Sf)}get status(){let e=[];return(0,D.EU)(this.data.ticket_number)||e.push("G\u1eedi"),(0,D.EU)(this.data.node_id)||e.push("Note"),5===this.data.status&&e.push("Close"),0===e.length?"Ch\u01b0a g\u1eedi":e.join(",")}agInit(e){this.param=e}refresh(e){return!(0,D.Ft)(e.value)}showAlert(){let e=this.param.data.error||{},i=`${e.message} (M\xe3 l\u1ed7i: ${e.code}${(0,D.EU)(e.e_code)?"":"- "+e.e_code})`,a=(0,D.Ft)(e.detail)||"object"!=typeof e.detail?e.detail:JSON.stringify(e.detail);i=`${i}${(0,D.Ft)(a)?"":"<br/>Chi ti\u1ebft: "+a}`,this.popup.create({nzTitle:"Chi ti\u1ebft l\u1ed7i",nzContent:i,nzCancelText:null,nzOkText:"\u0110\xf3ng",nzOnOk:()=>Promise.resolve()})}showLogs(){this.popup.create({nzTitle:"L\u1ecbch s\u1eed",nzContent:this.ticketLogComp,nzClassName:"show-logs",nzCancelText:null,nzOkText:"\u0110\xf3ng",nzOnOk:()=>Promise.resolve()})}showTicketDetail(){this.popup.create({nzTitle:"Th\xf4ng tin Ticket",nzContent:this.ticketDetailComp,nzWidth:700,nzClosable:!1,nzFooter:null})}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(n.zs3))},t.\u0275cmp=n.Xpm({type:t,selectors:[["cy-send-status"]],viewQuery:function(e,i){if(1&e&&(n.Gf(Vz,7),n.Gf(Zz,7)),2&e){let a;n.iGM(a=n.CRH())&&(i.ticketDetailComp=a.first),n.iGM(a=n.CRH())&&(i.ticketLogComp=a.first)}},decls:8,vars:4,consts:[[3,"ngSwitch",4,"ngIf"],[4,"ngIf"],["ticketDetail",""],["ticketLog",""],[3,"ngSwitch"],["class","fal fa-sync fa-spin",4,"ngSwitchCase"],["class","fal fa-check",4,"ngSwitchCase"],[3,"click",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"fal","fa-sync","fa-spin"],[1,"fal","fa-check"],[3,"click"],[1,"fal","fa-times"],[1,"fal","fa-comment"],[1,"row"],[1,"col-6","col-label"],[1,"form-group"],[1,"vl"],[1,"col-12"],["nzAutosize","","nz-input","",3,"value"],["ngFor","",3,"ngForOf"],[1,"log-item"],["nz-label","",1,"date"],[1,"text"],[1,"value"],["nz-label","",1,"act"],["nz-label",""]],template:function(e,i){1&e&&(n.YNc(0,$z,5,4,"ng-container",0),n.YNc(1,Jz,3,1,"ng-container",1),n.YNc(2,Qz,3,0,"ng-container",1),n.YNc(3,qz,1,0,"ng-container",1),n.YNc(4,Xz,40,7,"ng-template",null,2,n.W1O),n.YNc(6,tI,1,2,"ng-template",null,3,n.W1O)),2&e&&(n.Q6J("ngIf","send_status"===i.colId),n.xp6(1),n.Q6J("ngIf","index_stt"===i.colId),n.xp6(1),n.Q6J("ngIf","logs"===i.colId),n.xp6(1),n.Q6J("ngIf","ticket_number"===i.colId))},directives:[K.O5,K.RF,K.n9,K.ED,_n.Zp,_n.rh,K.sg],pipes:[K.uU],styles:[".col-label{margin-bottom:.5rem}.col-label .vl{font-weight:700;padding-left:10px}.show-logs .ant-modal-body{padding:10px;max-height:500px;overflow:visible}.show-logs .log-item{border-bottom:1px solid #d9d9d9;box-shadow:0 2px #00000004;transition:all .3s cubic-bezier(.645,.045,.355,1);padding:10px;margin-bottom:10px}.show-logs .log-item .date .value{font-weight:700}.show-logs .log-item .act{margin-left:10px}.show-logs .log-item .act .value{font-weight:700;color:var(--red)}.show-logs .log-item:last-child{border-bottom:unset}\n"],encapsulation:2}),t})();class Ze{static refreshRow(r,e,i={}){(e=Array.isArray(e)?e:[e]).forEach(a=>a.data=Object.assign(a.data,i)),r.redrawRows({rowNodes:e})}static getColDef(r,e,i){let a=r.getColumnDef(e);(0,D.Ft)(a)||i(a)}static fixColDef(r,e){Ze.getColDef(e,"index_stt",i=>{i.cellRenderer=Qs}),Ze.getColDef(e,"logs",i=>{i.cellRenderer=Qs}),Ze.getColDef(e,"partner",i=>{i.cellRenderer=a=>(0,D.gS)(a.value)?"":a.value.id}),Ze.getColDef(e,"is_note",i=>{i.cellRenderer=a=>Ze.cellCheckView(a.value)}),Ze.getColDef(e,"is_close",i=>{i.cellRenderer=a=>Ze.cellCheckView(3===a.value?3:null)}),Ze.getColDef(e,"is_upfile",i=>{i.cellRenderer=a=>Ze.cellCheckView(a.value)}),Ze.getColDef(e,"send_status",i=>{i.cellRenderer=Qs}),Ze.getColDef(e,"ticket_hid",i=>{i.cellRenderer=a=>Ze.cellTicketNumber(r,a)}),Ze.getColDef(e,"ticket_number",i=>{i.cellRenderer=a=>Ze.cellTicketNumber(r,a)}),Ze.getColDef(e,"od_team",i=>{i.valueGetter=a=>Ze.fixView(a.data.od_team)}),Ze.getColDef(e,"od_category",i=>{i.valueGetter=a=>Ze.fixView(a.data.od_category,"name")}),Ze.getColDef(e,"od_assign",i=>{i.valueGetter=a=>Ze.fixView(a.data.od_assign)}),Ze.getColDef(e,"od_topic",i=>{i.valueGetter=a=>Ze.fixView(a.data.od_topic)}),Ze.getColDef(e,"od_image",i=>{i.valueGetter=a=>Ze.fixViewImg(a.data.od_image)}),Ze.getColDef(e,"is_greport",i=>{i.cellRenderer=a=>(0,D.oA)(a.value)?'<i class="text-success">\u0110\xe3 g\u1eedi</i>':'<i class="text-danger">Ch\u01b0a g\u1eedi</i>'}),Ze.getColDef(e,"product_id",i=>{i.valueGetter=a=>(0,D.Ft)(a.data.product)?a.data.product_id:a.data.product.name}),Ze.getColDef(e,"channel_status",i=>i.valueGetter=a=>{let o=(0,D.Ft)(a.data.first_chanel)?(a.data.chanels||[])[0]:a.data.first_chanel;return(0,D.Ft)(o)?null:o.value}),Ze.getColDef(e,"soft_name",i=>{i.valueGetter=a=>(0,D.Ft)(a.data.software)?null:a.data.software.value})}static fixView(r,e="display_name"){return(0,D.Ft)(r)?void 0:r[e]}static fixViewImg(r,e=".png"){if(!(0,D.G5)(r))return Object.keys(r).filter(i=>!(0,D.EU)(i)).map(i=>`${i.replace(e,"")}${e}`).join("; ")}static cellTicketNumber(r,e){if((0,D.EU)((e=e||{}).value))return"";if((0,D.EU)(e.data.ticket_number))return e.value;let i=r.od_config.view_ticket;return i=D.K$.replaceQuery(i,{ticketNumber:e.data.ticket_number}),`<a href="${i}" target="_blank">${e.value}</a>`}static cellCheckView(r){return(0,D.Ft)(r)||!1===r?'<i class="fal fa-exclamation-circle"></i>':'<i class="fal fa-check"></i>'}static showOnlyColumns(r,e,i){let a=i.grid_fields;if(e=e||r.getAllColumns().map(o=>o.getColId()),!(0,D.gS)(a)){let o=Object.keys(a);Ze.visibleColumns(r,e,o,!0),r.moveColumns(o.sort((s,l)=>a[s].index-a[l].index).map(s=>{let l=r.getColumn(s);return(0,D.Ft)(l)?console.warn(`Loi col is null -> ${s}`):l.setActualWidth(a[s].width),l}),1)}}static visibleColumns(r,e,i,a=!0,o=!0){o&&r.setColumnsVisible(e,!1),r.setColumnsVisible(i,a)}static exportExcel(r,e,i){let a=e.getAllDisplayedColumns().map(o=>({data:{value:o.getColId(),type:"String"}}));i=Object.assign({fileName:"ReportKPIV2",exportMode:"xlsx",sheetName:"DATA",headerRowHeight:0,customHeader:[a]},i),r.exportDataAsExcel(i)}}var Ir=oe(2423),rr=oe(857);function nI(t,r){1&t&&n._UZ(0,"i",15)}function rI(t,r){1&t&&n._UZ(0,"i",16)}let iI=(()=>{class t{constructor(e,i,a,o){this.userCtrl=e,this.shared=i,this.fb=a,this.modal=o,this.isWaitGet=!1,this.userDetail=void 0}ngOnInit(){this.userDetail=this.userCtrl.read(),this.form=this.fb.group({email:[{value:this.userDetail.email,disabled:!0},ve.kI.required],token:[{value:this.userDetail.access_token,disabled:!0},ve.kI.required],password:[void 0,ve.kI.required]})}nzOnCancel(){this.modal.destroy({})}nzOnOk(){if(this.form.invalid)return void this.shared.alert.warning("Vui l\xf2ng nh\u1eadp \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin.");this.isWaitGet=!0;let e=this.form.getRawValue();try{D.DS.encode(e.password)}catch(i){this.shared.alert.error(`L\u1ed7i m\xe3 h\xf3a m\u1eadt kh\u1ea9u: ${i}`)}this.userCtrl.loginTs24(e).subscribe({next:i=>{this.isWaitGet=!1,this.modal.destroy({data:i})},error:i=>{this.isWaitGet=!1,console.log("\u0110\u0103ng nh\u1eadp TS24pro l\u1ed7i. "+i)}})}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(rr.a),n.Y36(li.W),n.Y36(ve.qu),n.Y36(Qn.Lf))},t.\u0275cmp=n.Xpm({type:t,selectors:[["cy-login-ts24"]],decls:35,vars:3,consts:[[1,"get-ticket-web",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-12"],[1,"form-group"],["for","email_ts24"],[1,"required"],["nz-input","","placeholder","Nh\u1eadp e-mail","id","email_ts24","formControlName","email","type","email","required","",1,"note"],["for","token"],["nz-input","","placeholder","Nh\u1eadp token","id","token","formControlName","token","required","",1,"note"],["for","password"],["nz-input","","placeholder","Nh\u1eadp m\u1eadt kh\u1ea9u TS24","id","password","formControlName","password","type","password","required","",1,"note"],["nz-button","","type","submit",2,"width","unset"],["class","fa-regular fa-arrows-spin fa-spin",4,"ngIf"],["class","fa-regular fa-floppy-disks",4,"ngIf"],["nz-button","","type","button",3,"click"],[1,"fa-regular","fa-arrows-spin","fa-spin"],[1,"fa-regular","fa-floppy-disks"]],template:function(e,i){1&e&&(n.TgZ(0,"form",0),n.NdJ("ngSubmit",function(){return i.nzOnOk()}),n.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),n._uU(5,"E-mail "),n.TgZ(6,"span",5),n._uU(7,"(*)"),n.qZA(),n._uU(8,": "),n.qZA(),n._UZ(9,"input",6),n.qZA()(),n.TgZ(10,"div",2)(11,"div",3)(12,"label",7),n._uU(13,"Token "),n.TgZ(14,"span",5),n._uU(15,"(*)"),n.qZA(),n._uU(16,": "),n.qZA(),n._UZ(17,"input",8),n.qZA()(),n.TgZ(18,"div",2)(19,"div",3)(20,"label",9),n._uU(21,"MK TS24 "),n.TgZ(22,"span",5),n._uU(23,"(*)"),n.qZA(),n._uU(24,": "),n.qZA(),n._UZ(25,"input",10),n.qZA()()(),n.TgZ(26,"div",1)(27,"div",2)(28,"button",11),n.YNc(29,nI,1,0,"i",12),n.YNc(30,rI,1,0,"i",13),n.TgZ(31,"i"),n._uU(32,"L\u1ea5y m\xe3 k\xedch ho\u1ea1t"),n.qZA()(),n.TgZ(33,"button",14),n.NdJ("click",function(){return i.nzOnCancel()}),n._uU(34,"\u0110\xf3ng"),n.qZA()()()()),2&e&&(n.Q6J("formGroup",i.form),n.xp6(29),n.Q6J("ngIf",i.isWaitGet),n.xp6(1),n.Q6J("ngIf",!i.isWaitGet))},directives:[ve._Y,ve.JL,ve.sg,_n.Zp,ve.Fj,ve.JJ,ve.u,ve.Q7,It.ix,Mr.dQ,Mn.w,K.O5],styles:[""]}),t})();var dd=oe(1963);let aI=(()=>{class t{constructor(e){this.srv=e}get cuser(){return this.srv.inj.get(rr.a)}getUrlApi(e){let i=this.cuser.read().id;return this.srv.cfig().read().fixUrl(`ag-grid/${i}/${e}`)}getByAgCode(e,i,a){let o=this.getUrlApi(`get-by-code/${e}/${i}`);return this.srv.client().sendGet(o)}getByAgAll(e){let i=this.getUrlApi(`get-ag-all/${e}`);return this.srv.client().sendGet(i).pipe((0,zt.w)(a=>(this.cuser.read().assignAgType(e,a).saveBy(this.srv.shared()),(0,Ke.of)(a))))}getByAgType(e){let i=this.getUrlApi(`get-by-type/${e}`);return this.srv.client().sendGet(i).pipe((0,Jn.b)(a=>(0,Ke.of)(this.cuser.read().assignAgType(e,a).saveBy(this.srv.shared()).getAgType(e))))}createOrUpdate(e){let i=this.getUrlApi("create-or-update");return this.srv.client().sendPost(i,e).pipe((0,Jn.b)(a=>{let o=this.cuser.read();o.grid_config[a.grid_type].grid_field[a.grid_code]=a,o.saveBy(this.srv.shared())}))}deleteField(e,i){let a=this.getUrlApi(`delete-by-code/${e}/${i}`);return this.srv.client().sendDelete(a)}getColumnAgFromCache(e,i=!0){return new Nt.y(a=>{let o=this.cuser.read().getAgType(e);(0,D.gS)(o)?i?this.getByAgType(e).subscribe(s=>a.next(s),s=>a.error(s),()=>a.complete()):a.error({msg:` Kh\xf4ng t\xecm th\u1ea5y [${e}]`}):(a.next(o),a.complete())})}}return t.\u0275fac=function(e){return new(e||t)(n.LFG(dd.X))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var oI=oe(3046);let qs=(()=>{class t extends oI.P{constructor(){super(...arguments),this.path="tickets"}get user(){return this.srv.get(rr.a)}get shared(){return this.srv.shared()}findByCreateOn(e,i){return this.findAll({create_min:e,create_max:i,user_id:this.user.read().id})}findAll(e,i=!0){return e=Object.assign({user_id:this.user.read().id},Object.assign({},e)),!0===i&&Object.keys(e).forEach(a=>{(0,D.Ft)(e[a])&&delete e[a]}),super.findAll(e)}loadCatalogs(e){let i=e?`,odoo&user_id=${this.user.read().id}`:"",a=this.fixUrl(`catalogs?include=all${i}`);return this.srv.client().sendGet(a).pipe((0,zt.w)(o=>(this.shared.catalogs=Object.assign(Object.assign({},this.shared.catalogs),o),(0,Ke.of)(o))),(0,Do.K)(o=>(0,Pr._)(o)))}addLog(e,i){let a=this.fixUrl(`${this.path}/${e}/logs/add`);return this.srv.client().sendPost(a,i,{alert:!1}).pipe((0,zt.w)(o=>(0,Ke.of)(o.logs)))}saveImage(e,i){let a=this.fixUrl(`${this.path}/${e}/images/update`);return this.srv.client().sendPost(a,i,{alert:!1})}getUrlApiOfUser(e){return`${this.srv.cfig().read().api_url}/${e}`}uploadFile(e,i){let a=this.getUrlApiOfUser(`file/${e}/upload`);return this.srv.client().sendPost(a,i)}}return t.\u0275fac=function(){let r;return function(i){return(r||(r=n.n5z(t)))(i||t)}}(),t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Xs=oe(6431);let bi=(()=>{class t{constructor(e){this.srv=e}get userCtrl(){return this.srv.inj.get(rr.a)}getUrlApi(e){let i=this.userCtrl.read().id;return this.srv.cfig().read().fixUrl(`odrest/${i}/${e}`)}odooCfig(){return this.srv.cfig().read().api_ticket}odooUser(){return this.userCtrl.read().od_user}get client(){return this.srv.client()}sendGet(e,i,a){return a=Object.assign({alert:!0},a,{params:i}),this.client.send("GET",e,a)}sendPost(e,i,a){return a=Object.assign({alert:!0},a,{body:i}),this.client.send("POST",e,a)}fixPage(e){return Object.assign({size:80},e)}}return t.\u0275fac=function(e){return new(e||t)(n.LFG(dd.X))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),sI=(()=>{class t extends bi{nameSearch(e){return this.sendGet(this.getUrlApi(`find-user/${e}`))}}return t.\u0275fac=function(){let r;return function(i){return(r||(r=n.n5z(t)))(i||t)}}(),t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),lI=(()=>{class t extends bi{searchRead(e,i){let a=this.getUrlApi("get-partner"),o=Object.assign(Object.assign({},e),this.fixPage(i));return this.sendGet(a,o)}getDetail(e){return this.sendGet(this.getUrlApi(`get-partner-byid/${e}`))}createOne(e){let i=this.getUrlApi("create-partner");return this.sendPost(i,e,{alert:!1})}}return t.\u0275fac=function(){let r;return function(i){return(r||(r=n.n5z(t)))(i||t)}}(),t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),cI=(()=>{class t extends bi{searchRead(e,i){let a=this.getUrlApi("get-ticket"),o=Object.assign(Object.assign({},e),this.fixPage(i));return this.sendGet(a,o)}getTicketOdooById(e){return this.sendGet(this.getUrlApi(`get-ticket-web?id=${e}`))}getTicketOdooByLink(e){return this.sendGet(this.getUrlApi(`get-ticket-web?link=${e}`))}getDetail(e){return this.sendGet(this.getUrlApi(`get-ticket-byid/${e}`))}newTicket(e){return this.createAll(e,"create_ticket")}updateTicket(e){return this.createAll(e,"update_ticket")}addNote(e){return this.createAll(e,"add_note")}getNoteDetail(e){return(0,Ke.of)({id:e})}closeTicket(e){return this.createAll(e,"close_ticket")}createAll(e,i,a){let o=this.getUrlApi(`send/${i}/${e}`);return this.sendPost(o,a,{alert:!1})}}return t.\u0275fac=function(){let r;return function(i){return(r||(r=n.n5z(t)))(i||t)}}(),t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),uI=(()=>{class t extends bi{searchRead(e,i){return this.sendGet(this.getUrlApi("get-team"))}nameSearch(e){return bo.E}}return t.\u0275fac=function(){let r;return function(i){return(r||(r=n.n5z(t)))(i||t)}}(),t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),dI=(()=>{class t extends bi{searchRead(e,i){return this.sendGet(this.getUrlApi("get-topic"))}}return t.\u0275fac=function(){let r;return function(i){return(r||(r=n.n5z(t)))(i||t)}}(),t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),fI=(()=>{class t extends bi{getCategories(e,i){return this.sendGet(this.getUrlApi("get-category"))}getStages(){return this.sendGet(this.getUrlApi("get-stage"))}loadAllInOne(e){return this.sendGet(this.getUrlApi(`get-all/${e}`)).pipe((0,Jn.b)(i=>{this.srv.shared().catalogs=Object.assign({},this.srv.shared().catalogs,i)}))}}return t.\u0275fac=function(){let r;return function(i){return(r||(r=n.n5z(t)))(i||t)}}(),t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Ks=(()=>{class t{constructor(e,i,a,o,s,l){this.user=e,this.partner=i,this.ticket=a,this.team=o,this.topic=s,this.cate=l}}return t.\u0275fac=function(e){return new(e||t)(n.LFG(sI),n.LFG(lI),n.LFG(cI),n.LFG(uI),n.LFG(dI),n.LFG(fI))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),pI=(()=>{class t{constructor(e,i,a){this.userSys=e,this.odoo=i,this.ticket=a}NOTICKET(e,i){return(0,Pr._)({code:"NO_TICKET",message:`<b>${i}</b> > <b>Ticket ch\u01b0a \u0111\u01b0\u1ee3c t\u1ea1o</b>.`})}ERR_SRV(e){return(0,Pr._)({message:"X\u1ea3y ra l\u1ed7i c\u1eadp nh\u1eadt th\xf4ng tin ticket l\xean m\xe1y ch\u1ee7.",code:"ERR_SRV",detail:e})}checkValidTicket(e,i){let a=(i=i||["partner","od_team","od_category","od_assign"]).filter(o=>D.K$.jsonEmpty(e[o]));return 0===a.length?void 0:{code:"ERR_DATA",message:`X\u1ea3y ra l\u1ed7i > D\u1eef li\u1ec7u ch\u01b0a \u0111\xfang \u1edf field ${a.join("|")}`,detail:a}}createTicket(e){return this.odoo.ticket.newTicket(e)}updateTicket(e){return this.odoo.ticket.updateTicket(e)}addNote(e){return this.odoo.ticket.addNote(e)}uploadFile(e,i){}updateStage(e,i){let a=e.ticket_id;return(0,D.Ft)(i)||(0,D.EU)(i.id)?(0,Pr._)({code:"NO_STAGE",message:`[${a}] Kh\xf4ng x\xe1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c [tr\u1ea1ng th\xe1i]`}):this.odoo.ticket.closeTicket(a)}allInOne(e,i,a){a=Object.assign({alert:!1},a),e=(0,D.EU)(e)||"all"===e?null:e;let o=(0,D.EU)(e)?["create_ticket","add_note","add_note_with_img","close_ticket"]:e.split(",");return this.odoo.ticket.createAll(i,o.join(","),a)}}return t.\u0275fac=function(e){return new(e||t)(n.LFG(rr.a),n.LFG(Ks),n.LFG(qs))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function ir(t,r){return!!(0,D.Ft)(t)||!(0,D.Ft)(t.get(r))&&t.get(r)._pendingDirty}function fd(t,r,e){r=r||!1,e=Object.assign({},e);const i=[];(0,D.EU)(t.email)||i.push(`${t.email}`);const a=e.subject||_o(t);return null!==a&&i.push(a),(0,D.EU)(t.tax_code)||i.push(`- M\xe3 s\u1ed1 thu\u1ebf / M\xe3 \u0111\u01a1n v\u1ecb: ${t.tax_code}`),(0,D.EU)(t.customer_name)||i.push(`- T\xean kh\xe1ch h\xe0ng: ${t.customer_name}`),(0,D.EU)(t.email)||i.push(`- Email: ${t.email}`),i.push(r?mo(t).join("\n"):e.body||t.body||mo(t).join("\n")),i.push("--------------------------------------------"),i.push(r?go(t).join("\n"):e.note||t.note||go(t).join("\n")),i.join("\n")}function mo(t,r){const e=[];let i=t.edit_ticket||!1;if(ir(r,"phone")&&!(0,D.EU)(t.phone)&&(e.push(`- S\u1ed1 \u0111i\u1ec7n tho\u1ea1i li\xean h\u1ec7: ${t.phone}`),i=!0),ir(r,"content_required")&&!(0,D.EU)(t.content_required)){let a=t.content_required,o=(0,D.EU)(t.soft_name)?"":`${t.soft_name} - `,s=(0,D.Ft)(t.support_help)||(0,D.EU)(t.support_help.support)?"":` - ${t.support_help.support}`;e.push(`- N\u1ed9i dung c\u1ea7n h\u1ed7 tr\u1ee3: ${o}${a}${s}`),i=!0}return ir(r,"full_name")&&!(0,D.EU)(t.full_name)&&(e.push(`- Nh\xe2n vi\xean g\u1eedi th\xf4ng tin: ${t.full_name}`),i=!0),ir(r,"reception_time")&&!(0,D.EU)(t.reception_time)&&(e.push(`- Th\u1eddi gian ti\u1ebfp nh\u1eadn: ${t.reception_time}`),i=!0),t.edit_ticket=i,e}function go(t,r){const e=[];let i=t.edit_ticket||!1;return ir(r,"full_name")&&!(0,D.EU)(t.full_name)&&(e.push(`- H\u1ecd t\xean: ${t.full_name}`),i=!0),ir(r,"support_help")&&!(0,D.Ft)(t.support_help)&&(e.push(`- H\xecnh th\u1ee9c h\u1ed7 tr\u1ee3: ${t.support_help.value}`),i=!0),ir(r,"group_help")&&!(0,D.Ft)(t.group_help)&&(e.push(`- Nh\xf3m h\u1ed7 tr\u1ee3: ${t.group_help.title}`),i=!0),ir(r,"content_help")&&!(0,D.EU)(t.content_help)&&(e.push(`- N\u1ed9i dung \u0111\xe3 h\u1ed7 tr\u1ee3: ${t.content_help} `),i=!0),ir(r,"complete_time")&&!(0,D.EU)(t.complete_time)&&(e.push(`- Th\u1eddi gian ho\xe0n t\u1ea5t: ${t.complete_time}`),i=!0),t.edit_ticket=i,e}function _o(t){if(!(0,D.EU)(t.tax_code)&&!(0,D.G5)(t.chanels))return`[HT-${t.chanels[0].code}]-${t.user_code}-${t.tax_code}-${t.ticket_on}`}var hI=oe(913);let mI=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.Xpm({type:t,selectors:[["cy-ticket-web"]],decls:2,vars:0,template:function(e,i){1&e&&(n.TgZ(0,"p"),n._uU(1,"ticket-web works!"),n.qZA())},styles:[""]}),t})();var pd=oe(3063),rn=(()=>{return(t=rn||(rn={}))[t.alpine=0]="alpine",t[t.material=1]="material",t[t.alpine_dark=2]="alpine_dark",t[t.balham=3]="balham",t[t.balham_dark=4]="balham_dark",t[t.fresh=5]="fresh",t[t.blue=6]="blue",t[t.bootstrap=7]="bootstrap",rn;var t})();function hd(t){switch(t){case rn.alpine:return"ag-theme-alpine";case rn.balham:return"ag-theme-balham";case rn.alpine_dark:return"ag-theme-alpine-dark";case rn.balham_dark:return"ag-theme-balham-dark";case rn.material:return"ag-theme-material";case rn.fresh:return"ag-theme-fresh";case rn.blue:return"ag-theme-blue";case rn.bootstrap:return"ag-theme-bootstrap";default:return"ag-theme-alpine"}}function g(t,r,e,i){var s,a=arguments.length,o=a<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,r,e,i);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(o=(a<3?s(o):a>3?s(r,e,o):s(r,e))||o);return a>3&&o&&Object.defineProperty(r,e,o),o}function _(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)}var tl,ni=oe(8267);let Y=tl=class{hasChildColumns(){return!(!(this.childColumns&&this.childColumns.length>0)||1===this.childColumns.length&&this.childColumns.first===this)}toColDef(){let r=this.createColDefFromGridColumn(this);return this.hasChildColumns()&&(r.children=this.getChildColDefs(this.childColumns)),r}getChildColDefs(r){return r.filter(e=>!e.hasChildColumns()).map(e=>e.toColDef())}createColDefFromGridColumn(r){return function gI(t,r){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&r.indexOf(i)<0&&(e[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(t);a<i.length;a++)r.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(t,i[a])&&(e[i[a]]=t[i[a]])}return e}(r,["childColumns"])}};Y.\u0275fac=function(r){return new(r||Y)},Y.\u0275cmp=n.Xpm({type:Y,selectors:[["ag-grid-column"]],contentQueries:function(r,e,i){if(1&r&&n.Suo(i,tl,4),2&r){let a;n.iGM(a=n.CRH())&&(e.childColumns=a)}},inputs:{filterFramework:"filterFramework",filterParams:"filterParams",floatingFilterComponent:"floatingFilterComponent",floatingFilterComponentParams:"floatingFilterComponentParams",floatingFilterComponentFramework:"floatingFilterComponentFramework",floatingFilterFramework:"floatingFilterFramework",filter:"filter",headerName:"headerName",headerValueGetter:"headerValueGetter",headerTooltip:"headerTooltip",headerClass:"headerClass",suppressHeaderKeyboardEvent:"suppressHeaderKeyboardEvent",columnGroupShow:"columnGroupShow",toolPanelClass:"toolPanelClass",suppressColumnsToolPanel:"suppressColumnsToolPanel",suppressFiltersToolPanel:"suppressFiltersToolPanel",tooltipComponent:"tooltipComponent",tooltipComponentFramework:"tooltipComponentFramework",tooltipComponentParams:"tooltipComponentParams",children:"children",groupId:"groupId",openByDefault:"openByDefault",marryChildren:"marryChildren",headerGroupComponent:"headerGroupComponent",headerGroupComponentFramework:"headerGroupComponentFramework",headerGroupComponentParams:"headerGroupComponentParams",colId:"colId",field:"field",type:"type",valueGetter:"valueGetter",valueFormatter:"valueFormatter",refData:"refData",keyCreator:"keyCreator",equals:"equals",tooltipField:"tooltipField",tooltipValueGetter:"tooltipValueGetter",checkboxSelection:"checkboxSelection",icons:"icons",suppressNavigable:"suppressNavigable",suppressKeyboardEvent:"suppressKeyboardEvent",suppressPaste:"suppressPaste",suppressFillHandle:"suppressFillHandle",hide:"hide",initialHide:"initialHide",lockVisible:"lockVisible",lockPosition:"lockPosition",suppressMovable:"suppressMovable",editable:"editable",valueSetter:"valueSetter",valueParser:"valueParser",cellEditor:"cellEditor",cellEditorFramework:"cellEditorFramework",cellEditorParams:"cellEditorParams",cellEditorSelector:"cellEditorSelector",singleClickEdit:"singleClickEdit",newValueHandler:"newValueHandler",cellEditorPopup:"cellEditorPopup",cellEditorPopupPosition:"cellEditorPopupPosition",onCellValueChanged:"onCellValueChanged",onCellClicked:"onCellClicked",onCellDoubleClicked:"onCellDoubleClicked",onCellContextMenu:"onCellContextMenu",getQuickFilterText:"getQuickFilterText",filterValueGetter:"filterValueGetter",floatingFilter:"floatingFilter",headerComponent:"headerComponent",headerComponentFramework:"headerComponentFramework",headerComponentParams:"headerComponentParams",menuTabs:"menuTabs",columnsMenuParams:"columnsMenuParams",suppressMenu:"suppressMenu",headerCheckboxSelection:"headerCheckboxSelection",headerCheckboxSelectionFilteredOnly:"headerCheckboxSelectionFilteredOnly",chartDataType:"chartDataType",pinned:"pinned",initialPinned:"initialPinned",lockPinned:"lockPinned",pinnedRowCellRenderer:"pinnedRowCellRenderer",pinnedRowCellRendererFramework:"pinnedRowCellRendererFramework",pinnedRowCellRendererParams:"pinnedRowCellRendererParams",pinnedRowValueFormatter:"pinnedRowValueFormatter",pivot:"pivot",initialPivot:"initialPivot",pivotIndex:"pivotIndex",initialPivotIndex:"initialPivotIndex",pivotComparator:"pivotComparator",enablePivot:"enablePivot",cellStyle:"cellStyle",cellClass:"cellClass",cellClassRules:"cellClassRules",cellRenderer:"cellRenderer",cellRendererFramework:"cellRendererFramework",cellRendererParams:"cellRendererParams",cellRendererSelector:"cellRendererSelector",autoHeight:"autoHeight",wrapText:"wrapText",enableCellChangeFlash:"enableCellChangeFlash",suppressCellFlash:"suppressCellFlash",rowDrag:"rowDrag",rowDragText:"rowDragText",dndSource:"dndSource",dndSourceOnRowDrag:"dndSourceOnRowDrag",rowGroup:"rowGroup",initialRowGroup:"initialRowGroup",rowGroupIndex:"rowGroupIndex",initialRowGroupIndex:"initialRowGroupIndex",enableRowGroup:"enableRowGroup",enableValue:"enableValue",aggFunc:"aggFunc",initialAggFunc:"initialAggFunc",allowedAggFuncs:"allowedAggFuncs",showRowGroup:"showRowGroup",sortable:"sortable",sort:"sort",initialSort:"initialSort",sortIndex:"sortIndex",initialSortIndex:"initialSortIndex",sortingOrder:"sortingOrder",comparator:"comparator",unSortIcon:"unSortIcon",sortedAt:"sortedAt",colSpan:"colSpan",rowSpan:"rowSpan",width:"width",initialWidth:"initialWidth",minWidth:"minWidth",maxWidth:"maxWidth",flex:"flex",initialFlex:"initialFlex",resizable:"resizable",suppressSizeToFit:"suppressSizeToFit",suppressAutoSize:"suppressAutoSize"},decls:0,vars:0,template:function(r,e){},encapsulation:2}),g([(0,n.AcB)(tl),_("design:type",n.n_E)],Y.prototype,"childColumns",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"filterFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"filterParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"floatingFilterComponent",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"floatingFilterComponentParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"floatingFilterComponentFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"floatingFilterFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"filter",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"headerName",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"headerValueGetter",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"headerTooltip",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"headerClass",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"suppressHeaderKeyboardEvent",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"columnGroupShow",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"toolPanelClass",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"suppressColumnsToolPanel",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"suppressFiltersToolPanel",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"tooltipComponent",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"tooltipComponentFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"tooltipComponentParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"children",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"groupId",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"openByDefault",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"marryChildren",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"headerGroupComponent",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"headerGroupComponentFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"headerGroupComponentParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"colId",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"field",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"type",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"valueGetter",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"valueFormatter",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"refData",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"keyCreator",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"equals",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"tooltipField",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"tooltipValueGetter",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"checkboxSelection",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"icons",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"suppressNavigable",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"suppressKeyboardEvent",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"suppressPaste",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"suppressFillHandle",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"hide",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"initialHide",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"lockVisible",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"lockPosition",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"suppressMovable",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"editable",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"valueSetter",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"valueParser",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"cellEditor",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"cellEditorFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"cellEditorParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"cellEditorSelector",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"singleClickEdit",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"newValueHandler",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"cellEditorPopup",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"cellEditorPopupPosition",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"onCellValueChanged",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"onCellClicked",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"onCellDoubleClicked",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"onCellContextMenu",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"getQuickFilterText",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"filterValueGetter",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"floatingFilter",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"headerComponent",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"headerComponentFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"headerComponentParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"menuTabs",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"columnsMenuParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"suppressMenu",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"headerCheckboxSelection",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"headerCheckboxSelectionFilteredOnly",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"chartDataType",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"pinned",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"initialPinned",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"lockPinned",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"pinnedRowCellRenderer",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"pinnedRowCellRendererFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"pinnedRowCellRendererParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"pinnedRowValueFormatter",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"pivot",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"initialPivot",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"pivotIndex",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"initialPivotIndex",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"pivotComparator",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"enablePivot",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"cellStyle",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"cellClass",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"cellClassRules",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"cellRenderer",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"cellRendererFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"cellRendererParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"cellRendererSelector",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"autoHeight",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"wrapText",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"enableCellChangeFlash",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"suppressCellFlash",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"rowDrag",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"rowDragText",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"dndSource",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"dndSourceOnRowDrag",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"rowGroup",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"initialRowGroup",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"rowGroupIndex",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"initialRowGroupIndex",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"enableRowGroup",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"enableValue",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"aggFunc",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"initialAggFunc",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"allowedAggFuncs",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"showRowGroup",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"sortable",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"sort",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"initialSort",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"sortIndex",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"initialSortIndex",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"sortingOrder",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"comparator",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"unSortIcon",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"sortedAt",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"colSpan",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"rowSpan",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"width",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"initialWidth",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"minWidth",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"maxWidth",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"flex",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"initialFlex",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"resizable",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"suppressSizeToFit",void 0),g([(0,n.IIB)(),_("design:type",Object)],Y.prototype,"suppressAutoSize",void 0);let nl=(()=>{let t=class extends ni.vA3{constructor(e){super(),this._ngZone=e}setEmitterUsedCallback(e){this.isEmitterUsed=e}setTimeout(e,i){this._ngZone?this._ngZone.runOutsideAngular(()=>{window.setTimeout(()=>{e()},i)}):window.setTimeout(()=>{e()},i)}setInterval(e,i){return new ni.j_S(a=>{this._ngZone?this._ngZone.runOutsideAngular(()=>{a(window.setInterval(()=>{e()},i))}):a(window.setInterval(()=>{e()},i))})}addEventListener(e,i,a,o){this.isOutsideAngular(i)&&this._ngZone?this._ngZone.runOutsideAngular(()=>{e.addEventListener(i,a,o)}):e.addEventListener(i,a,o)}dispatchEvent(e,i,a=!1){this.isOutsideAngular(e)?this._ngZone?this._ngZone.runOutsideAngular(i):i():(this.isEmitterUsed(e)||a)&&(!n.R0b.isInAngularZone()&&this._ngZone?this._ngZone.run(i):i())}isFrameworkComponent(e){if(!e)return!1;const i=e.prototype;return i&&"agInit"in i}};return t.\u0275fac=function(e){return new(e||t)(n.LFG(n.R0b))},t.\u0275prov=n.Yz7({token:t,factory:function(r){return t.\u0275fac(r)}}),t=g([_("design:paramtypes",[n.R0b])],t),t})(),rl=(()=>{let t=class extends ni.Nk3{setViewContainerRef(e){this.viewContainerRef=e}setComponentFactoryResolver(e){this.componentFactoryResolver=e}createWrapper(e){let i=this,o=new class a extends class xI{init(r){this._params=r,this._componentRef=this.createComponent(),this._agAwareComponent=this._componentRef.instance,this._frameworkComponentInstance=this._componentRef.instance,this._eGui=this._componentRef.location.nativeElement,this._agAwareComponent.agInit(this._params)}getGui(){return this._eGui}destroy(){this._frameworkComponentInstance&&"function"==typeof this._frameworkComponentInstance.destroy&&this._frameworkComponentInstance.destroy(),this._componentRef&&this._componentRef.destroy()}getFrameworkComponentInstance(){return this._frameworkComponentInstance}}{init(l){super.init(l),this._componentRef.changeDetectorRef.detectChanges()}createComponent(){return i.createComponent(e)}hasMethod(l){return null!=o.getFrameworkComponentInstance()[l]}callMethod(l,c){const u=this.getFrameworkComponentInstance();return o.getFrameworkComponentInstance()[l].apply(u,c)}addMethod(l,c){o[l]=c}};return o}createComponent(e){let i=this.componentFactoryResolver.resolveComponentFactory(e);return this.viewContainerRef.createComponent(i)}};return t.\u0275fac=function(){let r;return function(i){return(r||(r=n.n5z(t)))(i||t)}}(),t.\u0275prov=n.Yz7({token:t,factory:function(r){return t.\u0275fac(r)}}),t})(),_d=(()=>{let t=class{constructor(e,i,a,o,s){this.viewContainerRef=i,this.angularFrameworkOverrides=a,this.frameworkComponentWrapper=o,this.componentFactoryResolver=s,this._initialised=!1,this._destroyed=!1,this._fullyReady=ni.j_S.resolve(!0),this.statusBar=void 0,this.sideBar=void 0,this.suppressContextMenu=void 0,this.preventDefaultOnContextMenu=void 0,this.allowContextMenuWithControlKey=void 0,this.suppressMenuHide=void 0,this.enableBrowserTooltips=void 0,this.tooltipShowDelay=void 0,this.tooltipHideDelay=void 0,this.tooltipMouseTrack=void 0,this.popupParent=void 0,this.copyHeadersToClipboard=void 0,this.copyGroupHeadersToClipboard=void 0,this.clipboardDelimiter=void 0,this.suppressCopyRowsToClipboard=void 0,this.suppressLastEmptyLineOnPaste=void 0,this.suppressClipboardPaste=void 0,this.suppressClipboardApi=void 0,this.columnDefs=void 0,this.defaultColDef=void 0,this.defaultColGroupDef=void 0,this.columnTypes=void 0,this.maintainColumnOrder=void 0,this.suppressFieldDotNotation=void 0,this.deltaColumnMode=void 0,this.applyColumnDefOrder=void 0,this.immutableColumns=void 0,this.suppressSetColumnStateEvents=void 0,this.suppressColumnStateEvents=void 0,this.colWidth=void 0,this.minColWidth=void 0,this.maxColWidth=void 0,this.headerHeight=void 0,this.groupHeaderHeight=void 0,this.floatingFiltersHeight=void 0,this.pivotHeaderHeight=void 0,this.pivotGroupHeaderHeight=void 0,this.allowDragFromColumnsToolPanel=void 0,this.suppressMovableColumns=void 0,this.suppressColumnMoveAnimation=void 0,this.suppressDragLeaveHidesColumns=void 0,this.colResizeDefault=void 0,this.suppressAutoSize=void 0,this.autoSizePadding=void 0,this.skipHeaderOnAutoSize=void 0,this.components=void 0,this.frameworkComponents=void 0,this.reactUi=void 0,this.suppressReactUi=void 0,this.editType=void 0,this.singleClickEdit=void 0,this.suppressClickEdit=void 0,this.readOnlyEdit=void 0,this.stopEditingWhenCellsLoseFocus=void 0,this.enterMovesDown=void 0,this.enterMovesDownAfterEdit=void 0,this.undoRedoCellEditing=void 0,this.undoRedoCellEditingLimit=void 0,this.stopEditingWhenGridLosesFocus=void 0,this.defaultCsvExportParams=void 0,this.suppressCsvExport=void 0,this.defaultExcelExportParams=void 0,this.suppressExcelExport=void 0,this.excelStyles=void 0,this.defaultExportParams=void 0,this.quickFilterText=void 0,this.cacheQuickFilter=void 0,this.excludeChildrenWhenTreeDataFiltering=void 0,this.enableCharts=void 0,this.chartThemes=void 0,this.customChartThemes=void 0,this.chartThemeOverrides=void 0,this.loadingCellRenderer=void 0,this.loadingCellRendererFramework=void 0,this.loadingCellRendererParams=void 0,this.loadingCellRendererSelector=void 0,this.localeText=void 0,this.masterDetail=void 0,this.keepDetailRows=void 0,this.keepDetailRowsCount=void 0,this.detailCellRenderer=void 0,this.detailCellRendererFramework=void 0,this.detailCellRendererParams=void 0,this.detailRowHeight=void 0,this.detailRowAutoHeight=void 0,this.context=void 0,this.alignedGrids=void 0,this.tabIndex=void 0,this.rowBuffer=void 0,this.valueCache=void 0,this.valueCacheNeverExpires=void 0,this.enableCellExpressions=void 0,this.suppressParentsInRowNodes=void 0,this.suppressTouch=void 0,this.suppressFocusAfterRefresh=void 0,this.suppressAsyncEvents=void 0,this.suppressBrowserResizeObserver=void 0,this.suppressPropertyNamesCheck=void 0,this.suppressChangeDetection=void 0,this.debug=void 0,this.overlayLoadingTemplate=void 0,this.loadingOverlayComponent=void 0,this.loadingOverlayComponentFramework=void 0,this.loadingOverlayComponentParams=void 0,this.suppressLoadingOverlay=void 0,this.overlayNoRowsTemplate=void 0,this.noRowsOverlayComponent=void 0,this.noRowsOverlayComponentFramework=void 0,this.noRowsOverlayComponentParams=void 0,this.suppressNoRowsOverlay=void 0,this.pagination=void 0,this.paginationPageSize=void 0,this.paginationAutoPageSize=void 0,this.paginateChildRows=void 0,this.suppressPaginationPanel=void 0,this.pivotMode=void 0,this.pivotPanelShow=void 0,this.pivotColumnGroupTotals=void 0,this.pivotRowTotals=void 0,this.pivotSuppressAutoColumn=void 0,this.suppressExpandablePivotGroups=void 0,this.functionsReadOnly=void 0,this.aggFuncs=void 0,this.suppressAggFuncInHeader=void 0,this.suppressAggAtRootLevel=void 0,this.aggregateOnlyChangedColumns=void 0,this.suppressAggFilteredOnly=void 0,this.animateRows=void 0,this.enableCellChangeFlash=void 0,this.cellFlashDelay=void 0,this.cellFadeDelay=void 0,this.domLayout=void 0,this.ensureDomOrder=void 0,this.enableRtl=void 0,this.suppressColumnVirtualisation=void 0,this.suppressMaxRenderedRowRestriction=void 0,this.suppressRowVirtualisation=void 0,this.rowDragManaged=void 0,this.suppressRowDrag=void 0,this.suppressMoveWhenRowDragging=void 0,this.rowDragEntireRow=void 0,this.rowDragMultiRow=void 0,this.fullWidthCellRenderer=void 0,this.fullWidthCellRendererFramework=void 0,this.fullWidthCellRendererParams=void 0,this.embedFullWidthRows=void 0,this.deprecatedEmbedFullWidthRows=void 0,this.groupDisplayType=void 0,this.groupDefaultExpanded=void 0,this.autoGroupColumnDef=void 0,this.groupMaintainOrder=void 0,this.groupSelectsChildren=void 0,this.groupIncludeFooter=void 0,this.groupIncludeTotalFooter=void 0,this.groupSuppressBlankHeader=void 0,this.groupSelectsFiltered=void 0,this.showOpenedGroup=void 0,this.groupRemoveSingleChildren=void 0,this.groupRemoveLowestSingleChildren=void 0,this.groupHideOpenParents=void 0,this.rowGroupPanelShow=void 0,this.groupRowRenderer=void 0,this.groupRowRendererFramework=void 0,this.groupRowRendererParams=void 0,this.suppressMakeColumnVisibleAfterUnGroup=void 0,this.treeData=void 0,this.groupRowInnerRenderer=void 0,this.groupRowInnerRendererFramework=void 0,this.groupMultiAutoColumn=void 0,this.groupUseEntireRow=void 0,this.groupSuppressAutoColumn=void 0,this.rememberGroupStateWhenNewData=void 0,this.pinnedTopRowData=void 0,this.pinnedBottomRowData=void 0,this.rowModelType=void 0,this.rowData=void 0,this.immutableData=void 0,this.asyncTransactionWaitMillis=void 0,this.suppressModelUpdateAfterUpdateTransaction=void 0,this.deltaRowDataMode=void 0,this.batchUpdateWaitMillis=void 0,this.datasource=void 0,this.cacheOverflowSize=void 0,this.infiniteInitialRowCount=void 0,this.serverSideStoreType=void 0,this.cacheBlockSize=void 0,this.maxBlocksInCache=void 0,this.maxConcurrentDatasourceRequests=void 0,this.blockLoadDebounceMillis=void 0,this.purgeClosedRowNodes=void 0,this.serverSideDatasource=void 0,this.serverSideSortingAlwaysResets=void 0,this.serverSideFilteringAlwaysResets=void 0,this.suppressEnterpriseResetOnNewColumns=void 0,this.viewportDatasource=void 0,this.viewportRowModelPageSize=void 0,this.viewportRowModelBufferSize=void 0,this.alwaysShowHorizontalScroll=void 0,this.alwaysShowVerticalScroll=void 0,this.debounceVerticalScrollbar=void 0,this.suppressHorizontalScroll=void 0,this.suppressScrollOnNewData=void 0,this.suppressScrollWhenPopupsAreOpen=void 0,this.suppressAnimationFrame=void 0,this.suppressMiddleClickScrolls=void 0,this.suppressPreventDefaultOnMouseWheel=void 0,this.scrollbarWidth=void 0,this.rowSelection=void 0,this.rowMultiSelectWithClick=void 0,this.suppressRowDeselection=void 0,this.suppressRowClickSelection=void 0,this.suppressCellSelection=void 0,this.suppressCellFocus=void 0,this.suppressMultiRangeSelection=void 0,this.enableCellTextSelection=void 0,this.enableRangeSelection=void 0,this.enableRangeHandle=void 0,this.enableFillHandle=void 0,this.fillHandleDirection=void 0,this.suppressClearOnFillReduction=void 0,this.sortingOrder=void 0,this.accentedSort=void 0,this.unSortIcon=void 0,this.suppressMultiSort=void 0,this.multiSortKey=void 0,this.suppressMaintainUnsortedOrder=void 0,this.icons=void 0,this.rowHeight=void 0,this.rowStyle=void 0,this.rowClass=void 0,this.rowClassRules=void 0,this.suppressRowHoverHighlight=void 0,this.suppressRowTransform=void 0,this.columnHoverHighlight=void 0,this.deltaSort=void 0,this.treeDataDisplayType=void 0,this.angularCompileRows=void 0,this.angularCompileFilters=void 0,this.functionsPassive=void 0,this.enableGroupEdit=void 0,this.getContextMenuItems=void 0,this.getMainMenuItems=void 0,this.postProcessPopup=void 0,this.processCellForClipboard=void 0,this.processHeaderForClipboard=void 0,this.processGroupHeaderForClipboard=void 0,this.processCellFromClipboard=void 0,this.sendToClipboard=void 0,this.processDataFromClipboard=void 0,this.isExternalFilterPresent=void 0,this.doesExternalFilterPass=void 0,this.getChartToolbarItems=void 0,this.createChartContainer=void 0,this.navigateToNextHeader=void 0,this.tabToNextHeader=void 0,this.navigateToNextCell=void 0,this.tabToNextCell=void 0,this.suppressKeyboardEvent=void 0,this.localeTextFunc=void 0,this.getDocument=void 0,this.paginationNumberFormatter=void 0,this.groupRowAggNodes=void 0,this.isGroupOpenByDefault=void 0,this.defaultGroupOrderComparator=void 0,this.processSecondaryColDef=void 0,this.processSecondaryColGroupDef=void 0,this.getDataPath=void 0,this.defaultGroupSortComparator=void 0,this.getChildCount=void 0,this.getServerSideStoreParams=void 0,this.isServerSideGroupOpenByDefault=void 0,this.isApplyServerSideTransaction=void 0,this.isServerSideGroup=void 0,this.getServerSideGroupKey=void 0,this.getBusinessKeyForNode=void 0,this.getRowNodeId=void 0,this.getRowId=void 0,this.processRowPostCreate=void 0,this.isRowSelectable=void 0,this.isRowMaster=void 0,this.fillOperation=void 0,this.postSort=void 0,this.getRowStyle=void 0,this.getRowClass=void 0,this.getRowHeight=void 0,this.isFullWidthCell=void 0,this.toolPanelVisibleChanged=new n.vpe,this.pasteStart=new n.vpe,this.pasteEnd=new n.vpe,this.columnVisible=new n.vpe,this.columnPinned=new n.vpe,this.columnResized=new n.vpe,this.columnMoved=new n.vpe,this.columnValueChanged=new n.vpe,this.columnPivotModeChanged=new n.vpe,this.columnPivotChanged=new n.vpe,this.columnGroupOpened=new n.vpe,this.newColumnsLoaded=new n.vpe,this.gridColumnsChanged=new n.vpe,this.displayedColumnsChanged=new n.vpe,this.virtualColumnsChanged=new n.vpe,this.columnEverythingChanged=new n.vpe,this.componentStateChanged=new n.vpe,this.cellValueChanged=new n.vpe,this.cellEditRequest=new n.vpe,this.rowValueChanged=new n.vpe,this.cellEditingStarted=new n.vpe,this.cellEditingStopped=new n.vpe,this.rowEditingStarted=new n.vpe,this.rowEditingStopped=new n.vpe,this.filterOpened=new n.vpe,this.filterChanged=new n.vpe,this.filterModified=new n.vpe,this.chartCreated=new n.vpe,this.chartRangeSelectionChanged=new n.vpe,this.chartOptionsChanged=new n.vpe,this.chartDestroyed=new n.vpe,this.cellKeyDown=new n.vpe,this.cellKeyPress=new n.vpe,this.gridReady=new n.vpe,this.firstDataRendered=new n.vpe,this.gridSizeChanged=new n.vpe,this.modelUpdated=new n.vpe,this.virtualRowRemoved=new n.vpe,this.viewportChanged=new n.vpe,this.bodyScroll=new n.vpe,this.bodyScrollEnd=new n.vpe,this.dragStarted=new n.vpe,this.dragStopped=new n.vpe,this.paginationChanged=new n.vpe,this.rowDragEnter=new n.vpe,this.rowDragMove=new n.vpe,this.rowDragLeave=new n.vpe,this.rowDragEnd=new n.vpe,this.columnRowGroupChanged=new n.vpe,this.rowGroupOpened=new n.vpe,this.expandOrCollapseAll=new n.vpe,this.pinnedRowDataChanged=new n.vpe,this.rowDataChanged=new n.vpe,this.rowDataUpdated=new n.vpe,this.asyncTransactionsFlushed=new n.vpe,this.cellClicked=new n.vpe,this.cellDoubleClicked=new n.vpe,this.cellFocused=new n.vpe,this.cellMouseOver=new n.vpe,this.cellMouseOut=new n.vpe,this.cellMouseDown=new n.vpe,this.rowClicked=new n.vpe,this.rowDoubleClicked=new n.vpe,this.rowSelected=new n.vpe,this.selectionChanged=new n.vpe,this.cellContextMenu=new n.vpe,this.rangeSelectionChanged=new n.vpe,this.sortChanged=new n.vpe,this.columnRowGroupChangeRequest=new n.vpe,this.columnPivotChangeRequest=new n.vpe,this.columnValueChangeRequest=new n.vpe,this.columnAggFuncChangeRequest=new n.vpe,this._nativeElement=e.nativeElement}ngAfterViewInit(){this.frameworkComponentWrapper.setViewContainerRef(this.viewContainerRef),this.frameworkComponentWrapper.setComponentFactoryResolver(this.componentFactoryResolver),this.angularFrameworkOverrides.setEmitterUsedCallback(this.isEmitterUsed.bind(this)),this.gridOptions=ni.plv.copyAttributesToGridOptions(this.gridOptions,this,!0),this.gridParams={globalEventListener:this.globalEventListener.bind(this),frameworkOverrides:this.angularFrameworkOverrides,providedBeanInstances:{frameworkComponentWrapper:this.frameworkComponentWrapper},modules:this.modules||[]},this.columns&&this.columns.length>0&&(this.gridOptions.columnDefs=this.columns.map(e=>e.toColDef())),new ni.rjZ(this._nativeElement,this.gridOptions,this.gridParams),this.gridOptions.api&&(this.api=this.gridOptions.api),this.gridOptions.columnApi&&(this.columnApi=this.gridOptions.columnApi),this._initialised=!0,this._fullyReady.resolveNow(null,e=>e)}ngOnChanges(e){this._initialised&&ni.plv.processOnChange(e,this.gridOptions,this.api,this.columnApi)}ngOnDestroy(){this._initialised&&(this._destroyed=!0,this.api&&this.api.destroy())}isEmitterUsed(e){const i=this[e],a=!!i&&i.observers&&i.observers.length>0,o=`on${e.charAt(0).toUpperCase()}${e.substring(1)}`;return a||!!this.gridOptions&&!!this.gridOptions[o]}globalEventListener(e,i){if(this._destroyed)return;const a=this[e];a&&this.isEmitterUsed(e)&&("gridReady"===e?this._fullyReady.then(o=>{a.emit(i)}):a.emit(i))}};return t.\u0275fac=function(e){return new(e||t)(n.Y36(n.SBq),n.Y36(n.s_b),n.Y36(nl),n.Y36(rl),n.Y36(n._Vd))},t.\u0275cmp=n.Xpm({type:t,selectors:[["ag-grid-angular"]],contentQueries:function(e,i,a){if(1&e&&n.Suo(a,Y,4),2&e){let o;n.iGM(o=n.CRH())&&(i.columns=o)}},inputs:{statusBar:"statusBar",sideBar:"sideBar",suppressContextMenu:"suppressContextMenu",preventDefaultOnContextMenu:"preventDefaultOnContextMenu",allowContextMenuWithControlKey:"allowContextMenuWithControlKey",suppressMenuHide:"suppressMenuHide",enableBrowserTooltips:"enableBrowserTooltips",tooltipShowDelay:"tooltipShowDelay",tooltipHideDelay:"tooltipHideDelay",tooltipMouseTrack:"tooltipMouseTrack",popupParent:"popupParent",copyHeadersToClipboard:"copyHeadersToClipboard",copyGroupHeadersToClipboard:"copyGroupHeadersToClipboard",clipboardDelimiter:"clipboardDelimiter",suppressCopyRowsToClipboard:"suppressCopyRowsToClipboard",suppressLastEmptyLineOnPaste:"suppressLastEmptyLineOnPaste",suppressClipboardPaste:"suppressClipboardPaste",suppressClipboardApi:"suppressClipboardApi",columnDefs:"columnDefs",defaultColDef:"defaultColDef",defaultColGroupDef:"defaultColGroupDef",columnTypes:"columnTypes",maintainColumnOrder:"maintainColumnOrder",suppressFieldDotNotation:"suppressFieldDotNotation",deltaColumnMode:"deltaColumnMode",applyColumnDefOrder:"applyColumnDefOrder",immutableColumns:"immutableColumns",suppressSetColumnStateEvents:"suppressSetColumnStateEvents",suppressColumnStateEvents:"suppressColumnStateEvents",colWidth:"colWidth",minColWidth:"minColWidth",maxColWidth:"maxColWidth",headerHeight:"headerHeight",groupHeaderHeight:"groupHeaderHeight",floatingFiltersHeight:"floatingFiltersHeight",pivotHeaderHeight:"pivotHeaderHeight",pivotGroupHeaderHeight:"pivotGroupHeaderHeight",allowDragFromColumnsToolPanel:"allowDragFromColumnsToolPanel",suppressMovableColumns:"suppressMovableColumns",suppressColumnMoveAnimation:"suppressColumnMoveAnimation",suppressDragLeaveHidesColumns:"suppressDragLeaveHidesColumns",colResizeDefault:"colResizeDefault",suppressAutoSize:"suppressAutoSize",autoSizePadding:"autoSizePadding",skipHeaderOnAutoSize:"skipHeaderOnAutoSize",components:"components",frameworkComponents:"frameworkComponents",reactUi:"reactUi",suppressReactUi:"suppressReactUi",editType:"editType",singleClickEdit:"singleClickEdit",suppressClickEdit:"suppressClickEdit",readOnlyEdit:"readOnlyEdit",stopEditingWhenCellsLoseFocus:"stopEditingWhenCellsLoseFocus",enterMovesDown:"enterMovesDown",enterMovesDownAfterEdit:"enterMovesDownAfterEdit",undoRedoCellEditing:"undoRedoCellEditing",undoRedoCellEditingLimit:"undoRedoCellEditingLimit",stopEditingWhenGridLosesFocus:"stopEditingWhenGridLosesFocus",defaultCsvExportParams:"defaultCsvExportParams",suppressCsvExport:"suppressCsvExport",defaultExcelExportParams:"defaultExcelExportParams",suppressExcelExport:"suppressExcelExport",excelStyles:"excelStyles",defaultExportParams:"defaultExportParams",quickFilterText:"quickFilterText",cacheQuickFilter:"cacheQuickFilter",excludeChildrenWhenTreeDataFiltering:"excludeChildrenWhenTreeDataFiltering",enableCharts:"enableCharts",chartThemes:"chartThemes",customChartThemes:"customChartThemes",chartThemeOverrides:"chartThemeOverrides",loadingCellRenderer:"loadingCellRenderer",loadingCellRendererFramework:"loadingCellRendererFramework",loadingCellRendererParams:"loadingCellRendererParams",loadingCellRendererSelector:"loadingCellRendererSelector",localeText:"localeText",masterDetail:"masterDetail",keepDetailRows:"keepDetailRows",keepDetailRowsCount:"keepDetailRowsCount",detailCellRenderer:"detailCellRenderer",detailCellRendererFramework:"detailCellRendererFramework",detailCellRendererParams:"detailCellRendererParams",detailRowHeight:"detailRowHeight",detailRowAutoHeight:"detailRowAutoHeight",context:"context",alignedGrids:"alignedGrids",tabIndex:"tabIndex",rowBuffer:"rowBuffer",valueCache:"valueCache",valueCacheNeverExpires:"valueCacheNeverExpires",enableCellExpressions:"enableCellExpressions",suppressParentsInRowNodes:"suppressParentsInRowNodes",suppressTouch:"suppressTouch",suppressFocusAfterRefresh:"suppressFocusAfterRefresh",suppressAsyncEvents:"suppressAsyncEvents",suppressBrowserResizeObserver:"suppressBrowserResizeObserver",suppressPropertyNamesCheck:"suppressPropertyNamesCheck",suppressChangeDetection:"suppressChangeDetection",debug:"debug",overlayLoadingTemplate:"overlayLoadingTemplate",loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentFramework:"loadingOverlayComponentFramework",loadingOverlayComponentParams:"loadingOverlayComponentParams",suppressLoadingOverlay:"suppressLoadingOverlay",overlayNoRowsTemplate:"overlayNoRowsTemplate",noRowsOverlayComponent:"noRowsOverlayComponent",noRowsOverlayComponentFramework:"noRowsOverlayComponentFramework",noRowsOverlayComponentParams:"noRowsOverlayComponentParams",suppressNoRowsOverlay:"suppressNoRowsOverlay",pagination:"pagination",paginationPageSize:"paginationPageSize",paginationAutoPageSize:"paginationAutoPageSize",paginateChildRows:"paginateChildRows",suppressPaginationPanel:"suppressPaginationPanel",pivotMode:"pivotMode",pivotPanelShow:"pivotPanelShow",pivotColumnGroupTotals:"pivotColumnGroupTotals",pivotRowTotals:"pivotRowTotals",pivotSuppressAutoColumn:"pivotSuppressAutoColumn",suppressExpandablePivotGroups:"suppressExpandablePivotGroups",functionsReadOnly:"functionsReadOnly",aggFuncs:"aggFuncs",suppressAggFuncInHeader:"suppressAggFuncInHeader",suppressAggAtRootLevel:"suppressAggAtRootLevel",aggregateOnlyChangedColumns:"aggregateOnlyChangedColumns",suppressAggFilteredOnly:"suppressAggFilteredOnly",animateRows:"animateRows",enableCellChangeFlash:"enableCellChangeFlash",cellFlashDelay:"cellFlashDelay",cellFadeDelay:"cellFadeDelay",domLayout:"domLayout",ensureDomOrder:"ensureDomOrder",enableRtl:"enableRtl",suppressColumnVirtualisation:"suppressColumnVirtualisation",suppressMaxRenderedRowRestriction:"suppressMaxRenderedRowRestriction",suppressRowVirtualisation:"suppressRowVirtualisation",rowDragManaged:"rowDragManaged",suppressRowDrag:"suppressRowDrag",suppressMoveWhenRowDragging:"suppressMoveWhenRowDragging",rowDragEntireRow:"rowDragEntireRow",rowDragMultiRow:"rowDragMultiRow",fullWidthCellRenderer:"fullWidthCellRenderer",fullWidthCellRendererFramework:"fullWidthCellRendererFramework",fullWidthCellRendererParams:"fullWidthCellRendererParams",embedFullWidthRows:"embedFullWidthRows",deprecatedEmbedFullWidthRows:"deprecatedEmbedFullWidthRows",groupDisplayType:"groupDisplayType",groupDefaultExpanded:"groupDefaultExpanded",autoGroupColumnDef:"autoGroupColumnDef",groupMaintainOrder:"groupMaintainOrder",groupSelectsChildren:"groupSelectsChildren",groupIncludeFooter:"groupIncludeFooter",groupIncludeTotalFooter:"groupIncludeTotalFooter",groupSuppressBlankHeader:"groupSuppressBlankHeader",groupSelectsFiltered:"groupSelectsFiltered",showOpenedGroup:"showOpenedGroup",groupRemoveSingleChildren:"groupRemoveSingleChildren",groupRemoveLowestSingleChildren:"groupRemoveLowestSingleChildren",groupHideOpenParents:"groupHideOpenParents",rowGroupPanelShow:"rowGroupPanelShow",groupRowRenderer:"groupRowRenderer",groupRowRendererFramework:"groupRowRendererFramework",groupRowRendererParams:"groupRowRendererParams",suppressMakeColumnVisibleAfterUnGroup:"suppressMakeColumnVisibleAfterUnGroup",treeData:"treeData",groupRowInnerRenderer:"groupRowInnerRenderer",groupRowInnerRendererFramework:"groupRowInnerRendererFramework",groupMultiAutoColumn:"groupMultiAutoColumn",groupUseEntireRow:"groupUseEntireRow",groupSuppressAutoColumn:"groupSuppressAutoColumn",rememberGroupStateWhenNewData:"rememberGroupStateWhenNewData",pinnedTopRowData:"pinnedTopRowData",pinnedBottomRowData:"pinnedBottomRowData",rowModelType:"rowModelType",rowData:"rowData",immutableData:"immutableData",asyncTransactionWaitMillis:"asyncTransactionWaitMillis",suppressModelUpdateAfterUpdateTransaction:"suppressModelUpdateAfterUpdateTransaction",deltaRowDataMode:"deltaRowDataMode",batchUpdateWaitMillis:"batchUpdateWaitMillis",datasource:"datasource",cacheOverflowSize:"cacheOverflowSize",infiniteInitialRowCount:"infiniteInitialRowCount",serverSideStoreType:"serverSideStoreType",cacheBlockSize:"cacheBlockSize",maxBlocksInCache:"maxBlocksInCache",maxConcurrentDatasourceRequests:"maxConcurrentDatasourceRequests",blockLoadDebounceMillis:"blockLoadDebounceMillis",purgeClosedRowNodes:"purgeClosedRowNodes",serverSideDatasource:"serverSideDatasource",serverSideSortingAlwaysResets:"serverSideSortingAlwaysResets",serverSideFilteringAlwaysResets:"serverSideFilteringAlwaysResets",suppressEnterpriseResetOnNewColumns:"suppressEnterpriseResetOnNewColumns",viewportDatasource:"viewportDatasource",viewportRowModelPageSize:"viewportRowModelPageSize",viewportRowModelBufferSize:"viewportRowModelBufferSize",alwaysShowHorizontalScroll:"alwaysShowHorizontalScroll",alwaysShowVerticalScroll:"alwaysShowVerticalScroll",debounceVerticalScrollbar:"debounceVerticalScrollbar",suppressHorizontalScroll:"suppressHorizontalScroll",suppressScrollOnNewData:"suppressScrollOnNewData",suppressScrollWhenPopupsAreOpen:"suppressScrollWhenPopupsAreOpen",suppressAnimationFrame:"suppressAnimationFrame",suppressMiddleClickScrolls:"suppressMiddleClickScrolls",suppressPreventDefaultOnMouseWheel:"suppressPreventDefaultOnMouseWheel",scrollbarWidth:"scrollbarWidth",rowSelection:"rowSelection",rowMultiSelectWithClick:"rowMultiSelectWithClick",suppressRowDeselection:"suppressRowDeselection",suppressRowClickSelection:"suppressRowClickSelection",suppressCellSelection:"suppressCellSelection",suppressCellFocus:"suppressCellFocus",suppressMultiRangeSelection:"suppressMultiRangeSelection",enableCellTextSelection:"enableCellTextSelection",enableRangeSelection:"enableRangeSelection",enableRangeHandle:"enableRangeHandle",enableFillHandle:"enableFillHandle",fillHandleDirection:"fillHandleDirection",suppressClearOnFillReduction:"suppressClearOnFillReduction",sortingOrder:"sortingOrder",accentedSort:"accentedSort",unSortIcon:"unSortIcon",suppressMultiSort:"suppressMultiSort",multiSortKey:"multiSortKey",suppressMaintainUnsortedOrder:"suppressMaintainUnsortedOrder",icons:"icons",rowHeight:"rowHeight",rowStyle:"rowStyle",rowClass:"rowClass",rowClassRules:"rowClassRules",suppressRowHoverHighlight:"suppressRowHoverHighlight",suppressRowTransform:"suppressRowTransform",columnHoverHighlight:"columnHoverHighlight",deltaSort:"deltaSort",treeDataDisplayType:"treeDataDisplayType",angularCompileRows:"angularCompileRows",angularCompileFilters:"angularCompileFilters",functionsPassive:"functionsPassive",enableGroupEdit:"enableGroupEdit",getContextMenuItems:"getContextMenuItems",getMainMenuItems:"getMainMenuItems",postProcessPopup:"postProcessPopup",processCellForClipboard:"processCellForClipboard",processHeaderForClipboard:"processHeaderForClipboard",processGroupHeaderForClipboard:"processGroupHeaderForClipboard",processCellFromClipboard:"processCellFromClipboard",sendToClipboard:"sendToClipboard",processDataFromClipboard:"processDataFromClipboard",isExternalFilterPresent:"isExternalFilterPresent",doesExternalFilterPass:"doesExternalFilterPass",getChartToolbarItems:"getChartToolbarItems",createChartContainer:"createChartContainer",navigateToNextHeader:"navigateToNextHeader",tabToNextHeader:"tabToNextHeader",navigateToNextCell:"navigateToNextCell",tabToNextCell:"tabToNextCell",suppressKeyboardEvent:"suppressKeyboardEvent",localeTextFunc:"localeTextFunc",getDocument:"getDocument",paginationNumberFormatter:"paginationNumberFormatter",groupRowAggNodes:"groupRowAggNodes",isGroupOpenByDefault:"isGroupOpenByDefault",defaultGroupOrderComparator:"defaultGroupOrderComparator",processSecondaryColDef:"processSecondaryColDef",processSecondaryColGroupDef:"processSecondaryColGroupDef",getDataPath:"getDataPath",defaultGroupSortComparator:"defaultGroupSortComparator",getChildCount:"getChildCount",getServerSideStoreParams:"getServerSideStoreParams",isServerSideGroupOpenByDefault:"isServerSideGroupOpenByDefault",isApplyServerSideTransaction:"isApplyServerSideTransaction",isServerSideGroup:"isServerSideGroup",getServerSideGroupKey:"getServerSideGroupKey",getBusinessKeyForNode:"getBusinessKeyForNode",getRowNodeId:"getRowNodeId",getRowId:"getRowId",processRowPostCreate:"processRowPostCreate",isRowSelectable:"isRowSelectable",isRowMaster:"isRowMaster",fillOperation:"fillOperation",postSort:"postSort",getRowStyle:"getRowStyle",getRowClass:"getRowClass",getRowHeight:"getRowHeight",isFullWidthCell:"isFullWidthCell",gridOptions:"gridOptions",modules:"modules"},outputs:{toolPanelVisibleChanged:"toolPanelVisibleChanged",pasteStart:"pasteStart",pasteEnd:"pasteEnd",columnVisible:"columnVisible",columnPinned:"columnPinned",columnResized:"columnResized",columnMoved:"columnMoved",columnValueChanged:"columnValueChanged",columnPivotModeChanged:"columnPivotModeChanged",columnPivotChanged:"columnPivotChanged",columnGroupOpened:"columnGroupOpened",newColumnsLoaded:"newColumnsLoaded",gridColumnsChanged:"gridColumnsChanged",displayedColumnsChanged:"displayedColumnsChanged",virtualColumnsChanged:"virtualColumnsChanged",columnEverythingChanged:"columnEverythingChanged",componentStateChanged:"componentStateChanged",cellValueChanged:"cellValueChanged",cellEditRequest:"cellEditRequest",rowValueChanged:"rowValueChanged",cellEditingStarted:"cellEditingStarted",cellEditingStopped:"cellEditingStopped",rowEditingStarted:"rowEditingStarted",rowEditingStopped:"rowEditingStopped",filterOpened:"filterOpened",filterChanged:"filterChanged",filterModified:"filterModified",chartCreated:"chartCreated",chartRangeSelectionChanged:"chartRangeSelectionChanged",chartOptionsChanged:"chartOptionsChanged",chartDestroyed:"chartDestroyed",cellKeyDown:"cellKeyDown",cellKeyPress:"cellKeyPress",gridReady:"gridReady",firstDataRendered:"firstDataRendered",gridSizeChanged:"gridSizeChanged",modelUpdated:"modelUpdated",virtualRowRemoved:"virtualRowRemoved",viewportChanged:"viewportChanged",bodyScroll:"bodyScroll",bodyScrollEnd:"bodyScrollEnd",dragStarted:"dragStarted",dragStopped:"dragStopped",paginationChanged:"paginationChanged",rowDragEnter:"rowDragEnter",rowDragMove:"rowDragMove",rowDragLeave:"rowDragLeave",rowDragEnd:"rowDragEnd",columnRowGroupChanged:"columnRowGroupChanged",rowGroupOpened:"rowGroupOpened",expandOrCollapseAll:"expandOrCollapseAll",pinnedRowDataChanged:"pinnedRowDataChanged",rowDataChanged:"rowDataChanged",rowDataUpdated:"rowDataUpdated",asyncTransactionsFlushed:"asyncTransactionsFlushed",cellClicked:"cellClicked",cellDoubleClicked:"cellDoubleClicked",cellFocused:"cellFocused",cellMouseOver:"cellMouseOver",cellMouseOut:"cellMouseOut",cellMouseDown:"cellMouseDown",rowClicked:"rowClicked",rowDoubleClicked:"rowDoubleClicked",rowSelected:"rowSelected",selectionChanged:"selectionChanged",cellContextMenu:"cellContextMenu",rangeSelectionChanged:"rangeSelectionChanged",sortChanged:"sortChanged",columnRowGroupChangeRequest:"columnRowGroupChangeRequest",columnPivotChangeRequest:"columnPivotChangeRequest",columnValueChangeRequest:"columnValueChangeRequest",columnAggFuncChangeRequest:"columnAggFuncChangeRequest"},features:[n._Bn([nl,rl]),n.TTD],decls:0,vars:0,template:function(e,i){},encapsulation:2}),g([(0,n.AcB)(Y),_("design:type",n.n_E)],t.prototype,"columns",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"gridOptions",void 0),g([(0,n.IIB)(),_("design:type",Array)],t.prototype,"modules",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"statusBar",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"sideBar",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressContextMenu",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"preventDefaultOnContextMenu",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"allowContextMenuWithControlKey",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressMenuHide",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"enableBrowserTooltips",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"tooltipShowDelay",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"tooltipHideDelay",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"tooltipMouseTrack",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"popupParent",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"copyHeadersToClipboard",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"copyGroupHeadersToClipboard",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"clipboardDelimiter",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressCopyRowsToClipboard",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressLastEmptyLineOnPaste",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressClipboardPaste",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressClipboardApi",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"columnDefs",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"defaultColDef",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"defaultColGroupDef",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"columnTypes",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"maintainColumnOrder",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressFieldDotNotation",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"deltaColumnMode",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"applyColumnDefOrder",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"immutableColumns",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressSetColumnStateEvents",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressColumnStateEvents",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"colWidth",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"minColWidth",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"maxColWidth",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"headerHeight",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupHeaderHeight",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"floatingFiltersHeight",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"pivotHeaderHeight",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"pivotGroupHeaderHeight",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"allowDragFromColumnsToolPanel",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressMovableColumns",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressColumnMoveAnimation",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressDragLeaveHidesColumns",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"colResizeDefault",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressAutoSize",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"autoSizePadding",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"skipHeaderOnAutoSize",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"components",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"frameworkComponents",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"reactUi",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressReactUi",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"editType",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"singleClickEdit",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressClickEdit",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"readOnlyEdit",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"stopEditingWhenCellsLoseFocus",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"enterMovesDown",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"enterMovesDownAfterEdit",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"undoRedoCellEditing",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"undoRedoCellEditingLimit",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"stopEditingWhenGridLosesFocus",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"defaultCsvExportParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressCsvExport",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"defaultExcelExportParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressExcelExport",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"excelStyles",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"defaultExportParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"quickFilterText",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"cacheQuickFilter",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"excludeChildrenWhenTreeDataFiltering",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"enableCharts",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"chartThemes",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"customChartThemes",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"chartThemeOverrides",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"loadingCellRenderer",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"loadingCellRendererFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"loadingCellRendererParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"loadingCellRendererSelector",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"localeText",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"masterDetail",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"keepDetailRows",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"keepDetailRowsCount",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"detailCellRenderer",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"detailCellRendererFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"detailCellRendererParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"detailRowHeight",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"detailRowAutoHeight",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"context",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"alignedGrids",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"tabIndex",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rowBuffer",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"valueCache",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"valueCacheNeverExpires",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"enableCellExpressions",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressParentsInRowNodes",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressTouch",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressFocusAfterRefresh",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressAsyncEvents",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressBrowserResizeObserver",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressPropertyNamesCheck",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressChangeDetection",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"debug",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"overlayLoadingTemplate",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"loadingOverlayComponent",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"loadingOverlayComponentFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"loadingOverlayComponentParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressLoadingOverlay",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"overlayNoRowsTemplate",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"noRowsOverlayComponent",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"noRowsOverlayComponentFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"noRowsOverlayComponentParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressNoRowsOverlay",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"pagination",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"paginationPageSize",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"paginationAutoPageSize",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"paginateChildRows",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressPaginationPanel",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"pivotMode",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"pivotPanelShow",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"pivotColumnGroupTotals",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"pivotRowTotals",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"pivotSuppressAutoColumn",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressExpandablePivotGroups",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"functionsReadOnly",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"aggFuncs",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressAggFuncInHeader",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressAggAtRootLevel",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"aggregateOnlyChangedColumns",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressAggFilteredOnly",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"animateRows",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"enableCellChangeFlash",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"cellFlashDelay",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"cellFadeDelay",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"domLayout",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"ensureDomOrder",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"enableRtl",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressColumnVirtualisation",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressMaxRenderedRowRestriction",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressRowVirtualisation",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rowDragManaged",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressRowDrag",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressMoveWhenRowDragging",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rowDragEntireRow",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rowDragMultiRow",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"fullWidthCellRenderer",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"fullWidthCellRendererFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"fullWidthCellRendererParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"embedFullWidthRows",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"deprecatedEmbedFullWidthRows",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupDisplayType",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupDefaultExpanded",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"autoGroupColumnDef",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupMaintainOrder",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupSelectsChildren",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupIncludeFooter",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupIncludeTotalFooter",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupSuppressBlankHeader",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupSelectsFiltered",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"showOpenedGroup",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupRemoveSingleChildren",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupRemoveLowestSingleChildren",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupHideOpenParents",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rowGroupPanelShow",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupRowRenderer",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupRowRendererFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupRowRendererParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressMakeColumnVisibleAfterUnGroup",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"treeData",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupRowInnerRenderer",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupRowInnerRendererFramework",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupMultiAutoColumn",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupUseEntireRow",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupSuppressAutoColumn",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rememberGroupStateWhenNewData",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"pinnedTopRowData",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"pinnedBottomRowData",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rowModelType",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rowData",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"immutableData",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"asyncTransactionWaitMillis",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressModelUpdateAfterUpdateTransaction",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"deltaRowDataMode",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"batchUpdateWaitMillis",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"datasource",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"cacheOverflowSize",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"infiniteInitialRowCount",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"serverSideStoreType",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"cacheBlockSize",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"maxBlocksInCache",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"maxConcurrentDatasourceRequests",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"blockLoadDebounceMillis",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"purgeClosedRowNodes",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"serverSideDatasource",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"serverSideSortingAlwaysResets",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"serverSideFilteringAlwaysResets",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressEnterpriseResetOnNewColumns",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"viewportDatasource",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"viewportRowModelPageSize",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"viewportRowModelBufferSize",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"alwaysShowHorizontalScroll",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"alwaysShowVerticalScroll",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"debounceVerticalScrollbar",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressHorizontalScroll",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressScrollOnNewData",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressScrollWhenPopupsAreOpen",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressAnimationFrame",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressMiddleClickScrolls",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressPreventDefaultOnMouseWheel",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"scrollbarWidth",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rowSelection",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rowMultiSelectWithClick",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressRowDeselection",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressRowClickSelection",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressCellSelection",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressCellFocus",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressMultiRangeSelection",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"enableCellTextSelection",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"enableRangeSelection",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"enableRangeHandle",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"enableFillHandle",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"fillHandleDirection",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressClearOnFillReduction",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"sortingOrder",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"accentedSort",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"unSortIcon",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressMultiSort",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"multiSortKey",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressMaintainUnsortedOrder",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"icons",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rowHeight",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rowStyle",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rowClass",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"rowClassRules",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressRowHoverHighlight",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressRowTransform",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"columnHoverHighlight",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"deltaSort",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"treeDataDisplayType",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"angularCompileRows",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"angularCompileFilters",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"functionsPassive",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"enableGroupEdit",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getContextMenuItems",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getMainMenuItems",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"postProcessPopup",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"processCellForClipboard",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"processHeaderForClipboard",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"processGroupHeaderForClipboard",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"processCellFromClipboard",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"sendToClipboard",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"processDataFromClipboard",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"isExternalFilterPresent",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"doesExternalFilterPass",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getChartToolbarItems",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"createChartContainer",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"navigateToNextHeader",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"tabToNextHeader",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"navigateToNextCell",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"tabToNextCell",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"suppressKeyboardEvent",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"localeTextFunc",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getDocument",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"paginationNumberFormatter",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"groupRowAggNodes",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"isGroupOpenByDefault",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"defaultGroupOrderComparator",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"processSecondaryColDef",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"processSecondaryColGroupDef",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getDataPath",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"defaultGroupSortComparator",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getChildCount",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getServerSideStoreParams",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"isServerSideGroupOpenByDefault",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"isApplyServerSideTransaction",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"isServerSideGroup",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getServerSideGroupKey",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getBusinessKeyForNode",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getRowNodeId",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getRowId",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"processRowPostCreate",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"isRowSelectable",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"isRowMaster",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"fillOperation",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"postSort",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getRowStyle",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getRowClass",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"getRowHeight",void 0),g([(0,n.IIB)(),_("design:type",Object)],t.prototype,"isFullWidthCell",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"toolPanelVisibleChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"pasteStart",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"pasteEnd",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnVisible",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnPinned",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnResized",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnMoved",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnValueChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnPivotModeChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnPivotChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnGroupOpened",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"newColumnsLoaded",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"gridColumnsChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"displayedColumnsChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"virtualColumnsChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnEverythingChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"componentStateChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"cellValueChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"cellEditRequest",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rowValueChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"cellEditingStarted",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"cellEditingStopped",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rowEditingStarted",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rowEditingStopped",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"filterOpened",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"filterChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"filterModified",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"chartCreated",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"chartRangeSelectionChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"chartOptionsChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"chartDestroyed",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"cellKeyDown",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"cellKeyPress",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"gridReady",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"firstDataRendered",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"gridSizeChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"modelUpdated",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"virtualRowRemoved",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"viewportChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"bodyScroll",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"bodyScrollEnd",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"dragStarted",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"dragStopped",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"paginationChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rowDragEnter",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rowDragMove",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rowDragLeave",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rowDragEnd",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnRowGroupChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rowGroupOpened",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"expandOrCollapseAll",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"pinnedRowDataChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rowDataChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rowDataUpdated",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"asyncTransactionsFlushed",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"cellClicked",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"cellDoubleClicked",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"cellFocused",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"cellMouseOver",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"cellMouseOut",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"cellMouseDown",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rowClicked",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rowDoubleClicked",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rowSelected",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"selectionChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"cellContextMenu",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"rangeSelectionChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"sortChanged",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnRowGroupChangeRequest",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnPivotChangeRequest",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnValueChangeRequest",void 0),g([(0,n.r_U)(),_("design:type",n.vpe)],t.prototype,"columnAggFuncChangeRequest",void 0),t=g([_("design:paramtypes",[n.SBq,n.s_b,nl,rl,n._Vd])],t),t})();var il;let ri=il=class{static withComponents(r){return{ngModule:il,providers:[{provide:n.deG,useValue:r,multi:!0}]}}static forRoot(r){return{ngModule:il,providers:[{provide:n.deG,useValue:r,multi:!0}]}}};ri.\u0275fac=function(r){return new(r||ri)},ri.\u0275mod=n.oAB({type:ri}),ri.\u0275inj=n.cJS({imports:[[]]});let al=(()=>{class t{constructor(){this.gridModule=[],this.classList={},this.cellClicked=new n.vpe,this.rowClicked=new n.vpe,this.gridReady=new n.vpe,this.rowSelected=new n.vpe,this.columnApi=void 0,this.agGridApi=void 0,this.themeList=rn,this.theme=rn.fresh}set options(e){this.agOption=Object.assign({},e,this.defaultGridOption())}set minHeight(e){this.agMinHeight=e,this.agDomLayout=void 0}set height(e){this.agHeight=e,this.agDomLayout=void 0}set domLayout(e){this.agDomLayout=e}set theme(e){this.classList[this.agThemeClass]=!1,this.agThemeClass=hd(e),this.classList[this.agThemeClass]=!0,this.agTheme=e,console.log(this.agThemeClass)}ngOnInit(){}get options(){return this.agOption}get theme(){return this.agTheme}get minHeight(){return this.agMinHeight}get height(){return null==this.agHeight&&null!=this.agMinHeight&&(this.agHeight=this.agMinHeight),this.agHeight}get domLayout(){if(null==this.agHeight&&null==this.agMinHeight)return this.agDomLayout}gridApi(){return this.agGridApi}createThemeDefault(e=rn.alpine){return this.classList[this.agThemeClass]=!1,this.agThemeClass=hd(e),this.classList[this.agThemeClass]=!0,this.agTheme=e,this.agTheme}defaultGridOption(){return{domLayout:"normal",suppressRowClickSelection:!1,defaultColDef:{editable:!0,enableValue:!0,enableRowGroup:!0,enablePivot:!1,sortable:!1,resizable:!0,filter:!1}}}onCellClicked(e){this.cellClicked.emit(e)}onRowClicked(e){this.rowClicked.emit(e)}onGridReady(e){this.agGridApi=e.api,this.columnApi=e.columnApi,this.gridReady.emit(e)}onRowSelected(e){this.rowSelected.emit(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.Xpm({type:t,selectors:[["cy-custom-grid"]],viewQuery:function(e,i){if(1&e&&n.Gf(_d,7),2&e){let a;n.iGM(a=n.CRH())&&(i.grid=a.first)}},inputs:{items:"items",columns:"columns",gridModule:"gridModule",classList:"classList",options:"options",minHeight:"minHeight",height:"height",domLayout:"domLayout",theme:"theme"},outputs:{cellClicked:"cellClicked",rowClicked:"rowClicked",gridReady:"gridReady",rowSelected:"rowSelected"},decls:2,vars:11,consts:[[3,"ngClass","domLayout","rowDragManaged","rowData","modules","columnDefs","gridOptions","cellClicked","rowClicked","rowSelected","gridReady"],["grid",""]],template:function(e,i){1&e&&(n.TgZ(0,"ag-grid-angular",0,1),n.NdJ("cellClicked",function(o){return i.onCellClicked(o)})("rowClicked",function(o){return i.onRowClicked(o)})("rowSelected",function(o){return i.onRowSelected(o)})("gridReady",function(o){return i.onGridReady(o)}),n.qZA()),2&e&&(n.Udp("height",i.height)("min-height",i.minHeight),n.Q6J("ngClass",i.classList)("domLayout",i.domLayout)("rowDragManaged",!0)("rowData",i.items)("modules",i.gridModule)("columnDefs",i.columns)("gridOptions",i.options))},directives:[_d,K.mk],styles:[""],encapsulation:2}),t})();function vI(t,r){1&t&&(n.TgZ(0,"div",3)(1,"label",33),n._uU(2,"T\xean c\xf4ng ty"),n.qZA(),n.TgZ(3,"nz-input-group",34),n._UZ(4,"input",35)(5,"input",36),n.qZA()())}function CI(t,r){1&t&&(n.TgZ(0,"div",3)(1,"label",37),n._uU(2,"Ng\u01b0\u1eddi li\xean h\u1ec7 (C\xe1 nh\xe2n *)"),n.qZA(),n.TgZ(3,"nz-input-group",34),n._UZ(4,"input",38)(5,"input",39),n.qZA()())}function yI(t,r){1&t&&(n.TgZ(0,"div",3)(1,"label",40),n._uU(2,"\u0110\u1ecba ch\u1ec9"),n.qZA(),n._UZ(3,"input",41),n.qZA())}function wI(t,r){1&t&&(n.TgZ(0,"div",3)(1,"label",42),n._uU(2,"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i (C\xe1 nh\xe2n)"),n.qZA(),n._UZ(3,"input",43),n.qZA())}function TI(t,r){1&t&&n._UZ(0,"i",44)}function kI(t,r){1&t&&n._UZ(0,"i",45)}function SI(t,r){if(1&t&&(n.TgZ(0,"button",46),n._uU(1,"T\xecm theo API"),n.qZA()),2&t){const e=n.oxw();n.Q6J("disabled",e.disabled)}}function bI(t,r){1&t&&n._UZ(0,"i",44)}function zI(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"button",47),n.NdJ("click",function(){return n.CHM(e),n.oxw().onCreateContact("person")}),n.YNc(1,bI,1,0,"i",17),n.TgZ(2,"span"),n._uU(3,"+ C\xe1 nh\xe2n"),n.qZA()()}if(2&t){const e=n.oxw();n.Q6J("disabled",e.disabled_person),n.xp6(1),n.Q6J("ngIf",e.isAsyncCreate)}}function II(t,r){1&t&&n._UZ(0,"i",44)}function OI(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"button",47),n.NdJ("click",function(){return n.CHM(e),n.oxw().onCreateContact("company")}),n.YNc(1,II,1,0,"i",17),n.TgZ(2,"span"),n._uU(3,"+ C\xf4ng ty"),n.qZA()()}if(2&t){const e=n.oxw();n.Q6J("disabled",e.disabled_company),n.xp6(1),n.Q6J("ngIf",e.isAsyncCreate)}}const vo=function(){return{standalone:!0}};function EI(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"nz-input-group")(1,"label",48),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().autoUpdate=a}),n.TgZ(2,"span"),n._uU(3,"C\u1eadp nh\u1eadt khi ch\u1ecdn"),n.qZA()(),n.TgZ(4,"button",49),n.NdJ("click",function(){return n.CHM(e),n.oxw().onBtnSelectRow()}),n._uU(5,"Ch\u1ecdn"),n.qZA()()}if(2&t){const e=n.oxw();n.xp6(1),n.Q6J("ngModel",e.autoUpdate)("ngModelOptions",n.DdM(2,vo))}}let FI=(()=>{class t{constructor(e,i,a,o,s,l,c){this.cdRef=e,this.od=i,this.fb=a,this.modalRef=o,this.config=s,this.userCtrl=l,this.shared=c,this.fieldSearch=[],this.gridColumns=[],this.valueSearch={},this.totalRow=void 0,this.searchLimit=100,this.isSearch=!1,this.chkCreate=!1,this.chkUpForm=!1,this.isAsyncCreate=!1,this.autoUpdate=!0,this.searchLog="",this.resultColumns=[],this.resultData=[],this.agRowClick=void 0,this.gridApi=void 0,this.agOption={domLayout:"normal",suppressRowClickSelection:!1,rowSelection:"single",defaultColDef:{editable:!0,enableValue:!0,enableRowGroup:!0,enablePivot:!1,sortable:!1,resizable:!0,filter:!1}},this.searchWhere=[{label:"MST",value:"vat",checked:!0},{label:"E-mail",value:"email",checked:!0}]}ngOnInit(){this.initTaoForm(),this.createGridCols(),this.onSearch(),this.initialize()}initialize(){}onGridReady(e){this.gridApi=e.api,this.gridApi.getColumnDef("vat").cellStyle={color:"red","font-weight":"bold"},Ze.getColDef(this.gridApi,"open_link",a=>{a.cellRenderer=o=>`<a href="${this.getUrlView(o)}" target="_blank" class="open_link">Open</i></a>`})}ngAfterViewInit(){}getUrlView(e){let i=this.userCtrl.read().od_config.view_partner||"http://conyeu.dev";return D.K$.replaceQuery(i,{partnerId:e.data.id})}initTaoForm(){this.fieldSearch=[{key:"vat",label:"MST",operator:null},{key:"email",label:"Email",operator:null},{key:"comp_name",label:"T\xean c\xf4ng ty",operator:null},{key:"comp_id",label:"C\xf4ng ty ID",operator:null},{key:"phone",label:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i",operator:null},{key:"street",label:"\u0110\u1ecba ch\u1ec9",operator:null},{key:"customer_name",label:"Ng\u01b0\u1eddi li\xean h\u1ec7",operator:null},{key:"customer_id",label:"",operator:null}],this.searchFrm=this.fb.group({}),this.fieldSearch.forEach(e=>{let i=this.fb.control(this.valueSearch[e.key]||e.value);this.searchFrm.addControl(e.key,i)})}createGridCols(){this.resultColumns=[{headerName:"",field:"checked",colId:"checked",width:40,checkboxSelection:!0,headerCheckboxSelection:!0},{headerName:"Link",field:"open_link",colId:"open_link",width:75},{headerName:"M\xe3 s\u1ed1 thu\u1ebf",field:"vat",colId:"vat",width:150},{headerName:"T\xean hi\u1ec3n th\u1ecb",field:"display_name",colId:"display_name",width:400},{headerName:"E-mail",field:"email",colId:"email",width:230},{headerName:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i",field:"mobile",colId:"mobile",width:129},{headerName:"Ng\u01b0\u1eddi li\xean h\u1ec7",field:"name",colId:"name",width:168},{headerName:"T\xean c\xf4ng ty",field:"comp_name",colId:"comp_name",width:260}]}get isExistData(){var e;return console.log(null===(e=this.gridApi)||void 0===e?void 0:e.getSelectedNodes()),void 0!==this.gridApi&&this.gridApi.getSelectedNodes().length>0}get disabled(){return this.isSearch||this.isAsyncCreate}get disabled_person(){return this.disabled||!(0,D.EU)(this.getValueFrm().customer_id)}get disabled_company(){return this.disabled||!(0,D.EU)(this.getValueFrm().comp_id)}fieldTrackBy(e,i){return i?i.key:e}setValueFrm(e,i,a){if(a=a||[e],this.agRowClick=this.agRowClick||{},(0,D.EU)(i)){let o=a.map(s=>this.agRowClick[s]).filter(s=>!(0,D.EU)(s));i=o.length>0?o[0]:void 0}this.searchFrm.get(e).setValue(i)}getValueFrm(){return this.searchFrm.getRawValue()}onCloseRef(){this.modalRef.destroy()}onResetForm(){this.searchFrm.reset(this.valueSearch),this.chkUpForm=!1}formToObj(e){if(!this.searchFrm.invalid){let i=this.searchFrm.value;return 0===(e=(e=e||Object.keys(i)).filter(a=>!(0,D.EU)(i[a]))).length?void 0:e.map(a=>({[a]:i[a].trim()})).reduce((a,o)=>Object.assign(Object.assign({},a),o),{})}}onAgRowClick(e){this.agRowClick=e.data,(0,D.Ft)(this.agRowClick)||(this.setValueFrm("vat"),this.setValueFrm("comp_name",null,["display_name","comp_name"]),this.setValueFrm("comp_id"),this.setValueFrm("street"),this.chkUpForm&&(this.setValueFrm("customer_id",null),this.setValueFrm("customer_name",null),this.setValueFrm("email",null),this.setValueFrm("phone",null)),!this.agRowClick.is_company&&this.chkUpForm&&(this.setValueFrm("customer_id",null,["id"]),this.setValueFrm("email"),this.setValueFrm("customer_name",null,["name"]),this.setValueFrm("phone")))}onClickUp(){this.chkUpForm||this.onResetForm()}onBtnSelectRow(){let e=this.gridApi.getSelectedRows();if(0===e.length)return void this.shared.alert.warning("<b>Vui l\xf2ng ch\u1ecdn 1 d\xf2ng.</b>");let i=e[0];Object.keys(i).forEach(a=>i[a]=i[a]?i[a]:void 0),this.modalRef.destroy({item:i,autoUpdate:this.autoUpdate})}onSearch(e){e=e||this.searchWhere.filter(a=>a.checked).map(a=>a.value);let i=this.formToObj(e);void 0!==i?(this.totalRow=void 0,this.isSearch=!0,console.log(`Tim kiem thong tin: ${JSON.stringify(i)}`),this.od.partner.searchRead(i).subscribe(a=>{this.isSearch=!1,this.resultData=a,this.cdRef.detectChanges(),this.shared.alert.success(`T\xecm \u0111\u01b0\u1ee3c: <b>${a.length} k\u1ebft qu\u1ea3.</b>`)},a=>{this.isSearch=!1,this.cdRef.detectChanges()})):this.shared.alert.warning("<b>Vui l\xf2ng nh\u1eadp th\xf4ng tin t\xecm ki\u1ebfm.</b>")}onCreateContact(e){if(!["person","company"].includes(e))return;this.isAsyncCreate=!0;let i=this.getValueFrm(),a={phone:i.phone,mobile:i.phone,email:i.email,company_type:e};if("person"===e){if((0,D.EU)(i.comp_id))return this.shared.alert.warning("<b>Vui l\xf2ng ch\u1ecdn c\xf4ng ty.</b>"),void(this.isAsyncCreate=!1);a=Object.assign(a,{name:i.customer_name||i.email,parent_id:i.comp_id})}else a=Object.assign(a,{name:i.comp_name||i.email,vat:i.vat,street:i.street,parent_id:!1});let o="company"==e?"C\xf4ng ty":"C\xe1 nh\xe2n";this.od.partner.createOne(a).subscribe({next:s=>{this.isAsyncCreate=!1,this.gridApi.setRowData([s]),this.cdRef.detectChanges(),this.shared.alert.success(`[${s.id}] T\u1ea1o <b>${o}</b> th\xe0nh c\xf4ng`)},error:s=>{this.isAsyncCreate=!1,this.cdRef.detectChanges(),this.shared.alert.error(`X\u1ea3y ra l\u1ed7i t\u1ea1o <b>${o}</b> > ${s.message} !`)}})}onCellClicked(e){console.log(e)}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(n.sBO),n.Y36(Ks),n.Y36(ve.qu),n.Y36(Qn.Lf),n.Y36(Xs.t),n.Y36(rr.a),n.Y36(li.W))},t.\u0275cmp=n.Xpm({type:t,selectors:[["cy-search-user"]],viewQuery:function(e,i){if(1&e&&n.Gf(al,5),2&e){let a;n.iGM(a=n.CRH())&&(i.grid=a.first)}},inputs:{fieldSearch:"fieldSearch",gridColumns:"gridColumns",valueSearch:"valueSearch"},decls:47,vars:30,consts:[[1,"partner-search-wrapper"],[1,"row-form","form-body","pd-lr-5",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-6","form-group"],["for","vat"],["nz-input","","id","vat","formControlName","vat",1,"form-control","border","border-success"],["for","email"],["nz-input","","id","email","formControlName","email",1,"form-control","border","border-success"],["class","col-6 form-group",4,"ngIf"],[1,"row","mt-2"],[1,"col-12","d-flex","align-item-center"],["nz-label","",1,"text-info"],[1,"ml-2","w-none",3,"ngModel","ngModelOptions","ngModelChange"],[1,"row","tool"],[1,"col-12","d-flex","align-items-center"],["nz-button","","nzDanger","","type","button",3,"disabled","click"],["nz-button","","nzType","primary",3,"disabled"],["class","fal fa-sync-alt fa-spin",4,"ngIf"],["class","fas fa-cog",4,"ngIf"],["nz-button","","type","button",3,"disabled",4,"ngIf"],["nz-button","","type","button",3,"disabled","click",4,"ngIf"],["nz-checkbox","",3,"ngModel","ngModelOptions","disabled","ngModelChange","click"],["nz-checkbox","",3,"ngModel","ngModelOptions","disabled","ngModelChange"],[1,"row","row-log"],[1,"col-12",3,"innerHtml"],[1,"row","row-data"],[1,"col-12"],[3,"columns","theme","items","options","height","rowClicked","gridReady"],["grid",""],[1,"row","row-footer"],[1,"col-12","col-right"],[4,"ngIf"],["nz-button","","nzDanger","",3,"click"],["for","comp_name"],[1,"d-flex"],["nz-input","","id","comp_name","formControlName","comp_name",1,"form-control"],["nz-input","","id","comp_id","formControlName","comp_id",1,"form-control","ml-1","w-5","border","border-danger","font-weight-bold"],["for","customer_name"],["nz-input","","id","customer_name","formControlName","customer_name",1,"form-control"],["nz-input","","id","customer_id","formControlName","customer_id",1,"form-control","ml-1","w-5","border","border-danger","font-weight-bold"],["for","street"],["nz-input","","id","street","formControlName","street",1,"form-control"],["for","phone"],["nz-input","","id","phone","formControlName","phone",1,"form-control"],[1,"fal","fa-sync-alt","fa-spin"],[1,"fas","fa-cog"],["nz-button","","type","button",3,"disabled"],["nz-button","","type","button",3,"disabled","click"],["nz-checkbox","",3,"ngModel","ngModelOptions","ngModelChange"],["nz-button","","nzType","primary",3,"click"]],template:function(e,i){if(1&e&&(n.TgZ(0,"div",0)(1,"form",1),n.NdJ("ngSubmit",function(){return i.onSearch()}),n.TgZ(2,"div",2)(3,"div",3)(4,"label",4),n._uU(5,"M\xe3 s\u1ed1 thu\u1ebf"),n.qZA(),n._UZ(6,"input",5),n.qZA(),n.TgZ(7,"div",3)(8,"label",6),n._uU(9,"Email (C\xe1 nh\xe2n *)"),n.qZA(),n._UZ(10,"input",7),n.qZA(),n.YNc(11,vI,6,0,"div",8),n.YNc(12,CI,6,0,"div",8),n.YNc(13,yI,4,0,"div",8),n.YNc(14,wI,4,0,"div",8),n.qZA(),n.TgZ(15,"div",9)(16,"div",10)(17,"label",11),n._uU(18,"T\xecm theo: "),n.qZA(),n.TgZ(19,"nz-checkbox-group",12),n.NdJ("ngModelChange",function(o){return i.searchWhere=o}),n.qZA()()(),n.TgZ(20,"div",13)(21,"div",14)(22,"button",15),n.NdJ("click",function(){return i.onResetForm()}),n._uU(23,"L\u1ea5y t\u1eeb Form "),n.qZA(),n.TgZ(24,"button",16),n.YNc(25,TI,1,0,"i",17),n.YNc(26,kI,1,0,"i",18),n.TgZ(27,"span"),n._uU(28,"T\xecm theo TS24"),n.qZA()(),n.YNc(29,SI,2,1,"button",19),n.YNc(30,zI,4,2,"button",20),n.YNc(31,OI,4,2,"button",20),n.TgZ(32,"label",21),n.NdJ("ngModelChange",function(o){return i.chkUpForm=o})("click",function(){return i.onClickUp()}),n._uU(33,"Up+"),n.qZA(),n.TgZ(34,"label",22),n.NdJ("ngModelChange",function(o){return i.chkCreate=o}),n._uU(35,"T\u1ea1o..."),n.qZA()()()(),n.TgZ(36,"div",23),n._UZ(37,"div",24),n.qZA(),n.TgZ(38,"div",25)(39,"div",26)(40,"cy-custom-grid",27,28),n.NdJ("rowClicked",function(o){return i.onAgRowClick(o)})("gridReady",function(o){return i.onGridReady(o)}),n.qZA()()(),n.TgZ(42,"div",29)(43,"div",30),n.YNc(44,EI,6,3,"nz-input-group",31),n.TgZ(45,"button",32),n.NdJ("click",function(){return i.onCloseRef()}),n._uU(46,"\u0110\xf3ng"),n.qZA()()()()),2&e){const a=n.MAs(41);n.xp6(1),n.Q6J("formGroup",i.searchFrm),n.xp6(10),n.Q6J("ngIf",i.chkCreate),n.xp6(1),n.Q6J("ngIf",i.chkCreate),n.xp6(1),n.Q6J("ngIf",i.chkCreate),n.xp6(1),n.Q6J("ngIf",i.chkCreate),n.xp6(5),n.Q6J("ngModel",i.searchWhere)("ngModelOptions",n.DdM(27,vo)),n.xp6(3),n.Q6J("disabled",i.disabled),n.xp6(2),n.Q6J("disabled",i.disabled),n.xp6(1),n.Q6J("ngIf",i.isSearch),n.xp6(1),n.Q6J("ngIf",!i.isSearch),n.xp6(3),n.Q6J("ngIf",!1),n.xp6(1),n.Q6J("ngIf",i.chkCreate),n.xp6(1),n.Q6J("ngIf",i.chkCreate),n.xp6(1),n.Q6J("ngModel",i.chkUpForm)("ngModelOptions",n.DdM(28,vo))("disabled",i.disabled),n.xp6(2),n.Q6J("ngModel",i.chkCreate)("ngModelOptions",n.DdM(29,vo))("disabled",i.disabled),n.xp6(3),n.Q6J("innerHtml",i.searchLog,n.oJD),n.xp6(3),n.Q6J("columns",i.resultColumns)("theme",a.themeList.balham)("items",i.resultData)("options",i.agOption)("height","200px"),n.xp6(4),n.Q6J("ngIf",i.isExistData)}},directives:[ve._Y,ve.JL,ve.sg,ve.Fj,ve.JJ,ve.u,K.O5,Mn.w,Nr.ub,ve.On,It.ix,Mr.dQ,Nr.Ie,al],styles:['[class*=" row-"]{margin-bottom:10px}.form-body{padding:5px;border-radius:2px;border:1px solid #ebedf0}.form-body .row .ant-input:not(textarea){height:27px;border-radius:0}.form-body .row.tool{margin-top:5px}.form-body .row.tool .search-limit{width:50px;margin-right:10px}.row-data .ag-body-viewport{min-height:50px;max-height:200px}.row-footer{margin:5px -10px 0;padding:10px 6px 0 16px;text-align:right;border-top:2px solid #e8e8e8;border-radius:0 0 4px 4px}.row-footer .col-left1{text-align:left;padding-left:0;margin-left:-4px}.row-footer .col-left1 .total{font-weight:700;margin-left:5px;color:var(--bs-danger)}.row-footer .col-right{padding-right:5px}.row-footer .col-right .ant-btn:last-child{margin-right:0}.row-footer .col-right .ant-input-group{display:inline-flex;align-items:center;width:unset!important;margin-right:.5rem!important}a.open_link{text-decoration:underline;color:var(--blue)!important}\n'],encapsulation:2,changeDetection:0}),t})();const DI=["cChanels"],AI=["cProduct"],NI=["ngSlSupportHelp"];function MI(t,r){1&t&&(n.TgZ(0,"div",25)(1,"div",8)(2,"label",26),n._uU(3,"Ng\xe0y "),n.TgZ(4,"span",10),n._uU(5,"(*)"),n.qZA(),n._uU(6,": "),n.qZA(),n._UZ(7,"input",27),n.qZA()())}function RI(t,r){1&t&&(n.TgZ(0,"div",25)(1,"div",8)(2,"label",28),n._uU(3,"Ticket: "),n.qZA(),n._UZ(4,"input",29),n.qZA()())}function PI(t,r){1&t&&(n.TgZ(0,"div",12)(1,"div",8)(2,"label",30),n._uU(3,"T\xean NV "),n.TgZ(4,"span",10),n._uU(5,"(*)"),n.qZA(),n._uU(6,": "),n.qZA(),n._UZ(7,"input",31),n.qZA()())}function BI(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"div",32)(1,"div",3)(2,"div",12)(3,"div",8)(4,"label",33),n._uU(5,"Support Team"),n.TgZ(6,"span",10),n._uU(7,"(*)"),n.qZA(),n._uU(8,":"),n.qZA(),n.TgZ(9,"ng-select",34),n.NdJ("search",function(a){return n.CHM(e),n.oxw().odSearchItem("od_team",a)}),n.qZA()()(),n.TgZ(10,"div",12)(11,"div",8)(12,"label",35),n._uU(13,"Ph\xe2n c\xf4ng cho"),n.TgZ(14,"span",10),n._uU(15,"(*)"),n.qZA(),n._uU(16,":"),n.qZA(),n.TgZ(17,"ng-select",36),n.NdJ("search",function(a){return n.CHM(e),n.oxw().odSearchItem("od_assign",a)}),n.qZA()()(),n.TgZ(18,"div",12)(19,"div",8)(20,"label",37),n._uU(21,"Danh m\u1ee5c"),n.TgZ(22,"span",10),n._uU(23,"(*)"),n.qZA(),n._uU(24,":"),n.qZA(),n.TgZ(25,"ng-select",38),n.NdJ("change",function(a){return n.CHM(e),n.oxw().odChangeItem("od_category",a)})("search",function(a){return n.CHM(e),n.oxw().odSearchItem("od_category",a)}),n.qZA()()(),n.TgZ(26,"div",12)(27,"div",8)(28,"label",39),n._uU(29,"Topic"),n.TgZ(30,"span",10),n._uU(31,"(*)"),n.qZA(),n._uU(32,":"),n.qZA(),n.TgZ(33,"ng-select",40),n.NdJ("search",function(a){return n.CHM(e),n.oxw().odSearchItem("od_topic",a)}),n.qZA()()()()()}if(2&t){const e=n.oxw();n.xp6(9),n.Q6J("items",e.odWkTeamItems)("virtualScroll",!0)("loading",e.waitObj.od_team),n.xp6(8),n.Q6J("items",e.odAssignItems)("virtualScroll",!0)("loading",e.waitObj.od_assign),n.xp6(8),n.Q6J("virtualScroll",!0)("items",e.odCateItems),n.xp6(8),n.Q6J("virtualScroll",!0)("items",e.odTopicItems)}}function LI(t,r){1&t&&(n.TgZ(0,"div",17),n._uU(1,"-------"),n.qZA())}function UI(t,r){1&t&&(n.TgZ(0,"div",41)(1,"div",8)(2,"nz-input-group",42)(3,"label",43),n._uU(4,"M\xe3 s\u1ed1 thu\u1ebf "),n.TgZ(5,"span",10),n._uU(6,"(*)"),n.qZA(),n._uU(7,": "),n.qZA()(),n.TgZ(8,"nz-input-group",42),n._UZ(9,"input",44)(10,"input",45),n.qZA()()())}function HI(t,r){1&t&&(n.TgZ(0,"div",46)(1,"div",8)(2,"label",47),n._uU(3,"T\xean kh\xe1ch h\xe0ng: "),n.qZA(),n._UZ(4,"input",48),n.qZA()())}function VI(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"div",41)(1,"div",8)(2,"label"),n._uU(3,"Email + KH_ID "),n.TgZ(4,"span",10),n._uU(5,"(*)"),n.qZA(),n._uU(6,": "),n.qZA(),n.TgZ(7,"nz-input-group",42),n._UZ(8,"input",49),n.TgZ(9,"input",50),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().onChangeKhId(a)}),n.qZA()()()()}}function ZI(t,r){1&t&&(n.TgZ(0,"div",46)(1,"div",8)(2,"label",51),n._uU(3,"S\u1ed1 DT: "),n.qZA(),n._UZ(4,"input",52),n.qZA()())}function jI(t,r){1&t&&(n.TgZ(0,"div",41)(1,"nz-input-group",53)(2,"div",54)(3,"div",8)(4,"label",55),n._uU(5,"N\u1ed9i dung h\u1ed7 tr\u1ee3 "),n.TgZ(6,"span",10),n._uU(7,"(*)"),n.qZA(),n._uU(8,": "),n.qZA(),n._UZ(9,"input",56),n.qZA()(),n.TgZ(10,"div",57)(11,"div",8)(12,"label",58),n._uU(13,"TG ti\u1ebfp nh\u1eadn "),n.TgZ(14,"span",10),n._uU(15,"(*)"),n.qZA(),n._uU(16,": "),n.qZA(),n._UZ(17,"input",59),n.qZA()()()())}function GI(t,r){1&t&&(n.TgZ(0,"div",46)(1,"div",8)(2,"label",60),n._uU(3,"Teamviewer: "),n.qZA(),n._UZ(4,"input",61),n.qZA()())}function WI(t,r){1&t&&(n.TgZ(0,"div",41)(1,"nz-input-group",53)(2,"div",54)(3,"div",8)(4,"label",62),n._uU(5,"N\u1ed9i dung \u0111\xe3 h\u1ed7 tr\u1ecd "),n.TgZ(6,"span",10),n._uU(7,"(*)"),n.qZA(),n._uU(8,": "),n.qZA(),n._UZ(9,"input",63),n.qZA()(),n.TgZ(10,"div",57)(11,"div",8)(12,"label",64),n._uU(13,"TG ho\xe0n th\xe0nh "),n.TgZ(14,"span",10),n._uU(15,"(*)"),n.qZA(),n._uU(16,": "),n.qZA(),n._UZ(17,"input",65),n.qZA()()()())}const ar=function(){return{standalone:!0}};function YI(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"div",46)(1,"div",8)(2,"label",66),n._uU(3,"N\u1ed9i dung m\u1eabu"),n.qZA(),n.TgZ(4,"span"),n._uU(5," --- "),n.qZA(),n.TgZ(6,"label",67),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().isDeleteContentHelp=a}),n._uU(7,"X\xf3a"),n.qZA(),n.TgZ(8,"ng-select",68),n.NdJ("change",function(a){return n.CHM(e),n.oxw().onChangeCHelp(a)}),n.qZA()()()}if(2&t){const e=n.oxw();n.xp6(6),n.Q6J("ngModel",e.isDeleteContentHelp)("ngModelOptions",n.DdM(3,ar)),n.xp6(2),n.Q6J("items",e.helps)}}function $I(t,r){if(1&t&&(n.TgZ(0,"div",12)(1,"div",8)(2,"label",69),n._uU(3,"H\xecnh th\u1ee9c h\u1ed7 tr\u1ee3 "),n.TgZ(4,"span",10),n._uU(5,"(*)"),n.qZA(),n._uU(6,": "),n.qZA(),n._UZ(7,"ng-select",70,71),n.qZA()()),2&t){const e=n.oxw();n.xp6(7),n.Q6J("items",e.chanels)("virtualScroll",!0)}}function JI(t,r){if(1&t&&(n.TgZ(0,"div",12)(1,"div",8)(2,"label",72),n._uU(3,"T\xean ph\u1ea7n m\u1ec1m "),n.TgZ(4,"span",10),n._uU(5,"(*)"),n.qZA(),n._uU(6,": "),n.qZA(),n._UZ(7,"ng-select",73),n.qZA()()),2&t){const e=n.oxw();n.xp6(7),n.Q6J("items",e.SoftNames)("virtualScroll",!0)}}function QI(t,r){1&t&&(n.TgZ(0,"div",12)(1,"div",8)(2,"label",74),n._uU(3,"T\xean c\xf4ng ty: "),n.qZA(),n._UZ(4,"input",75),n.qZA()())}function qI(t,r){if(1&t&&(n.TgZ(0,"div",12)(1,"div",8)(2,"label",76),n._uU(3,"S\u1ea3n ph\u1ea9m: "),n.qZA(),n._UZ(4,"ng-select",77,78),n.qZA()()),2&t){const e=n.oxw();n.xp6(4),n.Q6J("items",e.products)("virtualScroll",!0)}}function XI(t,r){if(1&t&&(n.TgZ(0,"div",7)(1,"div",8)(2,"label",85),n._uU(3,"H\u1ed7 tr\u1ee3 => Subject <-> (Y/C nh\u1eadp m\xe3 s\u1ed1 thu\u1ebf) "),n.qZA(),n.TgZ(4,"nz-input-group",86),n._UZ(5,"input",87,88),n.qZA()()()),2&t){const e=n.oxw(2),i=n.MAs(52);n.xp6(4),n.Q6J("nzSuffix",i),n.xp6(1),n.Q6J("readonly",!e.isEmailTicket)}}function KI(t,r){1&t&&(n.TgZ(0,"div",7)(1,"div",8)(2,"label",89),n._uU(3,"N\u1ed9i dung email"),n.qZA(),n._UZ(4,"textarea",90),n.qZA()())}function eO(t,r){1&t&&(n.TgZ(0,"div",7)(1,"div",8)(2,"label",91),n._uU(3,"H\u1ed7 tr\u1ee3 => Body: "),n.qZA(),n._UZ(4,"textarea",92),n.qZA()())}function tO(t,r){1&t&&(n.TgZ(0,"div",7)(1,"div",8)(2,"label",93),n._uU(3,"H\u1ed7 tr\u1ee3 => Note: "),n.qZA(),n._UZ(4,"textarea",94),n.qZA()())}function nO(t,r){1&t&&(n.TgZ(0,"div",7)(1,"div",8)(2,"label",95),n._uU(3,"H\u1ed7 tr\u1ee3 => Copy: "),n.qZA(),n._UZ(4,"textarea",96),n.qZA()())}function rO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"div",79)(1,"div",3),n.YNc(2,XI,7,2,"div",80),n.YNc(3,KI,5,0,"div",80),n.YNc(4,eO,5,0,"div",80),n.YNc(5,tO,5,0,"div",80),n.YNc(6,nO,5,0,"div",80),n.qZA(),n.TgZ(7,"div",3)(8,"div",81)(9,"label",82),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().isAutoCreate=a})("click",function(){return n.CHM(e),n.oxw().onClickAutoCreate()}),n._uU(10,"T\u1ef1 \u0111\u1ed9ng t\u1ea1o > Copy"),n.qZA()(),n.TgZ(11,"div",81)(12,"label",83),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().isAutoInput=a}),n._uU(13,"[TS] T\u1ef1 \u0111\u1ed9ng \u0111i\u1ec1n"),n.qZA()(),n.TgZ(14,"div",81)(15,"label",82),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().isViewAll=a})("click",function(){return n.CHM(e),n.oxw().onClickShowMore()}),n._uU(16,"Hi\u1ec3n th\u1ecb ALL"),n.qZA()(),n.TgZ(17,"div",81)(18,"label",82),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().isViewColOdoo=a})("click",function(){return n.CHM(e),n.oxw().onClickShowOdoo()}),n._uU(19,"Hi\u1ec3n th\u1ecb c\u1ed9t TS24"),n.qZA()(),n.TgZ(20,"div",81)(21,"label",83),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().isSaveCache=a}),n._uU(22,"L\u01b0u Cache"),n.qZA()(),n.TgZ(23,"div",81)(24,"label",83),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().isViewTicket=a}),n._uU(25," \u1ea8n Danh s\xe1ch"),n.qZA()(),n.TgZ(26,"div",81)(27,"label",83),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().chkQuestion=a}),n._uU(28,"L\u01b0u n\u1ed9i dung m\u1eabu"),n.qZA()(),n.TgZ(29,"div",81)(30,"label",84),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().changeChkEmailTicket(a)})("ngModelChange",function(a){return n.CHM(e),n.oxw().isEmailTicket=a}),n._uU(31,"E-mail ticket"),n.qZA()()()()}if(2&t){const e=n.oxw();n.xp6(2),n.Q6J("ngIf",e.isViewAll||e.isEmailTicket),n.xp6(1),n.Q6J("ngIf",e.isEmailTicket&&e.isRole("email_ticket")),n.xp6(1),n.Q6J("ngIf",e.isViewAll),n.xp6(1),n.Q6J("ngIf",e.isViewAll),n.xp6(1),n.Q6J("ngIf",!e.isViewAll),n.xp6(3),n.Q6J("ngModel",e.isAutoCreate)("ngModelOptions",n.DdM(21,ar)),n.xp6(3),n.Q6J("ngModel",e.isAutoInput)("ngModelOptions",n.DdM(22,ar)),n.xp6(3),n.Q6J("ngModel",e.isViewAll)("ngModelOptions",n.DdM(23,ar)),n.xp6(3),n.Q6J("ngModel",e.isViewColOdoo)("ngModelOptions",n.DdM(24,ar)),n.xp6(3),n.Q6J("ngModel",e.isSaveCache)("ngModelOptions",n.DdM(25,ar)),n.xp6(3),n.Q6J("ngModel",e.isViewTicket)("ngModelOptions",n.DdM(26,ar)),n.xp6(3),n.Q6J("ngModel",e.chkQuestion)("ngModelOptions",n.DdM(27,ar)),n.xp6(3),n.Q6J("ngModel",e.isEmailTicket)("ngModelOptions",n.DdM(28,ar))}}function iO(t,r){1&t&&n._UZ(0,"i",113)}function aO(t,r){1&t&&n._UZ(0,"i",114)}function oO(t,r){if(1&t&&(n.TgZ(0,"button",111),n.YNc(1,iO,1,0,"i",104),n.YNc(2,aO,1,0,"i",112),n._uU(3),n.qZA()),2&t){const e=n.oxw(2);n.Q6J("disabled",e.ticketForm.invalid||e.disabledAction),n.xp6(1),n.Q6J("ngIf",e.isSaveTicket),n.xp6(1),n.Q6J("ngIf",!e.isSaveTicket),n.xp6(1),n.hij("",e.isUpdateTicket?"C\u1eadp nh\u1eadt":"L\u01b0u l\u1ea1i"," ")}}function sO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"button",101),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).onDeleteTicket()}),n._UZ(1,"i",115),n._uU(2,"X\xf3a Ticket "),n.qZA()}if(2&t){const e=n.oxw(2);n.Q6J("disabled",e.disabledAction)}}function lO(t,r){1&t&&n._UZ(0,"i",116)}function cO(t,r){1&t&&n._UZ(0,"i",113)}function uO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"button",101),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).onCreateNew()}),n._UZ(1,"i",117),n._uU(2,"T\u1ea1o m\u1edbi "),n.qZA()}if(2&t){const e=n.oxw(2);n.Q6J("disabled",e.disabledAction)}}function dO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"button",101),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).onFindPartner()}),n._UZ(1,"i",118),n.TgZ(2,"span"),n._uU(3,"T\xecm KH"),n.qZA()()}if(2&t){const e=n.oxw(2);n.Q6J("disabled",e.disabledAction)}}function fO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",119),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).autoFixTicket()}),n._UZ(1,"i",118),n._uU(2,"S\u1eeda l\u1ed7i ticket "),n.qZA()}}function pO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",119),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).onCopyTicketWeb()}),n._UZ(1,"i",120),n._uU(2,"L\u1ea5y ticket "),n.qZA()}}function hO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",119),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).onCopyTicket()}),n._UZ(1,"i",120),n._uU(2,"Sao ch\xe9p "),n.qZA()}}function mO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",119),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).onTest()}),n._UZ(1,"i",118),n._uU(2,"onTest() "),n.qZA()}}function gO(t,r){1&t&&n._UZ(0,"i",113)}function _O(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"button",121),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).onOpenUserConfig()}),n._UZ(1,"i",122),n.YNc(2,gO,1,0,"i",104),n.TgZ(3,"span"),n._uU(4,"C\xe0i m\u1eb7c \u0111\u1ecbnh"),n.qZA()()}if(2&t){const e=n.oxw(2);n.Q6J("disabled",e.disabledAction),n.xp6(2),n.Q6J("ngIf",e.isUpdateUser)}}function xO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"div",97)(1,"div",98),n.YNc(2,oO,4,4,"button",99),n.YNc(3,sO,3,1,"button",100),n.TgZ(4,"button",101),n.NdJ("click",function(){return n.CHM(e),n.oxw().onCompleteTicket()}),n._UZ(5,"i",102),n._uU(6,"Ho\xe0n th\xe0nh "),n.qZA(),n.TgZ(7,"button",101),n.NdJ("click",function(){return n.CHM(e),n.oxw().onLoadCatalog()}),n.YNc(8,lO,1,0,"i",103),n.YNc(9,cO,1,0,"i",104),n.TgZ(10,"span"),n._uU(11,"T\u1ea3i Danh m\u1ee5c"),n.qZA()(),n.YNc(12,uO,3,1,"button",100),n.YNc(13,dO,4,1,"button",100),n.TgZ(14,"button",105),n._UZ(15,"i",106),n.TgZ(16,"span"),n._uU(17,"Kh\xe1c"),n.qZA()(),n.TgZ(18,"nz-dropdown-menu",null,107)(20,"ul",108),n.YNc(21,fO,3,0,"li",109),n.YNc(22,pO,3,0,"li",109),n.YNc(23,hO,3,0,"li",109),n.YNc(24,mO,3,0,"li",109),n.qZA()(),n.YNc(25,_O,5,2,"button",110),n.qZA()()}if(2&t){const e=n.MAs(19),i=n.oxw();n.xp6(2),n.Q6J("ngIf",i.isRole("create")),n.xp6(1),n.Q6J("ngIf",i.isUpdateTicket&&i.isRole("delete_ticket")),n.xp6(1),n.Q6J("disabled",i.disabledAction),n.xp6(3),n.Q6J("disabled",i.disabledAction),n.xp6(1),n.Q6J("ngIf",!i.isAsyncCatalog),n.xp6(1),n.Q6J("ngIf",i.isAsyncCatalog),n.xp6(3),n.Q6J("ngIf",i.isRole("create")),n.xp6(1),n.Q6J("ngIf",i.isRole("find_kh")),n.xp6(1),n.Q6J("disabled",i.disabledAction)("nzDropdownMenu",e),n.xp6(7),n.Q6J("ngIf",i.isRole("fix_row")),n.xp6(1),n.Q6J("ngIf",i.isRole("get_tweb")),n.xp6(1),n.Q6J("ngIf",i.isRole("copy")),n.xp6(1),n.Q6J("ngIf",i.isRole("test")),n.xp6(1),n.Q6J("ngIf",i.isRole("cfig_def"))}}function vO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"i",123),n.NdJ("click",function(){return n.CHM(e),n.oxw().onClearSubject()}),n.qZA()}}let CO=(()=>{class t{constructor(e,i,a,o,s,l,c,u){this.aRouter=e,this.nzModal=i,this.fb=a,this.shared=o,this.ticketCtrl=s,this.odoo=l,this.user=c,this.ngCfig=u,this.logger=new pd.Y(t),this._userCache={},this.save=new n.vpe,this.remove=new n.vpe,this.asyncInput=new n.vpe(!1),this.isInitPageChange=new n.vpe(!1),this.handlerLoadCate=new n.vpe,this.isCreateNew=!0,this.isInitPage=!0,this.userCfigModalRef=void 0,this.isViewSetDefault=!1,this.inputUserCfigObj={id:"#UserConfig"},this.acceptEditPartner=!0,this.isViewTicket=!0,this.isAutoLoadCate=!0,this.isDeleteContentHelp=!1,this.userDetail=new hI.h,this.editTicket=null,this.isSaveTicket=!1,this.isAsyncCatalog=!1,this.setDataFromOther=void 0,this.isAutoCreate=!0,this.isAutoInput=!1,this.isViewAll=!1,this.isViewColOdoo=!1,this.isEmailTicket=!0,this.isAutoOpenSaveCfigDef=!1,this.chkQuestion=!1,this.isSaveCache=!1,this.isUpdateUser=!1,this._isEmailTicketCache=!1,this.ghelps=[],this.helps=[],this.chanels=[],this.softwares=[],this.products=[],this.odWkTeamItems=[],this.odAssignItems=[],this.odTopicItems=[],this.odCateItems=[],this.waitObj={od_category:!1,od_team:!1,od_assign:!1,od_topic:!1},this.OD_KEYS={cate:"od_category",team:"od_team",assign:"od_assign",topic:"od_topic",partner:"od_partner"},this.isClickSaveDef=!1,this.isCheckImage=!1,this.ticketNumber=void 0,this.ticketDefault=void 0}ngOnInit(){this.aRouter.queryParamMap.subscribe(e=>{this.isAutoOpenSaveCfigDef=(0,D.oA)(e.get("save_default"))}),this.ngCfig.notFoundText="Kh\xf4ng c\xf3 d\xf2ng n\xe0o.",this.ngCfig.clearAllText="X\xf3a d\u1eef li\u1ec7u",this.isInitPage=!0,this.userDetail=this.user.read(),this.initAutoChk(),this.isAutoLoadCate?this.onLoadCatalog():this.loadCateFromCookie(this.shared.catalogs),this.createFormGroup()}ngOnChanges(e){}loadCateFromCookie(e){var i=this;e=e||this.shared.catalogs,Promise.resolve(e).then(function(){var a=Eo(function*(o){let s=yield o;i.helps=s.questions||[],i.chanels=s.chanels||[],i.softwares=s.softwares||[],i.ghelps=s.group_helps||[],i.odWkTeamItems=s.od_team||[],i.odCateItems=s.od_category||[],i.odAssignItems=s.od_assign||[],i.odTopicItems=s.od_topic||[]});return function(o){return a.apply(this,arguments)}}()).then(a=>{this.onCreateNew(),this.isInitPage=!1})}initAutoChk(){let e=this.userDetail.config.auto_create;this.isAutoCreate=void 0===e||e,this.isViewAll=this.userDetail.config.view_all,this.isSaveCache=this.userDetail.config.save_cache,this.isViewColOdoo=this.userDetail.config.show_ts24,this.isAutoInput=this.isAutoInput||this.userDetail.config.auto_input}ngAfterViewInit(){}odSearchItem(e,i){let a="string"==typeof i?i:i.term;if(!((0,D.EU)(a)||a.length<3))switch(e){case this.OD_KEYS.assign:this.waitObj.od_assign=!0,this.odoo.user.nameSearch(a).subscribe(o=>{this.odAssignItems=o,this.waitObj.od_assign=!1});break;case this.OD_KEYS.team:this.waitObj.od_team=!0,this.odoo.team.nameSearch(a).subscribe(o=>{this.odWkTeamItems=o,this.waitObj.od_team=!1})}}odChangeItem(e,i,a=!0){if(e===this.OD_KEYS.cate&&!(0,D.Ft)(i)){a=!1!==a&&this.isAutoInput;let o=this.ticketForm.get(this.OD_KEYS.team);if((0,D.Ft)(o.value)||(0,D.G5)(o.value)||a){let u=i.wk_team;(0,D.gS)(u)||(this.odWkTeamItems=[u,...this.odWkTeamItems.slice(1)]),o.setValue(u)}let s=this.ticketForm.get(this.OD_KEYS.assign);if((0,D.Ft)(s.value)||a){this.odAssignItems=[this.userDetail.od_user,i.manager];let u=this.odAssignItems.filter(d=>!0===d.is_select)[0]||this.odAssignItems[0];s.setValue(u)}let l=this.OD_KEYS.topic,c=this.ticketForm.get(l);if((0,D.Ft)(c.value)||a){let u=this.odTopicItems.filter(d=>d.category_id[0]===i.id);this.ticketForm.get(l).setValue(u[0])}}}get ticket(){return this.formValue}isRole(e,i){return this.user.read().isRole(e,i)}set ticket(e){this.isInitPage?this.editTicket=e:(this.setDataFromOther=!0,this.setTicket(e))}setTicket(e,i=!0){if(Object.keys(e||{}).forEach(a=>{let o=e[a],s=o instanceof Array&&(0,D.G5)(o),l=o instanceof Object&&(0,D.gS)(o);((0,D.Ft)(o)||s||l)&&delete e[a]}),this.ticketDefault=i?this.createTicketDefault():{showMore:!1,tAuto:!0,showColOdoo:!1},e=Object.assign(this.ticketDefault,e),this.isCreateNew=(0,D.EU)(e.ticket_id),this.isEmailTicket=this.isCreateNew?this._userCache.isEmailTicket||!1:e.isEmailTicket,(0,D.Ft)(this.ticketForm)&&this.createFormGroup(),!(0,D.EU)(e.ticket_id)){let a=e[this.OD_KEYS.cate]||{},o=this.odCateItems.filter(s=>s.id===a.id);o.length>0&&(e[this.OD_KEYS.cate]=o[0])}if((0,D.Ft)(e.support_help)&&!(0,D.G5)(e.chanels)&&(e.support_help=e.chanels[e.chanels.length-1]),(0,D.Ft)(e.soft_name)&&!(0,D.Ft)(e.software)&&(e.soft_name=e.software.soft_names[0]),!(0,D.Ft)(e.group_help)&&(0,D.Ft)(e.group_help.title)){let a=e.group_help.id,o=this.ghelps.filter(s=>s.id===a);e.group_help=o.length>0?o[0]:e.group_help}if((0,D.Ft)(e.product_id)||this.products.forEach(a=>{a.extend_id!==e.product_id||(e.product=a)}),!(0,D.gS)(e.od_image)){let a=Object.keys(e.od_image)||[];a.length>0&&(e.image_name=a.map(o=>o.replace(".png","")).join(";"),this.setEnableFC("image_name",(0,D.kl)(e.is_upfile,!1)))}e.body=(0,D.EU)(e.body)?!0===this.isAutoCreate?mo(e).join("\n"):")":e.body,e.note=(0,D.EU)(e.note)?!0===this.isAutoCreate?go(e).join("\n"):"":e.note,e.subject=(0,D.EU)(e.subject)?!0===this.isAutoCreate?_o(e):"":e.subject,e.content_copy=(0,D.EU)(e.content_copy)?!0===this.isAutoCreate?fd(e,!this.isViewAll):"khong co":e.content_copy,0===e.od_khid&&(e.od_khid=void 0),this.update_contentCopy(e.content_copy),this.update_helpdeskBody(e.content_copy),this.update_helpdeskNote(e.note),this.update_helpdeskSubject("000000"+e.subject),D.K$.log(e.subject,this.isAutoCreate),this.ticketNumber=e.ticket_number,this.resetForm(e),this.asyncInput.emit(!1),this.isCreateNew=(0,D.Ft)(e.ticket_id)}setEnableFC(e,i){let a=this.ticketForm.get(e);i?a.enable():a.disable()}resetForm(e){this.ticketForm.reset(Object.assign({},e)),this.odChangeItem(this.OD_KEYS.cate,e[this.OD_KEYS.cate],!1)}get formValue(){return(0,D.Ft)(this.ticketForm)?{}:Object.assign({},this.ticketForm.getRawValue())}get isUpdateTicket(){return!(0,D.Ft)(this.ticket)&&!(0,D.Ft)(this.ticket.ticket_id)}get SoftNames(){const e=this.formValue.software;return(0,D.Ft)(e)?[]:e.soft_names}updateFValue(e,i){this.ticketForm.get(e).setValue(i)}changeEnableOrDisableCHelp(){const e=this.ticketForm.get("content_help"),i=this.ticketForm.get("content_required"),a=this.ticketForm.get("help");e.valueChanges.subscribe(o=>{(0,D.EU)(o)||(0,D.EU)(i.value)?a.enable():a.disable()}),i.valueChanges.subscribe(o=>{(0,D.EU)(o)||(0,D.EU)(e.value)?a.enable():a.disable()})}pathValue(e,i){this.ticketForm.patchValue({[e]:i}),!0===this.isAutoCreate&&this.autoFixTicket()}onLoadCatalog(e){this.logger.log("------ onLoadCatalog() ------- "),this.isAsyncCatalog=!0;let i=this.shared.loading("L\u1ea5y d\u1eef li\u1ec7u danh m\u1ee5c"),o=this.ticketCtrl.loadCatalogs(!0).pipe((0,zt.w)(d=>{this.chanels=d.chanels,this.helps=d.questions,this.ghelps=d.group_helps,this.softwares=d.softwares,this.products=d.products,this.odCateItems=d[this.OD_KEYS.cate]||[],this.odTopicItems=d[this.OD_KEYS.topic]||[];let f=d[this.OD_KEYS.team]||[];if(this.odWkTeamItems=[{display_name:"-- Ch\u1ecdn Team --"},...f],(0,D.Ft)(this.formValue[this.OD_KEYS.team])&&1===f.length){let p=f[0].manager,m={id:p[0],display_name:p[1]};this.ticketForm.get(this.OD_KEYS.team).setValue(f[0]),this.ticketForm.get(this.OD_KEYS.assign).setValue(m)}return(0,Ke.of)(d)})),s=!1,c=(0,Ke.of)(o).pipe((0,oi.b)(d=>d.pipe(si(1e3)))).subscribe(()=>{},d=>{s=!0,c.unsubscribe()});this.handlerLoadCate.emit(c);let u=Rr(100).subscribe(d=>{if(c.closed){if(this.isAsyncCatalog=!1,this.shared.alert.remove(i.messageId),s||(this.shared.alert.success("\u0110\xe3 l\u1ea5y xong danh m\u1ee5c"),this.shared.catalogs=Object.assign(Object.assign({},this.shared.catalogs),{isAutoLoadCate:!1}),this.isAutoLoadCate=!1,this.isAutoOpenSaveCfigDef&&this.onOpenUserConfig()),this.isInitPage){let f=!0===e?this.fixFormValIsNull(this.editTicket||this.formValue||{}):this.editTicket;this.setTicket(f),this.isInitPage=!1}u.unsubscribe()}},(0,Ai.q)(1))}fixFormValIsNull(e){return Object.keys(e).map(i=>{let a=e[i];return Array.isArray(a)?(0,D.G5)(a)&&(a=void 0):"object"==typeof a?(0,D.gS)(a)&&(a=void 0):(0,D.EU)(a)&&(a=void 0),{[i]:a}}).reduce((i,a)=>Object.assign(Object.assign({},i),a),{})}onClickAutoCreate(){!0===this.isAutoCreate&&this.autoFixTicket()}onCreateNew(e){D.K$.log(" -- onCreateNew() --"),e=Object.assign({},e),this.setDataFromOther=void 0,this.isEmailTicket=this._userCache.isEmailTicket||this._isEmailTicketCache,this.save.emit({ticket:void 0,isNew:!0}),this.setTicket(e,!0);let i=this._userCache.isEmailTicket;this.isEmailTicket=null==i?this._isEmailTicketCache:i}onCopyTicket(){let e=this.formValue;delete e.ticket_id,this.setDataFromOther=void 0,this.setTicket(e,!1)}addDayDate(e,i){return e.setMinutes(e.getMinutes()+i),e}onCompleteTicket(){this.pathValue("complete_time",new K.uU("en-US").transform(new Date,"yyyyMMdd-HH:mm"))}onOpenUserConfig(){this.userCfigModalRef=this.nzModal.create({nzWidth:700,nzMaskClosable:!1,nzClosable:!1,nzClassName:"user-config",nzTitle:"L\u01b0u d\u1eef li\u1ec7u m\u1eb7c \u0111\u1ecbnh",nzContent:t,nzOkText:"Luu m\u1eb7c \u0111\u1ecbnh",nzCancelText:"\u0110\xf3ng",nzComponentParams:{isViewCfigDef:this.userDetail.roles.cfig_def_input,isViewSetDefault:!0,isAutoInput:!0,isAutoLoadCate:!1},nzOnCancel:()=>"close",nzOnOk:()=>this.updateUserConfig().pipe((0,Jn.b)(e=>this.isClickSaveDef=!0)).toPromise()}),this.userCfigModalRef.afterClose.subscribe(e=>{"object"==typeof e&&(this._userCache={},this.isAutoOpenSaveCfigDef=!1)})}onChangeKhId(e){let i=(0,D.EU)(e)||0===Number.parseInt(e);["tax_code","customer_name","email","company_name"].forEach(o=>{const s=this.ticketForm.get(o);i?s.enable():s.disable({emitEvent:!0})})}updateUserConfig(){return new Nt.y(e=>{D.K$.log("updateUserConfig","C\u1eadp nh\u1eadt c\u1ea5u h\xecnh ng\u01b0\u1eddi d\xf9ng.");let i=this.userCfigModalRef.getContentComponent();this.isUpdateUser=!0;let a=this.shared.loading("<b>C\u1eadp nh\u1eadt danh m\u1ee5c m\u1eb7c \u0111\u1ecbnh.</b>"),o=this.user.read(),s=i.formValue,l={name:s.full_name,val_def:{chanel_ids:(0,D.G5)(s.chanels)?[]:s.chanels.map(c=>c.chanel_id),ghelp_id:(0,D.Ft)(s.group_help)?0:s.group_help.id,software_id:(0,D.Ft)(s.software)?0:s.software.id,product_id:(0,D.Ft)(s.product)?0:s.product.extend_id,support_help_id:(0,D.Ft)(s.support_help)?0:s.support_help.chanel_id,od_team_id:(0,D.Ft)(s[this.OD_KEYS.team])?0:s[this.OD_KEYS.team].id,od_category_id:(0,D.Ft)(s[this.OD_KEYS.cate])?0:s[this.OD_KEYS.cate].id,od_topic_id:(0,D.Ft)(s[this.OD_KEYS.topic])?0:s[this.OD_KEYS.topic].id,od_assign_id:(0,D.Ft)(s[this.OD_KEYS.assign])?0:s[this.OD_KEYS.assign].id,soft_name:s.soft_name},config:{show_ts24:this.isViewColOdoo,auto_create:this.isAutoCreate,auto_input:this.isAutoInput}};(0,D.EU)(s.od_user_def)||(l.odoo_user=JSON.parse(s.od_user_def||{})),(0,D.EU)(s.cookie_value)||(l.cookie_value=s.cookie_value),(0,D.EU)(s.csrf_token)||(l.csrf_token=s.csrf_token),this.user.updateOne(o.id,l).subscribe(c=>{this.isUpdateUser=!1,this.shared.alert.remove(a.messageId),this.shared.alert.success("C\u1eadp nh\u1eadt d\u1eef li\u1ec7u m\u1eb7c \u0111\u1ecbnh xong."),e.next(c),e.complete()},c=>{this.isUpdateUser=!1,this.shared.alert.remove(a.messageId),e.error(c)})})}onCopyTicketWeb(){this.nzModal.create({nzTitle:"L\u1ea5y ticket t\u1eeb Odoo",nzClosable:!1,nzContent:mI,nzMaskClosable:!1,nzOkText:"L\u1ea5y Ticket",nzCancelText:"\u0110\xf3ng",nzFooter:null}).afterClose.subscribe(i=>{if(!(0,D.Ft)(i)&&!(0,D.gS)(i.data)){this.shared.alert.success("\u0110\xe3 l\u1ea5y xong ticket t\u1eeb web.");let a=Object.assign(Object.assign({},i.data),{chanels:void 0,source_text:"odoo"});this.onCreateNew(a)}})}onSaveTicket(e=!0){!0===e&&this.ticketForm.invalid?this.shared.showError({error:{code:"230",message:"Ch\u01b0a nh\u1eadp \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin"}}):new Nt.y(a=>{(0,D.EU)(this.ticketNumber)?(a.next("update"),a.complete()):this.nzModal.create({nzTitle:"Th\xf4ng b\xe1o",nzClosable:!1,nzContent:`Ticket n\xe0y \u0111\xe3 c\xf3 s\u1ed1 [ID=${this.ticketNumber}] -> <b>B\u1ea1n c\xf3 mu\u1ed1n c\u1eadp nh\u1eadt l\u1ea1i th\xf4ng tin tr\xean h\u1ec7 th\u1ed1ng.</b>`,nzMaskClosable:!1,nzOkText:"C\u1eadp nh\u1eadt",nzCancelText:"Kh\xf4ng c\u1eadp nh\u1eadt",nzOnOk:()=>Promise.resolve("update")}).afterClose.subscribe(s=>{a.next(s),a.complete()})}).subscribe(a=>{if("update"===a){this.isSaveTicket=!0;let o={},l=[this.getAndValidateTicket(),this.handleSaveTicket(o)],c=!1,u=(0,Ke.of)(...l).pipe((0,oi.b)(f=>f)).subscribe({next:f=>{this.logger.log("K\u1ebft qu\u1ea3: Oki"),o=Object.assign(o,f)},error:f=>{this.logger.log("K\u1ebft qu\u1ea3: Error"),this.logger.log(f),null!=u&&u.unsubscribe(),c=!0}}),d=Rr(1e3).subscribe(f=>{u.closed&&(this.isSaveTicket=!1,d.unsubscribe())})}})}getAndValidateTicket(){return new Nt.y(e=>{this.logger.log("getAndValidateTicket() -> Chu\u1ea9n b\u1ecb d\u1eef li\u1ec7u l\u01b0u + c\u1eadp nh\u1eadt ticket");const i=this.formValue,a=this.user.read();if(i.user_id=a.id,i.ticket_number=(0,D.EU)(i.ticket_number)?null:i.ticket_number,i.chanel_ids=i.chanels.map(u=>u.chanel_id),i.product_id=(0,D.Ft)(i.product)?null:i.product.extend_id,i.software_id=(0,D.Ft)(i.software)?null:i.software.id,i.support_help_id=(0,D.Ft)(i.support_help)?null:i.support_help.chanel_id,i.group_help_id=(0,D.Ft)(i.group_help)?null:i.group_help.id,i.isEmailTicket=this.isEmailTicket,i.od_category=Object.assign({},i.od_category),!(0,D.gS)(i.od_assign)){let u=i.od_assign;i.od_assign={id:u.id,name:u.name,display_name:u.display_name}}(0,D.EU)(i.image_name)||(i.od_image=D.mz.reduce(i.image_name.split(";"),u=>({[u]:null}))),this.chkQuestion&&(i.question_save={title:i.content_required,question:i.content_required,reply:i.content_help,type:i.od_category.id,user_id:this.userDetail.id,is_shared:!1}),!0===this.isSaveCache?(this.shared.setByKey("isAutoCreate",this.isAutoCreate),this.shared.setByKey("isViewAll",this.isViewAll),this.shared.setByKey("isSaveCache",this.isSaveCache),this._userCache={chanels:i.chanels,ghelp:Object.assign({},i.group_help),software:Object.assign({},i.software),support_help:Object.assign({},i.support_help),soft_name:i.soft_name,product_id:(0,D.Ft)(i.product)?void 0:i.product.extend_id,od_team:Object.assign({},i.od_team),od_category:Object.assign({},i.od_category),od_assign:Object.assign({},i.od_assign),od_topic:Object.assign({},i.od_topic),isEmailTicketCache:this._isEmailTicketCache},D.K$.log("L\u01b0u cache: ",this._userCache)):this._userCache={};const o=Object.assign({},i);["od_user_def","cookie_value","csrf_token","help","chanels","product","software","support_help","first_chanel","group_help","image_name"].forEach(u=>delete o[u]);let l=o[this.OD_KEYS.cate];["wk_team","manager","sequence"].forEach(u=>delete l[u]);let c=o[this.OD_KEYS.topic];["description","sequence"].forEach(u=>delete c[u]),e.next(Object.assign({},o)),e.complete()})}handleSaveTicket(e){return new Nt.y(i=>{let a=e.ticket_id;(0,D.EU)(a)?(this.logger.log("handleSaveTicket() -> T\u1ea1o m\u1edbi ticket"),this.ticketCtrl.addOne(e).subscribe(o=>{this.editTicket=o,this.setTicket(o,!1),this.save.emit({ticket:o,isNew:(0,D.Ft)(this.setDataFromOther)}),this.shared.alert.success(`[${o.ticket_id}] Th\xeam m\u1edbi ticket th\xe0nh c\xf4ng.`),this.isSaveTicket=!1,this.asyncInput.emit(!1),this.updateQuestion(o),i.next(o),i.complete()},o=>i.error(o))):(this.logger.log("handleSaveTicket() -> C\u1eadp nh\u1eadt ticket"),this.ticketCtrl.updateOne(a,e).subscribe(o=>{this.setTicket(o,!1),this.save.emit({ticket:o,isNew:!1}),this.shared.alert.success(`[${o.ticket_id}] C\u1eadp nh\u1eadt ticket th\xe0nh c\xf4ng.`),this.isSaveTicket=!1,this.asyncInput.emit(!1),this.updateQuestion(o),i.next(o),i.complete()},o=>i.error(o)))})}updateQuestion(e){let i=e.question_save;(0,D.gS)(i)||(this.helps=[...this.helps,i])}onDeleteTicket(){(0,D.Ft)(this.ticket.ticket_id)?this.shared.alert.warning("Ch\u1ecdn l\u1ea1i d\xf2ng ticket c\u1ea7n x\xf3a."):this.nzModal.confirm({nzTitle:"B\u1ea1n mu\u1ed1n x\xf3a ticket n\xe0y ?",nzCancelText:"H\u1ee7y b\u1ecf",nzOkText:"X\xf3a",nzOnOk:()=>this.ticketCtrl.deleteOne(this.ticket.ticket_id).toPromise().then(()=>{this.remove.emit(this.ticket),this.shared.alert.success(`[${this.ticket.ticket_id}] \u0110\xe3 x\xf3a ticket xong.`),this.onCreateNew()})})}onClickShowMore(){this._userCache.showMore=this.isViewAll}onClickShowOdoo(){this._userCache.showColOdoo=this.isViewColOdoo}onChangeCHelp(e){const i=this.formValue;(this.isDeleteContentHelp||(0,D.EU)(i.content_required))&&this.pathValue("content_required",e.question||""),(this.isDeleteContentHelp||(0,D.EU)(i.content_help))&&(this.pathValue("content_help",e.reply),(0,D.EU)(i.complete_time)&&this.onCompleteTicket())}createFormGroup(){this.ticketForm=this.fb.group({ticket_id:null,user_code:null,ticket_on:[null,ve.kI.required],ticket_number:null,ticket_text:null,full_name:null,tax_code:[null,ve.kI.required],chkQuestion:!1,company_name:null,email:null,phone:null,teamviewer:null,customer_name:null,content_required:null,content_help:null,reception_time:null,complete_time:null,software:[null,ve.kI.required],chanels:[null,ve.kI.required],content_copy:null,first_chanel:null,help:[null],group_help:null,support_help:null,soft_name:null,product:null,body:null,note:null,subject:null,image_name:null,od_image:null,od_team:[null],od_assign:[null],od_category:[null],od_topic:null,od_khid:[0],od_partner:null,content_email:null,od_user_def:null,cookie_value:null,csrf_token:null}),this.formValueChange()}formValueChange(){this.ticketForm.get("content_help").valueChanges.subscribe(e=>{(0,D.EU)(this.formValue.complete_time)&&!(0,D.EU)(e)&&this.onCompleteTicket()}),this.ticketForm.get("chanels").valueChanges.subscribe(e=>{(0,D.G5)(e)||this.pathValue("support_help",e[e.length-1])}),this.ticketForm.get("software").valueChanges.subscribe(e=>{!(0,D.Ft)(e)&&!(0,D.G5)(e.soft_names)&&this.ticketForm.get("soft_name").setValue(e.soft_names[0])}),this.ticketForm.valueChanges.subscribe(e=>{this.ticketForm.dirty&&(this.asyncInput.emit(!0),!0===this.isAutoCreate&&this.autoFixTicket())})}update_helpdeskBody(e){this.ticketForm.get("body").patchValue(e,{onlySelf:!0})}update_helpdeskNote(e){this.ticketForm.get("note").patchValue(e,{onlySelf:!0})}update_helpdeskSubject(e){this.ticketForm.get("subject").patchValue(e,{onlySelf:!0})}update_contentCopy(e){this.ticketForm.get("content_copy").patchValue(e,{onlySelf:!0})}autoFixTicket(e,i){if(e=e||this.formValue,(0,D.oA)(i)){let c=this.createTicketDefault();this.fixCompleteTime(20,"minute"),this.fixTicketOn_fromReception_time(),(0,D.G5)(e.chanels)&&!(0,D.G5)(c.chanels)&&this.pathValue("chanels",c.chanels),(0,D.gS)(e.software)&&!(0,D.gS)(c.software)&&this.pathValue("software",c.software),(0,D.gS)(e.group_help)&&!(0,D.gS)(c.group_help)&&this.pathValue("group_help",c.group_help),(0,D.gS)(e.od_team)&&!(0,D.gS)(c.od_team)&&this.pathValue("od_team",c.od_team),(0,D.gS)(e.od_assign)&&!(0,D.gS)(c.od_assign)&&this.pathValue("od_assign",c.od_assign),(0,D.gS)(e.od_category)&&!(0,D.gS)(c.od_category)&&this.pathValue("od_category",c.od_category),(0,D.gS)(e.od_topic)&&!(0,D.gS)(c.od_topic)&&this.pathValue("od_topic",c.od_topic)}let a=mo(e).join("\n");this.update_helpdeskBody(a);let o=go(e).join("\n");this.update_helpdeskNote(o);let s=e.subject;this.isEmailTicket||(s=_o(e),this.update_helpdeskSubject(s));let l=fd(e,!1,{body:a,note:o,subject:s});return this.update_contentCopy(l),this.formValue}buildHelpdeskSubject(e=this.ticket){let i=_o(e);this.update_helpdeskSubject(i)}fixTicketOn_fromReception_time(){let e=this.formValue.reception_time;if(!(0,D.EU)(e)){e=e.replace(/ /g,"");let i=e.substring(2,8);this.ticketForm.get("ticket_on").patchValue(i),this.ticketForm.get("reception_time").patchValue(e)}}fixCompleteTime(e=20,i="minute"){let a=this.formValue.reception_time;if((0,D.EU)(a))return;let o=this.formValue.complete_time;if(!(0,D.EU)(a)&&((0,D.EU)(o)||12==o.length||a==o)){let s=a,l=new Date(Number.parseInt(s.substring(0,4)),Number.parseInt(s.substring(4,6))-1,Number.parseInt(s.substring(6,8)),Number.parseInt(s.substring(9,11)),Number.parseInt(s.substring(12,14))),c=D.Ov.dateAdd(l,i,e),u=D.Ov.dateToString(c,"yyyyMMdd-HH:mm");this.ticketForm.get("complete_time").patchValue(u)}}createTicketDefault(e){const i=this.user.read(),a=i.val_def||{},o=this._userCache;if((0,D.G5)(o.chanels)&&(o.chanels=(a.chanel_ids||[]).map(c=>this.chanels.filter(u=>u.chanel_id===c)[0]).filter(c=>!(0,D.Ft)(c))),(0,D.Ft)(o.support_help)){const l=a.support_help_id||0;o.support_help=this.chanels.filter(c=>c.chanel_id===l)[0]}if((0,D.Ft)(o.software)){const l=a.software_id||0,c=this.softwares.filter(u=>u.id===l);o.software=c.length>0?c[0]:void 0}if((0,D.Ft)(o.soft_name)&&(o.soft_name=a.soft_name),(0,D.Ft)(o.ghelp)){const l=a.ghelp_id||0,c=this.ghelps.filter(u=>u.id===l);o.ghelp=c.length>0?c[0]:void 0}if((0,D.Ft)(o.product)){const l=a.product_id||0,c=this.products.filter(u=>u.extend_id===l);o.product=c.length>0?c[0]:void 0}let s=o[this.OD_KEYS.cate];if((0,D.gS)(s)||(0,D.gS)(s.wk_team)){let l=a.od_category_id||0,u=(this.shared.catalogs.od_category||this.odCateItems).filter(d=>d.id===l);o[this.OD_KEYS.cate]=u.length>0?u[0]:void 0}if((0,D.gS)(o[this.OD_KEYS.team])){let l=a.od_team_id||0,c=this.odWkTeamItems.filter(u=>u.id===l);o[this.OD_KEYS.team]=c.length>0?c[0]:void 0}if((0,D.gS)(o[this.OD_KEYS.assign])){let l=a.od_assign_id||0,c=this.odAssignItems.filter(u=>u.id===l);o[this.OD_KEYS.assign]=c.length>0?c[0]:void 0}if((0,D.Ft)(o[this.OD_KEYS.topic])){let l=a.od_topic_id||0,c=this.odTopicItems.filter(u=>u.id===l);o[this.OD_KEYS.topic]=c.length>0?c[0]:void 0}return{user:i,full_name:i.name,user_id:i.id,user_code:i.token,od_khid:0,chanels:this._userCache.chanels||[],support_help:this._userCache.support_help,software:this._userCache.software||null,soft_name:this._userCache.soft_name,product:this._userCache.product,group_help:this._userCache.ghelp||null,od_team:this._userCache[this.OD_KEYS.team]||null,od_category:this._userCache[this.OD_KEYS.cate]||null,od_topic:this._userCache[this.OD_KEYS.topic]||null,od_assign:this._userCache[this.OD_KEYS.assign]||null,ticket_on:new K.uU("en-US").transform(new Date,"yyMMdd"),reception_time:new K.uU("en-US").transform(new Date,"yyyyMMdd-HH:mm"),complete_time:new K.uU("en-US").transform(new Date,"yyyyMMdd-HH:")}}get disabledAction(){return this.isSaveTicket||this.isAsyncCatalog||this.isInitPage||this.isUpdateUser}convertObjToColDefs(e,i){return e.map(a=>({colId:a,field:a,headerName:i[a]||a}))}onFindPartner(){let e=this.formValue;this.nzModal.create({nzTitle:"T\xecm ki\u1ebfm kh\xe1ch h\xe0ng",nzClosable:!1,nzWidth:900,nzMaskClosable:!1,nzFooter:null,nzContent:FI,nzComponentParams:{fieldSearch:[],valueSearch:{vat:e.tax_code,phone:e.phone,email:e.email,customer_name:e.customer_name}}}).afterClose.pipe((0,zt.w)(o=>{if(o&&!(0,D.Ft)(o.item)){let s=o.item;if(this.updateFValue("tax_code",s.vat),this.updateFValue("email",s.email),this.updateFValue("customer_name",s.display_name),this.updateFValue("company_name",s.comp_name),this.updateFValue("od_khid",s.id),this.updateFValue("od_partner",s),(0,D.EU)(this.formValue.phone)){let c=s.mobile||s.phone;"false"===c&&(c=void 0),this.updateFValue("phone",c)}this.autoFixTicket(),!0===o.autoUpdate&&this.onSaveTicket()}return bo.E})).subscribe()}ngSelectChange(e){this.logger.log(e)}onTest(){this.odoo.ticket.getNoteDetail(143389).subscribe({next:e=>this.logger.log(e),error:e=>this.logger.warn(e)})}get ticketId(){return this.ticket.ticket_id}changeChkEmailTicket(e){(0,D.EU)(this.ticketId)&&(this._isEmailTicketCache=this.isEmailTicket)}onClearSubject(){this.ticketForm.get("subject").patchValue(void 0)}}return t.\u0275fac=function(e){return new(e||t)(n.Y36($t.gz),n.Y36(Qn.Sf),n.Y36(ve.qu),n.Y36(li.W),n.Y36(qs),n.Y36(Ks),n.Y36(rr.a),n.Y36(Fr.$q))},t.\u0275cmp=n.Xpm({type:t,selectors:[["cy-ticket-form"]],viewQuery:function(e,i){if(1&e&&(n.Gf(DI,7),n.Gf(AI,7),n.Gf(NI,7)),2&e){let a;n.iGM(a=n.CRH())&&(i.cChanels=a.first),n.iGM(a=n.CRH())&&(i.cProduct=a.first),n.iGM(a=n.CRH())&&(i.ngSlSupportHelp=a.first)}},inputs:{isCreateNew:"isCreateNew",isInitPage:"isInitPage",userCfigModalRef:"userCfigModalRef",isViewSetDefault:"isViewSetDefault",inputUserCfigObj:"inputUserCfigObj",acceptEditPartner:"acceptEditPartner",isViewTicket:"isViewTicket",isAutoLoadCate:"isAutoLoadCate",isDeleteContentHelp:"isDeleteContentHelp",ticket:"ticket"},outputs:{save:"save",remove:"remove",asyncInput:"asyncInput",isInitPageChange:"isInitPageChange",handlerLoadCate:"handlerLoadCate"},features:[n.TTD],decls:53,vars:29,consts:[[1,"ticket-form",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"row"],[1,"col-xg-6","col-md-12","col-lr","col-body"],["class","col-md-3",4,"ngIf"],["class","col-md-6",4,"ngIf"],[1,"col-md-12"],[1,"form-group"],[1,""],[1,"required"],["bindLabel","value","formControlName","chanels",1,"required","chanel",3,"items","multiple","hideSelected","virtualScroll","closeOnSelect"],[1,"col-md-6"],["for","software",1,""],["id","software","bindLabel","value","formControlName","software",1,"required",3,"items","virtualScroll"],["for","group_help",1,""],["id","group_help","bindLabel","title","formControlName","group_help",1,"required",3,"items","virtualScroll"],[1,"col-12"],["class","col-12 col-od",4,"ngIf"],["class","col-12",4,"ngIf"],["class","col-md-7",4,"ngIf"],["class","col-md-5",4,"ngIf"],["class","col-xg-6 col-md-12 col-lr",4,"ngIf"],["class","row tool row-footer",4,"ngIf"],["clearSubject",""],[1,"col-md-3"],["for","ticketOn"],["nz-input","","id","ticketOn","formControlName","ticket_on","required","",1,"note"],["for","ticketNumber"],["nz-input","","type","number","id","ticketNumber","formControlName","ticket_number"],["for","full_name"],["nz-input","","id","full_name","formControlName","full_name","required","",1,"note"],[1,"col-12","col-od"],["for","od_wk_team",1,""],["id","od_wk_team","bindLabel","display_name","formControlName","od_team",1,"required1",3,"items","virtualScroll","loading","search"],["for","od_assign_users",1,""],["id","od_assign_users","bindLabel","display_name","formControlName","od_assign",1,"required1",3,"items","virtualScroll","loading","search"],["for","od_helpdesk_category",1,""],["id","od_helpdesk_category","bindLabel","name","formControlName","od_category",3,"virtualScroll","items","change","search"],["for","od_helpdesk_topic",1,""],["id","od_helpdesk_topic","bindLabel","display_name","formControlName","od_topic",3,"virtualScroll","items","search"],[1,"col-md-7"],[1,"partner-group","d-flex","align-item-center"],["for","taxCode",1,"mr-4"],["nz-input","","id","taxCode","formControlName","tax_code","required",""],["nz-input","","id","image_name","formControlName","image_name","placeholder","1;2(*.png)",1,"partner_id","ml-1"],[1,"col-md-5"],["for","customerName"],["nz-input","","id","customerName","formControlName","customer_name"],["nz-input","","id","email","formControlName","email","required",""],["nz-input","","id","od_khid","placeholder","KH_ID","formControlName","od_khid",1,"partner_id","ml-1","border-warning",3,"ngModelChange"],["for","phone"],["nz-input","","id","phone","formControlName","phone"],[1,"row","d-flex","ml-n1"],[1,"col-7"],["for","content_required"],["nz-input","","id","content_required","formControlName","content_required"],[1,"col-5"],["for","reception_time"],["nz-input","","id","reception_time","formControlName","reception_time"],["for","teamviewer"],["nz-input","","id","teamviewer","formControlName","teamviewer"],["for","content_help"],["nz-input","","id","content_help","formControlName","content_help"],["for","complete_time"],["nz-input","","id","complete_time","formControlName","complete_time"],["for","help",1,""],["nz-checkbox","",3,"ngModel","ngModelOptions","ngModelChange"],["id","help","bindLabel","title","formControlName","help",3,"items","change"],["for","support_help",1,""],["id","support_help","bindLabel","value","formControlName","support_help",3,"items","virtualScroll"],["ngSlSupportHelp",""],["for","soft_names",1,""],["id","soft_names","formControlName","soft_name",1,"required1",3,"items","virtualScroll"],["for","companyName"],["nz-input","","id","companyName","formControlName","company_name"],["for","productId",1,""],["id","productId","bindLabel","name","formControlName","product",3,"items","virtualScroll"],["cProduct",""],[1,"col-xg-6","col-md-12","col-lr"],["class","col-md-12",4,"ngIf"],[1,"col-6"],["nz-checkbox","",1,"show-column",3,"ngModel","ngModelOptions","ngModelChange","click"],["nz-checkbox","",1,"show-column",3,"ngModel","ngModelOptions","ngModelChange"],["nz-checkbox","",1,"show-column","chk-email-ticket",3,"ngModel","ngModelOptions","ngModelChange"],["for","subject"],[3,"nzSuffix"],["nz-input","","id","subject","formControlName","subject","placeholder","Ch\u1ec9 nh\u1eadp v\xe0o khi ch\u1ecdn 'E-mail ticket'",3,"readonly"],["txSubject",""],["for","content_email"],["nz-input","","id","content_email","rows","1","formControlName","content_email"],["for","body"],["nz-input","","nzAutosize","","id","body","formControlName","body"],["for","note"],["nz-input","","nzAutosize","","id","note","formControlName","note"],["for","content_copy"],["nz-input","","nzAutosize","","id","content_copy","formControlName","content_copy"],[1,"row","tool","row-footer"],[1,"col-12","d-flex"],["nz-button","","nzType","primary","type","submit",3,"disabled",4,"ngIf"],["nz-button","","nzType","default","type","button",3,"disabled","click",4,"ngIf"],["nz-button","","nzType","default","type","button",3,"disabled","click"],[1,"fa-regular","fa-circle-check"],["class","fa-regular fa-align-justify",4,"ngIf"],["class","fa-regular fa-arrows-spin fa-spin",4,"ngIf"],["nz-dropdown","","nz-button","","type","button",3,"disabled","nzDropdownMenu"],[1,"fa-regular","fa-plus"],["nzMenuOther",""],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngIf"],["nz-button","","nzDanger","","type","button",3,"disabled","click",4,"ngIf"],["nz-button","","nzType","primary","type","submit",3,"disabled"],["class","fa-regular fa-floppy-disk-circle-arrow-right",4,"ngIf"],[1,"fa-regular","fa-arrows-spin","fa-spin"],[1,"fa-regular","fa-floppy-disk-circle-arrow-right"],[1,"fa-regular","fa-circle-trash"],[1,"fa-regular","fa-align-justify"],[1,"fa-regular","fa-file-plus"],[1,"fal","fa-search"],["nz-menu-item","",3,"click"],[1,"fa-regular","fa-copy"],["nz-button","","nzDanger","","type","button",3,"disabled","click"],[1,"fa-regular","fa-user"],[1,"fa-regular","fa-xmark","clear-icon",3,"click"]],template:function(e,i){1&e&&(n.TgZ(0,"form",0),n.NdJ("ngSubmit",function(){return i.onSaveTicket()}),n.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",3),n.YNc(6,MI,8,0,"div",5),n.YNc(7,RI,5,0,"div",5),n.YNc(8,PI,8,0,"div",6),n.TgZ(9,"div",7)(10,"div",8)(11,"label",9),n._uU(12,"K\xeanh - T\xecnh tr\u1ea1ng "),n.TgZ(13,"span",10),n._uU(14,"(*)"),n.qZA(),n._uU(15,":"),n.qZA(),n._UZ(16,"ng-select",11),n.qZA()(),n.TgZ(17,"div",12)(18,"div",8)(19,"label",13),n._uU(20,"Nh\xf3m Ph\u1ea7n m\u1ec1m "),n.TgZ(21,"span",10),n._uU(22,"(*)"),n.qZA(),n._uU(23,": "),n.qZA(),n._UZ(24,"ng-select",14),n.qZA()(),n.TgZ(25,"div",12)(26,"div",8)(27,"label",15),n._uU(28,"Nh\xf3m h\u1ed7 tr\u1ee3 "),n.TgZ(29,"span",10),n._uU(30,"(*)"),n.qZA(),n._uU(31,":"),n.qZA(),n._UZ(32,"ng-select",16),n.qZA()(),n.TgZ(33,"div",17),n._uU(34,"-------"),n.qZA(),n.YNc(35,BI,34,10,"div",18),n.YNc(36,LI,2,0,"div",19),n.YNc(37,UI,11,0,"div",20),n.YNc(38,HI,5,0,"div",21),n.YNc(39,VI,10,0,"div",20),n.YNc(40,ZI,5,0,"div",21),n.YNc(41,jI,18,0,"div",20),n.YNc(42,GI,5,0,"div",21),n.YNc(43,WI,18,0,"div",20),n.YNc(44,YI,9,4,"div",21),n.YNc(45,$I,9,2,"div",6),n.YNc(46,JI,8,2,"div",6),n.YNc(47,QI,5,0,"div",6),n.YNc(48,qI,6,2,"div",6),n.qZA()(),n.YNc(49,rO,32,29,"div",22),n.qZA(),n.YNc(50,xO,26,15,"div",23),n.qZA()()(),n.YNc(51,vO,1,0,"ng-template",null,24,n.W1O)),2&e&&(n.Q6J("formGroup",i.ticketForm),n.xp6(6),n.Q6J("ngIf",i.isViewAll&&!i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",i.isViewAll&&!i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",i.isViewAll&&!i.isViewSetDefault),n.xp6(8),n.Q6J("items",i.chanels)("multiple",!0)("hideSelected",!0)("virtualScroll",!0)("closeOnSelect",!1),n.xp6(8),n.Q6J("items",i.softwares)("virtualScroll",!0),n.xp6(8),n.Q6J("items",i.ghelps)("virtualScroll",!0),n.xp6(3),n.Q6J("ngIf",i.isViewColOdoo||i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",i.isViewColOdoo),n.xp6(1),n.Q6J("ngIf",!i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",!i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",!i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",!i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",!i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",!i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",!i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",!i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",i.isViewAll||i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",i.isViewAll&&!i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",!1),n.xp6(1),n.Q6J("ngIf",!1),n.xp6(1),n.Q6J("ngIf",!i.isViewSetDefault),n.xp6(1),n.Q6J("ngIf",!i.isViewSetDefault))},directives:[ve._Y,ve.JL,ve.sg,K.O5,_n.Zp,ve.Fj,ve.JJ,ve.u,ve.Q7,ve.wV,Fr.w9,_n.gB,Mn.w,Nr.Ie,ve.On,_n.ke,_n.rh,It.ix,Mr.dQ,bl,zl,Il,ml,Sa],styles:[".ticket-form .chk-email-ticket{color:var(--bs-danger)}.ticket-form .clear-icon{cursor:pointer}.ticket-form [nz-button]{margin-right:5px}.ticket-form .card{margin-top:10px;padding:0 10px;border-radius:2px}.ticket-form .card .row.tool{margin-top:10px}.ticket-form .card .row.tool .show-column{padding-top:5px}.col-od .row{margin:auto 0}.ng-select.chanel .ng-select-container{height:40px!important;min-height:40px!important}.ng-select-container{height:27px!important;min-height:27px!important}.user-config .card{padding-bottom:0;margin-top:-10px;margin-bottom:0;border:unset}.user-config .col-body{max-width:100%;flex:0 0 100%}.user-config .row.tool{border-top:2px solid #2f54eb;padding-top:10px;padding-bottom:5px}.user-config .ant-modal-body{padding-bottom:0}.ng-select.ng-select-single .ng-select-container .ng-value-container .ng-input{top:3px;padding-left:3px}.partner-group .partner_id{width:120px;font-weight:700}.partner-group .chk_image{color:var(--danger)}.partner-group .img_group{max-width:155px;font-weight:700;top:0}.partner-group .img_group .img_id:hover,.partner-group .img_group .img_id:focus{z-index:unset}.partner-group .img_group .ant-input-group-addon{border:1px solid var(--warning);padding:unset}.partner-group .img_group label{height:unset;margin-right:unset;margin-bottom:unset}.ag-grid2 a{color:var(--blue)!important}.ag-grid2 .fa-check{font-size:1.3rem;color:var(--blue)}.ag-grid2 .fa-exclamation-circle{font-size:1.3rem;color:var(--red);padding-top:3px}\n"],encapsulation:2}),t})();var xd=oe(1894);const yO=["grid"],wO=["ticketForm"],TO=["importExcelRef"],kO=["linkDown"];function SO(t,r){1&t&&n._UZ(0,"i",33)}function bO(t,r){1&t&&n._UZ(0,"i",34)}function zO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",21),n.NdJ("click",function(){const o=n.CHM(e).$implicit;return n.oxw(2).onAgGridFilter(o.key)}),n.TgZ(1,"a"),n._uU(2),n.qZA()()}if(2&t){const e=r.index,i=r.$implicit;n.xp6(2),n.AsE("",e+1,". ",i.title,"")}}function IO(t,r){if(1&t&&(n.TgZ(0,"nz-form-item")(1,"nz-form-control")(2,"button",14),n._uU(3,"L\u1ecdc"),n._UZ(4,"i",35),n.qZA(),n.TgZ(5,"nz-dropdown-menu",null,36)(7,"ul",17),n.YNc(8,zO,3,2,"ng-template",37),n.qZA()()()()),2&t){const e=n.MAs(6),i=n.oxw();n.xp6(2),n.Q6J("nzTrigger","click")("nzDropdownMenu",e)("disabled",i.disabledAction),n.xp6(6),n.Q6J("ngForOf",i.allFilterObj)("ngForTrackBy",i.allFilterObjTrackByKey)}}function OO(t,r){1&t&&n._UZ(0,"i",40)}function EO(t,r){1&t&&n._UZ(0,"i",33)}function FO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",21),n.NdJ("click",function(){n.CHM(e);const a=n.oxw().$implicit;return n.oxw(2).onSendHelpdesk(a.code)}),n.TgZ(1,"a"),n._uU(2),n.qZA()()}if(2&t){const e=n.oxw(),i=e.index,a=e.$implicit;n.xp6(2),n.AsE("",i+1,". ",a.label,"")}}function DO(t,r){if(1&t&&n.YNc(0,FO,3,2,"li",18),2&t){const e=r.$implicit,i=n.oxw(2);n.Q6J("ngIf",i.isVisibleMenuSendTicket(e.visible))}}function AO(t,r){if(1&t&&(n.ynx(0),n.TgZ(1,"button",14),n.YNc(2,OO,1,0,"i",38),n.YNc(3,EO,1,0,"i",11),n.TgZ(4,"span"),n._uU(5,"G\u1eedi Ticket"),n.qZA()(),n.TgZ(6,"nz-dropdown-menu",null,39)(8,"ul",17),n.YNc(9,DO,1,1,"ng-template",37),n.qZA()(),n.BQk()),2&t){const e=n.MAs(7),i=n.oxw();n.xp6(1),n.Q6J("nzTrigger","click")("nzDropdownMenu",e)("disabled",i.disabledAction),n.xp6(1),n.Q6J("ngIf",!i.isSendTicket),n.xp6(1),n.Q6J("ngIf",i.isSendTicket),n.xp6(6),n.Q6J("ngForOf",i.allItemSendTicket)("ngForTrackBy",i.trackBySendTicketMenu)}}function NO(t,r){1&t&&n._UZ(0,"i",45)}function MO(t,r){1&t&&n._UZ(0,"i",33)}function RO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",21),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).onImportXlsx()}),n.TgZ(1,"a"),n._UZ(2,"i",40),n._uU(3,"N\u1ea1p d\u1eef li\u1ec7u"),n.qZA()()}}function PO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",21),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).onExportXlsx()}),n.TgZ(1,"a"),n._UZ(2,"i",46),n._uU(3,"Xu\u1ea5t d\u1eef li\u1ec7u"),n.qZA()()}}function BO(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"button",41),n.YNc(2,NO,1,0,"i",42),n.YNc(3,MO,1,0,"i",11),n.TgZ(4,"span"),n._uU(5,"N\u1ea1p / Xu\u1ea5t DL"),n.qZA()(),n.TgZ(6,"nz-dropdown-menu",null,43)(8,"ul",17),n.YNc(9,RO,4,0,"li",18),n.YNc(10,PO,4,0,"li",18),n.TgZ(11,"li",21),n.NdJ("click",function(){return n.CHM(e),n.oxw().onExportExcelMau()}),n.TgZ(12,"a"),n._uU(13,"<"),n._UZ(14,"i",44),n._uU(15,"File m\u1eabu"),n.qZA()()()(),n.BQk()}if(2&t){const e=n.MAs(7),i=n.oxw();n.xp6(1),n.Q6J("nzDropdownMenu",e)("disabled",i.disabledAction),n.xp6(1),n.Q6J("ngIf",!i.isRunImport),n.xp6(1),n.Q6J("ngIf",i.isRunImport),n.xp6(6),n.Q6J("ngIf",i.isRole("import_xsl")),n.xp6(1),n.Q6J("ngIf",i.isRole("export_xsl"))}}function LO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",21),n.NdJ("click",function(){const o=n.CHM(e).$implicit;return n.oxw(2).showCustomColumnAgGrid(o)}),n.TgZ(1,"a"),n._uU(2),n.qZA()()}if(2&t){const e=r.$implicit,i=r.index;n.xp6(2),n.AsE("",i+2,". ",e.grid_title,"")}}function UO(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"button",47),n._UZ(2,"i",48),n._uU(3,"Danh s\xe1ch m\u1eabu "),n.qZA(),n.TgZ(4,"nz-dropdown-menu",null,49)(6,"ul",50)(7,"li",21),n.NdJ("click",function(){return n.CHM(e),n.oxw().showColumnAgGrid("ALL")}),n.TgZ(8,"a"),n._uU(9,"1. Hi\u1ec3n th\u1ecb ALL"),n.qZA()(),n.YNc(10,LO,3,2,"ng-template",37),n.TgZ(11,"li",21),n.NdJ("click",function(){return n.CHM(e),n.oxw().clickCopyAllRowToClipboard()}),n.TgZ(12,"a"),n._uU(13),n.qZA()()()(),n.BQk()}if(2&t){const e=n.MAs(5),i=n.oxw();n.xp6(1),n.Q6J("nzDropdownMenu",e)("nzTrigger","click")("disabled",i.disabledAction),n.xp6(9),n.Q6J("ngForOf",i.allGridField)("ngForTrackBy",i.trackByAg),n.xp6(3),n.hij("",i.allGridField.length+2,". Sao ch\xe9p")}}function HO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",21),n.NdJ("click",function(){return n.CHM(e),n.oxw().onDeleteMultiTicket()}),n._UZ(1,"i",22),n._uU(2,"X\xf3a Ticket "),n.qZA()}}function VO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",21),n.NdJ("click",function(){return n.CHM(e),n.oxw().onAutoFixTicket()}),n._UZ(1,"i",51),n._uU(2,"T\u1ef1 \u0111\u1ed9ng s\u1eeda "),n.qZA()}}function ZO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",21),n.NdJ("click",function(){return n.CHM(e),n.oxw().createAgGridTemplate()}),n._UZ(1,"i",52),n._uU(2,"T\u1ea1o/C\u1eadp nh\u1eadt m\u1eabu "),n.qZA()}}function jO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"li",21),n.NdJ("click",function(){return n.CHM(e),n.oxw().onSendReport()}),n._UZ(1,"i",53),n._uU(2,"G\u1eedi b\xe1o c\xe1o "),n.qZA()}}const GO=function(){return["/admin"]};function WO(t,r){1&t&&(n.TgZ(0,"li",54)(1,"a"),n._UZ(2,"i",55),n._uU(3,"C\u1ea5u h\xecnh"),n.qZA()()),2&t&&n.Q6J("routerLink",n.DdM(1,GO))}function YO(t,r){if(1&t&&(n.TgZ(0,"span")(1,"span",28),n._uU(2," - "),n.qZA(),n.TgZ(3,"span",29),n._uU(4),n.qZA()()),2&t){const e=n.oxw();n.xp6(4),n.hij("C=",e.data.length," ")}}function $O(t,r){if(1&t&&(n.TgZ(0,"div"),n._UZ(1,"nz-divider",58),n.TgZ(2,"nz-upload",60)(3,"a",61),n._uU(4),n.qZA()()()),2&t){const e=n.oxw(2);n.xp6(2),n.Q6J("nzBeforeUpload",e.beforeUploadDir),n.xp6(2),n.Oqu(e.lblPathDir)}}function JO(t,r){if(1&t&&(n.TgZ(0,"label")(1,"span",66),n._uU(2),n.qZA(),n.TgZ(3,"span",67),n._uU(4,"Running =>"),n.qZA()()),2&t){const e=n.oxw(3);n.xp6(2),n.hij("[",null==e.msgObj?null:e.msgObj.action,"] ")}}function QO(t,r){if(1&t&&(n.ynx(0),n._UZ(1,"nz-divider",58),n.TgZ(2,"nz-input-group",62),n.YNc(3,JO,5,1,"label",13),n.TgZ(4,"label"),n._uU(5,"Oki"),n.TgZ(6,"span",63),n._uU(7),n.qZA(),n.TgZ(8,"i"),n._uU(9,"+"),n.qZA()(),n.TgZ(10,"label"),n._uU(11,"Err"),n.TgZ(12,"span",64),n._uU(13),n.qZA(),n.TgZ(14,"i"),n._uU(15,"="),n.qZA()(),n.TgZ(16,"label"),n._uU(17,"TS"),n.TgZ(18,"span",65),n._uU(19),n.qZA()()(),n.BQk()),2&t){const e=n.oxw(2);n.xp6(3),n.Q6J("ngIf",e.isSendTicket),n.xp6(4),n.hij("[",(null==e.msgObj?null:e.msgObj.ok)||0,"]"),n.xp6(6),n.hij("[",(null==e.msgObj?null:e.msgObj.err)||0,"]"),n.xp6(6),n.hij("[",(null==e.msgObj?null:e.msgObj.total)||e.totalSelect,"]")}}function qO(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"div"),n._UZ(1,"nz-divider",58),n.TgZ(2,"a",68),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).stopSendTicket()}),n.TgZ(3,"span"),n._uU(4,"D\u1eebng l\u1ea1i"),n.qZA()()()}}function XO(t,r){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"div",56)(2,"div",57),n._UZ(3,"nz-divider",58),n.TgZ(4,"label",59),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().isStopTicketIfError=a}),n._uU(5,"G\u1eb7p l\u1ed7i > D\u1eebng"),n.qZA(),n._UZ(6,"nz-divider",58),n.TgZ(7,"label",59),n.NdJ("ngModelChange",function(a){return n.CHM(e),n.oxw().isUpdateIfTicketExist=a}),n._uU(8,"T\u1ea1o m\u1edbi + c\u1eadp nh\u1eadt"),n.qZA(),n.YNc(9,$O,5,2,"div",13),n.YNc(10,QO,20,4,"ng-container",13),n.YNc(11,qO,5,0,"div",13),n.qZA()(),n.BQk()}if(2&t){const e=n.oxw();n.xp6(4),n.Q6J("ngModel",e.isStopTicketIfError),n.xp6(3),n.Q6J("ngModel",e.isUpdateIfTicketExist),n.xp6(2),n.Q6J("ngIf",e.isViewUploadDir),n.xp6(1),n.Q6J("ngIf",e.totalSelect>0||!!e.msgObj),n.xp6(1),n.Q6J("ngIf",e.isSendTicket)}}const KO=function(){return["ls_filter"]},eE=function(){return["excel"]},tE=function(){return["report"]};let nE=(()=>{class t{constructor(e,i,a,o,s,l,c,u,d,f,p,m){var x=this;this.nzModal=e,this.gridField=i,this.cd=a,this.fb=o,this.ticketCtrl=s,this.excelCtrl=l,this.router=c,this.aRouter=u,this.cfigCtrl=d,this.shared=f,this.userCtrl=p,this.helpdesk=m,this.allItemSendTicket=[{code:"all",label:"L\xe0m t\u1ea5t c\u1ea3 b\u01b0\u1edbc"},{code:"create_ticket",label:"G\u1eedi Ticket"},{code:"send_email",label:"G\u1eedi email",visible:!1},{code:"add_note",label:"G\u1eedi note"},{code:"add_note_with_img",label:"\u0110\xednh k\xe8m h\xecnh"},{code:"close_ticket",label:"Theo d\xf5i + \u0110\xf3ng"}],this.data=[],this.dataCache=[],this.msgObj={title:"K\u1ebft qu\u1ea3",total:0,ok:0,err:0,action:""},this.allImageUpload={},this.lblPathDir_=void 0,this.isViewUploadDir_=!1,this.agAllModule=[],this.gridOptions=this.createAgOption(),this.gridApi=null,this.gridColumnApi=null,this.columnDefs=[],this.agFilterType="ALL",this.excelStyles=[{id:"header",interior:{color:"#CCCCCC",pattern:"Solid"},borders:{borderBottom:{color:"#5687f5",lineStyle:"Continuous",weight:1},borderLeft:{color:"#5687f5",lineStyle:"Continuous",weight:1},borderRight:{color:"#5687f5",lineStyle:"Continuous",weight:1},borderTop:{color:"#5687f5",lineStyle:"Continuous",weight:1}}}],this.showBtnUpdate=!1,this.isNew=!0,this.isSendTicket=!1,this.isLoadSearch=!1,this.isRunImport=!1,this.isDeleteStatus=!1,this.isClickShowColKpi=!1,this.isLoadWithChanel=!1,this.isHideFormCreate="block",this.isShowMsg=!1,this.isAutoLoadCate=!0,this.isUpdateIfTicketExist=!1,this.isStopTicketIfError=!1,this.fileImport=[],this.xlsxType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",this.agGridViewType=this.shared.getByKey("agGridViewType")||"DEFAULT",this.isViewSendHelpdesk=this.agGridViewType===Ir.g1,this.fileList=[],this.isInitPage=!0,this.autoCreate=!1,this.editTicket=null,this.nodeTicket=null,this.asyncInput=!1,this.KEY_GRID_TYPE="ticket_list",this.lblGrid={total:0,with:"Ticket",view:"STT > Z-A",countTicket:0,countChanel:0},this.groupTemp=0,this.indexStyle=0,this.defaultColDef={enableValue:!0,enableRowGroup:!0,enablePivot:!0,sortable:!1,resizable:!0,suppressMenu:!0},this.allFilterObj=[{key:"all",title:"T\u1ea5t c\u1ea3"},{key:"is_send_ticket",title:"\u0110\xe3 g\u1eedi ticket"},{key:"is_send_note",title:"\u0110\xe3 \u0111\xecnh th\xeam note"},{key:"is_upfile",title:"\u0110\xe3 \u0111\xecnh k\xe8m h\xecnh"},{key:"is_close_ticket",title:"\u0110\xe3 \u0111\xf3ng ticket"},{key:"no_send_ticket",title:"Ch\u01b0a g\u1eedi ticket"},{key:"no_send_note",title:"Ch\u01b0a th\xeam note"},{key:"no_upfile",title:"Ch\u01b0a \u0111\xednh k\xe8m h\xecnh"},{key:"no_close_ticket",title:"Ch\u01b0a \u0111\xf3ng ticket"},{key:"is_report",title:"\u0110\xe3 g\u1eedi b\xe1o c\xe1o"},{key:"no_report",title:"Ch\u01b0a g\u1eedi b\xe1o c\xe1o"}],this.runSendTicket=void 0,this.agGridCustom={},this.beforeUploadDir=(h,v)=>(this.fileList=v,this.lblPathDir_=`(${v.length}) H\xecnh`,D.DS.getBase64(h.originFileObj).then(function(){var T=Eo(function*(S){let y=h.name.toLowerCase();x.allImageUpload[y]=yield S});return function(S){return T.apply(this,arguments)}}()),!1)}ngOnInit(){let e=this.shared.catalogs.isAutoLoadCate;this.isAutoLoadCate=!!(0,D.Ft)(e)||e,this.userDetail=this.userCtrl.read(),this.gridField.getColumnAgFromCache(Ir.z).subscribe(o=>{this.agColumnFix=o.column_fix,this.columnDefs=this.agColumnFix.def}),this.isHideFormCreate=this.shared.getByKey("isHideFormCreate");let i=new Date,a=new Date;this.searchForm=this.fb.group({ticketOn:[[i,a]],withChanel:[!1],hideFormCreate:["none"===this.isHideFormCreate]}),this.searchForm.get("withChanel").valueChanges.subscribe(o=>{this.showTicketWithChanel(o)}),this.searchForm.get("hideFormCreate").valueChanges.subscribe(o=>{this.isHideFormCreate=o?"none":"block",this.shared.setByKey("isHideFormCreate",this.isHideFormCreate),o||(this.isViewSendHelpdesk=!1,this.disableWithChanel(!1),this.showCustomColumnAgGrid(this.allGridFieldMap[Ir._J]||{}))}),this.getRowClass=o=>"ag-grid-row-style-"+(o.node.rowIndex%2==0?0:1),this.initSearchFromQuery()}initSearchFromQuery(){this.aRouter.queryParamMap.subscribe(e=>{this.searchForm.get("ticketOn").setValue([D.Em.parseDate(e.get("from"),new Date),D.Em.parseDate(e.get("to"),new Date)])})}disableWithChanel(e){console.log(e);let i=this.searchForm.get("withChanel");e?(i.setValue(!e),i.disable()):i.enable()}get isViewToolSendTicket(){return this.agGridViewType===Ir.g1}get lblPathDir(){return this.lblPathDir_||"Th\u01b0 m\u1ee5c h\xecnh"}get allGridFieldMap(){return this.userCtrl.read().getAgField(this.KEY_GRID_TYPE)||{}}get allGridField(){return Object.values(this.allGridFieldMap).sort((e,i)=>e.index-i.index)}get isViewUploadDir(){return this.isViewSendHelpdesk&&(this.isViewUploadDir_||this.totalSelect>0)}get countTicket(){return this.dataCache.length||0}get totalSelect(){return(0,D.Ft)(this.gridApi)?0:this.gridApi.getSelectedRows().length}get disabledAction(){return this.isLoadSearch||this.isSendTicket||this.isRunImport}isRole(e){return this.userDetail.isRole(e)}ngAfterViewInit(){this.cd.detectChanges()}ngOnChanges(e){console.log(e)}trackByAg(e,i){return`${i.grid_code}:${i.grid_code}`}trackBySendTicketMenu(e,i){return`send-ticket-menu-${i.code}`}createAgOption(){return{rowSelection:"multiple",sideBar:!0,excelStyles:this.excelStyles,getRowClass:this.getRowClass,onRowClicked:e=>this.onRowClicked(e),isExternalFilterPresent:()=>this.agFilterPresent(),doesExternalFilterPass:e=>this.agFilterPass(e),defaultColDef:{resizable:!0}}}agFilterPresent(){return"ALL"!==this.agFilterType}agFilterPass(e){let i=e.data;switch(this.agFilterType){case"is_send_ticket":return!(0,D.EU)(i.ticket_number);case"no_send_ticket":return(0,D.EU)(i.ticket_number);case"is_send_note":return!(0,D.EU)(i.note_id);case"no_send_note":return(0,D.EU)(i.note_id);case"is_close_ticket":return 3===i.status;case"no_close_ticket":return 3!==i.status;case"is_upfile":return(0,D.oA)(i.is_upfile);case"no_upfile":return!(0,D.oA)(i.is_upfile);case"is_report":return(0,D.oA)(i.is_greport);case"no_report":return!(0,D.oA)(i.is_greport);default:return!0}}allFilterObjTrackByKey(e,i){return i.key}onAgGridFilter(e){this.agFilterType=e,this.gridApi.onFilterChanged()}onGridReady(e){this.gridApi=e.api,this.gridColumnApi=e.columnApi,Ze.fixColDef(this.userDetail,this.gridApi),this.showCustomColumnAgGrid(this.allGridFieldMap.ag_default)}defIfNull(e,i){return(0,D.Ft)(e)?null:i}onSaveTicket(e,i=this.nodeTicket){if(e.isNew&&(0,D.Ft)(e.ticket))return;const a=(e=Object.assign({isRefresh:!0},e)).ticket;(0,Ke.of)("").pipe((0,Jn.b)(o=>{if((0,D.Ft)(i)||e.isNew){let s=this.gridApi.applyTransaction({add:[a]});this.nodeTicket=s.add[0],this.editTicket=a,this.dataCache.push(a),this.refreshRow(i=this.nodeTicket)}else(0,D.Ft)(i)||this.refreshRow(i,a)})).subscribe(()=>{})}clickCopyAllRowToClipboard(){let e=!1;this.gridApi.getSelectedRows().length>0==0&&(this.gridApi.selectAll(),e=!0),this.gridApi.copySelectedRowsToClipboard({includeHeaders:!1,includeGroupHeaders:!1}),e&&this.gridApi.deselectAll(),this.shared.alert.success("\u0110\xe3 sao ch\xe9p xong, gi\u1edd v\xe0o excel \u0111\u1ec3 d\xe1n (Ctrl + V).")}isSelectRow(){return this.gridApi.getSelectedRows().length>0}clickNewTicket(){this.isNew=!0,this.editTicket=void 0}onDeleteMultiTicket(){let e=this.gridApi.getSelectedNodes();0!==e.length?(this.isShowMsg=!0,this.msgObj={title:"X\xf3a d\u1eef li\u1ec7u",total:e.length,ok:0,err:0},this.shared.modal.warning({nzTitle:"C\u1ea3nh b\xe1o !!",nzClosable:!1,nzOkText:"X\xf3a",nzCancelText:"\u0110\xf3ng",nzContent:`B\u1ea1n c\xf3 mu\u1ed1n x\xf3a ${e.length} d\xf2ng \u0111\xe3 ch\u1ecdn?`,nzOnOk:()=>{let i=this.shared.loading("\u0110ang x\xf3a d\u1eef li\u1ec7u"),o=(0,Ke.of)(...e).pipe((0,oi.b)(l=>(0,Ke.of)(l).pipe(si(1e3)))).pipe((0,zt.w)(l=>(this.ticketCtrl.deleteOne(l.data.ticket_id).subscribe(),(0,Ke.of)(l)))).subscribe(l=>{this.msgObj.ok++,this.onRemoveNode(l),this.shared.alert.success(`[${l.data.ticket_id}] \u0110\xe3 x\xf3a ticket xong.`)},l=>{this.msgObj.err++,console.warn(l),o.unsubscribe()}),s=Rr(100).subscribe(()=>{o.closed&&(this.shared.alert.remove(i.messageId),s.unsubscribe())})}})):this.shared.alert.info("Vui l\xf2ng ch\u1ecdn d\xf2ng c\u1ea7n x\xf3a.")}onAutoFixTicket(){let e=this.gridApi.getSelectedNodes();0!==e.length?(this.visibleColumn("send_status",!0),this.isShowMsg=!0,this.msgObj={title:"S\u1eeda d\u1eef li\u1ec7u",total:e.length,ok:0,err:0},this.shared.modal.create({nzClosable:!1,nzOkText:"S\u1eeda d\u1eef li\u1ec7u",nzCancelText:"Kh\xf4ng",nzTitle:"C\u1ea3nh b\xe1o !!",nzContent:"B\u1ea1n c\xf3 ch\u1eafc mu\u1ed1n s\u1eeda d\xf2ng \u0111\u01b0\u1ee3c ch\u1ecdn ?",nzOnOk:()=>{let i=this.shared.loading("\u0110ang s\u1eeda d\u1eef li\u1ec7u"),a=e.map(l=>(0,Ke.of)(l.data).pipe((0,Jn.b)(c=>this.refreshRow(l,{send_status:!0})),(0,zt.w)(c=>this._handleAutoFixTicket(l)))),o=(0,Ke.of)(...a).pipe((0,oi.b)(l=>l.pipe(si(5e3)))).subscribe(l=>{this.refreshRow(l.node,Object.assign(Object.assign({},l.data),{send_status:l.status})),"error"===l.status?this.msgObj.err++:this.msgObj.ok++},l=>{this.msgObj.err++,this.refreshRow(l.node,{send_status:"error"})}),s=Rr(100).subscribe(()=>{o.closed&&(s.unsubscribe(),this.shared.alert.remove(i.messageId),this.visibleColumn("send_status",!1),this.clickAsyncTicket())})}})):this.shared.alert.info("B\u1ea1n ch\u01b0a ch\u1ecdn d\xf2ng \u0111\u1ec3 s\u1eeda.")}_handleAutoFixTicket(e){return new Nt.y(i=>{this.nodeTicket=e,this.ticketForm.setTicket(e.data,!0),this.ticketForm.autoFixTicket(null,!0),this.ticketForm.onSaveTicket(!1),i.next({data:{},node:e,status:"success"}),i.complete()})}clickConfigAccount(){this.router.navigate(["/account"])}clickQuestions(){this.router.navigate(["/questions"])}onRowClicked(e){this.nodeTicket=e.node,!0===this.asyncInput?this.shared.modal.confirm({nzTitle:"Th\xf4ng b\xe1o",nzContent:"B\u1ea1n \u0111ang nh\u1eadp li\u1ec7u th\xf4ng tin ticket. B\u1ea1n c\xf3 mu\u1ed1n c\u1eadp nh\u1eadt l\u1ea1i th\xf4ng tin t\u1eeb danh s\xe1ch v\u1eeba click.",nzCancelText:"Kh\xf4ng",nzOnCancel:()=>console.log("Kh\xf4ng c\u1eadp nh\u1eadt th\xf4ng tin v\u1eeda click t\u1eeb danh s\xe1ch"),nzOkText:"C\u1eadp nh\u1eadt",nzOnOk:()=>this.clickEditTicket(e.data)}):this.clickEditTicket(e.data)}clickEditTicket(e){D.K$.log("clickEditTicket()",e),this.editTicket=null,this.isLoadWithChanel||((e.chanels||[]).sort((i,a)=>i.position-a.position),this.editTicket=e,this.isNew=!1)}onRemoveTicket(e){console.log(`[${e.id}] X\xf3a Ticket`),this.onRemoveNode(this.nodeTicket)}onRemoveNode(e){this.gridApi.applyTransaction({remove:[e.data]})}clickLogout(){this.cfigCtrl.read().clear(this.shared),this.shared.navigateLogin(this.router)}clickRemoveCache(e=!0){D.K$.log("-- Xo\xe1 Cache --");let i=e?this.shared.loading("\u0110ang x\xf3a b\u1ed9 nh\u1edb"):void 0;this.cfigCtrl.clearAllCache().subscribe(a=>{void 0!==i&&(this.shared.alert.remove(i.messageId),this.shared.alert.success(a.msg,{nzDuration:2e3}))},a=>{console.warn(a)})}sortGridByIndex(e){(0,D.Ft)(this.gridApi)||(this.gridColumnApi.applyColumnState({state:[{colId:"index_stt",sort:e}]}),this.lblGrid.view="STT > "+("asc"===e?"A-Z":"Z-A"))}showColumnAgGrid(e){let i=e;switch("object"==typeof e&&(i=e.grid_code),this.shared.setByKey("agGridViewType",i),this.agGridViewType=i,this.isViewSendHelpdesk=!1,this.disableWithChanel(this.isViewToolSendTicket),i){case"ALL":this.gridColumnApi.setColumnsVisible(this.agColumnFix.id,!0);break;case"DEFAULT":this.gridColumnApi.resetColumnState();break;case"REPORT_KPI":this.sortGridByIndex("asc"),this.searchForm.controls.withChanel.setValue(!0);break;case"BODY_EMAIL":!0===this.isLoadWithChanel&&this.searchForm.get("withChanel").setValue(!1),this.visibleColumns(["content_copy"],!0);break;case Ir.g1:this.isViewSendHelpdesk=!0,this.msgObj=void 0,this.searchForm.get("withChanel").setValue(!1),this.searchForm.get("hideFormCreate").setValue(!0)}"object"==typeof e&&Ze.showOnlyColumns(this.gridColumnApi,this.agColumnFix.id,e)}resetDataAgrid(){this.data=[],this.dataCache=[],this.isShowMsg=!1,this.showBtnUpdate=!1,this.lblGrid.countTicket=0,this.lblGrid.countChanel=0}clickAsyncTicket(e){if(this.searchForm.invalid)return;this.resetDataAgrid(),this.editTicket=void 0,this.nodeTicket=void 0,this.lblPathDir_=void 0,this.isLoadSearch=!0,this.allImageUpload={},(0,D.Ft)(e)||this.searchForm.get("withChanel").setValue(e);let i=this.searchForm.value;this.isLoadWithChanel=!0===i.withChanel;const a=new K.uU("en-US").transform(i.ticketOn[0],"yyyy-MM-dd")+"T00:00:00",o=new K.uU("en-US").transform(i.ticketOn[1],"yyyy-MM-dd")+"T23:59:59";let l=this.shared.loading(`\u0110ang L\u1ea5y d\u1eef li\u1ec7u <br/>- T\u1eeb ng\xe0y: <b>${a}</b> <br/> - \u0110\u1ebfn ng\xe0y: <b>${o}</b>`);this.ticketCtrl.findByCreateOn(a,o).subscribe(c=>{let u=c.content||[];this.lblGrid.countTicket=u.length,this.dataCache=u,this.isLoadWithChanel?(this.convertTicketByCheckViewChanel(u),this.lblGrid.countChanel=this.data.length,this.sortGridByIndex("asc")):(this.data=u,this.sortGridByIndex("asc")),this.isLoadSearch=!1,this.shared.alert.remove(l.messageId),this.shared.alert.success(`[${this.data.length}] L\u1ea5y Ticket xong r\u1ed3i.`),this.cd.detectChanges()},c=>{this.isLoadSearch=!1,this.shared.alert.remove(l.messageId),D.K$.log("X\u1ea3y ra l\u1ed7i l\u1ea5y d\u1eef li\u1ec7u:",c)})}clickRefreshConfig(){}showTicketWithChanel(e){(0,D.Ft)(e)&&(e=this.searchForm.get("withChanel").value),this.isLoadWithChanel=!0===e,!0!==e?this.data=this.dataCache:this.convertTicketByCheckViewChanel()}get AgridHeader(){return this.gridColumnApi.getAllDisplayedColumns().map(i=>({[i.getColId()]:i.getColDef().headerName}))}convertTicketByCheckViewChanel(e=this.dataCache){console.log("convertTicketByCheckViewChanel()"),this.data=[];for(const i in e){const a=e[i];for(let o=0;o<a.chanels.length;o++){const s=Object.assign({},a);s.first_chanel=s.chanels[o],this.data.push(s)}}}visibleColumn(e,i=!0){this.gridColumnApi.setColumnVisible(e,i)}visibleColumns(e,i=!0,a=!0){Ze.visibleColumns(this.gridColumnApi,this.agColumnFix.id,e,i,a)}getAllRowSend(){if(this.isLoadWithChanel)return this.shared.modal.warning({nzContent:"Vui l\xf2ng b\u1ecf check `K\xeanh`"}),[];let e=this.gridApi.getSelectedNodes();return 0===e.length?(this.shared.modal.warning({nzContent:"Vui l\xf2ng ch\u1ecdn ticket \u0111\u1ec3 g\u1eedi"}),[]):(this.visibleColumn("send_status",!0),e)}refreshRow(e,i={}){Ze.refreshRow(this.gridApi,e,i)}onSendHelpdesk(e="all"){this.showColumnAgGrid(Ir.g1);let i=this.getAllRowSend();if(0==i.length)return;let a=["all","add_note_with_img"].includes(e);if(a&&this.isViewUploadDir&&(0,D.gS)(this.allImageUpload))return void this.shared.modal.warning({nzTitle:"C\u1ea3nh b\xe1o !!",nzContent:"Vui l\xf2ng ch\u1ecdn th\u01b0 m\u1ee5c ch\u1ee9a h\xecnh \u0111\xednh k\xe8m."});this.isShowMsg=!0,this.isSendTicket=!0,this.msgObj={title:"G\u1eedi Ticket",total:i.length,ok:0,err:0,action:e},a=a&&!(0,D.gS)(this.allImageUpload);let o=i.map(c=>(0,Ke.of)(c.data.ticket_id).pipe((0,Jn.b)(u=>this.refreshRow(c,{send_status:!0})),(0,zt.w)(u=>this.handleSendTicket(c,e,a)))),s=(0,Ke.of)(...o).pipe((0,oi.b)(c=>c.pipe(si(1e3))));this.runSendTicket=s.subscribe(c=>{this.refreshRow(c.node,Object.assign(Object.assign({},c.data),{send_status:c.status})),"error"===c.status?(this.msgObj.err++,this.showErrorAndStop(this.runSendTicket,c.node.data.ticket_id,c.data.error)):this.msgObj.ok++},c=>{this.msgObj.err++,this.refreshRow(c.node,{send_status:"error"}),this.showErrorAndStop(this.runSendTicket,c.node.data.ticket_id,c.error)});let l=Rr(500).subscribe(c=>{!(0,D.Ft)(this.runSendTicket)&&this.runSendTicket.closed&&(this.isSendTicket=!1,l.unsubscribe())},(0,Ai.q)(1))}handleSendTicket(e,i,a){i=(0,D.EU)(i)||"all"===i?null:i;let o=Object.assign({},e.data),s={isUpdate:this.isUpdateIfTicketExist,stopError:this.isStopTicketIfError,image_base64:!1===a?void 0:Object.keys(o.od_image).map(l=>`${l}.png`).filter(l=>void 0!==this.allImageUpload[l]).map(l=>({[l]:this.allImageUpload[l]})).reduce((l,c)=>Object.assign(Object.assign({},l),c),{})};return(null===i||-1!==i.indexOf("close"))&&(o.stage={id:3,name:"Ho\xe0n th\xe0nh"}),this.helpdesk.allInOne(i,o.ticket_id,s).pipe((0,zt.w)(l=>(0,Ke.of)({status:"success",node:e,data:l})),(0,Do.K)(l=>(0,Ke.of)({status:"error",node:e,data:{error:l}})))}stopSendTicket(){if(!(0,D.Ft)(this.runSendTicket)){this.runSendTicket.unsubscribe(),this.shared.alert.warning("\u0110\xe3 d\u1eebng g\u1eedi !!");let e=Rr(1e3).subscribe(i=>{this.clickAsyncTicket(),e.unsubscribe()},(0,Ai.q)(1))}}showErrorAndStop(e,i,a){"SessionExpired"===a.code?(e.unsubscribe(),this.shared.modal.error({nzTitle:"C\u1ea3nh b\xe1o !!",nzContent:a.message})):(this.shared.alert.error(`[${i}] > ${a.message}`),this.isStopTicketIfError&&e.unsubscribe())}onExportExcelMau(){this.excelCtrl.downloadFile("/assets/reportkpi_mau.xlsx").subscribe()}onExportXlsx(){Ze.exportExcel(this.gridApi,this.gridColumnApi,{fileName:"report_kpi"})}onImportXlsx(){var e=this;return Eo(function*(){e.isRunImport=!0,e.msgObj={title:"N\u1ea1p Excel",ok:0,err:0,total:0},e.shared.modal.create({nzTitle:"N\u1ea1p d\u1eef li\u1ec7u t\u1eeb file excel",nzContent:Hz,nzClassName:"select-file",nzClosable:!1,nzMaskClosable:!0,nzFooter:null,nzComponentParams:{isImportAndSave:!0}}).afterClose.pipe((0,Jn.b)(a=>{if((0,D.Ft)(a))return void(e.isRunImport=!1);a=Object.assign({isSave:!1,items:[]},a),e.data=[],e.dataCache=[],e.msgObj.total=a.items.length,e.msgObj.action=!0===a.isSave?"L\u01b0u":"Th\xeam";let o=a.isSave||!1,s=a.items.map(d=>e.prepareTicketFromXlsx(d)),c=(0,I_.x)(s,Fo.z).pipe((0,oi.b)(d=>(0,Ke.of)(d).pipe(si(2e3)))).subscribe({next:d=>{console.log(d),e.msgObj.ok++,o?(e.ticketForm.isAutoCreate=!0,e.ticketForm.setTicket(d,!0),e.ticketForm.onSaveTicket(),e.onSaveTicket({isNew:!0,ticket:e.ticketForm.editTicket})):e.onSaveTicket({isNew:!0,ticket:d})},error:d=>{e.msgObj.err++,console.warn(d)}}),u=Rr(1e3).subscribe(d=>{c.closed&&(e.isRunImport=!1,u.unsubscribe())})})).subscribe()})()}prepareTicketFromXlsx(e){let i=Object.assign({},e);if(["software","group_help","support_help","product_id","chanels"].forEach(o=>delete i[o]),!(0,D.EU)(e.chanels)){let o=e.chanels.split(",").map(l=>l.trim()),s=this.ticketForm.chanels.filter(l=>o.includes(l.extend_code));s.length>0&&(i.chanels=s)}if(!(0,D.EU)(e.software)){let o=e.software.trim(),s=this.ticketForm.softwares.filter(l=>l.code===o);s.length>0&&(i.software=s[0])}if(!(0,D.EU)(e.group_help)){let o=e.group_help.trim(),s=this.ticketForm.ghelps.filter(l=>l.code===o);s.length>0&&(i.group_help=s[0])}if(!(0,D.EU)(e.support_help)){let o=e.support_help.trim(),s=this.ticketForm.chanels.filter(l=>l.extend_code===o);s.length>0&&(i.support_help=s[0])}if(!(0,D.EU)(e.product_id)){let o=e.product_id.trim(),s=this.ticketForm.products.filter(l=>l.id===o);s.length>0&&(i.product=s[0])}return i}isShowTool(e){if("tool3"===e){let i=["delete_list","fix_row"];return this.totalSelect>0&&i.filter(a=>this.userDetail.isRole(a)).length>0}return"tool4"===e&&this.agGridViewType===Ir.g1}showCustomColumnAgGrid(e){this.showColumnAgGrid(e),this.agGridCustom=e}createAgGridTemplate(){throw Object.assign({grid_type:this.KEY_GRID_TYPE},!0===this.agGridCustom.is_system?void 0:this.agGridCustom,{columns:this.gridColumnApi.getAllDisplayedColumns()}),new Error("[createAgGridTemplate] Method not support")}handleUpload(){console.log(this.allImageUpload)}onSendReport(){this.router.navigateByUrl("/send-report")}onUpdateApiKey(){this.nzModal.create({nzTitle:"C\u1eadp nh\u1eadt m\xe3 k\xedch ho\u1ea1t",nzClosable:!1,nzContent:iI,nzMaskClosable:!1,nzOkText:"L\u1ea5y m\xe3 k\xedch ho\u1ea1t",nzCancelText:"\u0110\xf3ng",nzFooter:null}).afterClose.subscribe(i=>{!(0,D.Ft)(i)&&!(0,D.gS)(i.data)&&(this.shared.alert.success("\u0110\xe3 l\u1ea5y xong m\xe3 k\xedch ho\u1ea1t."),this.isInitPage=!0,this.ticketForm.onLoadCatalog())})}isVisibleMenuSendTicket(e){return null==e||e}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(Qn.Sf),n.Y36(aI),n.Y36(n.sBO),n.Y36(ve.qu),n.Y36(qs),n.Y36(ud),n.Y36($t.F0),n.Y36($t.gz),n.Y36(Xs.t),n.Y36(li.W),n.Y36(rr.a),n.Y36(pI))},t.\u0275cmp=n.Xpm({type:t,selectors:[["t2t-table"]],viewQuery:function(e,i){if(1&e&&(n.Gf(yO,5),n.Gf(wO,5),n.Gf(TO,5),n.Gf(kO,5)),2&e){let a;n.iGM(a=n.CRH())&&(i.grid=a.first),n.iGM(a=n.CRH())&&(i.ticketForm=a.first),n.iGM(a=n.CRH())&&(i.importComp=a.first),n.iGM(a=n.CRH())&&(i.linkDown=a.first)}},features:[n.TTD],decls:69,vars:36,consts:[[3,"ticket","isAutoLoadCate","asyncInput","save","remove"],["ticketForm",""],[1,"ag-ticket"],[1,"row","tool-2","mb-5px"],[1,"col-12"],["nz-form","",1,"search-form",3,"nzLayout","formGroup"],[2,"margin-left","2px","width","300px"],["formControlName","ticketOn",3,"nzFormat"],["nz-checkbox","","formControlName","withChanel"],["nz-checkbox","","formControlName","hideFormCreate"],["type","button","nz-button","",3,"disabled","click"],["class","fa-regular fa-arrows-spin fa-spin",4,"ngIf"],["class","fa-regular fa-magnifying-glass",4,"ngIf"],[4,"ngIf"],["nz-button","","nz-dropdown","",3,"nzTrigger","nzDropdownMenu","disabled"],[1,"fa-regular","fa-plus-minus"],["nzMenuOther",""],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngIf"],[1,"fa-regular","fa-file-export"],["nzMenuAccount",""],["nz-menu-item","",3,"click"],[1,"fa-regular","fa-circle-trash"],[1,"fa-regular","fa-circle-question"],["nz-menu-item","",3,"routerLink",4,"ngIf"],[1,"fa-regular","fa-copy"],[1,"fa-regular","fa-right-from-bracket"],[1,"countRow"],[1,"lbl"],[1,"number"],[2,"width","100%","height","100%"],[3,"minHeight","items","columns","options","theme","gridReady"],["grid",""],[1,"fa-regular","fa-arrows-spin","fa-spin"],[1,"fa-regular","fa-magnifying-glass"],[1,"fa-regular","fa-filter"],["nzMenuFilter",""],["ngFor","",3,"ngForOf","ngForTrackBy"],["class","fa-regular fa-cloud-arrow-up",4,"ngIf"],["nzMenuSendHelpdesk",""],[1,"fa-regular","fa-cloud-arrow-up"],["nz-button","","nz-dropdown","","nzTrigger","click",3,"nzDropdownMenu","disabled"],["class","fa-regular fa-file-import",4,"ngIf"],["nzMenuNXDL",""],[1,"fa-regular","fa-file-excel"],[1,"fa-regular","fa-file-import"],[1,"fa-regular","fa-cloud-arrow-down"],["nz-button","","nz-dropdown","",3,"nzDropdownMenu","nzTrigger","disabled"],[1,"fa-regular","fa-bars"],["nzMenuReport",""],["nz-menu","",1,"ag_grid"],[1,"fa-regular","fa-hammer"],[1,"fa-regular","fa-calendar-lines-pen"],[1,"fa-regular","fa-send-backward"],["nz-menu-item","",3,"routerLink"],[1,"fa-regular","fa-gears"],[1,"row","tool-3","mb-2","mt-2"],[1,"col-12","d-flex"],["nzType","vertical",1,"align-self-center"],["nz-checkbox","",3,"ngModel","ngModelChange"],["nzAccept","image/png","nzMultiple","",3,"nzBeforeUpload"],[1,"link_dir"],[1,"send-log","d-flex","align-items-center"],[1,"oki"],[1,"err"],[1,"total"],[1,"act"],[1,"run"],[1,"btnStopSend",3,"click"]],template:function(e,i){if(1&e&&(n.TgZ(0,"cy-ticket-form",0,1),n.NdJ("asyncInput",function(o){return i.asyncInput=o})("save",function(o){return i.onSaveTicket(o)})("remove",function(o){return i.onRemoveTicket(o)}),n.qZA(),n.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"form",5)(6,"nz-form-item")(7,"nz-form-control",6),n._UZ(8,"nz-range-picker",7),n.qZA()(),n.TgZ(9,"nz-form-item")(10,"nz-form-control")(11,"label",8),n._uU(12,"K\xeanh"),n.qZA(),n.TgZ(13,"label",9),n._uU(14,"\u1ea8n Form"),n.qZA()()(),n.TgZ(15,"nz-form-item")(16,"nz-form-control")(17,"button",10),n.NdJ("click",function(){return i.clickAsyncTicket()}),n.YNc(18,SO,1,0,"i",11),n.YNc(19,bO,1,0,"i",12),n._uU(20,"L\u1ea5y d\u1eef li\u1ec7u "),n.qZA()()(),n.YNc(21,IO,9,5,"nz-form-item",13),n.TgZ(22,"nz-form-item")(23,"nz-form-control"),n.YNc(24,AO,10,7,"ng-container",13),n.YNc(25,BO,16,6,"ng-container",13),n.YNc(26,UO,14,6,"ng-container",13),n.TgZ(27,"button",14),n._UZ(28,"i",15),n._uU(29,"Kh\xe1c "),n.qZA(),n.TgZ(30,"nz-dropdown-menu",null,16)(32,"ul",17),n.YNc(33,HO,3,0,"li",18),n.YNc(34,VO,3,0,"li",18),n.YNc(35,ZO,3,0,"li",18),n.YNc(36,jO,3,0,"li",18),n.qZA()(),n.TgZ(37,"button",14),n._UZ(38,"i",19),n._uU(39,"T\xe0i kho\u1ea3n "),n.qZA(),n.TgZ(40,"nz-dropdown-menu",null,20)(42,"ul",17)(43,"li",21),n.NdJ("click",function(){return i.clickRemoveCache()}),n.TgZ(44,"a"),n._UZ(45,"i",22),n._uU(46,"X\xf3a Cache"),n.qZA()(),n.TgZ(47,"li",21),n.NdJ("click",function(){return i.clickQuestions()}),n.TgZ(48,"a"),n._UZ(49,"i",23),n._uU(50,"C\xe2u h\u1ecfi"),n.qZA()(),n.YNc(51,WO,4,2,"li",24),n.TgZ(52,"li",21),n.NdJ("click",function(){return i.onUpdateApiKey()}),n._UZ(53,"i",25),n._uU(54,"M\xe3 k\xedch ho\u1ea1t"),n.qZA(),n.TgZ(55,"li",21),n.NdJ("click",function(){return i.clickLogout()}),n.TgZ(56,"a"),n._UZ(57,"i",26),n._uU(58,"\u0110\u0103ng xu\u1ea5t"),n.qZA()()()(),n.TgZ(59,"label",27)(60,"span",28),n._uU(61,"T\u1ed5ng s\u1ed1: "),n.qZA(),n.TgZ(62,"span",29),n._uU(63),n.qZA(),n.YNc(64,YO,5,1,"span",13),n.qZA()()()()()(),n.YNc(65,XO,12,5,"ng-container",13),n.TgZ(66,"div",30)(67,"cy-custom-grid",31,32),n.NdJ("gridReady",function(o){return i.onGridReady(o)}),n.qZA()()()),2&e){const a=n.MAs(31),o=n.MAs(41),s=n.MAs(68);n.Udp("display",i.isHideFormCreate),n.Q6J("ticket",i.editTicket)("isAutoLoadCate",i.isAutoLoadCate),n.xp6(5),n.Q6J("nzLayout","inline")("formGroup",i.searchForm),n.xp6(3),n.Q6J("nzFormat","yyyy-MM-dd"),n.xp6(9),n.Q6J("disabled",i.disabledAction),n.xp6(1),n.Q6J("ngIf",i.isLoadSearch),n.xp6(1),n.Q6J("ngIf",!i.isLoadSearch),n.xp6(2),n.Q6J("ngIf",i.userDetail.isRole(n.DdM(33,KO))),n.xp6(3),n.Q6J("ngIf",i.isShowTool("tool4")),n.xp6(1),n.Q6J("ngIf",i.userDetail.isRole(n.DdM(34,eE))),n.xp6(1),n.Q6J("ngIf",i.userDetail.isRole(n.DdM(35,tE))),n.xp6(1),n.Q6J("nzTrigger","click")("nzDropdownMenu",a)("disabled",i.disabledAction),n.xp6(6),n.Q6J("ngIf",i.isRole("delete_ticket")),n.xp6(1),n.Q6J("ngIf",i.isRole("fix_row")),n.xp6(1),n.Q6J("ngIf",i.isRole("create_grid")),n.xp6(1),n.Q6J("ngIf",i.isRole("send_report")),n.xp6(1),n.Q6J("nzTrigger","click")("nzDropdownMenu",o)("disabled",i.disabledAction),n.xp6(14),n.Q6J("ngIf",i.isRole("admin")),n.xp6(12),n.hij("T=",i.countTicket," "),n.xp6(1),n.Q6J("ngIf",i.isLoadWithChanel),n.xp6(1),n.Q6J("ngIf",i.isViewToolSendTicket),n.xp6(2),n.Q6J("minHeight","300px")("items",i.data)("columns",i.columnDefs)("options",i.gridOptions)("theme",s.themeList.balham)}},directives:[CO,ve._Y,ve.JL,Fi.Lr,ve.sg,xd.SK,Fi.Nx,xd.t3,Fi.Fd,Rl,z_,ve.JJ,ve.u,Nr.Ie,It.ix,Mr.dQ,Mn.w,K.O5,zl,bl,Il,ml,K.sg,Sa,$t.rH,yh,ve.On,Tl,_n.gB,al],styles:[".ag-ticket{box-sizing:border-box;margin-bottom:40px;border-top:2px solid #2f54eb;padding-top:.5rem}.ag-ticket .fal{font-size:1rem;font-weight:inherit}.ag-ticket .fal.fa-exclamation-circle{color:var(--bs-red)}.ag-ticket .fal.fa-times{color:var(--bs-danger)}.ag-ticket .fal.fa-comment{color:var(--bs-info)}ul.ag_grid .menu-header{padding:unset}ul.ag_grid .menu-header .title{padding:5px 12px}.send-log{width:unset}.send-log label{margin-right:5px}.send-log label i{margin-left:5px}.send-log label .err{color:var(--bs-red)}.send-log label .oki{color:var(--bs-success)}.send-log label .total{color:var(--bs-indigo)}.send-log label .run{color:var(--bs-primary)}a.link_dir{color:var(--bs-red)!important}.ant-divider{top:-.3em}.search-form nz-range-picker,.search-form [nz-checkbox]{margin-right:5px}.search-form.ant-form-inline .ant-form-item{margin-right:0}.search-form label.countRow .lbl{color:#007bff}.search-form label.countRow .number{color:red}.row.tool-3 .ant-form-item{margin:9px 0 15px}.row.tool-3 .ant-form-item-control{line-height:0px}.row.tool-3 .col-send-result{font-weight:700}.row.tool-3 .col-send-result .ok{margin-left:5px;color:#007bff}.row.tool-3 .col-send-result .err{margin-left:5px;color:#dc3545}.row.tool-3 .col-send-result .total{margin-left:5px;color:#28a745}.row.tool-3 .btnStopSend{color:#0056b3;text-decoration:underline}[nz-menu]{min-width:200px}[nz-menu] .ant-divider-inner-text{padding:0 10px}.select-file .ant-modal-body{padding:0}\n"],encapsulation:2}),t})(),rE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[K.ez,ve.u5,ve.UX,Qn.Qp,It.sL,Pt.PV,kl]]}),t})(),vd=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[K.ez,ri],ri]}),t})(),iE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[K.ez,_n.o7]]}),t})(),aE=(()=>{class t{constructor(e,i,a,o){this.appVersion=e,this.config=i,this.user=a,this.router=o,this.logger=new pd.Y(t)}canActivate(e,i){return new Nt.y(a=>{this.user.read().isAuthenticated()?(a.next(!0),a.complete()):(this.config.read(),this.user.shared.navigateLogin(this.router),a.next(!1),a.complete())})}checkAppVersion(e,i){return new Nt.y(a=>{e===this.appVersion?(a.next(!0),a.complete()):this.config.shared.modal.create({nzTitle:`C\u1ea3nh b\xe1o - V.${this.appVersion}`,nzContent:"Phi\xean b\u1ea3n \u1ee9ng d\u1ee5ng \u0111\xe3 l\u1ed7i th\u1eddi -> Vui l\xf2ng \u0111\u0103ng xu\u1ea5t v\xe0 \u0111\u0103ng nh\u1eadp l\u1ea1i.",nzCancelText:"\u0110\u1ec3 sau",nzOkText:"\u0110\u0103ng xu\u1ea5t",nzOnCancel:()=>"close",nzOnOk:()=>"ok"}).afterClose.subscribe(s=>{let l="ok"===s;l&&this.user.shared.navigateLogin(this.router,i),a.next(!l),a.complete()})})}}return t.\u0275fac=function(e){return new(e||t)(n.LFG(Ir.Ji),n.LFG(Xs.t),n.LFG(rr.a),n.LFG($t.F0))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var oE=oe(9727),sE=oe(2359);let lE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[K.ez]]}),t})(),cE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[K.ez,ve.UX,It.sL,_n.o7,Pt.PV]]}),t})(),uE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[K.ez,ve.UX,ve.u5,It.sL,Pt.PV,Nr.Wr,Qn.Qp,vd]]}),t})(),dE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[K.ez,on.JF,ve.u5,ve.UX,lE,cE,uE,Fr.A0,Bl,gl,_n.o7,Nr.Wr,Ol,cl,Sl,It.sL,Pt.PV,Qn.Qp,sE.L,Fi.U5,oE.gR]]}),t})();const fE=[{path:"",component:nE,canActivate:[aE]}];let pE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[K.ez,$t.Bz.forChild(fE),on.JF,ve.u5,ve.UX,dE,Bl,rE,Fr.A0,ko,gl,_n.o7,Nr.Wr,Ol,cl,Sl,It.sL,Pt.PV,Fi.U5,kl,vd,iE]]}),t})()},4327:function(yo,Ca){var ve;void 0!==(ve=function(){"use strict";function on(Ee,be,gn){var nt=new XMLHttpRequest;nt.open("GET",Ee),nt.responseType="blob",nt.onload=function(){ct(nt.response,be,gn)},nt.onerror=function(){console.error("could not download file")},nt.send()}function Fr(Ee){var be=new XMLHttpRequest;be.open("HEAD",Ee,!1);try{be.send()}catch(gn){}return 200<=be.status&&299>=be.status}function n(Ee){try{Ee.dispatchEvent(new MouseEvent("click"))}catch(gn){var be=document.createEvent("MouseEvents");be.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),Ee.dispatchEvent(be)}}var mn="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,zi=mn.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),ct=mn.saveAs||("object"!=typeof window||window!==mn?function(){}:"download"in HTMLAnchorElement.prototype&&!zi?function(Ee,be,gn){var nt=mn.URL||mn.webkitURL,en=document.createElement("a");en.download=be=be||Ee.name||"download",en.rel="noopener","string"==typeof Ee?(en.href=Ee,en.origin===location.origin?n(en):Fr(en.href)?on(Ee,be,gn):n(en,en.target="_blank")):(en.href=nt.createObjectURL(Ee),setTimeout(function(){nt.revokeObjectURL(en.href)},4e4),setTimeout(function(){n(en)},0))}:"msSaveOrOpenBlob"in navigator?function(Ee,be,gn){if(be=be||Ee.name||"download","string"!=typeof Ee)navigator.msSaveOrOpenBlob(function K(Ee,be){return void 0===be?be={autoBom:!1}:"object"!=typeof be&&(console.warn("Deprecated: Expected third argument to be a object"),be={autoBom:!be}),be.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(Ee.type)?new Blob(["\ufeff",Ee],{type:Ee.type}):Ee}(Ee,gn),be);else if(Fr(Ee))on(Ee,be,gn);else{var nt=document.createElement("a");nt.href=Ee,nt.target="_blank",setTimeout(function(){n(nt)})}}:function(Ee,be,gn,nt){if((nt=nt||open("","_blank"))&&(nt.document.title=nt.document.body.innerText="downloading..."),"string"==typeof Ee)return on(Ee,be,gn);var en="application/octet-stream"===Ee.type,ll=/constructor/i.test(mn.HTMLElement)||mn.safari,ya=/CriOS\/[\d]+/.test(navigator.userAgent);if((ya||en&&ll||zi)&&"undefined"!=typeof FileReader){var wa=new FileReader;wa.onloadend=function(){var Dr=wa.result;Dr=ya?Dr:Dr.replace(/^data:[^;]*;/,"data:attachment/file;"),nt?nt.location.href=Dr:location=Dr,nt=null},wa.readAsDataURL(Ee)}else{var Ta=mn.URL||mn.webkitURL,ka=Ta.createObjectURL(Ee);nt?nt.location=ka:location.href=ka,nt=null,setTimeout(function(){Ta.revokeObjectURL(ka)},4e4)}});mn.saveAs=ct.saveAs=ct,yo.exports=ct}.apply(Ca,[]))&&(yo.exports=ve)}}]);