"use strict";(self.webpackChunkTS24AppWeb=self.webpackChunkTS24AppWeb||[]).push([[392],{5392:(B,h,o)=>{o.r(h),o.d(h,{SigninModule:()=>V});var d=o(9808),f=o(1083),l=o(2382),v=o(520),A=o(8505),c=o(7854),S=o(2423),n=o(5e3),m=o(1047),y=o(2683);const Z=["input"];let U=(()=>{class e{constructor(){}ngOnInit(){}get element(){return this.input.nativeElement}get value(){return this.element.value}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Xpm({type:e,selectors:[["cy-security-form"]],viewQuery:function(t,i){if(1&t&&n.Gf(Z,5,n.SBq),2&t){let r;n.iGM(r=n.CRH())&&(i.input=r.first)}},decls:7,vars:0,consts:[[1,"row"],[1,"col-12"],["for","security_key"],["type","password","id","security_key","placeholder","Nh\u1eadp kh\xf3a b\u1ea3o m\u1eadt","nz-input",""],["input",""]],template:function(t,i){1&t&&(n.TgZ(0,"div",0)(1,"div",1)(2,"nz-input-group")(3,"label",2),n._uU(4,"Kh\xf3a b\u1ea3o m\u1eadt: "),n.qZA(),n._UZ(5,"input",3,4),n.qZA()()())},directives:[m.gB,y.w,m.Zp],styles:[""]}),e})();var x=o(6431),I=o(857),T=o(6305),b=o(4546),C=o(6114),z=o(6042),D=o(2643);function F(e,s){if(1&e&&(n.TgZ(0,"div",4)(1,"nz-input-group",5),n._UZ(2,"input",21),n.qZA()()),2&e){n.oxw();const t=n.MAs(34);n.xp6(1),n.Q6J("nzPrefix",t)}}function J(e,s){if(1&e){const t=n.EpF();n.TgZ(0,"label",22),n.NdJ("nzCheckedChange",function(r){return n.CHM(t),n.oxw().isVisibleUrlDev=r}),n._uU(1,"Dev h\u1ec7 th\u1ed1ng"),n.qZA()}if(2&e){const t=n.oxw();n.Q6J("nzChecked",t.isVisibleUrlDev)}}function k(e,s){1&e&&n._UZ(0,"i",23)}function L(e,s){1&e&&n._UZ(0,"i",24)}function E(e,s){1&e&&n._UZ(0,"i",25)}function M(e,s){1&e&&n._UZ(0,"i",26)}let _=(()=>{class e{constructor(t,i,r,a,g,p,u){this.appVersion=t,this.config=i,this.fb=r,this.router=a,this.activeR=g,this.userCtrl=p,this.shared=u,this.isAsyncLogin=!1,this.isDebugDev=!1,this.isVisibleUrlDev=!1,this.redirectUrl=""}ngOnInit(){if(this.userCtrl.read().isAuthenticated())this.router.navigate(["/",this.redirectUrl]);else{let t=null,i=null,r=!1;this.activeR.queryParams.subscribe(a=>{this.isDebugDev=a.debug,this.redirectUrl=a.redirect_url||"";let g=this.shared.getRememberLogin();(0,c.gS)(g)||(t=g.username,i=g.password,r=g.remember)}),this.loginForm=this.fb.group({email:[t,l.kI.required],code:[i,l.kI.required],url_dev:[this.config.read().api_url_dev],remember:[r],isDev:!1})}}gotoSignUp(){this.shared.modal.create({nzMaskClosable:!1,nzMask:!0,nzClosable:!1,nzContent:U,nzOkText:"M\u1edf kh\xf3a",nzCancelText:null,nzOnOk:i=>this.onSubmitSecurityKey(i)}).afterClose.subscribe(i=>{this.router.navigate(["/","signup"])})}onLogin(){if(this.loginForm.invalid)return void this.shared.alert.error("Vui l\xf2ng nh\u1eadp \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin.");const{remember:t,email:i,code:r,url_dev:a}=this.loginForm.value;this.config.load().then(g=>{g=g.assign({api_url_dev:a,isDev:this.isDev,api_key:this.isDev?"api_url_dev":"api_url"},!0).saveBy(this.shared),this.shared.setRememberLogin(t,i,r);let p=this.shared.loading("<b>\u0110ang ki\u1ec3m tra \u0111\u0103ng nh\u1eadp</b>");this.isAsyncLogin=!0,this.userCtrl.login(i,r).pipe((0,A.b)(u=>this.isAsyncLogin=!1)).subscribe({next:u=>{console.log("User Login: "+u.email),this.shared.alert.remove(p.messageId);let P=(0,c.oA)(u.config.isCfigDef||!1)?{save_default:1}:{};this.router.navigate(["/",this.redirectUrl],{queryParams:P})},error:u=>{this.isAsyncLogin=!1,this.shared.alert.remove(p.messageId),c.K$.log("Login Error",u),(0,c.Ft)(u.staus)&&!(0,c.EU)(u.msg)&&this.shared.alert.error(u.msg)}})})}get isDev(){return this.loginForm.get("isDev").value}changeApiUrl(t){console.log(t),this.loginForm.get("url_dev").setValue(t.url)}onSubmitSecurityKey(t){const i=(0,c._3)("yyyyMMdd")===t.value;return i||this.shared.alert.error("Sai kh\xf3a b\u1ea3o m\u1eadt"),Promise.resolve(i)}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(S.Ji),n.Y36(x.t),n.Y36(l.qu),n.Y36(f.F0),n.Y36(f.gz),n.Y36(I.a),n.Y36(T.W))},e.\u0275cmp=n.Xpm({type:e,selectors:[["cy-signin"]],decls:37,vars:14,consts:[["nz-form","",1,"login-form",3,"formGroup","ngSubmit"],[1,"row","pb-2"],[1,"col-12"],[1,"row"],[1,"col-12","form-group"],[3,"nzPrefix"],["type","text","id","email","nz-input","","formControlName","email","placeholder","E-mail NV"],["type","password","id","code","nz-input","","formControlName","code","placeholder","Nh\u1eadp MK"],["class","col-12 form-group",4,"ngIf"],[1,"col-12","d-flex","align-items-center","form-group"],["nz-checkbox","","formControlName","remember",1,"ml-auto"],["nz-checkbox","","class","ml-2",3,"nzChecked","nzCheckedChange",4,"ngIf"],[1,"col-6","d-grid","gap-2"],["nz-button","",1,"btn","btn-login",3,"nzType","disabled"],["class","fa-regular fa-right-to-bracket",4,"ngIf"],["class","fa-regular fa-arrows-spin fa-spin",4,"ngIf"],[1,"col-6","d-grid","gap-2","pdl-5"],["nz-button","","type","button",1,"btn","btn-signup",3,"disabled","click"],[1,"fa-regular","fa-user-plus"],["userIcon",""],["passwordIcon",""],["type","text","id","url_dev","nz-input","","formControlName","url_dev","placeholder","Url Dev"],["nz-checkbox","",1,"ml-2",3,"nzChecked","nzCheckedChange"],[1,"fa-regular","fa-right-to-bracket"],[1,"fa-regular","fa-arrows-spin","fa-spin"],[1,"fa-regular","fa-user"],[1,"fa-regular","fa-lock"]],template:function(t,i){if(1&t&&(n.TgZ(0,"form",0),n.NdJ("ngSubmit",function(){return i.onLogin()}),n.TgZ(1,"div",1)(2,"div",2)(3,"span"),n._uU(4,"Version: "),n.qZA(),n.TgZ(5,"em"),n._uU(6),n.ALo(7,"date"),n.qZA()()(),n.TgZ(8,"div",3)(9,"div",4)(10,"nz-input-group",5),n._UZ(11,"input",6),n.qZA()(),n.TgZ(12,"div",4)(13,"nz-input-group",5),n._UZ(14,"input",7),n.qZA()(),n.YNc(15,F,3,1,"div",8),n.qZA(),n.TgZ(16,"div",3)(17,"div",9)(18,"label",10),n._uU(19,"Ghi nh\u1edb t\xe0i kho\u1ea3n"),n.qZA(),n.YNc(20,J,2,1,"label",11),n.qZA()(),n.TgZ(21,"div",3)(22,"div",12)(23,"button",13),n.YNc(24,k,1,0,"i",14),n.YNc(25,L,1,0,"i",15),n.TgZ(26,"span"),n._uU(27,"\u0110\u0103ng nh\u1eadp"),n.qZA()()(),n.TgZ(28,"div",16)(29,"button",17),n.NdJ("click",function(){return i.gotoSignUp()}),n._UZ(30,"i",18),n.TgZ(31,"span"),n._uU(32,"\u0110\u0103ng k\xfd"),n.qZA()()()()(),n.YNc(33,E,1,0,"ng-template",null,19,n.W1O),n.YNc(35,M,1,0,"ng-template",null,20,n.W1O)),2&t){const r=n.MAs(34),a=n.MAs(36);n.Q6J("formGroup",i.loginForm),n.xp6(6),n.Oqu(n.xi3(7,11,i.appVersion,"yyyyMMddHHmmss")),n.xp6(4),n.Q6J("nzPrefix",r),n.xp6(3),n.Q6J("nzPrefix",a),n.xp6(2),n.Q6J("ngIf",i.isVisibleUrlDev),n.xp6(5),n.Q6J("ngIf",i.isDebugDev),n.xp6(3),n.Q6J("nzType","primary")("disabled",i.isAsyncLogin),n.xp6(1),n.Q6J("ngIf",!i.isAsyncLogin),n.xp6(1),n.Q6J("ngIf",i.isAsyncLogin),n.xp6(4),n.Q6J("disabled",i.isAsyncLogin)}},directives:[l._Y,l.JL,b.Lr,l.sg,m.gB,y.w,m.ke,m.Zp,l.Fj,l.JJ,l.u,d.O5,C.Ie,z.ix,D.dQ],pipes:[d.uU],styles:[".ant-form-item{margin:0}.login-form{max-width:300px;margin:50px auto auto}.login-form [nz-button]{margin-right:0}.login-form .row>*{padding-left:0;padding-right:0}.login-form .btn-login{float:left}.login-form .btn-login.btnGoogle{margin-left:6px}\n"],encapsulation:2}),e})();var N=o(2866),Q=o(3087);const Y=[{path:"",component:_}];let V=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[[d.ez,f.Bz.forChild(Y),v.JF,l.u5,l.UX,v.JF,N.A0,m.o7,C.Wr,z.sL,Q.PV,b.U5]]}),e})()}}]);