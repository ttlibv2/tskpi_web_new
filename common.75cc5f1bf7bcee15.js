"use strict";(self.webpackChunkTS24AppWeb=self.webpackChunkTS24AppWeb||[]).push([[592],{3073:(O,s,o)=>{o.d(s,{l:()=>C});var _=o(3075),u=o(1708),E=o(3900),c=o(9646),h=o(6305),g=o(9690),m=o(857),t=o(5e3),p=o(9727),d=o(7957),M=o(9808),A=o(4376),l=o(1047),D=o(2683),T=o(6042),v=o(2643);function P(r,f){if(1&r){const e=t.EpF();t.TgZ(0,"div",6)(1,"label"),t._uU(2,"Danh s\xe1ch: "),t.qZA(),t.TgZ(3,"ng-select",15),t.NdJ("change",function(a){return t.CHM(e),t.oxw().onSelectGrid(a)}),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(3),t.Q6J("items",e.allItem)}}let C=(()=>{class r{constructor(e,n,a,i,U,I,Z){this.fb=e,this.config=n,this.userSrv=a,this.alert=i,this.modal=U,this.fieldSrv=I,this.nzModalRef=Z,this.model="ticket_list",this.showDS=!1,this.allItem=[],this.allField=[]}ngOnInit(){this.createFormGroup(),this.loadDSData(),this.createColumns(),this.onSelectGrid(this.field)}get isUpdate(){var e;return!(0,g.EU)(null===(e=this.field)||void 0===e?void 0:e.grid_id)}loadDSData(){this.showDS&&this.fieldSrv.getByAgType(this.model).pipe((0,E.w)(n=>(0,c.of)(Object.values(n.grid_field)))).subscribe({next:n=>this.allItem=n})}onSelectGrid(e){this.updatePrefixCode(null==e?void 0:e.grid_code),this.patchValue("grid_code",null==e?void 0:e.grid_code),this.patchValue("grid_title",null==e?void 0:e.grid_title),this.patchValue("grid_fields",null==e?void 0:e.grid_fields,!1)}onSave(){this.fieldSrv.createOrUpdate(this.field).subscribe({next:e=>this.alertCreateOke(e)})}onClose(){this.nzModalRef.destroy({})}static showError(e){console.log("error load ds grid: ",e)}createColumns(){return this.columns=[{headerName:"Key",field:"colId"},{headerName:"Name",field:"headerName"},{headerName:"Field",field:"field"},{headerName:"Index",field:"index"},{headerName:"Width",field:"width"},{headerName:"Checkbox",field:"checkbox"}]}createFormGroup(){this.form=this.fb.group({grid_code:[null,_.kI.required],grid_title:[null,_.kI.required],grid_fields:[null,_.kI.required]})}objectToText(e){return"object"==typeof e?JSON.stringify(e):e}patchValue(e,n,a=!0){n="object"==typeof n?JSON.stringify(n):n;const i=this.form.get(e);0==a||(0,g.EU)(n)?i.enable():i.disable(),i.patchValue(n)}updatePrefixCode(e){this.prefixCode=((null!=e?e:"").includes(".")?e.split(".")[0]:this.model)+"."}alertCreateOke(e){this.alert.success("\u0110\xe3 t\u1ea1o v\xe0 c\u1eadp nh\u1eadt m\u1eabu template th\xe0nh c\xf4ng !!"),this.userSrv.read().setGridFieldForAgType(this.model,e.grid_code,e),this.nzModalRef.destroy(e)}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(_.qu),t.Y36(h.W),t.Y36(m.a),t.Y36(p.dD),t.Y36(d.Sf),t.Y36(u.P),t.Y36(d.Lf))},r.\u0275cmp=t.Xpm({type:r,selectors:[["cy-ag-template"]],inputs:{model:"model",field:"field",showDS:"showDS"},decls:40,vars:4,consts:[[1,"ag-template",3,"formGroup"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"row"],["class","col-12",4,"ngIf"],[1,"col-12"],[1,"required"],["nz-input","","placeholder","Nh\u1eadp t\xean","formControlName","grid_title","required",""],[3,"nzPrefix"],["nz-input","","placeholder","Nh\u1eadp m\xe3","formControlName","grid_code","required",""],["nz-input","","placeholder","Nh\u1eadp n\u1ed9i dung c\u1ea5u h\xecnh","formControlName","grid_fields","required","",2,"max-height","200px",3,"nzAutosize"],[1,"row","tool-1","tool-line"],["type","button","nz-button","",3,"click"],[1,"far","fa-send"],["bindLabel","grid_title","disabled","",3,"items","change"]],template:function(e,n){1&e&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"h1"),t._uU(4,"T\u1ea1o / C\u1eadp nh\u1eadt m\u1eabu "),t.qZA()(),t.TgZ(5,"div",3)(6,"div",4),t.YNc(7,P,4,1,"div",5),t.TgZ(8,"div",6)(9,"label"),t._uU(10,"T\xean m\u1eabu "),t.TgZ(11,"span",7),t._uU(12,"(*)"),t.qZA(),t._uU(13," : "),t.qZA(),t._UZ(14,"input",8),t.qZA(),t.TgZ(15,"div",6)(16,"label"),t._uU(17,"M\xe3 m\u1eabu "),t.TgZ(18,"span",7),t._uU(19,"(*)"),t.qZA(),t._uU(20," : "),t.qZA(),t.TgZ(21,"nz-input-group",9),t._UZ(22,"input",10),t.qZA()(),t.TgZ(23,"div",6)(24,"label"),t._uU(25,"N\u1ed9i dung "),t.TgZ(26,"span",7),t._uU(27,"(*)"),t.qZA(),t._uU(28," : "),t.qZA(),t._UZ(29,"textarea",11),t.qZA()(),t.TgZ(30,"div",12)(31,"div",6)(32,"button",13),t.NdJ("click",function(){return n.onSave()}),t._UZ(33,"i",14),t.TgZ(34,"span"),t._uU(35,"L\u01b0u l\u1ea1i"),t.qZA()(),t.TgZ(36,"button",13),t.NdJ("click",function(){return n.onClose()}),t._UZ(37,"i",14),t.TgZ(38,"span"),t._uU(39,"\u0110\xf3ng"),t.qZA()()()()()()()),2&e&&(t.Q6J("formGroup",n.form),t.xp6(7),t.Q6J("ngIf",n.showDS),t.xp6(14),t.Q6J("nzPrefix",n.prefixCode),t.xp6(8),t.Q6J("nzAutosize",!0))},directives:[_._Y,_.JL,_.sg,M.O5,A.w9,l.Zp,_.Fj,_.JJ,_.u,_.Q7,l.gB,D.w,l.ke,l.rh,T.ix,v.dQ],styles:[".ag-template{max-width:500px}.ag-template .tool-line{box-sizing:border-box;margin-top:10px;border-top:2px solid #2f54eb;padding-top:.5rem}.ag-template .required{border-color:unset}\n"],encapsulation:2}),r})()},3220:(O,s,o)=>{o.r(s),o.d(s,{AgTemplateModule:()=>A});var _=o(9808),u=o(3075),c=(o(3073),o(1047)),h=o(6042),g=o(520),m=o(4376),t=o(7957),p=o(1298),d=o(5e3);let A=(()=>{class l{}return l.\u0275fac=function(T){return new(T||l)},l.\u0275mod=d.oAB({type:l}),l.\u0275inj=d.cJS({imports:[[_.ez,g.JF,u.u5,u.UX,m.A0,c.o7,h.sL,t.Qp,p.w],t.Qp,m.A0]}),l})()}}]);